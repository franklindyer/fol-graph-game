/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={523:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var o=i(601),n=i.n(o),s=i(314),r=i.n(s)()(n());r.push([t.id,"body {\n  margin: 0;\n  max-width: 100vw;\n}\n\npre,\ncode {\n  overflow: auto;\n}\n\n#pageContainer {\n  display: flex;\n  width: 100%;\n  max-width: 100vw;\n  height: 100vh;\n}\n\n#blocklyDiv {\n  flex-basis: 100%;\n  height: 100%;\n  min-width: 600px;\n}\n\n#outputPane {\n  display: flex;\n  flex-direction: column;\n  width: 400px;\n  flex: 0 0 400px;\n  overflow: auto;\n  margin: 1rem;\n}\n\n#generatedCode {\n  height: 50%;\n  background-color: rgb(247, 240, 228);\n}\n\n#output {\n  height: 50%;\n}\n",""]);const a=r},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",o=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),o&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),o&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,o,n,s){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(o)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);o&&r[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),e.push(c))}},e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},72:t=>{"use strict";var e=[];function i(t){for(var i=-1,o=0;o<e.length;o++)if(e[o].identifier===t){i=o;break}return i}function o(t,o){for(var s={},r=[],a=0;a<t.length;a++){var l=t[a],h=o.base?l[0]+o.base:l[0],c=s[h]||0,u="".concat(h," ").concat(c);s[h]=c+1;var d=i(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var g=n(p,o);o.byIndex=a,e.splice(a,0,{identifier:u,updater:g,references:1})}r.push(u)}return r}function n(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,n){var s=o(t=t||[],n=n||{});return function(t){t=t||[];for(var r=0;r<s.length;r++){var a=i(s[r]);e[a].references--}for(var l=o(t,n),h=0;h<s.length;h++){var c=i(s[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},659:t=>{"use strict";var e={};t.exports=function(t,i){var o=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(i)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var o="";i.supports&&(o+="@supports (".concat(i.supports,") {")),i.media&&(o+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(o+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),o+=i.css,n&&(o+="}"),i.media&&(o+="}"),i.supports&&(o+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},107:function(t,e,i){!function(t){function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var s={exports:{}},r=function(t){return t&&t.Math===Math&&t},a=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof o&&o)||function(){return this}()||o||Function("return this")(),l=function(t){try{return!!t()}catch(t){return!0}},h=!l((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),c=h,u=Function.prototype,d=u.apply,p=u.call,g="object"==typeof Reflect&&Reflect.apply||(c?p.bind(d):function(){return p.apply(d,arguments)}),f=h,m=Function.prototype,v=m.call,b=f&&m.bind.bind(v,v),_=f?b:function(t){return function(){return v.apply(t,arguments)}},y=_,T=y({}.toString),E=y("".slice),w=function(t){return E(T(t),8,-1)},k=w,I=_,$=function(t){if("Function"===k(t))return I(t)},S="object"==typeof document&&document.all,C={all:S,IS_HTMLDDA:void 0===S&&void 0!==S},O=C.all,R=C.IS_HTMLDDA?function(t){return"function"==typeof t||t===O}:function(t){return"function"==typeof t},A={},M=!l((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),x=h,L=Function.prototype.call,D=x?L.bind(L):function(){return L.apply(L,arguments)},N={},P={}.propertyIsEnumerable,B=Object.getOwnPropertyDescriptor,F=B&&!P.call({1:2},1);N.f=F?function(t){var e=B(this,t);return!!e&&e.enumerable}:P;var H,U,G=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},V=l,W=w,z=Object,j=_("".split),X=V((function(){return!z("z").propertyIsEnumerable(0)}))?function(t){return"String"===W(t)?j(t,""):z(t)}:z,Y=function(t){return null==t},K=Y,J=TypeError,q=function(t){if(K(t))throw new J("Can't call method on "+t);return t},Z=X,Q=q,tt=function(t){return Z(Q(t))},et=R,it=C.all,ot=C.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:et(t)||t===it}:function(t){return"object"==typeof t?null!==t:et(t)},nt={},st=nt,rt=a,at=R,lt=function(t){return at(t)?t:void 0},ht=function(t,e){return arguments.length<2?lt(st[t])||lt(rt[t]):st[t]&&st[t][e]||rt[t]&&rt[t][e]},ct=_({}.isPrototypeOf),ut="undefined"!=typeof navigator&&String(navigator.userAgent)||"",dt=a,pt=ut,gt=dt.process,ft=dt.Deno,mt=gt&&gt.versions||ft&&ft.version,vt=mt&&mt.v8;vt&&(U=(H=vt.split("."))[0]>0&&H[0]<4?1:+(H[0]+H[1])),!U&&pt&&(!(H=pt.match(/Edge\/(\d+)/))||H[1]>=74)&&(H=pt.match(/Chrome\/(\d+)/))&&(U=+H[1]);var bt=U,_t=bt,yt=l,Tt=a.String,Et=!!Object.getOwnPropertySymbols&&!yt((function(){var t=Symbol("symbol detection");return!Tt(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&_t&&_t<41})),wt=Et&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,kt=ht,It=R,$t=ct,St=Object,Ct=wt?function(t){return"symbol"==typeof t}:function(t){var e=kt("Symbol");return It(e)&&$t(e.prototype,St(t))},Ot=String,Rt=function(t){try{return Ot(t)}catch(t){return"Object"}},At=R,Mt=Rt,xt=TypeError,Lt=function(t){if(At(t))return t;throw new xt(Mt(t)+" is not a function")},Dt=Lt,Nt=Y,Pt=function(t,e){var i=t[e];return Nt(i)?void 0:Dt(i)},Bt=D,Ft=R,Ht=ot,Ut=TypeError,Gt={exports:{}},Vt=a,Wt=Object.defineProperty,zt="__core-js_shared__",jt=a[zt]||function(t,e){try{Wt(Vt,t,{value:e,configurable:!0,writable:!0})}catch(i){Vt[t]=e}return e}(zt,{}),Xt=jt;(Gt.exports=function(t,e){return Xt[t]||(Xt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.2",mode:"pure",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Yt=Gt.exports,Kt=q,Jt=Object,qt=function(t){return Jt(Kt(t))},Zt=qt,Qt=_({}.hasOwnProperty),te=Object.hasOwn||function(t,e){return Qt(Zt(t),e)},ee=_,ie=0,oe=Math.random(),ne=ee(1..toString),se=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ne(++ie+oe,36)},re=Yt,ae=te,le=se,he=Et,ce=wt,ue=a.Symbol,de=re("wks"),pe=ce?ue.for||ue:ue&&ue.withoutSetter||le,ge=function(t){return ae(de,t)||(de[t]=he&&ae(ue,t)?ue[t]:pe("Symbol."+t)),de[t]},fe=D,me=ot,ve=Ct,be=Pt,_e=function(t,e){var i,o;if("string"===e&&Ft(i=t.toString)&&!Ht(o=Bt(i,t)))return o;if(Ft(i=t.valueOf)&&!Ht(o=Bt(i,t)))return o;if("string"!==e&&Ft(i=t.toString)&&!Ht(o=Bt(i,t)))return o;throw new Ut("Can't convert object to primitive value")},ye=TypeError,Te=ge("toPrimitive"),Ee=Ct,we=function(t){var e=function(t,e){if(!me(t)||ve(t))return t;var i,o=be(t,Te);if(o){if(void 0===e&&(e="default"),i=fe(o,t,e),!me(i)||ve(i))return i;throw new ye("Can't convert object to primitive value")}return void 0===e&&(e="number"),_e(t,e)}(t,"string");return Ee(e)?e:e+""},ke=ot,Ie=a.document,$e=ke(Ie)&&ke(Ie.createElement),Se=function(t){return $e?Ie.createElement(t):{}},Ce=Se,Oe=!M&&!l((function(){return 7!==Object.defineProperty(Ce("div"),"a",{get:function(){return 7}}).a})),Re=M,Ae=D,Me=N,xe=G,Le=tt,De=we,Ne=te,Pe=Oe,Be=Object.getOwnPropertyDescriptor;A.f=Re?Be:function(t,e){if(t=Le(t),e=De(e),Pe)try{return Be(t,e)}catch(t){}if(Ne(t,e))return xe(!Ae(Me.f,t,e),t[e])};var Fe=l,He=R,Ue=/#|\.prototype\./,Ge=function(t,e){var i=We[Ve(t)];return i===je||i!==ze&&(He(e)?Fe(e):!!e)},Ve=Ge.normalize=function(t){return String(t).replace(Ue,".").toLowerCase()},We=Ge.data={},ze=Ge.NATIVE="N",je=Ge.POLYFILL="P",Xe=Ge,Ye=Lt,Ke=h,Je=$($.bind),qe=function(t,e){return Ye(t),void 0===e?t:Ke?Je(t,e):function(){return t.apply(e,arguments)}},Ze={},Qe=M&&l((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ti=ot,ei=String,ii=TypeError,oi=function(t){if(ti(t))return t;throw new ii(ei(t)+" is not an object")},ni=M,si=Oe,ri=Qe,ai=oi,li=we,hi=TypeError,ci=Object.defineProperty,ui=Object.getOwnPropertyDescriptor,di="enumerable",pi="configurable",gi="writable";Ze.f=ni?ri?function(t,e,i){if(ai(t),e=li(e),ai(i),"function"==typeof t&&"prototype"===e&&"value"in i&&gi in i&&!i[gi]){var o=ui(t,e);o&&o[gi]&&(t[e]=i.value,i={configurable:pi in i?i[pi]:o[pi],enumerable:di in i?i[di]:o[di],writable:!1})}return ci(t,e,i)}:ci:function(t,e,i){if(ai(t),e=li(e),ai(i),si)try{return ci(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new hi("Accessors not supported");return"value"in i&&(t[e]=i.value),t};var fi=Ze,mi=G,vi=M?function(t,e,i){return fi.f(t,e,mi(1,i))}:function(t,e,i){return t[e]=i,t},bi=a,_i=g,yi=$,Ti=R,Ei=A.f,wi=Xe,ki=nt,Ii=qe,$i=vi,Si=te,Ci=function(t){var e=function(i,o,n){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(i);case 2:return new t(i,o)}return new t(i,o,n)}return _i(t,this,arguments)};return e.prototype=t.prototype,e},Oi=function(t,e){var i,o,n,s,r,a,l,h,c,u=t.target,d=t.global,p=t.stat,g=t.proto,f=d?bi:p?bi[u]:(bi[u]||{}).prototype,m=d?ki:ki[u]||$i(ki,u,{})[u],v=m.prototype;for(s in e)o=!(i=wi(d?s:u+(p?".":"#")+s,t.forced))&&f&&Si(f,s),a=m[s],o&&(l=t.dontCallGetSet?(c=Ei(f,s))&&c.value:f[s]),r=o&&l?l:e[s],o&&typeof a==typeof r||(h=t.bind&&o?Ii(r,bi):t.wrap&&o?Ci(r):g&&Ti(r)?yi(r):r,(t.sham||r&&r.sham||a&&a.sham)&&$i(h,"sham",!0),$i(m,s,h),g&&(Si(ki,n=u+"Prototype")||$i(ki,n,{}),$i(ki[n],s,r),t.real&&v&&(i||!v[s])&&$i(v,s,r)))},Ri=Oi,Ai=M,Mi=Ze.f;Ri({target:"Object",stat:!0,forced:Object.defineProperty!==Mi,sham:!Ai},{defineProperty:Mi});var xi=nt.Object,Li=s.exports=function(t,e,i){return xi.defineProperty(t,e,i)};xi.defineProperty.sham&&(Li.sham=!0);var Di=s.exports,Ni=Di,Pi=n(Ni),Bi=w,Fi=Array.isArray||function(t){return"Array"===Bi(t)},Hi=Math.ceil,Ui=Math.floor,Gi=Math.trunc||function(t){var e=+t;return(e>0?Ui:Hi)(e)},Vi=function(t){var e=+t;return e!=e||0===e?0:Gi(e)},Wi=Vi,zi=Math.min,ji=function(t){return(e=t.length)>0?zi(Wi(e),9007199254740991):0;var e},Xi=TypeError,Yi=function(t){if(t>9007199254740991)throw Xi("Maximum allowed index exceeded");return t},Ki=we,Ji=Ze,qi=G,Zi=function(t,e,i){var o=Ki(e);o in t?Ji.f(t,o,qi(0,i)):t[o]=i},Qi={};Qi[ge("toStringTag")]="z";var to="[object z]"===String(Qi),eo=to,io=R,oo=w,no=ge("toStringTag"),so=Object,ro="Arguments"===oo(function(){return arguments}()),ao=eo?oo:function(t){var e,i,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=so(t),no))?i:ro?oo(e):"Object"===(o=oo(e))&&io(e.callee)?"Arguments":o},lo=R,ho=jt,co=_(Function.toString);lo(ho.inspectSource)||(ho.inspectSource=function(t){return co(t)});var uo=ho.inspectSource,po=_,go=l,fo=R,mo=ao,vo=uo,bo=function(){},_o=[],yo=ht("Reflect","construct"),To=/^\s*(?:class|function)\b/,Eo=po(To.exec),wo=!To.test(bo),ko=function(t){if(!fo(t))return!1;try{return yo(bo,_o,t),!0}catch(t){return!1}},Io=function(t){if(!fo(t))return!1;switch(mo(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return wo||!!Eo(To,vo(t))}catch(t){return!0}};Io.sham=!0;var $o=!yo||go((function(){var t;return ko(ko.call)||!ko(Object)||!ko((function(){t=!0}))||t}))?Io:ko,So=Fi,Co=$o,Oo=ot,Ro=ge("species"),Ao=Array,Mo=function(t,e){return new(function(t){var e;return So(t)&&(e=t.constructor,(Co(e)&&(e===Ao||So(e.prototype))||Oo(e)&&null===(e=e[Ro]))&&(e=void 0)),void 0===e?Ao:e}(t))(0===e?0:e)},xo=l,Lo=bt,Do=ge("species"),No=function(t){return Lo>=51||!xo((function(){var e=[];return(e.constructor={})[Do]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Po=Oi,Bo=l,Fo=Fi,Ho=ot,Uo=qt,Go=ji,Vo=Yi,Wo=Zi,zo=Mo,jo=No,Xo=bt,Yo=ge("isConcatSpreadable"),Ko=Xo>=51||!Bo((function(){var t=[];return t[Yo]=!1,t.concat()[0]!==t})),Jo=function(t){if(!Ho(t))return!1;var e=t[Yo];return void 0!==e?!!e:Fo(t)};Po({target:"Array",proto:!0,arity:1,forced:!Ko||!jo("concat")},{concat:function(t){var e,i,o,n,s,r=Uo(this),a=zo(r,0),l=0;for(e=-1,o=arguments.length;e<o;e++)if(Jo(s=-1===e?r:arguments[e]))for(n=Go(s),Vo(l+n),i=0;i<n;i++,l++)i in s&&Wo(a,l,s[i]);else Vo(l+1),Wo(a,l++,s);return a.length=l,a}});var qo=ao,Zo=String,Qo=function(t){if("Symbol"===qo(t))throw new TypeError("Cannot convert a Symbol value to a string");return Zo(t)},tn={},en=Vi,on=Math.max,nn=Math.min,sn=function(t,e){var i=en(t);return i<0?on(i+e,0):nn(i,e)},rn=tt,an=sn,ln=ji,hn=function(t){return function(e,i,o){var n,s=rn(e),r=ln(s),a=an(o,r);if(t&&i!=i){for(;r>a;)if((n=s[a++])!=n)return!0}else for(;r>a;a++)if((t||a in s)&&s[a]===i)return t||a||0;return!t&&-1}},cn={includes:hn(!0),indexOf:hn(!1)},un={},dn=te,pn=tt,gn=cn.indexOf,fn=un,mn=_([].push),vn=function(t,e){var i,o=pn(t),n=0,s=[];for(i in o)!dn(fn,i)&&dn(o,i)&&mn(s,i);for(;e.length>n;)dn(o,i=e[n++])&&(~gn(s,i)||mn(s,i));return s},bn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_n=vn,yn=bn,Tn=Object.keys||function(t){return _n(t,yn)},En=M,wn=Qe,kn=Ze,In=oi,$n=tt,Sn=Tn;tn.f=En&&!wn?Object.defineProperties:function(t,e){In(t);for(var i,o=$n(e),n=Sn(e),s=n.length,r=0;s>r;)kn.f(t,i=n[r++],o[i]);return t};var Cn,On=ht("document","documentElement"),Rn=se,An=Yt("keys"),Mn=function(t){return An[t]||(An[t]=Rn(t))},xn=oi,Ln=tn,Dn=bn,Nn=un,Pn=On,Bn=Se,Fn="prototype",Hn="script",Un=Mn("IE_PROTO"),Gn=function(){},Vn=function(t){return"<"+Hn+">"+t+"</"+Hn+">"},Wn=function(t){t.write(Vn("")),t.close();var e=t.parentWindow.Object;return t=null,e},zn=function(){try{Cn=new ActiveXObject("htmlfile")}catch(t){}var t,e,i;zn="undefined"!=typeof document?document.domain&&Cn?Wn(Cn):(e=Bn("iframe"),i="java"+Hn+":",e.style.display="none",Pn.appendChild(e),e.src=String(i),(t=e.contentWindow.document).open(),t.write(Vn("document.F=Object")),t.close(),t.F):Wn(Cn);for(var o=Dn.length;o--;)delete zn[Fn][Dn[o]];return zn()};Nn[Un]=!0;var jn=Object.create||function(t,e){var i;return null!==t?(Gn[Fn]=xn(t),i=new Gn,Gn[Fn]=null,i[Un]=t):i=zn(),void 0===e?i:Ln.f(i,e)},Xn={},Yn=vn,Kn=bn.concat("length","prototype");Xn.f=Object.getOwnPropertyNames||function(t){return Yn(t,Kn)};var Jn={},qn=sn,Zn=ji,Qn=Zi,ts=Array,es=Math.max,is=function(t,e,i){for(var o=Zn(t),n=qn(e,o),s=qn(void 0===i?o:i,o),r=ts(es(s-n,0)),a=0;n<s;n++,a++)Qn(r,a,t[n]);return r.length=a,r},os=w,ns=tt,ss=Xn.f,rs=is,as="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Jn.f=function(t){return as&&"Window"===os(t)?function(t){try{return ss(t)}catch(t){return rs(as)}}(t):ss(ns(t))};var ls={};ls.f=Object.getOwnPropertySymbols;var hs=vi,cs=function(t,e,i,o){return o&&o.enumerable?t[e]=i:hs(t,e,i),t},us=Ze,ds=function(t,e,i){return us.f(t,e,i)},ps={},gs=ge;ps.f=gs;var fs,ms,vs,bs=nt,_s=te,ys=ps,Ts=Ze.f,Es=function(t){var e=bs.Symbol||(bs.Symbol={});_s(e,t)||Ts(e,t,{value:ys.f(t)})},ws=D,ks=ht,Is=ge,$s=cs,Ss=function(){var t=ks("Symbol"),e=t&&t.prototype,i=e&&e.valueOf,o=Is("toPrimitive");e&&!e[o]&&$s(e,o,(function(t){return ws(i,this)}),{arity:1})},Cs=ao,Os=to?{}.toString:function(){return"[object "+Cs(this)+"]"},Rs=to,As=Ze.f,Ms=vi,xs=te,Ls=Os,Ds=ge("toStringTag"),Ns=function(t,e,i,o){if(t){var n=i?t:t.prototype;xs(n,Ds)||As(n,Ds,{configurable:!0,value:e}),o&&!Rs&&Ms(n,"toString",Ls)}},Ps=R,Bs=a.WeakMap,Fs=Ps(Bs)&&/native code/.test(String(Bs)),Hs=a,Us=ot,Gs=vi,Vs=te,Ws=jt,zs=Mn,js=un,Xs="Object already initialized",Ys=Hs.TypeError,Ks=Hs.WeakMap;if(Fs||Ws.state){var Js=Ws.state||(Ws.state=new Ks);Js.get=Js.get,Js.has=Js.has,Js.set=Js.set,fs=function(t,e){if(Js.has(t))throw new Ys(Xs);return e.facade=t,Js.set(t,e),e},ms=function(t){return Js.get(t)||{}},vs=function(t){return Js.has(t)}}else{var qs=zs("state");js[qs]=!0,fs=function(t,e){if(Vs(t,qs))throw new Ys(Xs);return e.facade=t,Gs(t,qs,e),e},ms=function(t){return Vs(t,qs)?t[qs]:{}},vs=function(t){return Vs(t,qs)}}var Zs={set:fs,get:ms,has:vs,enforce:function(t){return vs(t)?ms(t):fs(t,{})},getterFor:function(t){return function(e){var i;if(!Us(e)||(i=ms(e)).type!==t)throw new Ys("Incompatible receiver, "+t+" required");return i}}},Qs=qe,tr=X,er=qt,ir=ji,or=Mo,nr=_([].push),sr=function(t){var e=1===t,i=2===t,o=3===t,n=4===t,s=6===t,r=7===t,a=5===t||s;return function(l,h,c,u){for(var d,p,g=er(l),f=tr(g),m=Qs(h,c),v=ir(f),b=0,_=u||or,y=e?_(l,v):i||r?_(l,0):void 0;v>b;b++)if((a||b in f)&&(p=m(d=f[b],b,g),t))if(e)y[b]=p;else if(p)switch(t){case 3:return!0;case 5:return d;case 6:return b;case 2:nr(y,d)}else switch(t){case 4:return!1;case 7:nr(y,d)}return s?-1:o||n?n:y}},rr={forEach:sr(0),map:sr(1),filter:sr(2),some:sr(3),every:sr(4),find:sr(5),findIndex:sr(6),filterReject:sr(7)},ar=Oi,lr=a,hr=D,cr=_,ur=M,dr=Et,pr=l,gr=te,fr=ct,mr=oi,vr=tt,br=we,_r=Qo,yr=G,Tr=jn,Er=Tn,wr=Xn,kr=Jn,Ir=ls,$r=A,Sr=Ze,Cr=tn,Or=N,Rr=cs,Ar=ds,Mr=Yt,xr=un,Lr=se,Dr=ge,Nr=ps,Pr=Es,Br=Ss,Fr=Ns,Hr=Zs,Ur=rr.forEach,Gr=Mn("hidden"),Vr="Symbol",Wr="prototype",zr=Hr.set,jr=Hr.getterFor(Vr),Xr=Object[Wr],Yr=lr.Symbol,Kr=Yr&&Yr[Wr],Jr=lr.RangeError,qr=lr.TypeError,Zr=lr.QObject,Qr=$r.f,ta=Sr.f,ea=kr.f,ia=Or.f,oa=cr([].push),na=Mr("symbols"),sa=Mr("op-symbols"),ra=Mr("wks"),aa=!Zr||!Zr[Wr]||!Zr[Wr].findChild,la=function(t,e,i){var o=Qr(Xr,e);o&&delete Xr[e],ta(t,e,i),o&&t!==Xr&&ta(Xr,e,o)},ha=ur&&pr((function(){return 7!==Tr(ta({},"a",{get:function(){return ta(this,"a",{value:7}).a}})).a}))?la:ta,ca=function(t,e){var i=na[t]=Tr(Kr);return zr(i,{type:Vr,tag:t,description:e}),ur||(i.description=e),i},ua=function(t,e,i){t===Xr&&ua(sa,e,i),mr(t);var o=br(e);return mr(i),gr(na,o)?(i.enumerable?(gr(t,Gr)&&t[Gr][o]&&(t[Gr][o]=!1),i=Tr(i,{enumerable:yr(0,!1)})):(gr(t,Gr)||ta(t,Gr,yr(1,{})),t[Gr][o]=!0),ha(t,o,i)):ta(t,o,i)},da=function(t,e){mr(t);var i=vr(e),o=Er(i).concat(ma(i));return Ur(o,(function(e){ur&&!hr(pa,i,e)||ua(t,e,i[e])})),t},pa=function(t){var e=br(t),i=hr(ia,this,e);return!(this===Xr&&gr(na,e)&&!gr(sa,e))&&(!(i||!gr(this,e)||!gr(na,e)||gr(this,Gr)&&this[Gr][e])||i)},ga=function(t,e){var i=vr(t),o=br(e);if(i!==Xr||!gr(na,o)||gr(sa,o)){var n=Qr(i,o);return!n||!gr(na,o)||gr(i,Gr)&&i[Gr][o]||(n.enumerable=!0),n}},fa=function(t){var e=ea(vr(t)),i=[];return Ur(e,(function(t){gr(na,t)||gr(xr,t)||oa(i,t)})),i},ma=function(t){var e=t===Xr,i=ea(e?sa:vr(t)),o=[];return Ur(i,(function(t){!gr(na,t)||e&&!gr(Xr,t)||oa(o,na[t])})),o};dr||(Yr=function(){if(fr(Kr,this))throw new qr("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?_r(arguments[0]):void 0,e=Lr(t),i=function(t){var o=void 0===this?lr:this;o===Xr&&hr(i,sa,t),gr(o,Gr)&&gr(o[Gr],e)&&(o[Gr][e]=!1);var n=yr(1,t);try{ha(o,e,n)}catch(t){if(!(t instanceof Jr))throw t;la(o,e,n)}};return ur&&aa&&ha(Xr,e,{configurable:!0,set:i}),ca(e,t)},Rr(Kr=Yr[Wr],"toString",(function(){return jr(this).tag})),Rr(Yr,"withoutSetter",(function(t){return ca(Lr(t),t)})),Or.f=pa,Sr.f=ua,Cr.f=da,$r.f=ga,wr.f=kr.f=fa,Ir.f=ma,Nr.f=function(t){return ca(Dr(t),t)},ur&&Ar(Kr,"description",{configurable:!0,get:function(){return jr(this).description}})),ar({global:!0,constructor:!0,wrap:!0,forced:!dr,sham:!dr},{Symbol:Yr}),Ur(Er(ra),(function(t){Pr(t)})),ar({target:Vr,stat:!0,forced:!dr},{useSetter:function(){aa=!0},useSimple:function(){aa=!1}}),ar({target:"Object",stat:!0,forced:!dr,sham:!ur},{create:function(t,e){return void 0===e?Tr(t):da(Tr(t),e)},defineProperty:ua,defineProperties:da,getOwnPropertyDescriptor:ga}),ar({target:"Object",stat:!0,forced:!dr},{getOwnPropertyNames:fa}),Br(),Fr(Yr,Vr),xr[Gr]=!0;var va=Et&&!!Symbol.for&&!!Symbol.keyFor,ba=Oi,_a=ht,ya=te,Ta=Qo,Ea=Yt,wa=va,ka=Ea("string-to-symbol-registry"),Ia=Ea("symbol-to-string-registry");ba({target:"Symbol",stat:!0,forced:!wa},{for:function(t){var e=Ta(t);if(ya(ka,e))return ka[e];var i=_a("Symbol")(e);return ka[e]=i,Ia[i]=e,i}});var $a=Oi,Sa=te,Ca=Ct,Oa=Rt,Ra=va,Aa=Yt("symbol-to-string-registry");$a({target:"Symbol",stat:!0,forced:!Ra},{keyFor:function(t){if(!Ca(t))throw new TypeError(Oa(t)+" is not a symbol");if(Sa(Aa,t))return Aa[t]}});var Ma=_([].slice),xa=Fi,La=R,Da=w,Na=Qo,Pa=_([].push),Ba=Oi,Fa=ht,Ha=g,Ua=D,Ga=_,Va=l,Wa=R,za=Ct,ja=Ma,Xa=Et,Ya=String,Ka=Fa("JSON","stringify"),Ja=Ga(/./.exec),qa=Ga("".charAt),Za=Ga("".charCodeAt),Qa=Ga("".replace),tl=Ga(1..toString),el=/[\uD800-\uDFFF]/g,il=/^[\uD800-\uDBFF]$/,ol=/^[\uDC00-\uDFFF]$/,nl=!Xa||Va((function(){var t=Fa("Symbol")("stringify detection");return"[null]"!==Ka([t])||"{}"!==Ka({a:t})||"{}"!==Ka(Object(t))})),sl=Va((function(){return'"\\udf06\\ud834"'!==Ka("\udf06\ud834")||'"\\udead"'!==Ka("\udead")})),rl=function(t,e){var i=ja(arguments),o=function(t){if(La(t))return t;if(xa(t)){for(var e=t.length,i=[],o=0;o<e;o++){var n=t[o];"string"==typeof n?Pa(i,n):"number"!=typeof n&&"Number"!==Da(n)&&"String"!==Da(n)||Pa(i,Na(n))}var s=i.length,r=!0;return function(t,e){if(r)return r=!1,e;if(xa(this))return e;for(var o=0;o<s;o++)if(i[o]===t)return e}}}(e);if(Wa(o)||void 0!==t&&!za(t))return i[1]=function(t,e){if(Wa(o)&&(e=Ua(o,this,Ya(t),e)),!za(e))return e},Ha(Ka,null,i)},al=function(t,e,i){var o=qa(i,e-1),n=qa(i,e+1);return Ja(il,t)&&!Ja(ol,n)||Ja(ol,t)&&!Ja(il,o)?"\\u"+tl(Za(t,0),16):t};Ka&&Ba({target:"JSON",stat:!0,arity:3,forced:nl||sl},{stringify:function(t,e,i){var o=ja(arguments),n=Ha(nl?rl:Ka,null,o);return sl&&"string"==typeof n?Qa(n,el,al):n}});var ll=ls,hl=qt;Oi({target:"Object",stat:!0,forced:!Et||l((function(){ll.f(1)}))},{getOwnPropertySymbols:function(t){var e=ll.f;return e?e(hl(t)):[]}}),Es("asyncIterator"),Es("hasInstance"),Es("isConcatSpreadable"),Es("iterator"),Es("match"),Es("matchAll"),Es("replace"),Es("search"),Es("species"),Es("split");var cl=Ss;Es("toPrimitive"),cl();var ul=ht,dl=Ns;Es("toStringTag"),dl(ul("Symbol"),"Symbol"),Es("unscopables"),Ns(a.JSON,"JSON",!0);var pl,gl,fl,ml=nt.Symbol,vl={},bl=M,_l=te,yl=Function.prototype,Tl=bl&&Object.getOwnPropertyDescriptor,El=_l(yl,"name"),wl={EXISTS:El,PROPER:El&&"something"===function(){}.name,CONFIGURABLE:El&&(!bl||bl&&Tl(yl,"name").configurable)},kl=!l((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Il=te,$l=R,Sl=qt,Cl=kl,Ol=Mn("IE_PROTO"),Rl=Object,Al=Rl.prototype,Ml=Cl?Rl.getPrototypeOf:function(t){var e=Sl(t);if(Il(e,Ol))return e[Ol];var i=e.constructor;return $l(i)&&e instanceof i?i.prototype:e instanceof Rl?Al:null},xl=l,Ll=R,Dl=ot,Nl=jn,Pl=Ml,Bl=cs,Fl=ge("iterator"),Hl=!1;[].keys&&("next"in(fl=[].keys())?(gl=Pl(Pl(fl)))!==Object.prototype&&(pl=gl):Hl=!0),pl=!Dl(pl)||xl((function(){var t={};return pl[Fl].call(t)!==t}))?{}:Nl(pl),Ll(pl[Fl])||Bl(pl,Fl,(function(){return this}));var Ul={IteratorPrototype:pl,BUGGY_SAFARI_ITERATORS:Hl},Gl=Ul.IteratorPrototype,Vl=jn,Wl=G,zl=Ns,jl=vl,Xl=function(){return this},Yl=_,Kl=Lt,Jl=R,ql=String,Zl=TypeError,Ql=oi,th=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=function(t,e,i){try{return Yl(Kl(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}}(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,o){return Ql(i),function(t){if("object"==typeof t||Jl(t))return t;throw new Zl("Can't set "+ql(t)+" as a prototype")}(o),e?t(i,o):i.__proto__=o,i}}():void 0),eh=Oi,ih=D,oh=wl,nh=function(t,e,i,o){var n=e+" Iterator";return t.prototype=Vl(Gl,{next:Wl(+!o,i)}),zl(t,n,!1,!0),jl[n]=Xl,t},sh=Ml,rh=Ns,ah=cs,lh=vl,hh=Ul,ch=oh.PROPER,uh=hh.BUGGY_SAFARI_ITERATORS,dh=ge("iterator"),ph="keys",gh="values",fh="entries",mh=function(){return this},vh=function(t,e,i,o,n,s,r){nh(i,e,o);var a,l,h,c=function(t){if(t===n&&f)return f;if(!uh&&t&&t in p)return p[t];switch(t){case ph:case gh:case fh:return function(){return new i(this,t)}}return function(){return new i(this)}},u=e+" Iterator",d=!1,p=t.prototype,g=p[dh]||p["@@iterator"]||n&&p[n],f=!uh&&g||c(n),m="Array"===e&&p.entries||g;if(m&&(a=sh(m.call(new t)))!==Object.prototype&&a.next&&(rh(a,u,!0,!0),lh[u]=mh),ch&&n===gh&&g&&g.name!==gh&&(d=!0,f=function(){return ih(g,this)}),n)if(l={values:c(gh),keys:s?f:c(ph),entries:c(fh)},r)for(h in l)(uh||d||!(h in p))&&ah(p,h,l[h]);else eh({target:e,proto:!0,forced:uh||d},l);return r&&p[dh]!==f&&ah(p,dh,f,{name:n}),lh[e]=f,l},bh=function(t,e){return{value:t,done:e}},_h=tt,yh=vl,Th=Zs;Ze.f;var Eh=vh,wh=bh,kh="Array Iterator",Ih=Th.set,$h=Th.getterFor(kh);Eh(Array,"Array",(function(t,e){Ih(this,{type:kh,target:_h(t),index:0,kind:e})}),(function(){var t=$h(this),e=t.target,i=t.index++;if(!e||i>=e.length)return t.target=void 0,wh(void 0,!0);switch(t.kind){case"keys":return wh(i,!1);case"values":return wh(e[i],!1)}return wh([i,e[i]],!1)}),"values"),yh.Arguments=yh.Array;var Sh=a,Ch=ao,Oh=vi,Rh=vl,Ah=ge("toStringTag");for(var Mh in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var xh=Sh[Mh],Lh=xh&&xh.prototype;Lh&&Ch(Lh)!==Ah&&Oh(Lh,Ah,Mh),Rh[Mh]=Rh.Array}var Dh=ml,Nh=ge,Ph=Ze.f,Bh=Nh("metadata"),Fh=Function.prototype;void 0===Fh[Bh]&&Ph(Fh,Bh,{value:null}),Es("asyncDispose"),Es("dispose"),Es("metadata");var Hh=Dh,Uh=_,Gh=ht("Symbol"),Vh=Gh.keyFor,Wh=Uh(Gh.prototype.valueOf),zh=Gh.isRegisteredSymbol||function(t){try{return void 0!==Vh(Wh(t))}catch(t){return!1}};Oi({target:"Symbol",stat:!0},{isRegisteredSymbol:zh});for(var jh=Yt,Xh=ht,Yh=_,Kh=Ct,Jh=ge,qh=Xh("Symbol"),Zh=qh.isWellKnownSymbol,Qh=Xh("Object","getOwnPropertyNames"),tc=Yh(qh.prototype.valueOf),ec=jh("wks"),ic=0,oc=Qh(qh),nc=oc.length;ic<nc;ic++)try{var sc=oc[ic];Kh(qh[sc])&&Jh(sc)}catch(t){}var rc=function(t){if(Zh&&Zh(t))return!0;try{for(var e=tc(t),i=0,o=Qh(ec),n=o.length;i<n;i++)if(ec[o[i]]==e)return!0}catch(t){}return!1};Oi({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:rc}),Es("matcher"),Es("observable"),Oi({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:zh}),Oi({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:rc}),Es("metadataKey"),Es("patternMatch"),Es("replaceAll");var ac=Hh,lc=n(ac),hc=_,cc=Vi,uc=Qo,dc=q,pc=hc("".charAt),gc=hc("".charCodeAt),fc=hc("".slice),mc=function(t){return function(e,i){var o,n,s=uc(dc(e)),r=cc(i),a=s.length;return r<0||r>=a?t?"":void 0:(o=gc(s,r))<55296||o>56319||r+1===a||(n=gc(s,r+1))<56320||n>57343?t?pc(s,r):o:t?fc(s,r,r+2):n-56320+(o-55296<<10)+65536}},vc=(mc(!1),mc(!0)),bc=Qo,_c=Zs,yc=vh,Tc=bh,Ec="String Iterator",wc=_c.set,kc=_c.getterFor(Ec);yc(String,"String",(function(t){wc(this,{type:Ec,string:bc(t),index:0})}),(function(){var t,e=kc(this),i=e.string,o=e.index;return o>=i.length?Tc(void 0,!0):(t=vc(i,o),e.index+=t.length,Tc(t,!1))}));var Ic=ps.f("iterator"),$c=Ic,Sc=n($c);function Cc(t){return Cc="function"==typeof lc&&"symbol"==typeof Sc?function(t){return typeof t}:function(t){return t&&"function"==typeof lc&&t.constructor===lc&&t!==lc.prototype?"symbol":typeof t},Cc(t)}var Oc=n(ps.f("toPrimitive"));function Rc(t){var e=function(t,e){if("object"!==Cc(t)||null===t)return t;var i=t[Oc];if(void 0!==i){var o=i.call(t,e||"default");if("object"!==Cc(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Cc(e)?e:String(e)}function Ac(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Pi(t,Rc(o.key),o)}}function Mc(t,e,i){return e&&Ac(t.prototype,e),i&&Ac(t,i),Pi(t,"prototype",{writable:!1}),t}function xc(t,e,i){return(e=Rc(e))in t?Pi(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Lc=_,Dc=Lt,Nc=ot,Pc=te,Bc=Ma,Fc=h,Hc=Function,Uc=Lc([].concat),Gc=Lc([].join),Vc={},Wc=Fc?Hc.bind:function(t){var e=Dc(this),i=e.prototype,o=Bc(arguments,1),n=function(){var i=Uc(o,Bc(arguments));return this instanceof n?function(t,e,i){if(!Pc(Vc,e)){for(var o=[],n=0;n<e;n++)o[n]="a["+n+"]";Vc[e]=Hc("C,a","return new C("+Gc(o,",")+")")}return Vc[e](t,i)}(e,i.length,i):e.apply(t,i)};return Nc(i)&&(n.prototype=i),n},zc=Wc;Oi({target:"Function",proto:!0,forced:Function.bind!==zc},{bind:zc});var jc=a,Xc=nt,Yc=function(t,e){var i=Xc[t+"Prototype"],o=i&&i[e];if(o)return o;var n=jc[t],s=n&&n.prototype;return s&&s[e]},Kc=Yc("Function","bind"),Jc=ct,qc=Kc,Zc=Function.prototype,Qc=function(t){var e=t.bind;return t===Zc||Jc(Zc,t)&&e===Zc.bind?qc:e},tu=n(Qc),eu=Lt,iu=qt,ou=X,nu=ji,su=TypeError,ru=function(t){return function(e,i,o,n){eu(i);var s=iu(e),r=ou(s),a=nu(s),l=t?a-1:0,h=t?-1:1;if(o<2)for(;;){if(l in r){n=r[l],l+=h;break}if(l+=h,t?l<0:a<=l)throw new su("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=h)l in r&&(n=i(n,r[l],l,s));return n}},au={left:ru(!1),right:ru(!0)},lu=l,hu=function(t,e){var i=[][t];return!!i&&lu((function(){i.call(null,e||function(){return 1},1)}))},cu="process"===w(a.process),uu=au.left;Oi({target:"Array",proto:!0,forced:!cu&&bt>79&&bt<83||!hu("reduce")},{reduce:function(t){var e=arguments.length;return uu(this,t,e,e>1?arguments[1]:void 0)}});var du=Yc("Array","reduce"),pu=ct,gu=du,fu=Array.prototype,mu=n((function(t){var e=t.reduce;return t===fu||pu(fu,t)&&e===fu.reduce?gu:e})),vu=rr.filter;Oi({target:"Array",proto:!0,forced:!No("filter")},{filter:function(t){return vu(this,t,arguments.length>1?arguments[1]:void 0)}});var bu=Yc("Array","filter"),_u=ct,yu=bu,Tu=Array.prototype,Eu=n((function(t){var e=t.filter;return t===Tu||_u(Tu,t)&&e===Tu.filter?yu:e})),wu=rr.map;Oi({target:"Array",proto:!0,forced:!No("map")},{map:function(t){return wu(this,t,arguments.length>1?arguments[1]:void 0)}});var ku=Yc("Array","map"),Iu=ct,$u=ku,Su=Array.prototype,Cu=n((function(t){var e=t.map;return t===Su||Iu(Su,t)&&e===Su.map?$u:e})),Ou=Fi,Ru=ji,Au=Yi,Mu=qe,xu=function(t,e,i,o,n,s,r,a){for(var l,h,c=n,u=0,d=!!r&&Mu(r,a);u<o;)u in i&&(l=d?d(i[u],u,e):i[u],s>0&&Ou(l)?(h=Ru(l),c=xu(t,e,l,h,c,s-1)-1):(Au(c+1),t[c]=l),c++),u++;return c},Lu=xu,Du=Lt,Nu=qt,Pu=ji,Bu=Mo;Oi({target:"Array",proto:!0},{flatMap:function(t){var e,i=Nu(this),o=Pu(i);return Du(t),(e=Bu(i,0)).length=Lu(e,i,i,o,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var Fu=Yc("Array","flatMap"),Hu=ct,Uu=Fu,Gu=Array.prototype,Vu=n((function(t){var e=t.flatMap;return t===Gu||Hu(Gu,t)&&e===Gu.flatMap?Uu:e}));var Wu=function(){function t(i,o,n){var s,r,a;e(this,t),xc(this,"_listeners",{add:tu(s=this._add).call(s,this),remove:tu(r=this._remove).call(r,this),update:tu(a=this._update).call(a,this)}),this._source=i,this._transformers=o,this._target=n}return Mc(t,[{key:"all",value:function(){return this._target.update(this._transformItems(this._source.get())),this}},{key:"start",value:function(){return this._source.on("add",this._listeners.add),this._source.on("remove",this._listeners.remove),this._source.on("update",this._listeners.update),this}},{key:"stop",value:function(){return this._source.off("add",this._listeners.add),this._source.off("remove",this._listeners.remove),this._source.off("update",this._listeners.update),this}},{key:"_transformItems",value:function(t){var e;return mu(e=this._transformers).call(e,(function(t,e){return e(t)}),t)}},{key:"_add",value:function(t,e){null!=e&&this._target.add(this._transformItems(this._source.get(e.items)))}},{key:"_update",value:function(t,e){null!=e&&this._target.update(this._transformItems(this._source.get(e.items)))}},{key:"_remove",value:function(t,e){null!=e&&this._target.remove(this._transformItems(e.oldData))}}]),t}(),zu=function(){function t(i){e(this,t),xc(this,"_transformers",[]),this._source=i}return Mc(t,[{key:"filter",value:function(t){return this._transformers.push((function(e){return Eu(e).call(e,t)})),this}},{key:"map",value:function(t){return this._transformers.push((function(e){return Cu(e).call(e,t)})),this}},{key:"flatMap",value:function(t){return this._transformers.push((function(e){return Vu(e).call(e,t)})),this}},{key:"to",value:function(t){return new Wu(this._source,this._transformers,t)}}]),t}(),ju=D,Xu=oi,Yu=Pt,Ku=function(t,e,i){var o,n;Xu(t);try{if(!(o=Yu(t,"return"))){if("throw"===e)throw i;return i}o=ju(o,t)}catch(t){n=!0,o=t}if("throw"===e)throw i;if(n)throw o;return Xu(o),i},Ju=oi,qu=Ku,Zu=vl,Qu=ge("iterator"),td=Array.prototype,ed=function(t){return void 0!==t&&(Zu.Array===t||td[Qu]===t)},id=ao,od=Pt,nd=Y,sd=vl,rd=ge("iterator"),ad=function(t){if(!nd(t))return od(t,rd)||od(t,"@@iterator")||sd[id(t)]},ld=D,hd=Lt,cd=oi,ud=Rt,dd=ad,pd=TypeError,gd=function(t,e){var i=arguments.length<2?dd(t):e;if(hd(i))return cd(ld(i,t));throw new pd(ud(t)+" is not iterable")},fd=qe,md=D,vd=qt,bd=function(t,e,i,o){try{return o?e(Ju(i)[0],i[1]):e(i)}catch(e){qu(t,"throw",e)}},_d=ed,yd=$o,Td=ji,Ed=Zi,wd=gd,kd=ad,Id=Array,$d=ge("iterator"),Sd=!1;try{var Cd=0,Od={next:function(){return{done:!!Cd++}},return:function(){Sd=!0}};Od[$d]=function(){return this},Array.from(Od,(function(){throw 2}))}catch(t){}var Rd=function(t,e){try{if(!e&&!Sd)return!1}catch(t){return!1}var i=!1;try{var o={};o[$d]=function(){return{next:function(){return{done:i=!0}}}},t(o)}catch(t){}return i},Ad=function(t){var e=vd(t),i=yd(this),o=arguments.length,n=o>1?arguments[1]:void 0,s=void 0!==n;s&&(n=fd(n,o>2?arguments[2]:void 0));var r,a,l,h,c,u,d=kd(e),p=0;if(!d||this===Id&&_d(d))for(r=Td(e),a=i?new this(r):Id(r);r>p;p++)u=s?n(e[p],p):e[p],Ed(a,p,u);else for(c=(h=wd(e,d)).next,a=i?new this:[];!(l=md(c,h)).done;p++)u=s?bd(h,n,[l.value,p],!0):l.value,Ed(a,p,u);return a.length=p,a};Oi({target:"Array",stat:!0,forced:!Rd((function(t){Array.from(t)}))},{from:Ad});var Md=nt.Array.from,xd=n(Md),Ld=ad,Dd=n(Ld),Nd=n(Ld);Oi({target:"Array",stat:!0},{isArray:Fi});var Pd=nt.Array.isArray,Bd=n(Pd);var Fd=M,Hd=Fi,Ud=TypeError,Gd=Object.getOwnPropertyDescriptor,Vd=Fd&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(Hd(t)&&!Gd(t,"length").writable)throw new Ud("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Wd=qt,zd=ji,jd=Vd,Xd=Yi;Oi({target:"Array",proto:!0,arity:1,forced:l((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=Wd(this),i=zd(e),o=arguments.length;Xd(i+o);for(var n=0;n<o;n++)e[i]=arguments[n],i++;return jd(e,i),i}});var Yd=Yc("Array","push"),Kd=ct,Jd=Yd,qd=Array.prototype,Zd=function(t){var e=t.push;return t===qd||Kd(qd,t)&&e===qd.push?Jd:e},Qd=n(Zd);var tp=Oi,ep=Fi,ip=$o,op=ot,np=sn,sp=ji,rp=tt,ap=Zi,lp=ge,hp=Ma,cp=No("slice"),up=lp("species"),dp=Array,pp=Math.max;tp({target:"Array",proto:!0,forced:!cp},{slice:function(t,e){var i,o,n,s=rp(this),r=sp(s),a=np(t,r),l=np(void 0===e?r:e,r);if(ep(s)&&(i=s.constructor,(ip(i)&&(i===dp||ep(i.prototype))||op(i)&&null===(i=i[up]))&&(i=void 0),i===dp||void 0===i))return hp(s,a,l);for(o=new(void 0===i?dp:i)(pp(l-a,0)),n=0;a<l;a++,n++)a in s&&ap(o,n,s[a]);return o.length=n,o}});var gp=Yc("Array","slice"),fp=ct,mp=gp,vp=Array.prototype,bp=function(t){var e=t.slice;return t===vp||fp(vp,t)&&e===vp.slice?mp:e},_p=bp,yp=n(_p),Tp=n(Md);function Ep(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function wp(t,e){var i;if(t){if("string"==typeof t)return Ep(t,e);var o=yp(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Tp(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ep(t,e):void 0}}function kp(t,e){return function(t){if(Bd(t))return t}(t)||function(t,e){var i=null==t?null:void 0!==lc&&Dd(t)||t["@@iterator"];if(null!=i){var o,n,s,r,a=[],l=!0,h=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(o=s.call(i)).done)&&(Qd(a).call(a,o.value),a.length!==e);l=!0);}catch(t){h=!0,n=t}finally{try{if(!l&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(h)throw n}}return a}}(t,e)||wp(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ip(t){return function(t){if(Bd(t))return Ep(t)}(t)||function(t){if(void 0!==lc&&null!=Dd(t)||null!=t["@@iterator"])return Tp(t)}(t)||wp(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var $p=n(Dh),Sp=Yc("Array","concat"),Cp=ct,Op=Sp,Rp=Array.prototype,Ap=n((function(t){var e=t.concat;return t===Rp||Cp(Rp,t)&&e===Rp.concat?Op:e})),Mp=n(bp),xp=ht,Lp=Xn,Dp=ls,Np=oi,Pp=_([].concat),Bp=xp("Reflect","ownKeys")||function(t){var e=Lp.f(Np(t)),i=Dp.f;return i?Pp(e,i(t)):e};Oi({target:"Reflect",stat:!0},{ownKeys:Bp});var Fp=n(nt.Reflect.ownKeys),Hp=n(Pd),Up=qt,Gp=Tn;Oi({target:"Object",stat:!0,forced:l((function(){Gp(1)}))},{keys:function(t){return Gp(Up(t))}});var Vp=n(nt.Object.keys),Wp=rr.forEach,zp=hu("forEach")?[].forEach:function(t){return Wp(this,t,arguments.length>1?arguments[1]:void 0)};Oi({target:"Array",proto:!0,forced:[].forEach!==zp},{forEach:zp});var jp=Yc("Array","forEach"),Xp=ao,Yp=te,Kp=ct,Jp=jp,qp=Array.prototype,Zp={DOMTokenList:!0,NodeList:!0},Qp=function(t){var e=t.forEach;return t===qp||Kp(qp,t)&&e===qp.forEach||Yp(Zp,Xp(t))?Jp:e},tg=n(Qp),eg=Oi,ig=Fi,og=_([].reverse),ng=[1,2];eg({target:"Array",proto:!0,forced:String(ng)===String(ng.reverse())},{reverse:function(){return ig(this)&&(this.length=this.length),og(this)}});var sg=Yc("Array","reverse"),rg=ct,ag=sg,lg=Array.prototype,hg=function(t){var e=t.reverse;return t===lg||rg(lg,t)&&e===lg.reverse?ag:e},cg=n(hg),ug=Rt,dg=TypeError,pg=function(t,e){if(!delete t[e])throw new dg("Cannot delete property "+ug(e)+" of "+ug(t))},gg=Oi,fg=qt,mg=sn,vg=Vi,bg=ji,_g=Vd,yg=Yi,Tg=Mo,Eg=Zi,wg=pg,kg=No("splice"),Ig=Math.max,$g=Math.min;gg({target:"Array",proto:!0,forced:!kg},{splice:function(t,e){var i,o,n,s,r,a,l=fg(this),h=bg(l),c=mg(t,h),u=arguments.length;for(0===u?i=o=0:1===u?(i=0,o=h-c):(i=u-2,o=$g(Ig(vg(e),0),h-c)),yg(h+i-o),n=Tg(l,o),s=0;s<o;s++)(r=c+s)in l&&Eg(n,s,l[r]);if(n.length=o,i<o){for(s=c;s<h-o;s++)a=s+i,(r=s+o)in l?l[a]=l[r]:wg(l,a);for(s=h;s>h-o+i;s--)wg(l,s-1)}else if(i>o)for(s=h-o;s>c;s--)a=s+i-1,(r=s+o-1)in l?l[a]=l[r]:wg(l,a);for(s=0;s<i;s++)l[s+c]=arguments[s+2];return _g(l,h-o+i),n}});var Sg=Yc("Array","splice"),Cg=ct,Og=Sg,Rg=Array.prototype,Ag=n((function(t){var e=t.splice;return t===Rg||Cg(Rg,t)&&e===Rg.splice?Og:e})),Mg=M,xg=_,Lg=D,Dg=l,Ng=Tn,Pg=ls,Bg=N,Fg=qt,Hg=X,Ug=Object.assign,Gg=Object.defineProperty,Vg=xg([].concat),Wg=!Ug||Dg((function(){if(Mg&&1!==Ug({b:1},Ug(Gg({},"a",{enumerable:!0,get:function(){Gg(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol("assign detection"),o="abcdefghijklmnopqrst";return t[i]=7,o.split("").forEach((function(t){e[t]=t})),7!==Ug({},t)[i]||Ng(Ug({},e)).join("")!==o}))?function(t,e){for(var i=Fg(t),o=arguments.length,n=1,s=Pg.f,r=Bg.f;o>n;)for(var a,l=Hg(arguments[n++]),h=s?Vg(Ng(l),s(l)):Ng(l),c=h.length,u=0;c>u;)a=h[u++],Mg&&!Lg(r,l,a)||(i[a]=l[a]);return i}:Ug,zg=Wg;Oi({target:"Object",stat:!0,arity:2,forced:Object.assign!==zg},{assign:zg});var jg=n(nt.Object.assign),Xg=qt,Yg=Ml,Kg=kl;Oi({target:"Object",stat:!0,forced:l((function(){Yg(1)})),sham:!Kg},{getPrototypeOf:function(t){return Yg(Xg(t))}});var Jg=nt.Object.getPrototypeOf;Oi({target:"Object",stat:!0,sham:!M},{create:jn});var qg=nt.Object,Zg=function(t,e){return qg.create(t,e)},Qg=n(Zg),tf=nt,ef=g;tf.JSON||(tf.JSON={stringify:JSON.stringify});var of=function(t,e,i){return ef(tf.JSON.stringify,null,arguments)},nf=n(of),sf="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,rf=TypeError,af=function(t,e){if(t<e)throw new rf("Not enough arguments");return t},lf=a,hf=g,cf=R,uf=sf,df=ut,pf=Ma,gf=af,ff=lf.Function,mf=/MSIE .\./.test(df)||uf&&function(){var t=lf.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}(),vf=function(t,e){var i=e?2:1;return mf?function(o,n){var s=gf(arguments.length,1)>i,r=cf(o)?o:ff(o),a=s?pf(arguments,i):[],l=s?function(){hf(r,this,a)}:r;return e?t(l,n):t(l)}:t},bf=Oi,_f=a,yf=vf(_f.setInterval,!0);bf({global:!0,bind:!0,forced:_f.setInterval!==yf},{setInterval:yf});var Tf=Oi,Ef=a,wf=vf(Ef.setTimeout,!0);Tf({global:!0,bind:!0,forced:Ef.setTimeout!==wf},{setTimeout:wf});var kf=n(nt.setTimeout),If={exports:{}};!function(t){function e(t){if(t)return function(t){return Object.assign(t,e.prototype),t._callbacks=new Map,t}(t);this._callbacks=new Map}e.prototype.on=function(t,e){const i=this._callbacks.get(t)??[];return i.push(e),this._callbacks.set(t,i),this},e.prototype.once=function(t,e){const i=(...o)=>{this.off(t,i),e.apply(this,o)};return i.fn=e,this.on(t,i),this},e.prototype.off=function(t,e){if(void 0===t&&void 0===e)return this._callbacks.clear(),this;if(void 0===e)return this._callbacks.delete(t),this;const i=this._callbacks.get(t);if(i){for(const[t,o]of i.entries())if(o===e||o.fn===e){i.splice(t,1);break}0===i.length?this._callbacks.delete(t):this._callbacks.set(t,i)}return this},e.prototype.emit=function(t,...e){const i=this._callbacks.get(t);if(i){const t=[...i];for(const i of t)i.apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks.get(t)??[]},e.prototype.listenerCount=function(t){if(t)return this.listeners(t).length;let e=0;for(const t of this._callbacks.values())e+=t.length;return e},e.prototype.hasListeners=function(t){return this.listenerCount(t)>0},e.prototype.addEventListener=e.prototype.on,e.prototype.removeListener=e.prototype.off,e.prototype.removeEventListener=e.prototype.off,e.prototype.removeAllListeners=e.prototype.off,t.exports=e}(If);var $f,Sf=n(If.exports);function Cf(){return Cf=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},Cf.apply(this,arguments)}function Of(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Rf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}$f="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var n in o)o.hasOwnProperty(n)&&(e[n]=o[n])}return e}:Object.assign;var Af,Mf=$f,xf=["","webkit","Moz","MS","ms","o"],Lf="undefined"==typeof document?{style:{}}:document.createElement("div"),Df=Math.round,Nf=Math.abs,Pf=Date.now;function Bf(t,e){for(var i,o,n=e[0].toUpperCase()+e.slice(1),s=0;s<xf.length;){if((o=(i=xf[s])?i+n:e)in t)return o;s++}}Af="undefined"==typeof window?{}:window;var Ff=Bf(Lf.style,"touchAction"),Hf=void 0!==Ff;var Uf="compute",Gf="auto",Vf="manipulation",Wf="none",zf="pan-x",jf="pan-y",Xf=function(){if(!Hf)return!1;var t={},e=Af.CSS&&Af.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){return t[i]=!e||Af.CSS.supports("touch-action",i)})),t}(),Yf="ontouchstart"in Af,Kf=void 0!==Bf(Af,"PointerEvent"),Jf=Yf&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),qf="touch",Zf="mouse",Qf=16,tm=24,em=["x","y"],im=["clientX","clientY"];function om(t,e,i){var o;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(o=0;o<t.length;)e.call(i,t[o],o,t),o++;else for(o in t)t.hasOwnProperty(o)&&e.call(i,t[o],o,t)}function nm(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function sm(t,e){return t.indexOf(e)>-1}var rm=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===Uf&&(t=this.compute()),Hf&&this.manager.element.style&&Xf[t]&&(this.manager.element.style[Ff]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return om(this.manager.recognizers,(function(e){nm(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(sm(t,Wf))return Wf;var e=sm(t,zf),i=sm(t,jf);return e&&i?Wf:e||i?e?zf:jf:sm(t,Vf)?Vf:Gf}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var o=this.actions,n=sm(o,Wf)&&!Xf[Wf],s=sm(o,jf)&&!Xf[jf],r=sm(o,zf)&&!Xf[zf];if(n){var a=1===t.pointers.length,l=t.distance<2,h=t.deltaTime<250;if(a&&l&&h)return}if(!r||!s)return n||s&&6&i||r&&i&tm?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function am(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function lm(t){var e=t.length;if(1===e)return{x:Df(t[0].clientX),y:Df(t[0].clientY)};for(var i=0,o=0,n=0;n<e;)i+=t[n].clientX,o+=t[n].clientY,n++;return{x:Df(i/e),y:Df(o/e)}}function hm(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:Df(t.pointers[i].clientX),clientY:Df(t.pointers[i].clientY)},i++;return{timeStamp:Pf(),pointers:e,center:lm(e),deltaX:t.deltaX,deltaY:t.deltaY}}function cm(t,e,i){i||(i=em);var o=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return Math.sqrt(o*o+n*n)}function um(t,e,i){i||(i=em);var o=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return 180*Math.atan2(n,o)/Math.PI}function dm(t,e){return t===e?1:Nf(t)>=Nf(e)?t<0?2:4:e<0?8:Qf}function pm(t,e,i){return{x:e/t||0,y:i/t||0}}function gm(t,e){var i=t.session,o=e.pointers,n=o.length;i.firstInput||(i.firstInput=hm(e)),n>1&&!i.firstMultiple?i.firstMultiple=hm(e):1===n&&(i.firstMultiple=!1);var s=i.firstInput,r=i.firstMultiple,a=r?r.center:s.center,l=e.center=lm(o);e.timeStamp=Pf(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=um(a,l),e.distance=cm(a,l),function(t,e){var i=e.center,o=t.offsetDelta||{},n=t.prevDelta||{},s=t.prevInput||{};1!==e.eventType&&4!==s.eventType||(n=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},o=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=n.x+(i.x-o.x),e.deltaY=n.y+(i.y-o.y)}(i,e),e.offsetDirection=dm(e.deltaX,e.deltaY);var h,c,u=pm(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=Nf(u.x)>Nf(u.y)?u.x:u.y,e.scale=r?(h=r.pointers,cm((c=o)[0],c[1],im)/cm(h[0],h[1],im)):1,e.rotation=r?function(t,e){return um(e[1],e[0],im)+um(t[1],t[0],im)}(r.pointers,o):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,o,n,s,r=t.lastInterval||e,a=e.timeStamp-r.timeStamp;if(8!==e.eventType&&(a>25||void 0===r.velocity)){var l=e.deltaX-r.deltaX,h=e.deltaY-r.deltaY,c=pm(a,l,h);o=c.x,n=c.y,i=Nf(c.x)>Nf(c.y)?c.x:c.y,s=dm(l,h),t.lastInterval=e}else i=r.velocity,o=r.velocityX,n=r.velocityY,s=r.direction;e.velocity=i,e.velocityX=o,e.velocityY=n,e.direction=s}(i,e);var d,p=t.element,g=e.srcEvent;am(d=g.composedPath?g.composedPath()[0]:g.path?g.path[0]:g.target,p)&&(p=d),e.target=p}function fm(t,e,i){var o=i.pointers.length,n=i.changedPointers.length,s=1&e&&o-n==0,r=12&e&&o-n==0;i.isFirst=!!s,i.isFinal=!!r,s&&(t.session={}),i.eventType=e,gm(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function mm(t){return t.trim().split(/\s+/g)}function vm(t,e,i){om(mm(e),(function(e){t.addEventListener(e,i,!1)}))}function bm(t,e,i){om(mm(e),(function(e){t.removeEventListener(e,i,!1)}))}function _m(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var ym=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){nm(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&vm(this.element,this.evEl,this.domHandler),this.evTarget&&vm(this.target,this.evTarget,this.domHandler),this.evWin&&vm(_m(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&bm(this.element,this.evEl,this.domHandler),this.evTarget&&bm(this.target,this.evTarget,this.domHandler),this.evWin&&bm(_m(this.element),this.evWin,this.domHandler)},t}();function Tm(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var o=0;o<t.length;){if(i&&t[o][i]==e||!i&&t[o]===e)return o;o++}return-1}var Em={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},wm={2:qf,3:"pen",4:Zf,5:"kinect"},km="pointerdown",Im="pointermove pointerup pointercancel";Af.MSPointerEvent&&!Af.PointerEvent&&(km="MSPointerDown",Im="MSPointerMove MSPointerUp MSPointerCancel");var $m=function(t){function e(){var i,o=e.prototype;return o.evEl=km,o.evWin=Im,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return Of(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,o=t.type.toLowerCase().replace("ms",""),n=Em[o],s=wm[t.pointerType]||t.pointerType,r=s===qf,a=Tm(e,t.pointerId,"pointerId");1&n&&(0===t.button||r)?a<0&&(e.push(t),a=e.length-1):12&n&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),i&&e.splice(a,1))},e}(ym);function Sm(t){return Array.prototype.slice.call(t,0)}function Cm(t,e,i){for(var o=[],n=[],s=0;s<t.length;){var r=e?t[s][e]:t[s];Tm(n,r)<0&&o.push(t[s]),n[s]=r,s++}return i&&(o=e?o.sort((function(t,i){return t[e]>i[e]})):o.sort()),o}var Om={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Rm=function(t){function e(){var i;return e.prototype.evTarget="touchstart touchmove touchend touchcancel",(i=t.apply(this,arguments)||this).targetIds={},i}return Of(e,t),e.prototype.handler=function(t){var e=Om[t.type],i=Am.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:qf,srcEvent:t})},e}(ym);function Am(t,e){var i,o,n=Sm(t.touches),s=this.targetIds;if(3&e&&1===n.length)return s[n[0].identifier]=!0,[n,n];var r=Sm(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return am(t.target,l)})),1===e)for(i=0;i<o.length;)s[o[i].identifier]=!0,i++;for(i=0;i<r.length;)s[r[i].identifier]&&a.push(r[i]),12&e&&delete s[r[i].identifier],i++;return a.length?[Cm(o.concat(a),"identifier",!0),a]:void 0}var Mm={mousedown:1,mousemove:2,mouseup:4},xm=function(t){function e(){var i,o=e.prototype;return o.evEl="mousedown",o.evWin="mousemove mouseup",(i=t.apply(this,arguments)||this).pressed=!1,i}return Of(e,t),e.prototype.handler=function(t){var e=Mm[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Zf,srcEvent:t}))},e}(ym);function Lm(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},o=this.lastTouches;this.lastTouches.push(i);setTimeout((function(){var t=o.indexOf(i);t>-1&&o.splice(t,1)}),2500)}}function Dm(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,Lm.call(this,e)):12&t&&Lm.call(this,e)}function Nm(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,o=0;o<this.lastTouches.length;o++){var n=this.lastTouches[o],s=Math.abs(e-n.x),r=Math.abs(i-n.y);if(s<=25&&r<=25)return!0}return!1}var Pm=function(){return function(t){function e(e,i){var o;return(o=t.call(this,e,i)||this).handler=function(t,e,i){var n=i.pointerType===qf,s=i.pointerType===Zf;if(!(s&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)Dm.call(Rf(Rf(o)),e,i);else if(s&&Nm.call(Rf(Rf(o)),i))return;o.callback(t,e,i)}},o.touch=new Rm(o.manager,o.handler),o.mouse=new xm(o.manager,o.handler),o.primaryTouch=null,o.lastTouches=[],o}return Of(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(ym)}();function Bm(t,e,i){return!!Array.isArray(t)&&(om(t,i[e],i),!0)}var Fm=32,Hm=1;function Um(t,e){var i=e.manager;return i?i.get(t):t}function Gm(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var Vm=function(){function t(t){void 0===t&&(t={}),this.options=Cf({enable:!0},t),this.id=Hm++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return Mf(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(Bm(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Um(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return Bm(t,"dropRecognizeWith",this)||(t=Um(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(Bm(t,"requireFailure",this))return this;var e=this.requireFail;return-1===Tm(e,t=Um(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(Bm(t,"dropRequireFailure",this))return this;t=Um(t,this);var e=Tm(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function o(i){e.manager.emit(i,t)}i<8&&o(e.options.event+Gm(i)),o(e.options.event),t.additionalEvent&&o(t.additionalEvent),i>=8&&o(e.options.event+Gm(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=Fm},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=Mf({},t);if(!nm(this.options.enable,[this,e]))return this.reset(),void(this.state=Fm);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),Wm=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Cf({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}Of(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Vf]},i.process=function(t){var e=this,i=this.options,o=t.pointers.length===i.pointers,n=t.distance<i.threshold,s=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(n&&s&&o){if(4!==t.eventType)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||cm(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout((function(){e.state=8,e.tryEmit()}),i.interval),2):8}return Fm},i.failTimeout=function(){var t=this;return this._timer=setTimeout((function(){t.state=Fm}),this.options.interval),Fm},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(Vm),zm=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Cf({pointers:1},e))||this}Of(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,o=6&e,n=this.attrTest(t);return o&&(8&i||!n)?16|e:o||n?4&i?8|e:2&e?4|e:2:Fm},e}(Vm);function jm(t){return t===Qf?"down":8===t?"up":2===t?"left":4===t?"right":""}var Xm=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Cf({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}Of(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(jf),t&tm&&e.push(zf),e},i.directionTest=function(t){var e=this.options,i=!0,o=t.distance,n=t.direction,s=t.deltaX,r=t.deltaY;return n&e.direction||(6&e.direction?(n=0===s?1:s<0?2:4,i=s!==this.pX,o=Math.abs(t.deltaX)):(n=0===r?1:r<0?8:Qf,i=r!==this.pY,o=Math.abs(t.deltaY))),t.direction=n,i&&o>e.threshold&&n&e.direction},i.attrTest=function(t){return zm.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=jm(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(zm),Ym=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Cf({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}Of(e,t);var i=e.prototype;return i.getTouchAction=function(){return Xm.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,o=this.options.direction;return 30&o?i=e.overallVelocity:6&o?i=e.overallVelocityX:o&tm&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&o&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&Nf(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=jm(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(zm),Km=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Cf({event:"pinch",threshold:0,pointers:2},e))||this}Of(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Wf]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){if(1!==e.scale){var i=e.scale<1?"in":"out";e.additionalEvent=this.options.event+i}t.prototype.emit.call(this,e)},e}(zm),Jm=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Cf({event:"rotate",threshold:0,pointers:2},e))||this}Of(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Wf]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(zm),qm=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Cf({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}Of(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Gf]},i.process=function(t){var e=this,i=this.options,o=t.pointers.length===i.pointers,n=t.distance<i.threshold,s=t.deltaTime>i.time;if(this._input=t,!n||!o||12&t.eventType&&!s)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout((function(){e.state=8,e.tryEmit()}),i.time);else if(4&t.eventType)return 8;return Fm},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=Pf(),this.manager.emit(this.options.event,this._input)))},e}(Vm),Zm={domEvents:!1,touchAction:Uf,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Qm=[[Jm,{enable:!1}],[Km,{enable:!1},["rotate"]],[Ym,{direction:6}],[Xm,{direction:6},["swipe"]],[Wm],[Wm,{event:"doubletap",taps:2},["tap"]],[qm]];function tv(t,e){var i,o=t.element;o.style&&(om(t.options.cssProps,(function(n,s){i=Bf(o.style,s),e?(t.oldCssProps[i]=o.style[i],o.style[i]=n):o.style[i]=t.oldCssProps[i]||""})),e||(t.oldCssProps={}))}var ev=function(){function t(t,e){var i,o=this;this.options=Mf({},Zm,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this).options.inputClass||(Kf?$m:Jf?Rm:Yf?Pm:xm))(i,fm),this.touchAction=new rm(this,this.options.touchAction),tv(this,!0),om(this.options.recognizers,(function(t){var e=o.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}var e=t.prototype;return e.set=function(t){return Mf(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var o=this.recognizers,n=e.curRecognizer;(!n||n&&8&n.state)&&(e.curRecognizer=null,n=null);for(var s=0;s<o.length;)i=o[s],2===e.stopped||n&&i!==n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&14&i.state&&(e.curRecognizer=i,n=i),s++}},e.get=function(t){if(t instanceof Vm)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(Bm(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(Bm(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,o=Tm(i,e);-1!==o&&(i.splice(o,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return om(mm(t),(function(t){i[t]=i[t]||[],i[t].push(e)})),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return om(mm(t),(function(t){e?i[t]&&i[t].splice(Tm(i[t],e),1):delete i[t]})),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var o=0;o<i.length;)i[o](e),o++}},e.destroy=function(){this.element&&tv(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),iv={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ov=function(t){function e(){var i,o=e.prototype;return o.evTarget="touchstart",o.evWin="touchstart touchmove touchend touchcancel",(i=t.apply(this,arguments)||this).started=!1,i}return Of(e,t),e.prototype.handler=function(t){var e=iv[t.type];if(1===e&&(this.started=!0),this.started){var i=nv.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:qf,srcEvent:t})}},e}(ym);function nv(t,e){var i=Sm(t.touches),o=Sm(t.changedTouches);return 12&e&&(i=Cm(i.concat(o),"identifier",!0)),[i,o]}function sv(t,e,i){var o="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",n=window.console&&(window.console.warn||window.console.log);return n&&n.call(window.console,o,i),t.apply(this,arguments)}}var rv=sv((function(t,e,i){for(var o=Object.keys(e),n=0;n<o.length;)(!i||i&&void 0===t[o[n]])&&(t[o[n]]=e[o[n]]),n++;return t}),"extend","Use `assign`."),av=sv((function(t,e){return rv(t,e,!0)}),"merge","Use `assign`.");function lv(t,e,i){var o,n=e.prototype;(o=t.prototype=Object.create(n)).constructor=t,o._super=n,i&&Mf(o,i)}function hv(t,e){return function(){return t.apply(e,arguments)}}var cv=function(){var t=function(t,e){return void 0===e&&(e={}),new ev(t,Cf({recognizers:Qm.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=Qf,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=tm,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=Qf,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=Fm,t.Manager=ev,t.Input=ym,t.TouchAction=rm,t.TouchInput=Rm,t.MouseInput=xm,t.PointerEventInput=$m,t.TouchMouseInput=Pm,t.SingleTouchInput=ov,t.Recognizer=Vm,t.AttrRecognizer=zm,t.Tap=Wm,t.Pan=Xm,t.Swipe=Ym,t.Pinch=Km,t.Rotate=Jm,t.Press=qm,t.on=vm,t.off=bm,t.each=om,t.merge=av,t.extend=rv,t.bindFn=hv,t.assign=Mf,t.inherit=lv,t.bindFn=hv,t.prefixed=Bf,t.toArray=Sm,t.inArray=Tm,t.uniqueArray=Cm,t.splitStr=mm,t.boolOrFn=nm,t.hasParent=am,t.addEventListeners=vm,t.removeEventListeners=bm,t.defaults=Mf({},Zm,{preset:Qm}),t}();function uv(t,e){var i=void 0!==$p&&Nd(t)||t["@@iterator"];if(!i){if(Hp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return dv(t,e);var o=Mp(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?xd(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?dv(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function dv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}var pv=$p("DELETE");function gv(){var t=fv.apply(void 0,arguments);return vv(t),t}function fv(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<2)return e[0];var o;if(e.length>2)return fv.apply(void 0,Ap(o=[gv(e[0],e[1])]).call(o,Ip(Mp(e).call(e,2))));var n=e[0],s=e[1];if(n instanceof Date&&s instanceof Date)return n.setTime(s.getTime()),n;var r,a=uv(Fp(s));try{for(a.s();!(r=a.n()).done;){var l=r.value;Object.prototype.propertyIsEnumerable.call(s,l)&&(s[l]===pv?delete n[l]:null===n[l]||null===s[l]||"object"!=typeof n[l]||"object"!=typeof s[l]||Hp(n[l])||Hp(s[l])?n[l]=mv(s[l]):n[l]=fv(n[l],s[l]))}}catch(t){a.e(t)}finally{a.f()}return n}function mv(t){return Hp(t)?Cu(t).call(t,(function(t){return mv(t)})):"object"==typeof t&&null!==t?t instanceof Date?new Date(t.getTime()):fv({},t):t}function vv(t){for(var e=0,i=Vp(t);e<i.length;e++){var o=i[e];t[o]===pv?delete t[o]:"object"==typeof t[o]&&null!==t[o]&&vv(t[o])}}var bv="undefined"!=typeof window?window.Hammer||cv:function(){return function(){var t=function(){};return{on:t,off:t,destroy:t,emit:t,get:()=>({set:t})}}()};function _v(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push((function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)}));var o=bv(this._dom.overlay);o.on("tap",tu(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push((function(){o.destroy()}));var n=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];tg(n).call(n,(function(t){o.on(t,(function(t){t.srcEvent.stopPropagation()}))})),document&&document.body&&(this._onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push((function(){document.body.removeEventListener("click",i._onClick)}))),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}Sf(_v.prototype),_v.current=null,_v.prototype.destroy=function(){var t,e;this.deactivate();var i,o=uv(cg(t=Ag(e=this._cleanupQueue).call(e,0)).call(t));try{for(o.s();!(i=o.n()).done;)(0,i.value)()}catch(t){o.e(t)}finally{o.f()}},_v.prototype.activate=function(){_v.current&&_v.current.deactivate(),_v.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},_v.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},_v.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var yv=$o,Tv=Rt,Ev=TypeError,wv=function(t){if(yv(t))return t;throw new Ev(Tv(t)+" is not a constructor")},kv=Oi,Iv=g,$v=Wc,Sv=wv,Cv=oi,Ov=ot,Rv=jn,Av=l,Mv=ht("Reflect","construct"),xv=Object.prototype,Lv=[].push,Dv=Av((function(){function t(){}return!(Mv((function(){}),[],t)instanceof t)})),Nv=!Av((function(){Mv((function(){}))})),Pv=Dv||Nv;kv({target:"Reflect",stat:!0,forced:Pv,sham:Pv},{construct:function(t,e){Sv(t),Cv(e);var i=arguments.length<3?t:Sv(arguments[2]);if(Nv&&!Dv)return Mv(t,e,i);if(t===i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var o=[null];return Iv(Lv,o,e),new(Iv($v,t,o))}var n=i.prototype,s=Rv(Ov(n)?n:xv),r=Iv(t,s,e);return Ov(r)?r:s}});var Bv=n(nt.Reflect.construct),Fv=n(nt.Object.getOwnPropertySymbols),Hv={exports:{}},Uv=Oi,Gv=l,Vv=tt,Wv=A.f,zv=M;Uv({target:"Object",stat:!0,forced:!zv||Gv((function(){Wv(1)})),sham:!zv},{getOwnPropertyDescriptor:function(t,e){return Wv(Vv(t),e)}});var jv=nt.Object,Xv=Hv.exports=function(t,e){return jv.getOwnPropertyDescriptor(t,e)};jv.getOwnPropertyDescriptor.sham&&(Xv.sham=!0);var Yv=n(Hv.exports),Kv=Bp,Jv=tt,qv=A,Zv=Zi;Oi({target:"Object",stat:!0,sham:!M},{getOwnPropertyDescriptors:function(t){for(var e,i,o=Jv(t),n=qv.f,s=Kv(o),r={},a=0;s.length>a;)void 0!==(i=n(o,e=s[a++]))&&Zv(r,e,i);return r}});var Qv=n(nt.Object.getOwnPropertyDescriptors),tb={exports:{}},eb=Oi,ib=M,ob=tn.f;eb({target:"Object",stat:!0,forced:Object.defineProperties!==ob,sham:!ib},{defineProperties:ob});var nb=nt.Object,sb=tb.exports=function(t,e){return nb.defineProperties(t,e)};nb.defineProperties.sham&&(sb.sham=!0);var rb=n(tb.exports),ab=n(Di);function lb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var hb=Zg,cb=n(hb);Oi({target:"Object",stat:!0},{setPrototypeOf:th});var ub=nt.Object.setPrototypeOf,db=n(ub),pb=n(Qc);function gb(t,e){var i;return gb=db?pb(i=db).call(i):function(t,e){return t.__proto__=e,t},gb(t,e)}function fb(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=cb(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Pi(t,"prototype",{writable:!1}),e&&gb(t,e)}function mb(t,e){if(e&&("object"===Cc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return lb(t)}var vb=Jg,bb=n(vb);function _b(t){var e;return _b=db?pb(e=bb).call(e):function(t){return t.__proto__||bb(t)},_b(t)}var yb={exports:{}},Tb={exports:{}};!function(t){var e=ac,i=$c;function o(n){return t.exports=o="function"==typeof e&&"symbol"==typeof i?function(t){return typeof t}:function(t){return t&&"function"==typeof e&&t.constructor===e&&t!==e.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,o(n)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports}(Tb);var Eb=Tb.exports,wb=Qp,kb=te,Ib=Bp,$b=A,Sb=Ze,Cb=ot,Ob=vi,Rb=Error,Ab=_("".replace),Mb=String(new Rb("zxcasd").stack),xb=/\n\s*at [^:]*:[^\n]*/,Lb=xb.test(Mb),Db=G,Nb=!l((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",Db(1,7)),7!==t.stack)})),Pb=vi,Bb=function(t,e){if(Lb&&"string"==typeof t&&!Rb.prepareStackTrace)for(;e--;)t=Ab(t,xb,"");return t},Fb=Nb,Hb=Error.captureStackTrace,Ub=qe,Gb=D,Vb=oi,Wb=Rt,zb=ed,jb=ji,Xb=ct,Yb=gd,Kb=ad,Jb=Ku,qb=TypeError,Zb=function(t,e){this.stopped=t,this.result=e},Qb=Zb.prototype,t_=function(t,e,i){var o,n,s,r,a,l,h,c=i&&i.that,u=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_RECORD),p=!(!i||!i.IS_ITERATOR),g=!(!i||!i.INTERRUPTED),f=Ub(e,c),m=function(t){return o&&Jb(o,"normal",t),new Zb(!0,t)},v=function(t){return u?(Vb(t),g?f(t[0],t[1],m):f(t[0],t[1])):g?f(t,m):f(t)};if(d)o=t.iterator;else if(p)o=t;else{if(!(n=Kb(t)))throw new qb(Wb(t)+" is not iterable");if(zb(n)){for(s=0,r=jb(t);r>s;s++)if((a=v(t[s]))&&Xb(Qb,a))return a;return new Zb(!1)}o=Yb(t,n)}for(l=d?t.next:o.next;!(h=Gb(l,o)).done;){try{a=v(h.value)}catch(t){Jb(o,"throw",t)}if("object"==typeof a&&a&&Xb(Qb,a))return a}return new Zb(!1)},e_=Qo,i_=Oi,o_=ct,n_=Ml,s_=th,r_=function(t,e,i){for(var o=Ib(e),n=Sb.f,s=$b.f,r=0;r<o.length;r++){var a=o[r];kb(t,a)||i&&kb(i,a)||n(t,a,s(e,a))}},a_=jn,l_=vi,h_=G,c_=function(t,e){Cb(e)&&"cause"in e&&Ob(t,"cause",e.cause)},u_=function(t,e,i,o){Fb&&(Hb?Hb(t,e):Pb(t,"stack",Bb(i,o)))},d_=t_,p_=function(t,e){return void 0===t?arguments.length<2?"":e:e_(t)},g_=ge("toStringTag"),f_=Error,m_=[].push,v_=function(t,e){var i,o=o_(b_,this);s_?i=s_(new f_,o?n_(this):b_):(i=o?this:a_(b_),l_(i,g_,"Error")),void 0!==e&&l_(i,"message",p_(e)),u_(i,v_,i.stack,1),arguments.length>2&&c_(i,arguments[2]);var n=[];return d_(t,m_,{that:n}),l_(i,"errors",n),i};s_?s_(v_,f_):r_(v_,f_,{name:!0});var b_=v_.prototype=a_(f_.prototype,{constructor:h_(1,v_),message:h_(1,""),name:h_(1,"AggregateError")});i_({global:!0,constructor:!0,arity:2},{AggregateError:v_});var __,y_,T_,E_,w_=ht,k_=ds,I_=M,$_=ge("species"),S_=function(t){var e=w_(t);I_&&e&&!e[$_]&&k_(e,$_,{configurable:!0,get:function(){return this}})},C_=ct,O_=TypeError,R_=function(t,e){if(C_(e,t))return t;throw new O_("Incorrect invocation")},A_=oi,M_=wv,x_=Y,L_=ge("species"),D_=function(t,e){var i,o=A_(t).constructor;return void 0===o||x_(i=A_(o)[L_])?e:M_(i)},N_=/(?:ipad|iphone|ipod).*applewebkit/i.test(ut),P_=a,B_=g,F_=qe,H_=R,U_=te,G_=l,V_=On,W_=Ma,z_=Se,j_=af,X_=N_,Y_=cu,K_=P_.setImmediate,J_=P_.clearImmediate,q_=P_.process,Z_=P_.Dispatch,Q_=P_.Function,ty=P_.MessageChannel,ey=P_.String,iy=0,oy={},ny="onreadystatechange";G_((function(){__=P_.location}));var sy=function(t){if(U_(oy,t)){var e=oy[t];delete oy[t],e()}},ry=function(t){return function(){sy(t)}},ay=function(t){sy(t.data)},ly=function(t){P_.postMessage(ey(t),__.protocol+"//"+__.host)};K_&&J_||(K_=function(t){j_(arguments.length,1);var e=H_(t)?t:Q_(t),i=W_(arguments,1);return oy[++iy]=function(){B_(e,void 0,i)},y_(iy),iy},J_=function(t){delete oy[t]},Y_?y_=function(t){q_.nextTick(ry(t))}:Z_&&Z_.now?y_=function(t){Z_.now(ry(t))}:ty&&!X_?(E_=(T_=new ty).port2,T_.port1.onmessage=ay,y_=F_(E_.postMessage,E_)):P_.addEventListener&&H_(P_.postMessage)&&!P_.importScripts&&__&&"file:"!==__.protocol&&!G_(ly)?(y_=ly,P_.addEventListener("message",ay,!1)):y_=ny in z_("script")?function(t){V_.appendChild(z_("script"))[ny]=function(){V_.removeChild(this),sy(t)}}:function(t){setTimeout(ry(t),0)});var hy={set:K_,clear:J_},cy=function(){this.head=null,this.tail=null};cy.prototype={add:function(t){var e={item:t,next:null},i=this.tail;i?i.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var uy,dy,py,gy,fy,my=cy,vy=/ipad|iphone|ipod/i.test(ut)&&"undefined"!=typeof Pebble,by=/web0s(?!.*chrome)/i.test(ut),_y=a,yy=qe,Ty=A.f,Ey=hy.set,wy=my,ky=N_,Iy=vy,$y=by,Sy=cu,Cy=_y.MutationObserver||_y.WebKitMutationObserver,Oy=_y.document,Ry=_y.process,Ay=_y.Promise,My=Ty(_y,"queueMicrotask"),xy=My&&My.value;if(!xy){var Ly=new wy,Dy=function(){var t,e;for(Sy&&(t=Ry.domain)&&t.exit();e=Ly.get();)try{e()}catch(t){throw Ly.head&&uy(),t}t&&t.enter()};ky||Sy||$y||!Cy||!Oy?!Iy&&Ay&&Ay.resolve?((gy=Ay.resolve(void 0)).constructor=Ay,fy=yy(gy.then,gy),uy=function(){fy(Dy)}):Sy?uy=function(){Ry.nextTick(Dy)}:(Ey=yy(Ey,_y),uy=function(){Ey(Dy)}):(dy=!0,py=Oy.createTextNode(""),new Cy(Dy).observe(py,{characterData:!0}),uy=function(){py.data=dy=!dy}),xy=function(t){Ly.head||uy(),Ly.add(t)}}var Ny=xy,Py=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},By=a.Promise,Fy="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Hy=!Fy&&!cu&&"object"==typeof window&&"object"==typeof document,Uy=a,Gy=By,Vy=R,Wy=Xe,zy=uo,jy=ge,Xy=Hy,Yy=Fy,Ky=bt,Jy=Gy&&Gy.prototype,qy=jy("species"),Zy=!1,Qy=Vy(Uy.PromiseRejectionEvent),tT={CONSTRUCTOR:Wy("Promise",(function(){var t=zy(Gy),e=t!==String(Gy);if(!e&&66===Ky)return!0;if(!Jy.catch||!Jy.finally)return!0;if(!Ky||Ky<51||!/native code/.test(t)){var i=new Gy((function(t){t(1)})),o=function(t){t((function(){}),(function(){}))};if((i.constructor={})[qy]=o,!(Zy=i.then((function(){}))instanceof o))return!0}return!e&&(Xy||Yy)&&!Qy})),REJECTION_EVENT:Qy,SUBCLASSING:Zy},eT={},iT=Lt,oT=TypeError,nT=function(t){var e,i;this.promise=new t((function(t,o){if(void 0!==e||void 0!==i)throw new oT("Bad Promise constructor");e=t,i=o})),this.resolve=iT(e),this.reject=iT(i)};eT.f=function(t){return new nT(t)};var sT,rT,aT=Oi,lT=cu,hT=a,cT=D,uT=cs,dT=Ns,pT=S_,gT=Lt,fT=R,mT=ot,vT=R_,bT=D_,_T=hy.set,yT=Ny,TT=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}},ET=Py,wT=my,kT=Zs,IT=By,$T=tT,ST=eT,CT="Promise",OT=$T.CONSTRUCTOR,RT=$T.REJECTION_EVENT,AT=kT.getterFor(CT),MT=kT.set,xT=IT&&IT.prototype,LT=IT,DT=xT,NT=hT.TypeError,PT=hT.document,BT=hT.process,FT=ST.f,HT=FT,UT=!!(PT&&PT.createEvent&&hT.dispatchEvent),GT="unhandledrejection",VT=function(t){var e;return!(!mT(t)||!fT(e=t.then))&&e},WT=function(t,e){var i,o,n,s=e.value,r=1===e.state,a=r?t.ok:t.fail,l=t.resolve,h=t.reject,c=t.domain;try{a?(r||(2===e.rejection&&KT(e),e.rejection=1),!0===a?i=s:(c&&c.enter(),i=a(s),c&&(c.exit(),n=!0)),i===t.promise?h(new NT("Promise-chain cycle")):(o=VT(i))?cT(o,i,l,h):l(i)):h(s)}catch(t){c&&!n&&c.exit(),h(t)}},zT=function(t,e){t.notified||(t.notified=!0,yT((function(){for(var i,o=t.reactions;i=o.get();)WT(i,t);t.notified=!1,e&&!t.rejection&&XT(t)})))},jT=function(t,e,i){var o,n;UT?((o=PT.createEvent("Event")).promise=e,o.reason=i,o.initEvent(t,!1,!0),hT.dispatchEvent(o)):o={promise:e,reason:i},!RT&&(n=hT["on"+t])?n(o):t===GT&&TT("Unhandled promise rejection",i)},XT=function(t){cT(_T,hT,(function(){var e,i=t.facade,o=t.value;if(YT(t)&&(e=ET((function(){lT?BT.emit("unhandledRejection",o,i):jT(GT,i,o)})),t.rejection=lT||YT(t)?2:1,e.error))throw e.value}))},YT=function(t){return 1!==t.rejection&&!t.parent},KT=function(t){cT(_T,hT,(function(){var e=t.facade;lT?BT.emit("rejectionHandled",e):jT("rejectionhandled",e,t.value)}))},JT=function(t,e,i){return function(o){t(e,o,i)}},qT=function(t,e,i){t.done||(t.done=!0,i&&(t=i),t.value=e,t.state=2,zT(t,!0))},ZT=function(t,e,i){if(!t.done){t.done=!0,i&&(t=i);try{if(t.facade===e)throw new NT("Promise can't be resolved itself");var o=VT(e);o?yT((function(){var i={done:!1};try{cT(o,e,JT(ZT,i,t),JT(qT,i,t))}catch(e){qT(i,e,t)}})):(t.value=e,t.state=1,zT(t,!1))}catch(e){qT({done:!1},e,t)}}};OT&&(DT=(LT=function(t){vT(this,DT),gT(t),cT(sT,this);var e=AT(this);try{t(JT(ZT,e),JT(qT,e))}catch(t){qT(e,t)}}).prototype,(sT=function(t){MT(this,{type:CT,done:!1,notified:!1,parent:!1,reactions:new wT,rejection:!1,state:0,value:void 0})}).prototype=uT(DT,"then",(function(t,e){var i=AT(this),o=FT(bT(this,LT));return i.parent=!0,o.ok=!fT(t)||t,o.fail=fT(e)&&e,o.domain=lT?BT.domain:void 0,0===i.state?i.reactions.add(o):yT((function(){WT(o,i)})),o.promise})),rT=function(){var t=new sT,e=AT(t);this.promise=t,this.resolve=JT(ZT,e),this.reject=JT(qT,e)},ST.f=FT=function(t){return t===LT||undefined===t?new rT(t):HT(t)}),aT({global:!0,constructor:!0,wrap:!0,forced:OT},{Promise:LT}),dT(LT,CT,!1,!0),pT(CT);var QT=By,tE=tT.CONSTRUCTOR||!Rd((function(t){QT.all(t).then(void 0,(function(){}))})),eE=D,iE=Lt,oE=eT,nE=Py,sE=t_;Oi({target:"Promise",stat:!0,forced:tE},{all:function(t){var e=this,i=oE.f(e),o=i.resolve,n=i.reject,s=nE((function(){var i=iE(e.resolve),s=[],r=0,a=1;sE(t,(function(t){var l=r++,h=!1;a++,eE(i,e,t).then((function(t){h||(h=!0,s[l]=t,--a||o(s))}),n)})),--a||o(s)}));return s.error&&n(s.value),i.promise}});var rE=Oi,aE=tT.CONSTRUCTOR;By&&By.prototype,rE({target:"Promise",proto:!0,forced:aE,real:!0},{catch:function(t){return this.then(void 0,t)}});var lE=D,hE=Lt,cE=eT,uE=Py,dE=t_;Oi({target:"Promise",stat:!0,forced:tE},{race:function(t){var e=this,i=cE.f(e),o=i.reject,n=uE((function(){var n=hE(e.resolve);dE(t,(function(t){lE(n,e,t).then(i.resolve,o)}))}));return n.error&&o(n.value),i.promise}});var pE=D,gE=eT;Oi({target:"Promise",stat:!0,forced:tT.CONSTRUCTOR},{reject:function(t){var e=gE.f(this);return pE(e.reject,void 0,t),e.promise}});var fE=oi,mE=ot,vE=eT,bE=function(t,e){if(fE(t),mE(e)&&e.constructor===t)return e;var i=vE.f(t);return(0,i.resolve)(e),i.promise},_E=Oi,yE=By,TE=tT.CONSTRUCTOR,EE=bE,wE=ht("Promise"),kE=!TE;_E({target:"Promise",stat:!0,forced:true},{resolve:function(t){return EE(kE&&this===wE?yE:this,t)}});var IE=D,$E=Lt,SE=eT,CE=Py,OE=t_;Oi({target:"Promise",stat:!0,forced:tE},{allSettled:function(t){var e=this,i=SE.f(e),o=i.resolve,n=i.reject,s=CE((function(){var i=$E(e.resolve),n=[],s=0,r=1;OE(t,(function(t){var a=s++,l=!1;r++,IE(i,e,t).then((function(t){l||(l=!0,n[a]={status:"fulfilled",value:t},--r||o(n))}),(function(t){l||(l=!0,n[a]={status:"rejected",reason:t},--r||o(n))}))})),--r||o(n)}));return s.error&&n(s.value),i.promise}});var RE=D,AE=Lt,ME=ht,xE=eT,LE=Py,DE=t_,NE="No one promise resolved";Oi({target:"Promise",stat:!0,forced:tE},{any:function(t){var e=this,i=ME("AggregateError"),o=xE.f(e),n=o.resolve,s=o.reject,r=LE((function(){var o=AE(e.resolve),r=[],a=0,l=1,h=!1;DE(t,(function(t){var c=a++,u=!1;l++,RE(o,e,t).then((function(t){u||h||(h=!0,n(t))}),(function(t){u||h||(u=!0,r[c]=t,--l||s(new i(r,NE)))}))})),--l||s(new i(r,NE))}));return r.error&&s(r.value),o.promise}});var PE=Oi,BE=By,FE=l,HE=ht,UE=R,GE=D_,VE=bE,WE=BE&&BE.prototype;PE({target:"Promise",proto:!0,real:!0,forced:!!BE&&FE((function(){WE.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=GE(this,HE("Promise")),i=UE(t);return this.then(i?function(i){return VE(e,t()).then((function(){return i}))}:t,i?function(i){return VE(e,t()).then((function(){throw i}))}:t)}});var zE=nt.Promise,jE=eT;Oi({target:"Promise",stat:!0},{withResolvers:function(){var t=jE.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}});var XE=zE,YE=eT,KE=Py;Oi({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=YE.f(this),i=KE(t);return(i.error?e.reject:e.resolve)(i.value),e.promise}});var JE=XE,qE=hg;!function(t){var e=Eb.default,i=Ni,o=ac,n=hb,s=vb,r=wb,a=Zd,l=ub,h=JE,c=qE,u=_p;function d(){t.exports=d=function(){return g},t.exports.__esModule=!0,t.exports.default=t.exports;var p,g={},f=Object.prototype,m=f.hasOwnProperty,v=i||function(t,e,i){t[e]=i.value},b="function"==typeof o?o:{},_=b.iterator||"@@iterator",y=b.asyncIterator||"@@asyncIterator",T=b.toStringTag||"@@toStringTag";function E(t,e,o){return i(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{E({},"")}catch(p){E=function(t,e,i){return t[e]=i}}function w(t,e,i,o){var s=e&&e.prototype instanceof R?e:R,r=n(s.prototype),a=new G(o||[]);return v(r,"_invoke",{value:B(t,i,a)}),r}function k(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}g.wrap=w;var I="suspendedStart",$="suspendedYield",S="executing",C="completed",O={};function R(){}function A(){}function M(){}var x={};E(x,_,(function(){return this}));var L=s&&s(s(V([])));L&&L!==f&&m.call(L,_)&&(x=L);var D=M.prototype=R.prototype=n(x);function N(t){var e;r(e=["next","throw","return"]).call(e,(function(e){E(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,i){function o(n,s,r,a){var l=k(t[n],t,s);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==e(c)&&m.call(c,"__await")?i.resolve(c.__await).then((function(t){o("next",t,r,a)}),(function(t){o("throw",t,r,a)})):i.resolve(c).then((function(t){h.value=t,r(h)}),(function(t){return o("throw",t,r,a)}))}a(l.arg)}var n;v(this,"_invoke",{value:function(t,e){function s(){return new i((function(i,n){o(t,e,i,n)}))}return n=n?n.then(s,s):s()}})}function B(t,e,i){var o=I;return function(n,s){if(o===S)throw new Error("Generator is already running");if(o===C){if("throw"===n)throw s;return{value:p,done:!0}}for(i.method=n,i.arg=s;;){var r=i.delegate;if(r){var a=F(r,i);if(a){if(a===O)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(o===I)throw o=C,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o=S;var l=k(t,e,i);if("normal"===l.type){if(o=i.done?C:$,l.arg===O)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(o=C,i.method="throw",i.arg=l.arg)}}}function F(t,e){var i=e.method,o=t.iterator[i];if(o===p)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=p,F(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),O;var n=k(o,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,O;var s=n.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=p),e.delegate=null,O):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,O)}function H(t){var e,i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),a(e=this.tryEntries).call(e,i)}function U(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],r(t).call(t,H,this),this.reset(!0)}function V(t){if(t||""===t){var i=t[_];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,n=function e(){for(;++o<t.length;)if(m.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=p,e.done=!0,e};return n.next=n}}throw new TypeError(e(t)+" is not iterable")}return A.prototype=M,v(D,"constructor",{value:M,configurable:!0}),v(M,"constructor",{value:A,configurable:!0}),A.displayName=E(M,T,"GeneratorFunction"),g.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===A||"GeneratorFunction"===(e.displayName||e.name))},g.mark=function(t){return l?l(t,M):(t.__proto__=M,E(t,T,"GeneratorFunction")),t.prototype=n(D),t},g.awrap=function(t){return{__await:t}},N(P.prototype),E(P.prototype,y,(function(){return this})),g.AsyncIterator=P,g.async=function(t,e,i,o,n){void 0===n&&(n=h);var s=new P(w(t,e,i,o),n);return g.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},N(D),E(D,T,"Generator"),E(D,_,(function(){return this})),E(D,"toString",(function(){return"[object Generator]"})),g.keys=function(t){var e=Object(t),i=[];for(var o in e)a(i).call(i,o);return c(i).call(i),function t(){for(;i.length;){var o=i.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},g.values=V,G.prototype={constructor:G,reset:function(t){var e;if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,r(e=this.tryEntries).call(e,U),!t)for(var i in this)"t"===i.charAt(0)&&m.call(this,i)&&!isNaN(+u(i).call(i,1))&&(this[i]=p)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,o){return s.type="throw",s.arg=t,e.next=i,o&&(e.method="next",e.arg=p),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],s=n.completion;if("root"===n.tryLoc)return i("end");if(n.tryLoc<=this.prev){var r=m.call(n,"catchLoc"),a=m.call(n,"finallyLoc");if(r&&a){if(this.prev<n.catchLoc)return i(n.catchLoc,!0);if(this.prev<n.finallyLoc)return i(n.finallyLoc)}else if(r){if(this.prev<n.catchLoc)return i(n.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return i(n.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&m.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=e,n?(this.method="next",this.next=n.finallyLoc,O):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),O},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),U(i),O}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var n=o.arg;U(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:V(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=p),O}},g}t.exports=d,t.exports.__esModule=!0,t.exports.default=t.exports}(yb);var ZE=(0,yb.exports)(),QE=ZE;try{regeneratorRuntime=ZE}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=ZE:Function("r","regeneratorRuntime = r")(ZE)}var tw=n(QE),ew={exports:{}},iw=l((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),ow=l,nw=ot,sw=w,rw=iw,aw=Object.isExtensible,lw=ow((function(){aw(1)}))||rw?function(t){return!!nw(t)&&(!rw||"ArrayBuffer"!==sw(t))&&(!aw||aw(t))}:aw,hw=!l((function(){return Object.isExtensible(Object.preventExtensions({}))})),cw=Oi,uw=_,dw=un,pw=ot,gw=te,fw=Ze.f,mw=Xn,vw=Jn,bw=lw,_w=hw,yw=!1,Tw=se("meta"),Ew=0,ww=function(t){fw(t,Tw,{value:{objectID:"O"+Ew++,weakData:{}}})},kw=ew.exports={enable:function(){kw.enable=function(){},yw=!0;var t=mw.f,e=uw([].splice),i={};i[Tw]=1,t(i).length&&(mw.f=function(i){for(var o=t(i),n=0,s=o.length;n<s;n++)if(o[n]===Tw){e(o,n,1);break}return o},cw({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:vw.f}))},fastKey:function(t,e){if(!pw(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!gw(t,Tw)){if(!bw(t))return"F";if(!e)return"E";ww(t)}return t[Tw].objectID},getWeakData:function(t,e){if(!gw(t,Tw)){if(!bw(t))return!0;if(!e)return!1;ww(t)}return t[Tw].weakData},onFreeze:function(t){return _w&&yw&&bw(t)&&!gw(t,Tw)&&ww(t),t}};dw[Tw]=!0;var Iw=ew.exports,$w=Oi,Sw=a,Cw=Iw,Ow=l,Rw=vi,Aw=t_,Mw=R_,xw=R,Lw=ot,Dw=Y,Nw=Ns,Pw=Ze.f,Bw=rr.forEach,Fw=M,Hw=Zs.set,Uw=Zs.getterFor,Gw=function(t,e,i){var o,n=-1!==t.indexOf("Map"),s=-1!==t.indexOf("Weak"),r=n?"set":"add",a=Sw[t],l=a&&a.prototype,h={};if(Fw&&xw(a)&&(s||l.forEach&&!Ow((function(){(new a).entries().next()})))){var c=(o=e((function(e,i){Hw(Mw(e,c),{type:t,collection:new a}),Dw(i)||Aw(i,e[r],{that:e,AS_ENTRIES:n})}))).prototype,u=Uw(t);Bw(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(t){var e="add"===t||"set"===t;!(t in l)||s&&"clear"===t||Rw(c,t,(function(i,o){var n=u(this).collection;if(!e&&s&&!Lw(i))return"get"===t&&void 0;var r=n[t](0===i?0:i,o);return e?this:r}))})),s||Pw(c,"size",{configurable:!0,get:function(){return u(this).collection.size}})}else o=i.getConstructor(e,t,n,r),Cw.enable();return Nw(o,t,!1,!0),h[t]=o,$w({global:!0,forced:!0},h),s||i.setStrong(o,t,n),o},Vw=cs,Ww=jn,zw=ds,jw=function(t,e,i){for(var o in e)i&&i.unsafe&&t[o]?t[o]=e[o]:Vw(t,o,e[o],i);return t},Xw=qe,Yw=R_,Kw=Y,Jw=t_,qw=vh,Zw=bh,Qw=S_,tk=M,ek=Iw.fastKey,ik=Zs.set,ok=Zs.getterFor,nk={getConstructor:function(t,e,i,o){var n=t((function(t,n){Yw(t,s),ik(t,{type:e,index:Ww(null),first:void 0,last:void 0,size:0}),tk||(t.size=0),Kw(n)||Jw(n,t[o],{that:t,AS_ENTRIES:i})})),s=n.prototype,r=ok(e),a=function(t,e,i){var o,n,s=r(t),a=l(t,e);return a?a.value=i:(s.last=a={index:n=ek(e,!0),key:e,value:i,previous:o=s.last,next:void 0,removed:!1},s.first||(s.first=a),o&&(o.next=a),tk?s.size++:t.size++,"F"!==n&&(s.index[n]=a)),t},l=function(t,e){var i,o=r(t),n=ek(e);if("F"!==n)return o.index[n];for(i=o.first;i;i=i.next)if(i.key===e)return i};return jw(s,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,tk?t.size=0:this.size=0},delete:function(t){var e=this,i=r(e),o=l(e,t);if(o){var n=o.next,s=o.previous;delete i.index[o.index],o.removed=!0,s&&(s.next=n),n&&(n.previous=s),i.first===o&&(i.first=n),i.last===o&&(i.last=s),tk?i.size--:e.size--}return!!o},forEach:function(t){for(var e,i=r(this),o=Xw(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:i.first;)for(o(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!l(this,t)}}),jw(s,i?{get:function(t){var e=l(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),tk&&zw(s,"size",{configurable:!0,get:function(){return r(this).size}}),n},setStrong:function(t,e,i){var o=e+" Iterator",n=ok(e),s=ok(o);qw(t,e,(function(t,e){ik(this,{type:o,target:t,state:n(t),kind:e,last:void 0})}),(function(){for(var t=s(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?Zw("keys"===e?i.key:"values"===e?i.value:[i.key,i.value],!1):(t.target=void 0,Zw(void 0,!0))}),i?"entries":"values",!i,!0),Qw(e)}};Gw("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),nk);var sk=n(nt.Map),rk=rr.some;Oi({target:"Array",proto:!0,forced:!hu("some")},{some:function(t){return rk(this,t,arguments.length>1?arguments[1]:void 0)}});var ak=Yc("Array","some"),lk=ct,hk=ak,ck=Array.prototype,uk=n((function(t){var e=t.some;return t===ck||lk(ck,t)&&e===ck.some?hk:e})),dk=Yc("Array","keys"),pk=ao,gk=te,fk=ct,mk=dk,vk=Array.prototype,bk={DOMTokenList:!0,NodeList:!0},_k=n((function(t){var e=t.keys;return t===vk||fk(vk,t)&&e===vk.keys||gk(bk,pk(t))?mk:e})),yk=is,Tk=Math.floor,Ek=function(t,e){var i=t.length,o=Tk(i/2);return i<8?wk(t,e):kk(t,Ek(yk(t,0,o),e),Ek(yk(t,o),e),e)},wk=function(t,e){for(var i,o,n=t.length,s=1;s<n;){for(o=s,i=t[s];o&&e(t[o-1],i)>0;)t[o]=t[--o];o!==s++&&(t[o]=i)}return t},kk=function(t,e,i,o){for(var n=e.length,s=i.length,r=0,a=0;r<n||a<s;)t[r+a]=r<n&&a<s?o(e[r],i[a])<=0?e[r++]:i[a++]:r<n?e[r++]:i[a++];return t},Ik=Ek,$k=ut.match(/firefox\/(\d+)/i),Sk=!!$k&&+$k[1],Ck=/MSIE|Trident/.test(ut),Ok=ut.match(/AppleWebKit\/(\d+)\./),Rk=!!Ok&&+Ok[1],Ak=Oi,Mk=_,xk=Lt,Lk=qt,Dk=ji,Nk=pg,Pk=Qo,Bk=l,Fk=Ik,Hk=hu,Uk=Sk,Gk=Ck,Vk=bt,Wk=Rk,zk=[],jk=Mk(zk.sort),Xk=Mk(zk.push),Yk=Bk((function(){zk.sort(void 0)})),Kk=Bk((function(){zk.sort(null)})),Jk=Hk("sort"),qk=!Bk((function(){if(Vk)return Vk<70;if(!(Uk&&Uk>3)){if(Gk)return!0;if(Wk)return Wk<603;var t,e,i,o,n="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(o=0;o<47;o++)zk.push({k:e+o,v:i})}for(zk.sort((function(t,e){return e.v-t.v})),o=0;o<zk.length;o++)e=zk[o].k.charAt(0),n.charAt(n.length-1)!==e&&(n+=e);return"DGBEFHACIJK"!==n}}));Ak({target:"Array",proto:!0,forced:Yk||!Kk||!Jk||!qk},{sort:function(t){void 0!==t&&xk(t);var e=Lk(this);if(qk)return void 0===t?jk(e):jk(e,t);var i,o,n=[],s=Dk(e);for(o=0;o<s;o++)o in e&&Xk(n,e[o]);for(Fk(n,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:Pk(e)>Pk(i)?1:-1}}(t)),i=Dk(n),o=0;o<i;)e[o]=n[o++];for(;o<s;)Nk(e,o++);return e}});var Zk=Yc("Array","sort"),Qk=ct,tI=Zk,eI=Array.prototype,iI=n((function(t){var e=t.sort;return t===eI||Qk(eI,t)&&e===eI.sort?tI:e})),oI=Yc("Array","values"),nI=ao,sI=te,rI=ct,aI=oI,lI=Array.prototype,hI={DOMTokenList:!0,NodeList:!0},cI=n((function(t){var e=t.values;return t===lI||rI(lI,t)&&e===lI.values||sI(hI,nI(t))?aI:e})),uI=n(Ic),dI=Yc("Array","entries"),pI=ao,gI=te,fI=ct,mI=dI,vI=Array.prototype,bI={DOMTokenList:!0,NodeList:!0},_I=n((function(t){var e=t.entries;return t===vI||fI(vI,t)&&e===vI.entries||gI(bI,pI(t))?mI:e}));let yI;const TI=new Uint8Array(16);function EI(){if(!yI&&(yI="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!yI))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return yI(TI)}const wI=[];for(let t=0;t<256;++t)wI.push((t+256).toString(16).slice(1));var kI={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function II(t,e,i){if(kI.randomUUID&&!e&&!t)return kI.randomUUID();const o=(t=t||{}).random||(t.rng||EI)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){i=i||0;for(let t=0;t<16;++t)e[i+t]=o[t];return e}return function(t,e=0){return wI[t[e+0]]+wI[t[e+1]]+wI[t[e+2]]+wI[t[e+3]]+"-"+wI[t[e+4]]+wI[t[e+5]]+"-"+wI[t[e+6]]+wI[t[e+7]]+"-"+wI[t[e+8]]+wI[t[e+9]]+"-"+wI[t[e+10]]+wI[t[e+11]]+wI[t[e+12]]+wI[t[e+13]]+wI[t[e+14]]+wI[t[e+15]]}(o)}function $I(t){return"string"==typeof t||"number"==typeof t}var SI=function(){function t(i){e(this,t),xc(this,"_queue",[]),xc(this,"_timeout",null),xc(this,"_extended",null),this.delay=null,this.max=1/0,this.setOptions(i)}return Mc(t,[{key:"setOptions",value:function(t){t&&void 0!==t.delay&&(this.delay=t.delay),t&&void 0!==t.max&&(this.max=t.max),this._flushIfNeeded()}},{key:"destroy",value:function(){if(this.flush(),this._extended){for(var t=this._extended.object,e=this._extended.methods,i=0;i<e.length;i++){var o=e[i];o.original?t[o.name]=o.original:delete t[o.name]}this._extended=null}}},{key:"replace",value:function(t,e){var i=this,o=t[e];if(!o)throw new Error("Method "+e+" undefined");t[e]=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];i.queue({args:e,fn:o,context:this})}}},{key:"queue",value:function(t){"function"==typeof t?this._queue.push({fn:t}):this._queue.push(t),this._flushIfNeeded()}},{key:"_flushIfNeeded",value:function(){var t=this;this._queue.length>this.max&&this.flush(),null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.queue.length>0&&"number"==typeof this.delay&&(this._timeout=kf((function(){t.flush()}),this.delay))}},{key:"flush",value:function(){var t,e;tg(t=Ag(e=this._queue).call(e,0)).call(t,(function(t){t.fn.apply(t.context||t.fn,t.args||[])}))}}],[{key:"extend",value:function(e,i){var o=new t(i);if(void 0!==e.flush)throw new Error("Target object already has a property flush");e.flush=function(){o.flush()};var n=[{name:"flush",original:void 0}];if(i&&i.replace)for(var s=0;s<i.replace.length;s++){var r=i.replace[s];n.push({name:r,original:e[r]}),o.replace(e,r)}return o._extended={object:e,methods:n},o}}]),t}(),CI=function(){function t(){e(this,t),xc(this,"_subscribers",{"*":[],add:[],remove:[],update:[]}),xc(this,"subscribe",t.prototype.on),xc(this,"unsubscribe",t.prototype.off)}return Mc(t,[{key:"_trigger",value:function(t,e,i){var o,n;if("*"===t)throw new Error("Cannot trigger event *");tg(o=Ap(n=[]).call(n,Ip(this._subscribers[t]),Ip(this._subscribers["*"]))).call(o,(function(o){o(t,e,null!=i?i:null)}))}},{key:"on",value:function(t,e){"function"==typeof e&&this._subscribers[t].push(e)}},{key:"off",value:function(t,e){var i;this._subscribers[t]=Eu(i=this._subscribers[t]).call(i,(function(t){return t!==e}))}}]),t}();Gw("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),nk);var OI=n(nt.Set),RI=n(gd);function AI(t,e){var i=void 0!==$p&&Nd(t)||t["@@iterator"];if(!i){if(Hp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return MI(t,e);var o=Mp(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?xd(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?MI(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function MI(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}var xI=function(t){function i(t){e(this,i),this._pairs=t}return Mc(i,[{key:t,value:tw.mark((function t(){var e,i,o,n,s;return tw.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=AI(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return o=kp(i.value,2),n=o[0],s=o[1],t.next=7,[n,s];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"entries",value:tw.mark((function t(){var e,i,o,n,s;return tw.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=AI(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return o=kp(i.value,2),n=o[0],s=o[1],t.next=7,[n,s];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"keys",value:tw.mark((function t(){var e,i,o,n;return tw.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=AI(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return o=kp(i.value,1),n=o[0],t.next=7,n;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"values",value:tw.mark((function t(){var e,i,o,n;return tw.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=AI(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return o=kp(i.value,2),n=o[1],t.next=7,n;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"toIdArray",value:function(){var t;return Cu(t=Ip(this._pairs)).call(t,(function(t){return t[0]}))}},{key:"toItemArray",value:function(){var t;return Cu(t=Ip(this._pairs)).call(t,(function(t){return t[1]}))}},{key:"toEntryArray",value:function(){return Ip(this._pairs)}},{key:"toObjectMap",value:function(){var t,e=Qg(null),i=AI(this._pairs);try{for(i.s();!(t=i.n()).done;){var o=kp(t.value,2),n=o[0],s=o[1];e[n]=s}}catch(t){i.e(t)}finally{i.f()}return e}},{key:"toMap",value:function(){return new sk(this._pairs)}},{key:"toIdSet",value:function(){return new OI(this.toIdArray())}},{key:"toItemSet",value:function(){return new OI(this.toItemArray())}},{key:"cache",value:function(){return new i(Ip(this._pairs))}},{key:"distinct",value:function(t){var e,i=new OI,o=AI(this._pairs);try{for(o.s();!(e=o.n()).done;){var n=kp(e.value,2),s=n[0],r=n[1];i.add(t(r,s))}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"filter",value:function(t){var e=this._pairs;return new i({[uI]:()=>tw.mark((function i(){var o,n,s,r,a;return tw.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:o=AI(e),i.prev=1,o.s();case 3:if((n=o.n()).done){i.next=10;break}if(s=kp(n.value,2),r=s[0],a=s[1],!t(a,r)){i.next=8;break}return i.next=8,[r,a];case 8:i.next=3;break;case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(1),o.e(i.t0);case 15:return i.prev=15,o.f(),i.finish(15);case 18:case"end":return i.stop()}}),i,null,[[1,12,15,18]])}))()})}},{key:"forEach",value:function(t){var e,i=AI(this._pairs);try{for(i.s();!(e=i.n()).done;){var o=kp(e.value,2),n=o[0];t(o[1],n)}}catch(t){i.e(t)}finally{i.f()}}},{key:"map",value:function(t){var e=this._pairs;return new i({[uI]:()=>tw.mark((function i(){var o,n,s,r,a;return tw.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:o=AI(e),i.prev=1,o.s();case 3:if((n=o.n()).done){i.next=9;break}return s=kp(n.value,2),r=s[0],a=s[1],i.next=7,[r,t(a,r)];case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),o.e(i.t0);case 14:return i.prev=14,o.f(),i.finish(14);case 17:case"end":return i.stop()}}),i,null,[[1,11,14,17]])}))()})}},{key:"max",value:function(t){var e=RI(this._pairs),i=e.next();if(i.done)return null;for(var o=i.value[1],n=t(i.value[1],i.value[0]);!(i=e.next()).done;){var s=kp(i.value,2),r=s[0],a=s[1],l=t(a,r);l>n&&(n=l,o=a)}return o}},{key:"min",value:function(t){var e=RI(this._pairs),i=e.next();if(i.done)return null;for(var o=i.value[1],n=t(i.value[1],i.value[0]);!(i=e.next()).done;){var s=kp(i.value,2),r=s[0],a=s[1],l=t(a,r);l<n&&(n=l,o=a)}return o}},{key:"reduce",value:function(t,e){var i,o=AI(this._pairs);try{for(o.s();!(i=o.n()).done;){var n=kp(i.value,2),s=n[0];e=t(e,n[1],s)}}catch(t){o.e(t)}finally{o.f()}return e}},{key:"sort",value:function(t){var e=this;return new i({[uI]:function(){var i;return RI(iI(i=Ip(e._pairs)).call(i,(function(e,i){var o=kp(e,2),n=o[0],s=o[1],r=kp(i,2),a=r[0],l=r[1];return t(s,l,n,a)})))}})}}]),i}(uI);function LI(t,e){var i=Vp(t);if(Fv){var o=Fv(t);e&&(o=Eu(o).call(o,(function(e){return Yv(t,e).enumerable}))),i.push.apply(i,o)}return i}function DI(t){for(var e=1;e<arguments.length;e++){var i,o,n=null!=arguments[e]?arguments[e]:{};e%2?tg(i=LI(Object(n),!0)).call(i,(function(e){xc(t,e,n[e])})):Qv?rb(t,Qv(n)):tg(o=LI(Object(n))).call(o,(function(e){ab(t,e,Yv(n,e))}))}return t}function NI(t,e){var i=void 0!==$p&&Nd(t)||t["@@iterator"];if(!i){if(Hp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return PI(t,e);var o=Mp(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?xd(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?PI(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function PI(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function BI(t){var e=function(){if("undefined"==typeof Reflect||!Bv)return!1;if(Bv.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Bv(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=_b(t);if(e){var n=_b(this).constructor;i=Bv(o,arguments,n)}else i=o.apply(this,arguments);return mb(this,i)}}var FI=function(t){fb(o,t);var i=BI(o);function o(t,n){var s;return e(this,o),xc(lb(s=i.call(this)),"_queue",null),t&&!Hp(t)&&(n=t,t=[]),s._options=n||{},s._data=new sk,s.length=0,s._idProp=s._options.fieldId||"id",t&&t.length&&s.add(t),s.setOptions(n),s}return Mc(o,[{key:"idProp",get:function(){return this._idProp}},{key:"setOptions",value:function(t){t&&void 0!==t.queue&&(!1===t.queue?this._queue&&(this._queue.destroy(),this._queue=null):(this._queue||(this._queue=SI.extend(this,{replace:["add","update","remove"]})),t.queue&&"object"==typeof t.queue&&this._queue.setOptions(t.queue)))}},{key:"add",value:function(t,e){var i,o=this,n=[];if(Hp(t)){var s=Cu(t).call(t,(function(t){return t[o._idProp]}));if(uk(s).call(s,(function(t){return o._data.has(t)})))throw new Error("A duplicate id was found in the parameter array.");for(var r=0,a=t.length;r<a;r++)i=this._addItem(t[r]),n.push(i)}else{if(!t||"object"!=typeof t)throw new Error("Unknown dataType");i=this._addItem(t),n.push(i)}return n.length&&this._trigger("add",{items:n},e),n}},{key:"update",value:function(t,e){var i=this,o=[],n=[],s=[],r=[],a=this._idProp,l=function(t){var e=t[a];if(null!=e&&i._data.has(e)){var l=t,h=jg({},i._data.get(e)),c=i._updateItem(l);n.push(c),r.push(l),s.push(h)}else{var u=i._addItem(t);o.push(u)}};if(Hp(t))for(var h=0,c=t.length;h<c;h++)t[h]&&"object"==typeof t[h]?l(t[h]):console.warn("Ignoring input item, which is not an object at index "+h);else{if(!t||"object"!=typeof t)throw new Error("Unknown dataType");l(t)}if(o.length&&this._trigger("add",{items:o},e),n.length){var u={items:n,oldData:s,data:r};this._trigger("update",u,e)}return Ap(o).call(o,n)}},{key:"updateOnly",value:function(t,e){var i,o=this;Hp(t)||(t=[t]);var n=Cu(i=Cu(t).call(t,(function(t){var e=o._data.get(t[o._idProp]);if(null==e)throw new Error("Updating non-existent items is not allowed.");return{oldData:e,update:t}}))).call(i,(function(t){var e=t.oldData,i=t.update,n=e[o._idProp],s=function(t){for(var e,i=arguments.length,o=new Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return gv.apply(void 0,Ap(e=[{},t]).call(e,o))}(e,i);return o._data.set(n,s),{id:n,oldData:e,updatedData:s}}));if(n.length){var s={items:Cu(n).call(n,(function(t){return t.id})),oldData:Cu(n).call(n,(function(t){return t.oldData})),data:Cu(n).call(n,(function(t){return t.updatedData}))};return this._trigger("update",s,e),s.items}return[]}},{key:"get",value:function(t,e){var i=void 0,o=void 0,n=void 0;$I(t)?(i=t,n=e):Hp(t)?(o=t,n=e):n=t;var s,r=n&&"Object"===n.returnType?"Object":"Array",a=n&&Eu(n),l=[],h=void 0,c=void 0,u=void 0;if(null!=i)(h=this._data.get(i))&&a&&!a(h)&&(h=void 0);else if(null!=o)for(var d=0,p=o.length;d<p;d++)null==(h=this._data.get(o[d]))||a&&!a(h)||l.push(h);else for(var g,f=0,m=(c=Ip(_k(g=this._data).call(g))).length;f<m;f++)u=c[f],null==(h=this._data.get(u))||a&&!a(h)||l.push(h);if(n&&n.order&&null==i&&this._sort(l,n.order),n&&n.fields){var v=n.fields;if(null!=i&&null!=h)h=this._filterFields(h,v);else for(var b=0,_=l.length;b<_;b++)l[b]=this._filterFields(l[b],v)}if("Object"==r){for(var y={},T=0,E=l.length;T<E;T++){var w=l[T];y[w[this._idProp]]=w}return y}return null!=i?null!==(s=h)&&void 0!==s?s:null:l}},{key:"getIds",value:function(t){var e=this._data,i=t&&Eu(t),o=t&&t.order,n=Ip(_k(e).call(e)),s=[];if(i)if(o){for(var r=[],a=0,l=n.length;a<l;a++){var h=n[a],c=this._data.get(h);null!=c&&i(c)&&r.push(c)}this._sort(r,o);for(var u=0,d=r.length;u<d;u++)s.push(r[u][this._idProp])}else for(var p=0,g=n.length;p<g;p++){var f=n[p],m=this._data.get(f);null!=m&&i(m)&&s.push(m[this._idProp])}else if(o){for(var v=[],b=0,_=n.length;b<_;b++){var y=n[b];v.push(e.get(y))}this._sort(v,o);for(var T=0,E=v.length;T<E;T++)s.push(v[T][this._idProp])}else for(var w=0,k=n.length;w<k;w++){var I=n[w],$=e.get(I);null!=$&&s.push($[this._idProp])}return s}},{key:"getDataSet",value:function(){return this}},{key:"forEach",value:function(t,e){var i=e&&Eu(e),o=this._data,n=Ip(_k(o).call(o));if(e&&e.order)for(var s=this.get(e),r=0,a=s.length;r<a;r++){var l=s[r];t(l,l[this._idProp])}else for(var h=0,c=n.length;h<c;h++){var u=n[h],d=this._data.get(u);null==d||i&&!i(d)||t(d,u)}}},{key:"map",value:function(t,e){for(var i=e&&Eu(e),o=[],n=this._data,s=Ip(_k(n).call(n)),r=0,a=s.length;r<a;r++){var l=s[r],h=this._data.get(l);null==h||i&&!i(h)||o.push(t(h,l))}return e&&e.order&&this._sort(o,e.order),o}},{key:"_filterFields",value:function(t,e){var i;return t?mu(i=Hp(e)?e:Vp(e)).call(i,(function(e,i){return e[i]=t[i],e}),{}):t}},{key:"_sort",value:function(t,e){if("string"==typeof e){var i=e;iI(t).call(t,(function(t,e){var o=t[i],n=e[i];return o>n?1:o<n?-1:0}))}else{if("function"!=typeof e)throw new TypeError("Order must be a function or a string");iI(t).call(t,e)}}},{key:"remove",value:function(t,e){for(var i=[],o=[],n=Hp(t)?t:[t],s=0,r=n.length;s<r;s++){var a=this._remove(n[s]);if(a){var l=a[this._idProp];null!=l&&(i.push(l),o.push(a))}}return i.length&&this._trigger("remove",{items:i,oldData:o},e),i}},{key:"_remove",value:function(t){var e;if($I(t)?e=t:t&&"object"==typeof t&&(e=t[this._idProp]),null!=e&&this._data.has(e)){var i=this._data.get(e)||null;return this._data.delete(e),--this.length,i}return null}},{key:"clear",value:function(t){for(var e,i=Ip(_k(e=this._data).call(e)),o=[],n=0,s=i.length;n<s;n++)o.push(this._data.get(i[n]));return this._data.clear(),this.length=0,this._trigger("remove",{items:i,oldData:o},t),i}},{key:"max",value:function(t){var e,i,o=null,n=null,s=NI(cI(e=this._data).call(e));try{for(s.s();!(i=s.n()).done;){var r=i.value,a=r[t];"number"==typeof a&&(null==n||a>n)&&(o=r,n=a)}}catch(t){s.e(t)}finally{s.f()}return o||null}},{key:"min",value:function(t){var e,i,o=null,n=null,s=NI(cI(e=this._data).call(e));try{for(s.s();!(i=s.n()).done;){var r=i.value,a=r[t];"number"==typeof a&&(null==n||a<n)&&(o=r,n=a)}}catch(t){s.e(t)}finally{s.f()}return o||null}},{key:"distinct",value:function(t){for(var e=this._data,i=Ip(_k(e).call(e)),o=[],n=0,s=0,r=i.length;s<r;s++){for(var a=i[s],l=e.get(a)[t],h=!1,c=0;c<n;c++)if(o[c]==l){h=!0;break}h||void 0===l||(o[n]=l,n++)}return o}},{key:"_addItem",value:function(t){var e=function(t,e){return null==t[e]&&(t[e]=II()),t}(t,this._idProp),i=e[this._idProp];if(this._data.has(i))throw new Error("Cannot add item: item with id "+i+" already exists");return this._data.set(i,e),++this.length,i}},{key:"_updateItem",value:function(t){var e=t[this._idProp];if(null==e)throw new Error("Cannot update item: item has no id (item: "+nf(t)+")");var i=this._data.get(e);if(!i)throw new Error("Cannot update item: no item with id "+e+" found");return this._data.set(e,DI(DI({},i),t)),e}},{key:"stream",value:function(t){if(t){var e=this._data;return new xI({[uI]:()=>tw.mark((function i(){var o,n,s,r;return tw.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:o=NI(t),i.prev=1,o.s();case 3:if((n=o.n()).done){i.next=11;break}if(s=n.value,null==(r=e.get(s))){i.next=9;break}return i.next=9,[s,r];case 9:i.next=3;break;case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(1),o.e(i.t0);case 16:return i.prev=16,o.f(),i.finish(16);case 19:case"end":return i.stop()}}),i,null,[[1,13,16,19]])}))()})}var i;return new xI({[uI]:tu(i=_I(this._data)).call(i,this._data)})}}]),o}(CI);function HI(t,e){var i=void 0!==$p&&Nd(t)||t["@@iterator"];if(!i){if(Hp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return UI(t,e);var o=Mp(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?xd(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?UI(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function UI(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function GI(t){var e=function(){if("undefined"==typeof Reflect||!Bv)return!1;if(Bv.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Bv(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=_b(t);if(e){var n=_b(this).constructor;i=Bv(o,arguments,n)}else i=o.apply(this,arguments);return mb(this,i)}}var VI=function(t){fb(o,t);var i=GI(o);function o(t,n){var s,r;return e(this,o),xc(lb(r=i.call(this)),"length",0),xc(lb(r),"_ids",new OI),r._options=n||{},r._listener=tu(s=r._onEvent).call(s,lb(r)),r.setData(t),r}return Mc(o,[{key:"idProp",get:function(){return this.getDataSet().idProp}},{key:"setData",value:function(t){if(this._data){this._data.off&&this._data.off("*",this._listener);var e=this._data.getIds({filter:Eu(this._options)}),i=this._data.get(e);this._ids.clear(),this.length=0,this._trigger("remove",{items:e,oldData:i})}if(null!=t){this._data=t;for(var o=this._data.getIds({filter:Eu(this._options)}),n=0,s=o.length;n<s;n++){var r=o[n];this._ids.add(r)}this.length=o.length,this._trigger("add",{items:o})}else this._data=new FI;this._data.on&&this._data.on("*",this._listener)}},{key:"refresh",value:function(){for(var t=this._data.getIds({filter:Eu(this._options)}),e=Ip(this._ids),i={},o=[],n=[],s=[],r=0,a=t.length;r<a;r++){var l=t[r];i[l]=!0,this._ids.has(l)||(o.push(l),this._ids.add(l))}for(var h=0,c=e.length;h<c;h++){var u=e[h],d=this._data.get(u);null==d?console.error("If you see this, report it please."):i[u]||(n.push(u),s.push(d),this._ids.delete(u))}this.length+=o.length-n.length,o.length&&this._trigger("add",{items:o}),n.length&&this._trigger("remove",{items:n,oldData:s})}},{key:"get",value:function(t,e){if(null==this._data)return null;var i,o=null;$I(t)||Hp(t)?(o=t,i=e):i=t;var n=jg({},this._options,i),s=Eu(this._options),r=i&&Eu(i);return s&&r&&(n.filter=function(t){return s(t)&&r(t)}),null==o?this._data.get(n):this._data.get(o,n)}},{key:"getIds",value:function(t){if(this._data.length){var e,i=Eu(this._options),o=null!=t?Eu(t):null;return e=o?i?function(t){return i(t)&&o(t)}:o:i,this._data.getIds({filter:e,order:t&&t.order})}return[]}},{key:"forEach",value:function(t,e){if(this._data){var i,o,n=Eu(this._options),s=e&&Eu(e);o=s?n?function(t){return n(t)&&s(t)}:s:n,tg(i=this._data).call(i,t,{filter:o,order:e&&e.order})}}},{key:"map",value:function(t,e){if(this._data){var i,o,n=Eu(this._options),s=e&&Eu(e);return o=s?n?function(t){return n(t)&&s(t)}:s:n,Cu(i=this._data).call(i,t,{filter:o,order:e&&e.order})}return[]}},{key:"getDataSet",value:function(){return this._data.getDataSet()}},{key:"stream",value:function(t){var e;return this._data.stream(t||{[uI]:tu(e=_k(this._ids)).call(e,this._ids)})}},{key:"dispose",value:function(){var t;null!==(t=this._data)&&void 0!==t&&t.off&&this._data.off("*",this._listener);var e,i="This data view has already been disposed of.",n={get:function(){throw new Error(i)},set:function(){throw new Error(i)},configurable:!1},s=HI(Fp(o.prototype));try{for(s.s();!(e=s.n()).done;){var r=e.value;ab(this,r,n)}}catch(t){s.e(t)}finally{s.f()}}},{key:"_onEvent",value:function(t,e,i){if(e&&e.items&&this._data){var o=e.items,n=[],s=[],r=[],a=[],l=[],h=[];switch(t){case"add":for(var c=0,u=o.length;c<u;c++){var d=o[c];this.get(d)&&(this._ids.add(d),n.push(d))}break;case"update":for(var p=0,g=o.length;p<g;p++){var f=o[p];this.get(f)?this._ids.has(f)?(s.push(f),l.push(e.data[p]),a.push(e.oldData[p])):(this._ids.add(f),n.push(f)):this._ids.has(f)&&(this._ids.delete(f),r.push(f),h.push(e.oldData[p]))}break;case"remove":for(var m=0,v=o.length;m<v;m++){var b=o[m];this._ids.has(b)&&(this._ids.delete(b),r.push(b),h.push(e.oldData[m]))}}this.length+=n.length-r.length,n.length&&this._trigger("add",{items:n},i),s.length&&this._trigger("update",{items:s,oldData:a,data:l},i),r.length&&this._trigger("remove",{items:r,oldData:h},i)}}}]),o}(CI);function WI(t,e){return"object"==typeof e&&null!==e&&t===e.idProp&&"function"==typeof e.add&&"function"==typeof e.clear&&"function"==typeof e.distinct&&"function"==typeof tg(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof Cu(e)&&"function"==typeof e.max&&"function"==typeof e.min&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.remove&&"function"==typeof e.setOptions&&"function"==typeof e.stream&&"function"==typeof e.update&&"function"==typeof e.updateOnly}t.DELETE=pv,t.DataSet=FI,t.DataStream=xI,t.DataView=VI,t.Queue=SI,t.createNewDataPipeFrom=function(t){return new zu(t)},t.isDataSetLike=WI,t.isDataViewLike=function(t,e){return"object"==typeof e&&null!==e&&t===e.idProp&&"function"==typeof tg(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof Cu(e)&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.stream&&WI(t,e.getDataSet())}}(e)},993:function(t,e,i){!function(t,e){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var s=function(t){return t&&t.Math===Math&&t},r=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof o&&o)||function(){return this}()||o||Function("return this")(),a=function(t){try{return!!t()}catch(t){return!0}},l=!a((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),h=l,c=Function.prototype,u=c.apply,d=c.call,p="object"==typeof Reflect&&Reflect.apply||(h?d.bind(u):function(){return d.apply(u,arguments)}),g=l,f=Function.prototype,m=f.call,v=g&&f.bind.bind(m,m),b=g?v:function(t){return function(){return m.apply(t,arguments)}},_=b,y=_({}.toString),T=_("".slice),E=function(t){return T(y(t),8,-1)},w=E,k=b,I=function(t){if("Function"===w(t))return k(t)},$="object"==typeof document&&document.all,S={all:$,IS_HTMLDDA:void 0===$&&void 0!==$},C=S.all,O=S.IS_HTMLDDA?function(t){return"function"==typeof t||t===C}:function(t){return"function"==typeof t},R={},A=!a((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),M=l,x=Function.prototype.call,L=M?x.bind(x):function(){return x.apply(x,arguments)},D={},N={}.propertyIsEnumerable,P=Object.getOwnPropertyDescriptor,B=P&&!N.call({1:2},1);D.f=B?function(t){var e=P(this,t);return!!e&&e.enumerable}:N;var F,H,U=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},G=a,V=E,W=Object,z=b("".split),j=G((function(){return!W("z").propertyIsEnumerable(0)}))?function(t){return"String"===V(t)?z(t,""):W(t)}:W,X=function(t){return null==t},Y=X,K=TypeError,J=function(t){if(Y(t))throw new K("Can't call method on "+t);return t},q=j,Z=J,Q=function(t){return q(Z(t))},tt=O,et=S.all,it=S.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:tt(t)||t===et}:function(t){return"object"==typeof t?null!==t:tt(t)},ot={},nt=ot,st=r,rt=O,at=function(t){return rt(t)?t:void 0},lt=function(t,e){return arguments.length<2?at(nt[t])||at(st[t]):nt[t]&&nt[t][e]||st[t]&&st[t][e]},ht=b({}.isPrototypeOf),ct="undefined"!=typeof navigator&&String(navigator.userAgent)||"",ut=r,dt=ct,pt=ut.process,gt=ut.Deno,ft=pt&&pt.versions||gt&&gt.version,mt=ft&&ft.v8;mt&&(H=(F=mt.split("."))[0]>0&&F[0]<4?1:+(F[0]+F[1])),!H&&dt&&(!(F=dt.match(/Edge\/(\d+)/))||F[1]>=74)&&(F=dt.match(/Chrome\/(\d+)/))&&(H=+F[1]);var vt=H,bt=vt,_t=a,yt=r.String,Tt=!!Object.getOwnPropertySymbols&&!_t((function(){var t=Symbol("symbol detection");return!yt(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&bt&&bt<41})),Et=Tt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,wt=lt,kt=O,It=ht,$t=Object,St=Et?function(t){return"symbol"==typeof t}:function(t){var e=wt("Symbol");return kt(e)&&It(e.prototype,$t(t))},Ct=String,Ot=function(t){try{return Ct(t)}catch(t){return"Object"}},Rt=O,At=Ot,Mt=TypeError,xt=function(t){if(Rt(t))return t;throw new Mt(At(t)+" is not a function")},Lt=xt,Dt=X,Nt=function(t,e){var i=t[e];return Dt(i)?void 0:Lt(i)},Pt=L,Bt=O,Ft=it,Ht=TypeError,Ut={exports:{}},Gt=r,Vt=Object.defineProperty,Wt="__core-js_shared__",zt=r[Wt]||function(t,e){try{Vt(Gt,t,{value:e,configurable:!0,writable:!0})}catch(i){Gt[t]=e}return e}(Wt,{}),jt=zt;(Ut.exports=function(t,e){return jt[t]||(jt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.0",mode:"pure",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Xt=Ut.exports,Yt=J,Kt=Object,Jt=function(t){return Kt(Yt(t))},qt=Jt,Zt=b({}.hasOwnProperty),Qt=Object.hasOwn||function(t,e){return Zt(qt(t),e)},te=b,ee=0,ie=Math.random(),oe=te(1..toString),ne=function(t){return"Symbol("+(void 0===t?"":t)+")_"+oe(++ee+ie,36)},se=Xt,re=Qt,ae=ne,le=Tt,he=Et,ce=r.Symbol,ue=se("wks"),de=he?ce.for||ce:ce&&ce.withoutSetter||ae,pe=function(t){return re(ue,t)||(ue[t]=le&&re(ce,t)?ce[t]:de("Symbol."+t)),ue[t]},ge=L,fe=it,me=St,ve=Nt,be=TypeError,_e=pe("toPrimitive"),ye=function(t,e){if(!fe(t)||me(t))return t;var i,o=ve(t,_e);if(o){if(void 0===e&&(e="default"),i=ge(o,t,e),!fe(i)||me(i))return i;throw new be("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var i,o;if("string"===e&&Bt(i=t.toString)&&!Ft(o=Pt(i,t)))return o;if(Bt(i=t.valueOf)&&!Ft(o=Pt(i,t)))return o;if("string"!==e&&Bt(i=t.toString)&&!Ft(o=Pt(i,t)))return o;throw new Ht("Can't convert object to primitive value")}(t,e)},Te=St,Ee=function(t){var e=ye(t,"string");return Te(e)?e:e+""},we=it,ke=r.document,Ie=we(ke)&&we(ke.createElement),$e=function(t){return Ie?ke.createElement(t):{}},Se=$e,Ce=!A&&!a((function(){return 7!==Object.defineProperty(Se("div"),"a",{get:function(){return 7}}).a})),Oe=A,Re=L,Ae=D,Me=U,xe=Q,Le=Ee,De=Qt,Ne=Ce,Pe=Object.getOwnPropertyDescriptor;R.f=Oe?Pe:function(t,e){if(t=xe(t),e=Le(e),Ne)try{return Pe(t,e)}catch(t){}if(De(t,e))return Me(!Re(Ae.f,t,e),t[e])};var Be=a,Fe=O,He=/#|\.prototype\./,Ue=function(t,e){var i=Ve[Ge(t)];return i===ze||i!==We&&(Fe(e)?Be(e):!!e)},Ge=Ue.normalize=function(t){return String(t).replace(He,".").toLowerCase()},Ve=Ue.data={},We=Ue.NATIVE="N",ze=Ue.POLYFILL="P",je=Ue,Xe=xt,Ye=l,Ke=I(I.bind),Je=function(t,e){return Xe(t),void 0===e?t:Ye?Ke(t,e):function(){return t.apply(e,arguments)}},qe={},Ze=A&&a((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Qe=it,ti=String,ei=TypeError,ii=function(t){if(Qe(t))return t;throw new ei(ti(t)+" is not an object")},oi=A,ni=Ce,si=Ze,ri=ii,ai=Ee,li=TypeError,hi=Object.defineProperty,ci=Object.getOwnPropertyDescriptor,ui="enumerable",di="configurable",pi="writable";qe.f=oi?si?function(t,e,i){if(ri(t),e=ai(e),ri(i),"function"==typeof t&&"prototype"===e&&"value"in i&&pi in i&&!i[pi]){var o=ci(t,e);o&&o[pi]&&(t[e]=i.value,i={configurable:di in i?i[di]:o[di],enumerable:ui in i?i[ui]:o[ui],writable:!1})}return hi(t,e,i)}:hi:function(t,e,i){if(ri(t),e=ai(e),ri(i),ni)try{return hi(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new li("Accessors not supported");return"value"in i&&(t[e]=i.value),t};var gi=qe,fi=U,mi=A?function(t,e,i){return gi.f(t,e,fi(1,i))}:function(t,e,i){return t[e]=i,t},vi=r,bi=p,_i=I,yi=O,Ti=R.f,Ei=je,wi=ot,ki=Je,Ii=mi,$i=Qt,Si=function(t){var e=function(i,o,n){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(i);case 2:return new t(i,o)}return new t(i,o,n)}return bi(t,this,arguments)};return e.prototype=t.prototype,e},Ci=function(t,e){var i,o,n,s,r,a,l,h,c,u=t.target,d=t.global,p=t.stat,g=t.proto,f=d?vi:p?vi[u]:(vi[u]||{}).prototype,m=d?wi:wi[u]||Ii(wi,u,{})[u],v=m.prototype;for(s in e)o=!(i=Ei(d?s:u+(p?".":"#")+s,t.forced))&&f&&$i(f,s),a=m[s],o&&(l=t.dontCallGetSet?(c=Ti(f,s))&&c.value:f[s]),r=o&&l?l:e[s],o&&typeof a==typeof r||(h=t.bind&&o?ki(r,vi):t.wrap&&o?Si(r):g&&yi(r)?_i(r):r,(t.sham||r&&r.sham||a&&a.sham)&&Ii(h,"sham",!0),Ii(m,s,h),g&&($i(wi,n=u+"Prototype")||Ii(wi,n,{}),Ii(wi[n],s,r),t.real&&v&&(i||!v[s])&&Ii(v,s,r)))},Oi=Math.ceil,Ri=Math.floor,Ai=Math.trunc||function(t){var e=+t;return(e>0?Ri:Oi)(e)},Mi=function(t){var e=+t;return e!=e||0===e?0:Ai(e)},xi=Mi,Li=Math.max,Di=Math.min,Ni=function(t,e){var i=xi(t);return i<0?Li(i+e,0):Di(i,e)},Pi=Mi,Bi=Math.min,Fi=function(t){return function(t){return t>0?Bi(Pi(t),9007199254740991):0}(t.length)},Hi=Q,Ui=Ni,Gi=Fi,Vi=function(t){return function(e,i,o){var n,s=Hi(e),r=Gi(s),a=Ui(o,r);if(t&&i!=i){for(;r>a;)if((n=s[a++])!=n)return!0}else for(;r>a;a++)if((t||a in s)&&s[a]===i)return t||a||0;return!t&&-1}},Wi={includes:Vi(!0),indexOf:Vi(!1)},zi={},ji=Qt,Xi=Q,Yi=Wi.indexOf,Ki=zi,Ji=b([].push),qi=function(t,e){var i,o=Xi(t),n=0,s=[];for(i in o)!ji(Ki,i)&&ji(o,i)&&Ji(s,i);for(;e.length>n;)ji(o,i=e[n++])&&(~Yi(s,i)||Ji(s,i));return s},Zi=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Qi=qi,to=Zi,eo=Object.keys||function(t){return Qi(t,to)},io={};io.f=Object.getOwnPropertySymbols;var oo=A,no=b,so=L,ro=a,ao=eo,lo=io,ho=D,co=Jt,uo=j,po=Object.assign,go=Object.defineProperty,fo=no([].concat),mo=!po||ro((function(){if(oo&&1!==po({b:1},po(go({},"a",{enumerable:!0,get:function(){go(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol("assign detection"),o="abcdefghijklmnopqrst";return t[i]=7,o.split("").forEach((function(t){e[t]=t})),7!==po({},t)[i]||ao(po({},e)).join("")!==o}))?function(t,e){for(var i=co(t),o=arguments.length,n=1,s=lo.f,r=ho.f;o>n;)for(var a,l=uo(arguments[n++]),h=s?fo(ao(l),s(l)):ao(l),c=h.length,u=0;c>u;)a=h[u++],oo&&!so(r,l,a)||(i[a]=l[a]);return i}:po,vo=mo;Ci({target:"Object",stat:!0,arity:2,forced:Object.assign!==vo},{assign:vo});var bo=n(ot.Object.assign),_o=b([].slice),yo=b,To=xt,Eo=it,wo=Qt,ko=_o,Io=l,$o=Function,So=yo([].concat),Co=yo([].join),Oo={},Ro=Io?$o.bind:function(t){var e=To(this),i=e.prototype,o=ko(arguments,1),n=function(){var i=So(o,ko(arguments));return this instanceof n?function(t,e,i){if(!wo(Oo,e)){for(var o=[],n=0;n<e;n++)o[n]="a["+n+"]";Oo[e]=$o("C,a","return new C("+Co(o,",")+")")}return Oo[e](t,i)}(e,i.length,i):e.apply(t,i)};return Eo(i)&&(n.prototype=i),n},Ao=Ro;Ci({target:"Function",proto:!0,forced:Function.bind!==Ao},{bind:Ao});var Mo=ot,xo=function(t){return Mo[t+"Prototype"]},Lo=xo("Function").bind,Do=ht,No=Lo,Po=Function.prototype,Bo=function(t){var e=t.bind;return t===Po||Do(Po,t)&&e===Po.bind?No:e},Fo=n(Bo);function Ho(t,e,i,o){t.beginPath(),t.arc(e,i,o,0,2*Math.PI,!1),t.closePath()}function Uo(t,e,i,o,n,s){var r=Math.PI/180;o-2*s<0&&(s=o/2),n-2*s<0&&(s=n/2),t.beginPath(),t.moveTo(e+s,i),t.lineTo(e+o-s,i),t.arc(e+o-s,i+s,s,270*r,360*r,!1),t.lineTo(e+o,i+n-s),t.arc(e+o-s,i+n-s,s,0,90*r,!1),t.lineTo(e+s,i+n),t.arc(e+s,i+n-s,s,90*r,180*r,!1),t.lineTo(e,i+s),t.arc(e+s,i+s,s,180*r,270*r,!1),t.closePath()}function Go(t,e,i,o,n){var s=.5522848,r=o/2*s,a=n/2*s,l=e+o,h=i+n,c=e+o/2,u=i+n/2;t.beginPath(),t.moveTo(e,u),t.bezierCurveTo(e,u-a,c-r,i,c,i),t.bezierCurveTo(c+r,i,l,u-a,l,u),t.bezierCurveTo(l,u+a,c+r,h,c,h),t.bezierCurveTo(c-r,h,e,u+a,e,u),t.closePath()}function Vo(t,e,i,o,n){var s=n*(1/3),r=.5522848,a=o/2*r,l=s/2*r,h=e+o,c=i+s,u=e+o/2,d=i+s/2,p=i+(n-s/2),g=i+n;t.beginPath(),t.moveTo(h,d),t.bezierCurveTo(h,d+l,u+a,c,u,c),t.bezierCurveTo(u-a,c,e,d+l,e,d),t.bezierCurveTo(e,d-l,u-a,i,u,i),t.bezierCurveTo(u+a,i,h,d-l,h,d),t.lineTo(h,p),t.bezierCurveTo(h,p+l,u+a,g,u,g),t.bezierCurveTo(u-a,g,e,p+l,e,p),t.lineTo(e,d)}function Wo(t,e,i,o,n,s){t.beginPath(),t.moveTo(e,i);for(var r=s.length,a=o-e,l=n-i,h=l/a,c=Math.sqrt(a*a+l*l),u=0,d=!0,p=0,g=+s[0];c>=.1;)(g=+s[u++%r])>c&&(g=c),p=Math.sqrt(g*g/(1+h*h)),e+=p=a<0?-p:p,i+=h*p,!0===d?t.lineTo(e,i):t.moveTo(e,i),c-=g,d=!d}var zo={circle:Ho,dashedLine:Wo,database:Vo,diamond:function(t,e,i,o){t.beginPath(),t.lineTo(e,i+o),t.lineTo(e+o,i),t.lineTo(e,i-o),t.lineTo(e-o,i),t.closePath()},ellipse:Go,ellipse_vis:Go,hexagon:function(t,e,i,o){t.beginPath();var n=2*Math.PI/6;t.moveTo(e+o,i);for(var s=1;s<6;s++)t.lineTo(e+o*Math.cos(n*s),i+o*Math.sin(n*s));t.closePath()},roundRect:Uo,square:function(t,e,i,o){t.beginPath(),t.rect(e-o,i-o,2*o,2*o),t.closePath()},star:function(t,e,i,o){t.beginPath(),i+=.1*(o*=.82);for(var n=0;n<10;n++){var s=n%2==0?1.3*o:.5*o;t.lineTo(e+s*Math.sin(2*n*Math.PI/10),i-s*Math.cos(2*n*Math.PI/10))}t.closePath()},triangle:function(t,e,i,o){t.beginPath(),i+=.275*(o*=1.15);var n=2*o,s=n/2,r=Math.sqrt(3)/6*n,a=Math.sqrt(n*n-s*s);t.moveTo(e,i-(a-r)),t.lineTo(e+s,i+r),t.lineTo(e-s,i+r),t.lineTo(e,i-(a-r)),t.closePath()},triangleDown:function(t,e,i,o){t.beginPath(),i-=.275*(o*=1.15);var n=2*o,s=n/2,r=Math.sqrt(3)/6*n,a=Math.sqrt(n*n-s*s);t.moveTo(e,i+(a-r)),t.lineTo(e+s,i-r),t.lineTo(e-s,i-r),t.lineTo(e,i+(a-r)),t.closePath()}},jo={exports:{}};!function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,o=this._callbacks["$"+t];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n=0;n<o.length;n++)if((i=o[n])===e||i.fn===e){o.splice(n,1);break}return 0===o.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],o=1;o<arguments.length;o++)e[o-1]=arguments[o];if(i){o=0;for(var n=(i=i.slice(0)).length;o<n;++o)i[o].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}}(jo);var Xo=n(jo.exports),Yo={};Yo[pe("toStringTag")]="z";var Ko,Jo,qo,Zo="[object z]"===String(Yo),Qo=Zo,tn=O,en=E,on=pe("toStringTag"),nn=Object,sn="Arguments"===en(function(){return arguments}()),rn=Qo?en:function(t){var e,i,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=nn(t),on))?i:sn?en(e):"Object"===(o=en(e))&&tn(e.callee)?"Arguments":o},an=rn,ln=String,hn=function(t){if("Symbol"===an(t))throw new TypeError("Cannot convert a Symbol value to a string");return ln(t)},cn=b,un=Mi,dn=hn,pn=J,gn=cn("".charAt),fn=cn("".charCodeAt),mn=cn("".slice),vn=function(t){return function(e,i){var o,n,s=dn(pn(e)),r=un(i),a=s.length;return r<0||r>=a?t?"":void 0:(o=fn(s,r))<55296||o>56319||r+1===a||(n=fn(s,r+1))<56320||n>57343?t?gn(s,r):o:t?mn(s,r,r+2):n-56320+(o-55296<<10)+65536}},bn={codeAt:vn(!1),charAt:vn(!0)},_n=O,yn=r.WeakMap,Tn=_n(yn)&&/native code/.test(String(yn)),En=ne,wn=Xt("keys"),kn=function(t){return wn[t]||(wn[t]=En(t))},In=Tn,$n=r,Sn=it,Cn=mi,On=Qt,Rn=zt,An=kn,Mn=zi,xn="Object already initialized",Ln=$n.TypeError,Dn=$n.WeakMap;if(In||Rn.state){var Nn=Rn.state||(Rn.state=new Dn);Nn.get=Nn.get,Nn.has=Nn.has,Nn.set=Nn.set,Ko=function(t,e){if(Nn.has(t))throw new Ln(xn);return e.facade=t,Nn.set(t,e),e},Jo=function(t){return Nn.get(t)||{}},qo=function(t){return Nn.has(t)}}else{var Pn=An("state");Mn[Pn]=!0,Ko=function(t,e){if(On(t,Pn))throw new Ln(xn);return e.facade=t,Cn(t,Pn,e),e},Jo=function(t){return On(t,Pn)?t[Pn]:{}},qo=function(t){return On(t,Pn)}}var Bn={set:Ko,get:Jo,has:qo,enforce:function(t){return qo(t)?Jo(t):Ko(t,{})},getterFor:function(t){return function(e){var i;if(!Sn(e)||(i=Jo(e)).type!==t)throw new Ln("Incompatible receiver, "+t+" required");return i}}},Fn=A,Hn=Qt,Un=Function.prototype,Gn=Fn&&Object.getOwnPropertyDescriptor,Vn=Hn(Un,"name"),Wn={EXISTS:Vn,PROPER:Vn&&"something"===function(){}.name,CONFIGURABLE:Vn&&(!Fn||Fn&&Gn(Un,"name").configurable)},zn={},jn=A,Xn=Ze,Yn=qe,Kn=ii,Jn=Q,qn=eo;zn.f=jn&&!Xn?Object.defineProperties:function(t,e){Kn(t);for(var i,o=Jn(e),n=qn(e),s=n.length,r=0;s>r;)Yn.f(t,i=n[r++],o[i]);return t};var Zn,Qn=lt("document","documentElement"),ts=ii,es=zn,is=Zi,os=zi,ns=Qn,ss=$e,rs="prototype",as="script",ls=kn("IE_PROTO"),hs=function(){},cs=function(t){return"<"+as+">"+t+"</"+as+">"},us=function(t){t.write(cs("")),t.close();var e=t.parentWindow.Object;return t=null,e},ds=function(){try{Zn=new ActiveXObject("htmlfile")}catch(t){}var t,e,i;ds="undefined"!=typeof document?document.domain&&Zn?us(Zn):(e=ss("iframe"),i="java"+as+":",e.style.display="none",ns.appendChild(e),e.src=String(i),(t=e.contentWindow.document).open(),t.write(cs("document.F=Object")),t.close(),t.F):us(Zn);for(var o=is.length;o--;)delete ds[rs][is[o]];return ds()};os[ls]=!0;var ps,gs,fs,ms=Object.create||function(t,e){var i;return null!==t?(hs[rs]=ts(t),i=new hs,hs[rs]=null,i[ls]=t):i=ds(),void 0===e?i:es.f(i,e)},vs=!a((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),bs=Qt,_s=O,ys=Jt,Ts=vs,Es=kn("IE_PROTO"),ws=Object,ks=ws.prototype,Is=Ts?ws.getPrototypeOf:function(t){var e=ys(t);if(bs(e,Es))return e[Es];var i=e.constructor;return _s(i)&&e instanceof i?i.prototype:e instanceof ws?ks:null},$s=mi,Ss=function(t,e,i,o){return o&&o.enumerable?t[e]=i:$s(t,e,i),t},Cs=a,Os=O,Rs=it,As=ms,Ms=Is,xs=Ss,Ls=pe("iterator"),Ds=!1;[].keys&&("next"in(fs=[].keys())?(gs=Ms(Ms(fs)))!==Object.prototype&&(ps=gs):Ds=!0);var Ns=!Rs(ps)||Cs((function(){var t={};return ps[Ls].call(t)!==t}));Os((ps=Ns?{}:As(ps))[Ls])||xs(ps,Ls,(function(){return this}));var Ps={IteratorPrototype:ps,BUGGY_SAFARI_ITERATORS:Ds},Bs=rn,Fs=Zo?{}.toString:function(){return"[object "+Bs(this)+"]"},Hs=Zo,Us=qe.f,Gs=mi,Vs=Qt,Ws=Fs,zs=pe("toStringTag"),js=function(t,e,i,o){if(t){var n=i?t:t.prototype;Vs(n,zs)||Us(n,zs,{configurable:!0,value:e}),o&&!Hs&&Gs(n,"toString",Ws)}},Xs={},Ys=Ps.IteratorPrototype,Ks=ms,Js=U,qs=js,Zs=Xs,Qs=function(){return this},tr=b,er=xt,ir=O,or=String,nr=TypeError,sr=ii,rr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=function(t,e,i){try{return tr(er(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}}(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,o){return sr(i),function(t){if("object"==typeof t||ir(t))return t;throw new nr("Can't set "+or(t)+" as a prototype")}(o),e?t(i,o):i.__proto__=o,i}}():void 0),ar=Ci,lr=L,hr=Is,cr=js,ur=Ss,dr=Xs,pr=Wn.PROPER,gr=Ps.BUGGY_SAFARI_ITERATORS,fr=pe("iterator"),mr="keys",vr="values",br="entries",_r=function(){return this},yr=function(t,e,i,o,n,s,r){!function(t,e,i,o){var n=e+" Iterator";t.prototype=Ks(Ys,{next:Js(+!o,i)}),qs(t,n,!1,!0),Zs[n]=Qs}(i,e,o);var a,l,h,c=function(t){if(t===n&&f)return f;if(!gr&&t&&t in p)return p[t];switch(t){case mr:case vr:case br:return function(){return new i(this,t)}}return function(){return new i(this)}},u=e+" Iterator",d=!1,p=t.prototype,g=p[fr]||p["@@iterator"]||n&&p[n],f=!gr&&g||c(n),m="Array"===e&&p.entries||g;if(m&&(a=hr(m.call(new t)))!==Object.prototype&&a.next&&(cr(a,u,!0,!0),dr[u]=_r),pr&&n===vr&&g&&g.name!==vr&&(d=!0,f=function(){return lr(g,this)}),n)if(l={values:c(vr),keys:s?f:c(mr),entries:c(br)},r)for(h in l)(gr||d||!(h in p))&&ur(p,h,l[h]);else ar({target:e,proto:!0,forced:gr||d},l);return r&&p[fr]!==f&&ur(p,fr,f,{name:n}),dr[e]=f,l},Tr=function(t,e){return{value:t,done:e}},Er=bn.charAt,wr=hn,kr=Bn,Ir=yr,$r=Tr,Sr="String Iterator",Cr=kr.set,Or=kr.getterFor(Sr);Ir(String,"String",(function(t){Cr(this,{type:Sr,string:wr(t),index:0})}),(function(){var t,e=Or(this),i=e.string,o=e.index;return o>=i.length?$r(void 0,!0):(t=Er(i,o),e.index+=t.length,$r(t,!1))}));var Rr=L,Ar=ii,Mr=Nt,xr=function(t,e,i){var o,n;Ar(t);try{if(!(o=Mr(t,"return"))){if("throw"===e)throw i;return i}o=Rr(o,t)}catch(t){n=!0,o=t}if("throw"===e)throw i;if(n)throw o;return Ar(o),i},Lr=ii,Dr=xr,Nr=Xs,Pr=pe("iterator"),Br=Array.prototype,Fr=function(t){return void 0!==t&&(Nr.Array===t||Br[Pr]===t)},Hr=O,Ur=zt,Gr=b(Function.toString);Hr(Ur.inspectSource)||(Ur.inspectSource=function(t){return Gr(t)});var Vr=Ur.inspectSource,Wr=b,zr=a,jr=O,Xr=rn,Yr=Vr,Kr=function(){},Jr=[],qr=lt("Reflect","construct"),Zr=/^\s*(?:class|function)\b/,Qr=Wr(Zr.exec),ta=!Zr.test(Kr),ea=function(t){if(!jr(t))return!1;try{return qr(Kr,Jr,t),!0}catch(t){return!1}},ia=function(t){if(!jr(t))return!1;switch(Xr(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ta||!!Qr(Zr,Yr(t))}catch(t){return!0}};ia.sham=!0;var oa=!qr||zr((function(){var t;return ea(ea.call)||!ea(Object)||!ea((function(){t=!0}))||t}))?ia:ea,na=Ee,sa=qe,ra=U,aa=function(t,e,i){var o=na(e);o in t?sa.f(t,o,ra(0,i)):t[o]=i},la=rn,ha=Nt,ca=X,ua=Xs,da=pe("iterator"),pa=function(t){if(!ca(t))return ha(t,da)||ha(t,"@@iterator")||ua[la(t)]},ga=L,fa=xt,ma=ii,va=Ot,ba=pa,_a=TypeError,ya=function(t,e){var i=arguments.length<2?ba(t):e;if(fa(i))return ma(ga(i,t));throw new _a(va(t)+" is not iterable")},Ta=Je,Ea=L,wa=Jt,ka=function(t,e,i,o){try{return o?e(Lr(i)[0],i[1]):e(i)}catch(e){Dr(t,"throw",e)}},Ia=Fr,$a=oa,Sa=Fi,Ca=aa,Oa=ya,Ra=pa,Aa=Array,Ma=pe("iterator"),xa=!1;try{var La=0,Da={next:function(){return{done:!!La++}},return:function(){xa=!0}};Da[Ma]=function(){return this},Array.from(Da,(function(){throw 2}))}catch(t){}Ci({target:"Array",stat:!0,forced:!function(t,e){try{if(!e&&!xa)return!1}catch(t){return!1}var i=!1;try{var o={};o[Ma]=function(){return{next:function(){return{done:i=!0}}}},t(o)}catch(t){}return i}((function(t){Array.from(t)}))},{from:function(t){var e=wa(t),i=$a(this),o=arguments.length,n=o>1?arguments[1]:void 0,s=void 0!==n;s&&(n=Ta(n,o>2?arguments[2]:void 0));var r,a,l,h,c,u,d=Ra(e),p=0;if(!d||this===Aa&&Ia(d))for(r=Sa(e),a=i?new this(r):Aa(r);r>p;p++)u=s?n(e[p],p):e[p],Ca(a,p,u);else for(c=(h=Oa(e,d)).next,a=i?new this:[];!(l=Ea(c,h)).done;p++)u=s?ka(h,n,[l.value,p],!0):l.value,Ca(a,p,u);return a.length=p,a}});var Na=ot.Array.from,Pa=n(Na),Ba=Q,Fa=Xs,Ha=Bn;qe.f;var Ua=yr,Ga=Tr,Va="Array Iterator",Wa=Ha.set,za=Ha.getterFor(Va);Ua(Array,"Array",(function(t,e){Wa(this,{type:Va,target:Ba(t),index:0,kind:e})}),(function(){var t=za(this),e=t.target,i=t.kind,o=t.index++;if(!e||o>=e.length)return t.target=void 0,Ga(void 0,!0);switch(i){case"keys":return Ga(o,!1);case"values":return Ga(e[o],!1)}return Ga([o,e[o]],!1)}),"values"),Fa.Arguments=Fa.Array;var ja=pa,Xa=r,Ya=rn,Ka=mi,Ja=Xs,qa=pe("toStringTag");for(var Za in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Qa=Xa[Za],tl=Qa&&Qa.prototype;tl&&Ya(tl)!==qa&&Ka(tl,qa,Za),Ja[Za]=Ja.Array}var el=ja,il=n(el),ol=n(el);function nl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var sl={exports:{}},rl=Ci,al=A,ll=qe.f;rl({target:"Object",stat:!0,forced:Object.defineProperty!==ll,sham:!al},{defineProperty:ll});var hl=ot.Object,cl=sl.exports=function(t,e,i){return hl.defineProperty(t,e,i)};hl.defineProperty.sham&&(cl.sham=!0);var ul=sl.exports,dl=n(ul),pl=E,gl=Array.isArray||function(t){return"Array"===pl(t)},fl=TypeError,ml=function(t){if(t>9007199254740991)throw fl("Maximum allowed index exceeded");return t},vl=gl,bl=oa,_l=it,yl=pe("species"),Tl=Array,El=function(t,e){return new(function(t){var e;return vl(t)&&(e=t.constructor,(bl(e)&&(e===Tl||vl(e.prototype))||_l(e)&&null===(e=e[yl]))&&(e=void 0)),void 0===e?Tl:e}(t))(0===e?0:e)},wl=a,kl=vt,Il=pe("species"),$l=function(t){return kl>=51||!wl((function(){var e=[];return(e.constructor={})[Il]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Sl=Ci,Cl=a,Ol=gl,Rl=it,Al=Jt,Ml=Fi,xl=ml,Ll=aa,Dl=El,Nl=$l,Pl=vt,Bl=pe("isConcatSpreadable"),Fl=Pl>=51||!Cl((function(){var t=[];return t[Bl]=!1,t.concat()[0]!==t})),Hl=function(t){if(!Rl(t))return!1;var e=t[Bl];return void 0!==e?!!e:Ol(t)};Sl({target:"Array",proto:!0,arity:1,forced:!Fl||!Nl("concat")},{concat:function(t){var e,i,o,n,s,r=Al(this),a=Dl(r,0),l=0;for(e=-1,o=arguments.length;e<o;e++)if(Hl(s=-1===e?r:arguments[e]))for(n=Ml(s),xl(l+n),i=0;i<n;i++,l++)i in s&&Ll(a,l,s[i]);else xl(l+1),Ll(a,l++,s);return a.length=l,a}});var Ul={},Gl=qi,Vl=Zi.concat("length","prototype");Ul.f=Object.getOwnPropertyNames||function(t){return Gl(t,Vl)};var Wl={},zl=Ni,jl=Fi,Xl=aa,Yl=Array,Kl=Math.max,Jl=function(t,e,i){for(var o=jl(t),n=zl(e,o),s=zl(void 0===i?o:i,o),r=Yl(Kl(s-n,0)),a=0;n<s;n++,a++)Xl(r,a,t[n]);return r.length=a,r},ql=E,Zl=Q,Ql=Ul.f,th=Jl,eh="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Wl.f=function(t){return eh&&"Window"===ql(t)?function(t){try{return Ql(t)}catch(t){return th(eh)}}(t):Ql(Zl(t))};var ih=qe,oh=function(t,e,i){return ih.f(t,e,i)},nh={},sh=pe;nh.f=sh;var rh=ot,ah=Qt,lh=nh,hh=qe.f,ch=function(t){var e=rh.Symbol||(rh.Symbol={});ah(e,t)||hh(e,t,{value:lh.f(t)})},uh=L,dh=lt,ph=pe,gh=Ss,fh=function(){var t=dh("Symbol"),e=t&&t.prototype,i=e&&e.valueOf,o=ph("toPrimitive");e&&!e[o]&&gh(e,o,(function(t){return uh(i,this)}),{arity:1})},mh=Je,vh=j,bh=Jt,_h=Fi,yh=El,Th=b([].push),Eh=function(t){var e=1===t,i=2===t,o=3===t,n=4===t,s=6===t,r=7===t,a=5===t||s;return function(l,h,c,u){for(var d,p,g=bh(l),f=vh(g),m=mh(h,c),v=_h(f),b=0,_=u||yh,y=e?_(l,v):i||r?_(l,0):void 0;v>b;b++)if((a||b in f)&&(p=m(d=f[b],b,g),t))if(e)y[b]=p;else if(p)switch(t){case 3:return!0;case 5:return d;case 6:return b;case 2:Th(y,d)}else switch(t){case 4:return!1;case 7:Th(y,d)}return s?-1:o||n?n:y}},wh={forEach:Eh(0),map:Eh(1),filter:Eh(2),some:Eh(3),every:Eh(4),find:Eh(5),findIndex:Eh(6),filterReject:Eh(7)},kh=Ci,Ih=r,$h=L,Sh=b,Ch=A,Oh=Tt,Rh=a,Ah=Qt,Mh=ht,xh=ii,Lh=Q,Dh=Ee,Nh=hn,Ph=U,Bh=ms,Fh=eo,Hh=Ul,Uh=Wl,Gh=io,Vh=R,Wh=qe,zh=zn,jh=D,Xh=Ss,Yh=oh,Kh=Xt,Jh=zi,qh=ne,Zh=pe,Qh=nh,tc=ch,ec=fh,ic=js,oc=Bn,nc=wh.forEach,sc=kn("hidden"),rc="Symbol",ac="prototype",lc=oc.set,hc=oc.getterFor(rc),cc=Object[ac],uc=Ih.Symbol,dc=uc&&uc[ac],pc=Ih.RangeError,gc=Ih.TypeError,fc=Ih.QObject,mc=Vh.f,vc=Wh.f,bc=Uh.f,_c=jh.f,yc=Sh([].push),Tc=Kh("symbols"),Ec=Kh("op-symbols"),wc=Kh("wks"),kc=!fc||!fc[ac]||!fc[ac].findChild,Ic=function(t,e,i){var o=mc(cc,e);o&&delete cc[e],vc(t,e,i),o&&t!==cc&&vc(cc,e,o)},$c=Ch&&Rh((function(){return 7!==Bh(vc({},"a",{get:function(){return vc(this,"a",{value:7}).a}})).a}))?Ic:vc,Sc=function(t,e){var i=Tc[t]=Bh(dc);return lc(i,{type:rc,tag:t,description:e}),Ch||(i.description=e),i},Cc=function(t,e,i){t===cc&&Cc(Ec,e,i),xh(t);var o=Dh(e);return xh(i),Ah(Tc,o)?(i.enumerable?(Ah(t,sc)&&t[sc][o]&&(t[sc][o]=!1),i=Bh(i,{enumerable:Ph(0,!1)})):(Ah(t,sc)||vc(t,sc,Ph(1,{})),t[sc][o]=!0),$c(t,o,i)):vc(t,o,i)},Oc=function(t,e){xh(t);var i=Lh(e),o=Fh(i).concat(xc(i));return nc(o,(function(e){Ch&&!$h(Rc,i,e)||Cc(t,e,i[e])})),t},Rc=function(t){var e=Dh(t),i=$h(_c,this,e);return!(this===cc&&Ah(Tc,e)&&!Ah(Ec,e))&&(!(i||!Ah(this,e)||!Ah(Tc,e)||Ah(this,sc)&&this[sc][e])||i)},Ac=function(t,e){var i=Lh(t),o=Dh(e);if(i!==cc||!Ah(Tc,o)||Ah(Ec,o)){var n=mc(i,o);return!n||!Ah(Tc,o)||Ah(i,sc)&&i[sc][o]||(n.enumerable=!0),n}},Mc=function(t){var e=bc(Lh(t)),i=[];return nc(e,(function(t){Ah(Tc,t)||Ah(Jh,t)||yc(i,t)})),i},xc=function(t){var e=t===cc,i=bc(e?Ec:Lh(t)),o=[];return nc(i,(function(t){!Ah(Tc,t)||e&&!Ah(cc,t)||yc(o,Tc[t])})),o};Oh||(uc=function(){if(Mh(dc,this))throw new gc("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?Nh(arguments[0]):void 0,e=qh(t),i=function(t){this===cc&&$h(i,Ec,t),Ah(this,sc)&&Ah(this[sc],e)&&(this[sc][e]=!1);var o=Ph(1,t);try{$c(this,e,o)}catch(t){if(!(t instanceof pc))throw t;Ic(this,e,o)}};return Ch&&kc&&$c(cc,e,{configurable:!0,set:i}),Sc(e,t)},Xh(dc=uc[ac],"toString",(function(){return hc(this).tag})),Xh(uc,"withoutSetter",(function(t){return Sc(qh(t),t)})),jh.f=Rc,Wh.f=Cc,zh.f=Oc,Vh.f=Ac,Hh.f=Uh.f=Mc,Gh.f=xc,Qh.f=function(t){return Sc(Zh(t),t)},Ch&&Yh(dc,"description",{configurable:!0,get:function(){return hc(this).description}})),kh({global:!0,constructor:!0,wrap:!0,forced:!Oh,sham:!Oh},{Symbol:uc}),nc(Fh(wc),(function(t){tc(t)})),kh({target:rc,stat:!0,forced:!Oh},{useSetter:function(){kc=!0},useSimple:function(){kc=!1}}),kh({target:"Object",stat:!0,forced:!Oh,sham:!Ch},{create:function(t,e){return void 0===e?Bh(t):Oc(Bh(t),e)},defineProperty:Cc,defineProperties:Oc,getOwnPropertyDescriptor:Ac}),kh({target:"Object",stat:!0,forced:!Oh},{getOwnPropertyNames:Mc}),ec(),ic(uc,rc),Jh[sc]=!0;var Lc=Tt&&!!Symbol.for&&!!Symbol.keyFor,Dc=Ci,Nc=lt,Pc=Qt,Bc=hn,Fc=Xt,Hc=Lc,Uc=Fc("string-to-symbol-registry"),Gc=Fc("symbol-to-string-registry");Dc({target:"Symbol",stat:!0,forced:!Hc},{for:function(t){var e=Bc(t);if(Pc(Uc,e))return Uc[e];var i=Nc("Symbol")(e);return Uc[e]=i,Gc[i]=e,i}});var Vc=Ci,Wc=Qt,zc=St,jc=Ot,Xc=Lc,Yc=Xt("symbol-to-string-registry");Vc({target:"Symbol",stat:!0,forced:!Xc},{keyFor:function(t){if(!zc(t))throw new TypeError(jc(t)+" is not a symbol");if(Wc(Yc,t))return Yc[t]}});var Kc=gl,Jc=O,qc=E,Zc=hn,Qc=b([].push),tu=Ci,eu=lt,iu=p,ou=L,nu=b,su=a,ru=O,au=St,lu=_o,hu=Tt,cu=String,uu=eu("JSON","stringify"),du=nu(/./.exec),pu=nu("".charAt),gu=nu("".charCodeAt),fu=nu("".replace),mu=nu(1..toString),vu=/[\uD800-\uDFFF]/g,bu=/^[\uD800-\uDBFF]$/,_u=/^[\uDC00-\uDFFF]$/,yu=!hu||su((function(){var t=eu("Symbol")("stringify detection");return"[null]"!==uu([t])||"{}"!==uu({a:t})||"{}"!==uu(Object(t))})),Tu=su((function(){return'"\\udf06\\ud834"'!==uu("\udf06\ud834")||'"\\udead"'!==uu("\udead")})),Eu=function(t,e){var i=lu(arguments),o=function(t){if(Jc(t))return t;if(Kc(t)){for(var e=t.length,i=[],o=0;o<e;o++){var n=t[o];"string"==typeof n?Qc(i,n):"number"!=typeof n&&"Number"!==qc(n)&&"String"!==qc(n)||Qc(i,Zc(n))}var s=i.length,r=!0;return function(t,e){if(r)return r=!1,e;if(Kc(this))return e;for(var o=0;o<s;o++)if(i[o]===t)return e}}}(e);if(ru(o)||void 0!==t&&!au(t))return i[1]=function(t,e){if(ru(o)&&(e=ou(o,this,cu(t),e)),!au(e))return e},iu(uu,null,i)},wu=function(t,e,i){var o=pu(i,e-1),n=pu(i,e+1);return du(bu,t)&&!du(_u,n)||du(_u,t)&&!du(bu,o)?"\\u"+mu(gu(t,0),16):t};uu&&tu({target:"JSON",stat:!0,arity:3,forced:yu||Tu},{stringify:function(t,e,i){var o=lu(arguments),n=iu(yu?Eu:uu,null,o);return Tu&&"string"==typeof n?fu(n,vu,wu):n}});var ku=io,Iu=Jt;Ci({target:"Object",stat:!0,forced:!Tt||a((function(){ku.f(1)}))},{getOwnPropertySymbols:function(t){var e=ku.f;return e?e(Iu(t)):[]}}),ch("asyncIterator"),ch("hasInstance"),ch("isConcatSpreadable"),ch("iterator"),ch("match"),ch("matchAll"),ch("replace"),ch("search"),ch("species"),ch("split");var $u=fh;ch("toPrimitive"),$u();var Su=lt,Cu=js;ch("toStringTag"),Cu(Su("Symbol"),"Symbol"),ch("unscopables"),js(r.JSON,"JSON",!0);var Ou=ot.Symbol,Ru=pe,Au=qe.f,Mu=Ru("metadata"),xu=Function.prototype;void 0===xu[Mu]&&Au(xu,Mu,{value:null}),ch("asyncDispose"),ch("dispose"),ch("metadata");var Lu=Ou,Du=b,Nu=lt("Symbol"),Pu=Nu.keyFor,Bu=Du(Nu.prototype.valueOf),Fu=Nu.isRegisteredSymbol||function(t){try{return void 0!==Pu(Bu(t))}catch(t){return!1}};Ci({target:"Symbol",stat:!0},{isRegisteredSymbol:Fu});for(var Hu=Xt,Uu=lt,Gu=b,Vu=St,Wu=pe,zu=Uu("Symbol"),ju=zu.isWellKnownSymbol,Xu=Uu("Object","getOwnPropertyNames"),Yu=Gu(zu.prototype.valueOf),Ku=Hu("wks"),Ju=0,qu=Xu(zu),Zu=qu.length;Ju<Zu;Ju++)try{var Qu=qu[Ju];Vu(zu[Qu])&&Wu(Qu)}catch(t){}var td=function(t){if(ju&&ju(t))return!0;try{for(var e=Yu(t),i=0,o=Xu(Ku),n=o.length;i<n;i++)if(Ku[o[i]]==e)return!0}catch(t){}return!1};Ci({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:td}),ch("matcher"),ch("observable"),Ci({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Fu}),Ci({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:td}),ch("metadataKey"),ch("patternMatch"),ch("replaceAll");var ed=n(Lu),id=n(nh.f("iterator"));function od(t){return od="function"==typeof ed&&"symbol"==typeof id?function(t){return typeof t}:function(t){return t&&"function"==typeof ed&&t.constructor===ed&&t!==ed.prototype?"symbol":typeof t},od(t)}var nd=n(nh.f("toPrimitive"));function sd(t){var e=function(t){if("object"!==od(t)||null===t)return t;var e=t[nd];if(void 0!==e){var i=e.call(t,"string");if("object"!==od(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===od(e)?e:String(e)}function rd(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),dl(t,sd(o.key),o)}}function ad(t,e,i){return e&&rd(t.prototype,e),i&&rd(t,i),dl(t,"prototype",{writable:!1}),t}Ci({target:"Array",stat:!0},{isArray:gl});var ld=ot.Array.isArray,hd=n(ld),cd=A,ud=gl,dd=TypeError,pd=Object.getOwnPropertyDescriptor,gd=cd&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(ud(t)&&!pd(t,"length").writable)throw new dd("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},fd=Jt,md=Fi,vd=gd,bd=ml;Ci({target:"Array",proto:!0,arity:1,forced:a((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=fd(this),i=md(e),o=arguments.length;bd(i+o);for(var n=0;n<o;n++)e[i]=arguments[n],i++;return vd(e,i),i}});var _d=xo("Array").push,yd=ht,Td=_d,Ed=Array.prototype,wd=n((function(t){var e=t.push;return t===Ed||yd(Ed,t)&&e===Ed.push?Td:e})),kd=Ci,Id=gl,$d=oa,Sd=it,Cd=Ni,Od=Fi,Rd=Q,Ad=aa,Md=pe,xd=_o,Ld=$l("slice"),Dd=Md("species"),Nd=Array,Pd=Math.max;kd({target:"Array",proto:!0,forced:!Ld},{slice:function(t,e){var i,o,n,s=Rd(this),r=Od(s),a=Cd(t,r),l=Cd(void 0===e?r:e,r);if(Id(s)&&(i=s.constructor,($d(i)&&(i===Nd||Id(i.prototype))||Sd(i)&&null===(i=i[Dd]))&&(i=void 0),i===Nd||void 0===i))return xd(s,a,l);for(o=new(void 0===i?Nd:i)(Pd(l-a,0)),n=0;a<l;a++,n++)a in s&&Ad(o,n,s[a]);return o.length=n,o}});var Bd=xo("Array").slice,Fd=ht,Hd=Bd,Ud=Array.prototype,Gd=function(t){var e=t.slice;return t===Ud||Fd(Ud,t)&&e===Ud.slice?Hd:e},Vd=n(Gd),Wd=n(Na);function zd(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function jd(t,e){var i;if(t){if("string"==typeof t)return zd(t,e);var o=Vd(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Wd(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?zd(t,e):void 0}}function Xd(t,e){return function(t){if(hd(t))return t}(t)||function(t,e){var i=null==t?null:void 0!==ed&&il(t)||t["@@iterator"];if(null!=i){var o,n,s,r,a=[],l=!0,h=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(o=s.call(i)).done)&&(wd(a).call(a,o.value),a.length!==e);l=!0);}catch(t){h=!0,n=t}finally{try{if(!l&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(h)throw n}}return a}}(t,e)||jd(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yd(t){return function(t){if(hd(t))return zd(t)}(t)||function(t){if(void 0!==ed&&null!=il(t)||null!=t["@@iterator"])return Wd(t)}(t)||jd(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Kd=n(Ou),Jd=xo("Array").concat,qd=ht,Zd=Jd,Qd=Array.prototype,tp=n((function(t){var e=t.concat;return t===Qd||qd(Qd,t)&&e===Qd.concat?Zd:e})),ep=n(Gd),ip=lt,op=Ul,np=io,sp=ii,rp=b([].concat),ap=ip("Reflect","ownKeys")||function(t){var e=op.f(sp(t)),i=np.f;return i?rp(e,i(t)):e},lp=n(ld),hp=wh.map;Ci({target:"Array",proto:!0,forced:!$l("map")},{map:function(t){return hp(this,t,arguments.length>1?arguments[1]:void 0)}});var cp=xo("Array").map,up=ht,dp=cp,pp=Array.prototype,gp=n((function(t){var e=t.map;return t===pp||up(pp,t)&&e===pp.map?dp:e})),fp=Jt,mp=eo;Ci({target:"Object",stat:!0,forced:a((function(){mp(1)}))},{keys:function(t){return mp(fp(t))}});var vp=n(ot.Object.keys),bp=Ci,_p=Date,yp=b(_p.prototype.getTime);bp({target:"Date",stat:!0},{now:function(){return yp(new _p)}});var Tp=n(ot.Date.now),Ep=a,wp=function(t,e){var i=[][t];return!!i&&Ep((function(){i.call(null,e||function(){return 1},1)}))},kp=wh.forEach,Ip=wp("forEach")?[].forEach:function(t){return kp(this,t,arguments.length>1?arguments[1]:void 0)};Ci({target:"Array",proto:!0,forced:[].forEach!==Ip},{forEach:Ip});var $p=xo("Array").forEach,Sp=rn,Cp=Qt,Op=ht,Rp=$p,Ap=Array.prototype,Mp={DOMTokenList:!0,NodeList:!0},xp=n((function(t){var e=t.forEach;return t===Ap||Op(Ap,t)&&e===Ap.forEach||Cp(Mp,Sp(t))?Rp:e})),Lp=Ci,Dp=gl,Np=b([].reverse),Pp=[1,2];Lp({target:"Array",proto:!0,forced:String(Pp)===String(Pp.reverse())},{reverse:function(){return Dp(this)&&(this.length=this.length),Np(this)}});var Bp=xo("Array").reverse,Fp=ht,Hp=Bp,Up=Array.prototype,Gp=n((function(t){var e=t.reverse;return t===Up||Fp(Up,t)&&e===Up.reverse?Hp:e})),Vp=Ot,Wp=TypeError,zp=function(t,e){if(!delete t[e])throw new Wp("Cannot delete property "+Vp(e)+" of "+Vp(t))},jp=Ci,Xp=Jt,Yp=Ni,Kp=Mi,Jp=Fi,qp=gd,Zp=ml,Qp=El,tg=aa,eg=zp,ig=$l("splice"),og=Math.max,ng=Math.min;jp({target:"Array",proto:!0,forced:!ig},{splice:function(t,e){var i,o,n,s,r,a,l=Xp(this),h=Jp(l),c=Yp(t,h),u=arguments.length;for(0===u?i=o=0:1===u?(i=0,o=h-c):(i=u-2,o=ng(og(Kp(e),0),h-c)),Zp(h+i-o),n=Qp(l,o),s=0;s<o;s++)(r=c+s)in l&&tg(n,s,l[r]);if(n.length=o,i<o){for(s=c;s<h-o;s++)a=s+i,(r=s+o)in l?l[a]=l[r]:eg(l,a);for(s=h;s>h-o+i;s--)eg(l,s-1)}else if(i>o)for(s=h-o;s>c;s--)a=s+i-1,(r=s+o-1)in l?l[a]=l[r]:eg(l,a);for(s=0;s<i;s++)l[s+c]=arguments[s+2];return qp(l,h-o+i),n}});var sg=xo("Array").splice,rg=ht,ag=sg,lg=Array.prototype,hg=n((function(t){var e=t.splice;return t===lg||rg(lg,t)&&e===lg.splice?ag:e})),cg=Wi.includes;Ci({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(t){return cg(this,t,arguments.length>1?arguments[1]:void 0)}});var ug=xo("Array").includes,dg=it,pg=E,gg=pe("match"),fg=TypeError,mg=pe("match"),vg=Ci,bg=function(t){if(function(t){var e;return dg(t)&&(void 0!==(e=t[gg])?!!e:"RegExp"===pg(t))}(t))throw new fg("The method doesn't accept regular expressions");return t},_g=J,yg=hn,Tg=b("".indexOf);vg({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[mg]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~Tg(yg(_g(this)),yg(bg(t)),arguments.length>1?arguments[1]:void 0)}});var Eg=xo("String").includes,wg=ht,kg=ug,Ig=Eg,$g=Array.prototype,Sg=String.prototype,Cg=n((function(t){var e=t.includes;return t===$g||wg($g,t)&&e===$g.includes?kg:"string"==typeof t||t===Sg||wg(Sg,t)&&e===Sg.includes?Ig:e})),Og=Jt,Rg=Is,Ag=vs;Ci({target:"Object",stat:!0,forced:a((function(){Rg(1)})),sham:!Ag},{getPrototypeOf:function(t){return Rg(Og(t))}});var Mg=ot.Object.getPrototypeOf,xg=n(Mg),Lg=wh.filter;Ci({target:"Array",proto:!0,forced:!$l("filter")},{filter:function(t){return Lg(this,t,arguments.length>1?arguments[1]:void 0)}});var Dg=xo("Array").filter,Ng=ht,Pg=Dg,Bg=Array.prototype,Fg=n((function(t){var e=t.filter;return t===Bg||Ng(Bg,t)&&e===Bg.filter?Pg:e})),Hg="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",Ug=J,Gg=hn,Vg=Hg,Wg=b("".replace),zg=RegExp("^["+Vg+"]+"),jg=RegExp("(^|[^"+Vg+"])["+Vg+"]+$"),Xg=function(t){return function(e){var i=Gg(Ug(e));return 1&t&&(i=Wg(i,zg,"")),2&t&&(i=Wg(i,jg,"$1")),i}},Yg={start:Xg(1),end:Xg(2),trim:Xg(3)},Kg=r,Jg=a,qg=b,Zg=hn,Qg=Yg.trim,tf=Hg,ef=Kg.parseInt,of=Kg.Symbol,nf=of&&of.iterator,sf=/^[+-]?0x/i,rf=qg(sf.exec),af=8!==ef(tf+"08")||22!==ef(tf+"0x16")||nf&&!Jg((function(){ef(Object(nf))}))?function(t,e){var i=Qg(Zg(t));return ef(i,e>>>0||(rf(sf,i)?16:10))}:ef;Ci({global:!0,forced:parseInt!==af},{parseInt:af});var lf=n(ot.parseInt),hf=Ci,cf=Wi.indexOf,uf=wp,df=I([].indexOf),pf=!!df&&1/df([1],1,-0)<0;hf({target:"Array",proto:!0,forced:pf||!uf("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return pf?df(this,t,e)||0:cf(this,t,e)}});var gf=xo("Array").indexOf,ff=ht,mf=gf,vf=Array.prototype,bf=n((function(t){var e=t.indexOf;return t===vf||ff(vf,t)&&e===vf.indexOf?mf:e}));Ci({target:"Object",stat:!0,sham:!A},{create:ms});var _f=ot.Object,yf=function(t,e){return _f.create(t,e)},Tf=n(yf),Ef=ot,wf=p;Ef.JSON||(Ef.JSON={stringify:JSON.stringify});var kf=n((function(t,e,i){return wf(Ef.JSON.stringify,null,arguments)})),If="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,$f=TypeError,Sf=r,Cf=p,Of=O,Rf=If,Af=ct,Mf=_o,xf=Sf.Function,Lf=/MSIE .\./.test(Af)||Rf&&function(){var t=Sf.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}(),Df=function(t,e){var i=e?2:1;return Lf?function(o,n){var s=function(t,e){if(t<e)throw new $f("Not enough arguments");return t}(arguments.length,1)>i,r=Of(o)?o:xf(o),a=s?Mf(arguments,i):[],l=s?function(){Cf(r,this,a)}:r;return e?t(l,n):t(l)}:t},Nf=Ci,Pf=r,Bf=Df(Pf.setInterval,!0);Nf({global:!0,bind:!0,forced:Pf.setInterval!==Bf},{setInterval:Bf});var Ff=Ci,Hf=r,Uf=Df(Hf.setTimeout,!0);Ff({global:!0,bind:!0,forced:Hf.setTimeout!==Uf},{setTimeout:Uf});var Gf=n(ot.setTimeout),Vf=Jt,Wf=Ni,zf=Fi;Ci({target:"Array",proto:!0},{fill:function(t){for(var e=Vf(this),i=zf(e),o=arguments.length,n=Wf(o>1?arguments[1]:void 0,i),s=o>2?arguments[2]:void 0,r=void 0===s?i:Wf(s,i);r>n;)e[n++]=t;return e}});var jf,Xf=xo("Array").fill,Yf=ht,Kf=Xf,Jf=Array.prototype,qf=n((function(t){var e=t.fill;return t===Jf||Yf(Jf,t)&&e===Jf.fill?Kf:e}));function Zf(){return Zf=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},Zf.apply(this,arguments)}function Qf(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function tm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}jf="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var n in o)o.hasOwnProperty(n)&&(e[n]=o[n])}return e}:Object.assign;var em,im=jf,om=["","webkit","Moz","MS","ms","o"],nm="undefined"==typeof document?{style:{}}:document.createElement("div"),sm=Math.round,rm=Math.abs,am=Date.now;function lm(t,e){for(var i,o,n=e[0].toUpperCase()+e.slice(1),s=0;s<om.length;){if((o=(i=om[s])?i+n:e)in t)return o;s++}}em="undefined"==typeof window?{}:window;var hm=lm(nm.style,"touchAction"),cm=void 0!==hm,um="compute",dm="auto",pm="manipulation",gm="none",fm="pan-x",mm="pan-y",vm=function(){if(!cm)return!1;var t={},e=em.CSS&&em.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){return t[i]=!e||em.CSS.supports("touch-action",i)})),t}(),bm="ontouchstart"in em,_m=void 0!==lm(em,"PointerEvent"),ym=bm&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Tm="touch",Em="mouse",wm=16,km=24,Im=["x","y"],$m=["clientX","clientY"];function Sm(t,e,i){var o;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(o=0;o<t.length;)e.call(i,t[o],o,t),o++;else for(o in t)t.hasOwnProperty(o)&&e.call(i,t[o],o,t)}function Cm(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function Om(t,e){return t.indexOf(e)>-1}var Rm=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===um&&(t=this.compute()),cm&&this.manager.element.style&&vm[t]&&(this.manager.element.style[hm]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return Sm(this.manager.recognizers,(function(e){Cm(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(Om(t,gm))return gm;var e=Om(t,fm),i=Om(t,mm);return e&&i?gm:e||i?e?fm:mm:Om(t,pm)?pm:dm}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var o=this.actions,n=Om(o,gm)&&!vm[gm],s=Om(o,mm)&&!vm[mm],r=Om(o,fm)&&!vm[fm];if(n){var a=1===t.pointers.length,l=t.distance<2,h=t.deltaTime<250;if(a&&l&&h)return}if(!r||!s)return n||s&&6&i||r&&i&km?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function Am(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function Mm(t){var e=t.length;if(1===e)return{x:sm(t[0].clientX),y:sm(t[0].clientY)};for(var i=0,o=0,n=0;n<e;)i+=t[n].clientX,o+=t[n].clientY,n++;return{x:sm(i/e),y:sm(o/e)}}function xm(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:sm(t.pointers[i].clientX),clientY:sm(t.pointers[i].clientY)},i++;return{timeStamp:am(),pointers:e,center:Mm(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Lm(t,e,i){i||(i=Im);var o=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return Math.sqrt(o*o+n*n)}function Dm(t,e,i){i||(i=Im);var o=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return 180*Math.atan2(n,o)/Math.PI}function Nm(t,e){return t===e?1:rm(t)>=rm(e)?t<0?2:4:e<0?8:wm}function Pm(t,e,i){return{x:e/t||0,y:i/t||0}}function Bm(t,e,i){var o=i.pointers.length,n=i.changedPointers.length,s=1&e&&o-n==0,r=12&e&&o-n==0;i.isFirst=!!s,i.isFinal=!!r,s&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,o=e.pointers,n=o.length;i.firstInput||(i.firstInput=xm(e)),n>1&&!i.firstMultiple?i.firstMultiple=xm(e):1===n&&(i.firstMultiple=!1);var s=i.firstInput,r=i.firstMultiple,a=r?r.center:s.center,l=e.center=Mm(o);e.timeStamp=am(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=Dm(a,l),e.distance=Lm(a,l),function(t,e){var i=e.center,o=t.offsetDelta||{},n=t.prevDelta||{},s=t.prevInput||{};1!==e.eventType&&4!==s.eventType||(n=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},o=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=n.x+(i.x-o.x),e.deltaY=n.y+(i.y-o.y)}(i,e),e.offsetDirection=Nm(e.deltaX,e.deltaY);var h,c,u=Pm(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=rm(u.x)>rm(u.y)?u.x:u.y,e.scale=r?(h=r.pointers,Lm((c=o)[0],c[1],$m)/Lm(h[0],h[1],$m)):1,e.rotation=r?function(t,e){return Dm(e[1],e[0],$m)+Dm(t[1],t[0],$m)}(r.pointers,o):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,o,n,s,r=t.lastInterval||e,a=e.timeStamp-r.timeStamp;if(8!==e.eventType&&(a>25||void 0===r.velocity)){var l=e.deltaX-r.deltaX,h=e.deltaY-r.deltaY,c=Pm(a,l,h);o=c.x,n=c.y,i=rm(c.x)>rm(c.y)?c.x:c.y,s=Nm(l,h),t.lastInterval=e}else i=r.velocity,o=r.velocityX,n=r.velocityY,s=r.direction;e.velocity=i,e.velocityX=o,e.velocityY=n,e.direction=s}(i,e);var d,p=t.element,g=e.srcEvent;Am(d=g.composedPath?g.composedPath()[0]:g.path?g.path[0]:g.target,p)&&(p=d),e.target=p}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Fm(t){return t.trim().split(/\s+/g)}function Hm(t,e,i){Sm(Fm(e),(function(e){t.addEventListener(e,i,!1)}))}function Um(t,e,i){Sm(Fm(e),(function(e){t.removeEventListener(e,i,!1)}))}function Gm(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var Vm=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){Cm(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&Hm(this.element,this.evEl,this.domHandler),this.evTarget&&Hm(this.target,this.evTarget,this.domHandler),this.evWin&&Hm(Gm(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&Um(this.element,this.evEl,this.domHandler),this.evTarget&&Um(this.target,this.evTarget,this.domHandler),this.evWin&&Um(Gm(this.element),this.evWin,this.domHandler)},t}();function Wm(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var o=0;o<t.length;){if(i&&t[o][i]==e||!i&&t[o]===e)return o;o++}return-1}var zm={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},jm={2:Tm,3:"pen",4:Em,5:"kinect"},Xm="pointerdown",Ym="pointermove pointerup pointercancel";em.MSPointerEvent&&!em.PointerEvent&&(Xm="MSPointerDown",Ym="MSPointerMove MSPointerUp MSPointerCancel");var Km=function(t){function e(){var i,o=e.prototype;return o.evEl=Xm,o.evWin=Ym,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return Qf(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,o=t.type.toLowerCase().replace("ms",""),n=zm[o],s=jm[t.pointerType]||t.pointerType,r=s===Tm,a=Wm(e,t.pointerId,"pointerId");1&n&&(0===t.button||r)?a<0&&(e.push(t),a=e.length-1):12&n&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),i&&e.splice(a,1))},e}(Vm);function Jm(t){return Array.prototype.slice.call(t,0)}function qm(t,e,i){for(var o=[],n=[],s=0;s<t.length;){var r=e?t[s][e]:t[s];Wm(n,r)<0&&o.push(t[s]),n[s]=r,s++}return i&&(o=e?o.sort((function(t,i){return t[e]>i[e]})):o.sort()),o}var Zm={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Qm=function(t){function e(){var i;return e.prototype.evTarget="touchstart touchmove touchend touchcancel",(i=t.apply(this,arguments)||this).targetIds={},i}return Qf(e,t),e.prototype.handler=function(t){var e=Zm[t.type],i=tv.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Tm,srcEvent:t})},e}(Vm);function tv(t,e){var i,o,n=Jm(t.touches),s=this.targetIds;if(3&e&&1===n.length)return s[n[0].identifier]=!0,[n,n];var r=Jm(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return Am(t.target,l)})),1===e)for(i=0;i<o.length;)s[o[i].identifier]=!0,i++;for(i=0;i<r.length;)s[r[i].identifier]&&a.push(r[i]),12&e&&delete s[r[i].identifier],i++;return a.length?[qm(o.concat(a),"identifier",!0),a]:void 0}var ev={mousedown:1,mousemove:2,mouseup:4},iv=function(t){function e(){var i,o=e.prototype;return o.evEl="mousedown",o.evWin="mousemove mouseup",(i=t.apply(this,arguments)||this).pressed=!1,i}return Qf(e,t),e.prototype.handler=function(t){var e=ev[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Em,srcEvent:t}))},e}(Vm);function ov(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},o=this.lastTouches;this.lastTouches.push(i),setTimeout((function(){var t=o.indexOf(i);t>-1&&o.splice(t,1)}),2500)}}function nv(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ov.call(this,e)):12&t&&ov.call(this,e)}function sv(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,o=0;o<this.lastTouches.length;o++){var n=this.lastTouches[o],s=Math.abs(e-n.x),r=Math.abs(i-n.y);if(s<=25&&r<=25)return!0}return!1}var rv=function(t){function e(e,i){var o;return(o=t.call(this,e,i)||this).handler=function(t,e,i){var n=i.pointerType===Tm,s=i.pointerType===Em;if(!(s&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)nv.call(tm(tm(o)),e,i);else if(s&&sv.call(tm(tm(o)),i))return;o.callback(t,e,i)}},o.touch=new Qm(o.manager,o.handler),o.mouse=new iv(o.manager,o.handler),o.primaryTouch=null,o.lastTouches=[],o}return Qf(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(Vm);function av(t,e,i){return!!Array.isArray(t)&&(Sm(t,i[e],i),!0)}var lv=32,hv=1;function cv(t,e){var i=e.manager;return i?i.get(t):t}function uv(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var dv=function(){function t(t){void 0===t&&(t={}),this.options=Zf({enable:!0},t),this.id=hv++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return im(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(av(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=cv(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return av(t,"dropRecognizeWith",this)||(t=cv(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(av(t,"requireFailure",this))return this;var e=this.requireFail;return-1===Wm(e,t=cv(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(av(t,"dropRequireFailure",this))return this;t=cv(t,this);var e=Wm(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function o(i){e.manager.emit(i,t)}i<8&&o(e.options.event+uv(i)),o(e.options.event),t.additionalEvent&&o(t.additionalEvent),i>=8&&o(e.options.event+uv(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=lv},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=im({},t);if(!Cm(this.options.enable,[this,e]))return this.reset(),void(this.state=lv);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),pv=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Zf({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}Qf(e,t);var i=e.prototype;return i.getTouchAction=function(){return[pm]},i.process=function(t){var e=this,i=this.options,o=t.pointers.length===i.pointers,n=t.distance<i.threshold,s=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(n&&s&&o){if(4!==t.eventType)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||Lm(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout((function(){e.state=8,e.tryEmit()}),i.interval),2):8}return lv},i.failTimeout=function(){var t=this;return this._timer=setTimeout((function(){t.state=lv}),this.options.interval),lv},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(dv),gv=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Zf({pointers:1},e))||this}Qf(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,o=6&e,n=this.attrTest(t);return o&&(8&i||!n)?16|e:o||n?4&i?8|e:2&e?4|e:2:lv},e}(dv);function fv(t){return t===wm?"down":8===t?"up":2===t?"left":4===t?"right":""}var mv=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Zf({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}Qf(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(mm),t&km&&e.push(fm),e},i.directionTest=function(t){var e=this.options,i=!0,o=t.distance,n=t.direction,s=t.deltaX,r=t.deltaY;return n&e.direction||(6&e.direction?(n=0===s?1:s<0?2:4,i=s!==this.pX,o=Math.abs(t.deltaX)):(n=0===r?1:r<0?8:wm,i=r!==this.pY,o=Math.abs(t.deltaY))),t.direction=n,i&&o>e.threshold&&n&e.direction},i.attrTest=function(t){return gv.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=fv(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(gv),vv=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Zf({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}Qf(e,t);var i=e.prototype;return i.getTouchAction=function(){return mv.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,o=this.options.direction;return 30&o?i=e.overallVelocity:6&o?i=e.overallVelocityX:o&km&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&o&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&rm(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=fv(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(gv),bv=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Zf({event:"pinch",threshold:0,pointers:2},e))||this}Qf(e,t);var i=e.prototype;return i.getTouchAction=function(){return[gm]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){if(1!==e.scale){var i=e.scale<1?"in":"out";e.additionalEvent=this.options.event+i}t.prototype.emit.call(this,e)},e}(gv),_v=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Zf({event:"rotate",threshold:0,pointers:2},e))||this}Qf(e,t);var i=e.prototype;return i.getTouchAction=function(){return[gm]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(gv),yv=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Zf({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}Qf(e,t);var i=e.prototype;return i.getTouchAction=function(){return[dm]},i.process=function(t){var e=this,i=this.options,o=t.pointers.length===i.pointers,n=t.distance<i.threshold,s=t.deltaTime>i.time;if(this._input=t,!n||!o||12&t.eventType&&!s)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout((function(){e.state=8,e.tryEmit()}),i.time);else if(4&t.eventType)return 8;return lv},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=am(),this.manager.emit(this.options.event,this._input)))},e}(dv),Tv={domEvents:!1,touchAction:um,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ev=[[_v,{enable:!1}],[bv,{enable:!1},["rotate"]],[vv,{direction:6}],[mv,{direction:6},["swipe"]],[pv],[pv,{event:"doubletap",taps:2},["tap"]],[yv]];function wv(t,e){var i,o=t.element;o.style&&(Sm(t.options.cssProps,(function(n,s){i=lm(o.style,s),e?(t.oldCssProps[i]=o.style[i],o.style[i]=n):o.style[i]=t.oldCssProps[i]||""})),e||(t.oldCssProps={}))}var kv=function(){function t(t,e){var i=this;this.options=im({},Tv,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(_m?Km:ym?Qm:bm?rv:iv))(this,Bm),this.touchAction=new Rm(this,this.options.touchAction),wv(this,!0),Sm(this.options.recognizers,(function(t){var e=i.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}var e=t.prototype;return e.set=function(t){return im(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var o=this.recognizers,n=e.curRecognizer;(!n||n&&8&n.state)&&(e.curRecognizer=null,n=null);for(var s=0;s<o.length;)i=o[s],2===e.stopped||n&&i!==n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&14&i.state&&(e.curRecognizer=i,n=i),s++}},e.get=function(t){if(t instanceof dv)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(av(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(av(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,o=Wm(i,e);-1!==o&&(i.splice(o,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return Sm(Fm(t),(function(t){i[t]=i[t]||[],i[t].push(e)})),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return Sm(Fm(t),(function(t){e?i[t]&&i[t].splice(Wm(i[t],e),1):delete i[t]})),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var o=0;o<i.length;)i[o](e),o++}},e.destroy=function(){this.element&&wv(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),Iv={touchstart:1,touchmove:2,touchend:4,touchcancel:8},$v=function(t){function e(){var i,o=e.prototype;return o.evTarget="touchstart",o.evWin="touchstart touchmove touchend touchcancel",(i=t.apply(this,arguments)||this).started=!1,i}return Qf(e,t),e.prototype.handler=function(t){var e=Iv[t.type];if(1===e&&(this.started=!0),this.started){var i=Sv.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Tm,srcEvent:t})}},e}(Vm);function Sv(t,e){var i=Jm(t.touches),o=Jm(t.changedTouches);return 12&e&&(i=qm(i.concat(o),"identifier",!0)),[i,o]}function Cv(t,e,i){var o="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",n=window.console&&(window.console.warn||window.console.log);return n&&n.call(window.console,o,i),t.apply(this,arguments)}}var Ov=Cv((function(t,e,i){for(var o=Object.keys(e),n=0;n<o.length;)(!i||i&&void 0===t[o[n]])&&(t[o[n]]=e[o[n]]),n++;return t}),"extend","Use `assign`."),Rv=Cv((function(t,e){return Ov(t,e,!0)}),"merge","Use `assign`.");function Av(t,e,i){var o,n=e.prototype;(o=t.prototype=Object.create(n)).constructor=t,o._super=n,i&&im(o,i)}function Mv(t,e){return function(){return t.apply(e,arguments)}}var xv=function(){var t=function(t,e){return void 0===e&&(e={}),new kv(t,Zf({recognizers:Ev.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=wm,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=km,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=wm,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=lv,t.Manager=kv,t.Input=Vm,t.TouchAction=Rm,t.TouchInput=Qm,t.MouseInput=iv,t.PointerEventInput=Km,t.TouchMouseInput=rv,t.SingleTouchInput=$v,t.Recognizer=dv,t.AttrRecognizer=gv,t.Tap=pv,t.Pan=mv,t.Swipe=vv,t.Pinch=bv,t.Rotate=_v,t.Press=yv,t.on=Hm,t.off=Um,t.each=Sm,t.merge=Rv,t.extend=Ov,t.bindFn=Mv,t.assign=im,t.inherit=Av,t.bindFn=Mv,t.prefixed=lm,t.toArray=Jm,t.inArray=Wm,t.uniqueArray=qm,t.splitStr=Fm,t.boolOrFn=Cm,t.hasParent=Am,t.addEventListeners=Hm,t.removeEventListeners=Um,t.defaults=im({},Tv,{preset:Ev}),t}();xv.defaults;var Lv=xv;function Dv(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Nv(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Nv(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function Nv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function Pv(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){var e=function(){for(var t=function(){var t=4022871197;return function(e){for(var i=e.toString(),o=0;o<i.length;o++){var n=.02519603282416938*(t+=i.charCodeAt(o));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}}(),e=t(" "),i=t(" "),o=t(" "),n=0;n<arguments.length;n++)(e-=t(n<0||arguments.length<=n?void 0:arguments[n]))<0&&(e+=1),(i-=t(n<0||arguments.length<=n?void 0:arguments[n]))<0&&(i+=1),(o-=t(n<0||arguments.length<=n?void 0:arguments[n]))<0&&(o+=1);return[e,i,o]}(t),i=Xd(e,3),o=i[0],n=i[1],s=i[2],r=1,a=function(){var t=2091639*o+2.3283064365386963e-10*r;return o=n,n=s,s=t-(r=0|t)};return a.uint32=function(){return 4294967296*a()},a.fract53=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.algorithm="Alea",a.seed=t,a.version="0.9",a}(e.length?e:[Tp()])}Kd("DELETE");var Bv="undefined"!=typeof window?window.Hammer||Lv:function(){return function(){var t=function(){};return{on:t,off:t,destroy:t,emit:t,get:function(){return{set:t}}}}()};function Fv(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push((function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)}));var o=Bv(this._dom.overlay);o.on("tap",Fo(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push((function(){o.destroy()}));var n=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];xp(n).call(n,(function(t){o.on(t,(function(t){t.srcEvent.stopPropagation()}))})),document&&document.body&&(this._onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push((function(){document.body.removeEventListener("click",i._onClick)}))),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}Xo(Fv.prototype),Fv.current=null,Fv.prototype.destroy=function(){var t,e;this.deactivate();var i,o=Dv(Gp(t=hg(e=this._cleanupQueue).call(e,0)).call(t));try{for(o.s();!(i=o.n()).done;)(0,i.value)()}catch(t){o.e(t)}finally{o.f()}},Fv.prototype.activate=function(){Fv.current&&Fv.current.deactivate(),Fv.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},Fv.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},Fv.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var Hv=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Uv=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Gv=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,Vv=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;function Wv(t){if(t)for(;!0===t.hasChildNodes();){var e=t.firstChild;e&&(Wv(e),t.removeChild(e))}}function zv(t){return t instanceof String||"string"==typeof t}function jv(t){return"object"===od(t)&&null!==t}function Xv(t,e,i,o){var n=!1;!0===o&&(n=null===e[i]&&void 0!==t[i]),n?delete t[i]:t[i]=e[i]}function Yv(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var o in t)if(void 0!==e[o])if(null===e[o]||"object"!==od(e[o]))Xv(t,e,o,i);else{var n=t[o],s=e[o];jv(n)&&jv(s)&&Yv(n,s,i)}}function Kv(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(lp(i))throw new TypeError("Arrays are not supported by deepExtend");for(var n=0;n<t.length;n++){var s=t[n];if(Object.prototype.hasOwnProperty.call(i,s))if(i[s]&&i[s].constructor===Object)void 0===e[s]&&(e[s]={}),e[s].constructor===Object?qv(e[s],i[s],!1,o):Xv(e,i,s,o);else{if(lp(i[s]))throw new TypeError("Arrays are not supported by deepExtend");Xv(e,i,s,o)}}return e}function Jv(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(lp(i))throw new TypeError("Arrays are not supported by deepExtend");for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)&&!Cg(t).call(t,n))if(i[n]&&i[n].constructor===Object)void 0===e[n]&&(e[n]={}),e[n].constructor===Object?qv(e[n],i[n]):Xv(e,i,n,o);else if(lp(i[n])){e[n]=[];for(var s=0;s<i[n].length;s++)e[n].push(i[n][s])}else Xv(e,i,n,o);return e}function qv(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)||!0===i)if("object"===od(e[n])&&null!==e[n]&&xg(e[n])===Object.prototype)void 0===t[n]?t[n]=qv({},e[n],i):"object"===od(t[n])&&null!==t[n]&&xg(t[n])===Object.prototype?qv(t[n],e[n],i):Xv(t,e,n,o);else if(lp(e[n])){var s;t[n]=ep(s=e[n]).call(s)}else Xv(t,e,n,o);return t}function Zv(t,e){var i;return tp(i=[]).call(i,Yd(t),[e])}function Qv(t){return t.getBoundingClientRect().top}function tb(t,e){if(lp(t))for(var i=t.length,o=0;o<i;o++)e(t[o],o,t);else for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(t[n],n,t)}function eb(t){var e;switch(t.length){case 3:case 4:return(e=Uv.exec(t))?{r:lf(e[1]+e[1],16),g:lf(e[2]+e[2],16),b:lf(e[3]+e[3],16)}:null;case 6:case 7:return(e=Hv.exec(t))?{r:lf(e[1],16),g:lf(e[2],16),b:lf(e[3],16)}:null;default:return null}}function ib(t,e){if(Cg(t).call(t,"rgba"))return t;if(Cg(t).call(t,"rgb")){var i=t.substr(bf(t).call(t,"(")+1).replace(")","").split(",");return"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")"}var o=eb(t);return null==o?t:"rgba("+o.r+","+o.g+","+o.b+","+e+")"}function ob(t,e,i){var o;return"#"+ep(o=((1<<24)+(t<<16)+(e<<8)+i).toString(16)).call(o,1)}function nb(t,e){if(zv(t)){var i=t;if(hb(i)){var o,n=gp(o=i.substr(4).substr(0,i.length-5).split(",")).call(o,(function(t){return lf(t)}));i=ob(n[0],n[1],n[2])}if(!0===lb(i)){var s=function(t){var e=eb(t);if(!e)throw new TypeError("'".concat(t,"' is not a valid color."));return sb(e.r,e.g,e.b)}(i),r={h:s.h,s:.8*s.s,v:Math.min(1,1.02*s.v)},a={h:s.h,s:Math.min(1,1.25*s.s),v:.8*s.v},l=ab(a.h,a.s,a.v),h=ab(r.h,r.s,r.v);return{background:i,border:l,highlight:{background:h,border:l},hover:{background:h,border:l}}}return{background:i,border:i,highlight:{background:i,border:i},hover:{background:i,border:i}}}return e?{background:t.background||e.background,border:t.border||e.border,highlight:zv(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||e.highlight.background,border:t.highlight&&t.highlight.border||e.highlight.border},hover:zv(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||e.hover.border,background:t.hover&&t.hover.background||e.hover.background}}:{background:t.background||void 0,border:t.border||void 0,highlight:zv(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||void 0,border:t.highlight&&t.highlight.border||void 0},hover:zv(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||void 0,background:t.hover&&t.hover.background||void 0}}}function sb(t,e,i){t/=255,e/=255,i/=255;var o=Math.min(t,Math.min(e,i)),n=Math.max(t,Math.max(e,i));return o===n?{h:0,s:0,v:o}:{h:60*((t===o?3:i===o?1:5)-(t===o?e-i:i===o?t-e:i-t)/(n-o))/360,s:(n-o)/n,v:n}}function rb(t,e,i){var o,n,s,r=Math.floor(6*t),a=6*t-r,l=i*(1-e),h=i*(1-a*e),c=i*(1-(1-a)*e);switch(r%6){case 0:o=i,n=c,s=l;break;case 1:o=h,n=i,s=l;break;case 2:o=l,n=i,s=c;break;case 3:o=l,n=h,s=i;break;case 4:o=c,n=l,s=i;break;case 5:o=i,n=l,s=h}return{r:Math.floor(255*o),g:Math.floor(255*n),b:Math.floor(255*s)}}function ab(t,e,i){var o=rb(t,e,i);return ob(o.r,o.g,o.b)}function lb(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}function hb(t){return Gv.test(t)}function cb(t){if(null===t||"object"!==od(t))return null;if(t instanceof Element)return t;var e=Tf(t);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&"object"==od(t[i])&&(e[i]=cb(t[i]));return e}function ub(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=function(t){return null!=t},s=function(t){return null!==t&&"object"===od(t)};if(!s(t))throw new Error("Parameter mergeTarget must be an object");if(!s(e))throw new Error("Parameter options must be an object");if(!n(i))throw new Error("Parameter option must have a value");if(!s(o))throw new Error("Parameter globalOptions must be an object");var r=e[i],a=s(o)&&!function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(o)?o[i]:void 0,l=a?a.enabled:void 0;if(void 0!==r){if("boolean"==typeof r)return s(t[i])||(t[i]={}),void(t[i].enabled=r);if(null===r&&!s(t[i])){if(!n(a))return;t[i]=Tf(a)}if(s(r)){var h=!0;void 0!==r.enabled?h=r.enabled:void 0!==l&&(h=a.enabled),function(t,e,i){s(t[i])||(t[i]={});var o=e[i],n=t[i];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])}(t,e,i),t[i].enabled=h}}}var db={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};function pb(t,e){var i;lp(e)||(e=[e]);var o,n=Dv(t);try{for(n.s();!(o=n.n()).done;){var s=o.value;if(s){i=s[e[0]];for(var r=1;r<e.length;r++)i&&(i=i[e[r]]);if(void 0!==i)break}}}catch(t){n.e(t)}finally{n.f()}return i}var gb={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},fb=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;nl(this,t),this.pixelRatio=e,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return ad(t,[{key:"insertTo",value:function(t){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=t,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker update callback is not a function.");this.updateCallback=t}},{key:"setCloseCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker closing callback is not a function.");this.closeCallback=t}},{key:"_isColorString",value:function(t){if("string"==typeof t)return gb[t]}},{key:"setColor",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("none"!==t){var i,o=this._isColorString(t);if(void 0!==o&&(t=o),!0===zv(t)){if(!0===hb(t)){var n=t.substr(4).substr(0,t.length-5).split(",");i={r:n[0],g:n[1],b:n[2],a:1}}else if(!0===function(t){return Vv.test(t)}(t)){var s=t.substr(5).substr(0,t.length-6).split(",");i={r:s[0],g:s[1],b:s[2],a:s[3]}}else if(!0===lb(t)){var r=eb(t);i={r:r.r,g:r.g,b:r.b,a:1}}}else if(t instanceof Object&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b){var a=void 0!==t.a?t.a:"1.0";i={r:t.r,g:t.g,b:t.b,a}}if(void 0===i)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+kf(t));this._setColor(i,e)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var t=this;!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.previousColor=bo({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",Gf((function(){void 0!==t.closeCallback&&(t.closeCallback(),t.closeCallback=void 0)}),0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(t){!0===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.initialColor=bo({},t)),this.color=t;var e=sb(t.r,t.g,t.b),i=2*Math.PI,o=this.r*e.s,n=this.centerCoordinates.x+o*Math.sin(i*e.h),s=this.centerCoordinates.y+o*Math.cos(i*e.h);this.colorPickerSelector.style.left=n-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=s-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(t)}},{key:"_setOpacity",value:function(t){this.color.a=t/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(t){var e=sb(this.color.r,this.color.g,this.color.b);e.v=t/100;var i=rb(e.h,e.s,e.v);i.a=this.color.a,this.color=i,this._updatePicker()}},{key:"_updatePicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,e=sb(t.r,t.g,t.b),i=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)),i.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var o=this.colorPickerCanvas.clientWidth,n=this.colorPickerCanvas.clientHeight;i.clearRect(0,0,o,n),i.putImageData(this.hueCircle,0,0),i.fillStyle="rgba(0,0,0,"+(1-e.v)+")",i.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),qf(i).call(i),this.brightnessRange.value=100*e.v,this.opacityRange.value=100*t.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var t,e,i,o;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var n=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var s=document.createElement("DIV");s.style.color="red",s.style.fontWeight="bold",s.style.padding="10px",s.innerText="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(s)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(t){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(t){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var r=this;this.opacityRange.onchange=function(){r._setOpacity(this.value)},this.opacityRange.oninput=function(){r._setOpacity(this.value)},this.brightnessRange.onchange=function(){r._setBrightness(this.value)},this.brightnessRange.oninput=function(){r._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerText="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerText="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerText="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerText="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerText="cancel",this.cancelButton.onclick=Fo(t=this._hide).call(t,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerText="apply",this.applyButton.onclick=Fo(e=this._apply).call(e,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerText="save",this.saveButton.onclick=Fo(i=this._save).call(i,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerText="load last",this.loadButton.onclick=Fo(o=this._loadLast).call(o,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var t=this;this.drag={},this.pinch={},this.hammer=new Bv(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("hammer.input",(function(e){e.isFirst&&t._moveSelector(e)})),this.hammer.on("tap",(function(e){t._moveSelector(e)})),this.hammer.on("panstart",(function(e){t._moveSelector(e)})),this.hammer.on("panmove",(function(e){t._moveSelector(e)})),this.hammer.on("panend",(function(e){t._moveSelector(e)}))}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var t=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)),t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var e,i,o,n,s=this.colorPickerCanvas.clientWidth,r=this.colorPickerCanvas.clientHeight;t.clearRect(0,0,s,r),this.centerCoordinates={x:.5*s,y:.5*r},this.r=.49*s;var a,l=2*Math.PI/360,h=1/this.r;for(o=0;o<360;o++)for(n=0;n<this.r;n++)e=this.centerCoordinates.x+n*Math.sin(l*o),i=this.centerCoordinates.y+n*Math.cos(l*o),a=rb(.002777777777777778*o,n*h,1),t.fillStyle="rgb("+a.r+","+a.g+","+a.b+")",t.fillRect(e-.5,i-.5,2,2);t.strokeStyle="rgba(0,0,0,1)",t.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),t.stroke(),this.hueCircle=t.getImageData(0,0,s,r)}this.generated=!0}},{key:"_moveSelector",value:function(t){var e=this.colorPickerDiv.getBoundingClientRect(),i=t.center.x-e.left,o=t.center.y-e.top,n=.5*this.colorPickerDiv.clientHeight,s=.5*this.colorPickerDiv.clientWidth,r=i-s,a=o-n,l=Math.atan2(r,a),h=.98*Math.min(Math.sqrt(r*r+a*a),s),c=Math.cos(l)*h+n,u=Math.sin(l)*h+s;this.colorPickerSelector.style.top=c-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=u-.5*this.colorPickerSelector.clientWidth+"px";var d=l/(2*Math.PI);d=d<0?d+1:d;var p=h/this.r,g=sb(this.color.r,this.color.g,this.color.b);g.h=d,g.s=p;var f=rb(g.h,g.s,g.v);f.a=this.color.a,this.color=f,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),t}();function mb(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<1)throw new TypeError("Invalid arguments.");if(1===e.length)return document.createTextNode(e[0]);var o=document.createElement(e[0]);return o.appendChild(mb.apply(void 0,Yd(ep(e).call(e,1)))),o}var vb,bb=function(){function t(e,i,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return!1};nl(this,t),this.parent=e,this.changedOptions=[],this.container=i,this.allowCreation=!1,this.hideOption=s,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},bo(this.options,this.defaultOptions),this.configureOptions=o,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new fb(n),this.wrapper=void 0}return ad(t,[{key:"setOptions",value:function(t){if(void 0!==t){this.popupHistory={},this._removePopup();var e=!0;if("string"==typeof t)this.options.filter=t;else if(lp(t))this.options.filter=t.join();else if("object"===od(t)){if(null==t)throw new TypeError("options cannot be null");void 0!==t.container&&(this.options.container=t.container),void 0!==Fg(t)&&(this.options.filter=Fg(t)),void 0!==t.showButton&&(this.options.showButton=t.showButton),void 0!==t.enabled&&(e=t.enabled)}else"boolean"==typeof t?(this.options.filter=!0,e=t):"function"==typeof t&&(this.options.filter=t,e=!0);!1===Fg(this.options)&&(e=!1),this.options.enabled=e}this._clean()}},{key:"setModuleOptions",value:function(t){this.moduleOptions=t,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var t=Fg(this.options),e=0,i=!1;for(var o in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,o)&&(this.allowCreation=!1,i=!1,"function"==typeof t?i=(i=t(o,[]))||this._handleObject(this.configureOptions[o],[o],!0):!0!==t&&-1===bf(t).call(t,o)||(i=!0),!1!==i&&(this.allowCreation=!0,e>0&&this._makeItem([]),this._makeHeader(o),this._handleObject(this.configureOptions[o],[o])),e++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var t=0;t<this.domElements.length;t++)this.wrapper.appendChild(this.domElements[t]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var t=0;t<this.domElements.length;t++)this.wrapper.removeChild(this.domElements[t]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(t){for(var e=this.moduleOptions,i=0;i<t.length;i++){if(void 0===e[t[i]]){e=void 0;break}e=e[t[i]]}return e}},{key:"_makeItem",value:function(t){if(!0===this.allowCreation){var e=document.createElement("div");e.className="vis-configuration vis-config-item vis-config-s"+t.length;for(var i=arguments.length,o=new Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return xp(o).call(o,(function(t){e.appendChild(t)})),this.domElements.push(e),this.domElements.length}return 0}},{key:"_makeHeader",value:function(t){var e=document.createElement("div");e.className="vis-configuration vis-config-header",e.innerText=t,this._makeItem([],e)}},{key:"_makeLabel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=document.createElement("div");if(o.className="vis-configuration vis-config-label vis-config-s"+e.length,!0===i){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(mb("i","b",t))}else o.innerText=t+":";return o}},{key:"_makeDropdown",value:function(t,e,i){var o=document.createElement("select");o.className="vis-configuration vis-config-select";var n=0;void 0!==e&&-1!==bf(t).call(t,e)&&(n=bf(t).call(t,e));for(var s=0;s<t.length;s++){var r=document.createElement("option");r.value=t[s],s===n&&(r.selected="selected"),r.innerText=t[s],o.appendChild(r)}var a=this;o.onchange=function(){a._update(this.value,i)};var l=this._makeLabel(i[i.length-1],i);this._makeItem(i,l,o)}},{key:"_makeRange",value:function(t,e,i){var o=t[0],n=t[1],s=t[2],r=t[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=n,a.max=s}catch(t){}a.step=r;var l="",h=0;if(void 0!==e){var c=1.2;e<0&&e*c<n?(a.min=Math.ceil(e*c),h=a.min,l="range increased"):e/c<n&&(a.min=Math.ceil(e/c),h=a.min,l="range increased"),e*c>s&&1!==s&&(a.max=Math.ceil(e*c),h=a.max,l="range increased"),a.value=e}else a.value=o;var u=document.createElement("input");u.className="vis-configuration vis-config-rangeinput",u.value=a.value;var d=this;a.onchange=function(){u.value=this.value,d._update(Number(this.value),i)},a.oninput=function(){u.value=this.value};var p=this._makeLabel(i[i.length-1],i),g=this._makeItem(i,p,a,u);""!==l&&this.popupHistory[g]!==h&&(this.popupHistory[g]=h,this._setupPopup(l,g))}},{key:"_makeButton",value:function(){var t=this;if(!0===this.options.showButton){var e=document.createElement("div");e.className="vis-configuration vis-config-button",e.innerText="generate options",e.onclick=function(){t._printOptions()},e.onmouseover=function(){e.className="vis-configuration vis-config-button hover"},e.onmouseout=function(){e.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(e)}}},{key:"_setupPopup",value:function(t,e){var i=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var o=document.createElement("div");o.id="vis-configuration-popup",o.className="vis-configuration-popup",o.innerText=t,o.onclick=function(){i._removePopup()},this.popupCounter+=1,this.popupDiv={html:o,index:e}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var t=this;if(void 0!==this.popupDiv.html){var e=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=e.left+"px",this.popupDiv.html.style.top=e.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=Gf((function(){t.popupDiv.html.style.opacity=0}),1500),this.popupDiv.deleteTimeout=Gf((function(){t._removePopup()}),1800)}}},{key:"_makeCheckbox",value:function(t,e,i){var o=document.createElement("input");o.type="checkbox",o.className="vis-configuration vis-config-checkbox",o.checked=t,void 0!==e&&(o.checked=e,e!==t&&("object"===od(t)?e!==t.enabled&&this.changedOptions.push({path:i,value:e}):this.changedOptions.push({path:i,value:e})));var n=this;o.onchange=function(){n._update(this.checked,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,o)}},{key:"_makeTextInput",value:function(t,e,i){var o=document.createElement("input");o.type="text",o.className="vis-configuration vis-config-text",o.value=e,e!==t&&this.changedOptions.push({path:i,value:e});var n=this;o.onchange=function(){n._update(this.value,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,o)}},{key:"_makeColorField",value:function(t,e,i){var o=this,n=t[1],s=document.createElement("div");"none"!==(e=void 0===e?n:e)?(s.className="vis-configuration vis-config-colorBlock",s.style.backgroundColor=e):s.className="vis-configuration vis-config-colorBlock none",e=void 0===e?n:e,s.onclick=function(){o._showColorPicker(e,s,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,s)}},{key:"_showColorPicker",value:function(t,e,i){var o=this;e.onclick=function(){},this.colorPicker.insertTo(e),this.colorPicker.show(),this.colorPicker.setColor(t),this.colorPicker.setUpdateCallback((function(t){var n="rgba("+t.r+","+t.g+","+t.b+","+t.a+")";e.style.backgroundColor=n,o._update(n,i)})),this.colorPicker.setCloseCallback((function(){e.onclick=function(){o._showColorPicker(t,e,i)}}))}},{key:"_handleObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,n=Fg(this.options),s=!1;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){o=!0;var a=t[r],l=Zv(e,r);if("function"==typeof n&&!1===(o=n(r,e))&&!lp(a)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,o=this._handleObject(a,l,!0),this.allowCreation=!1===i),!1!==o){s=!0;var h=this._getValue(l);if(lp(a))this._handleArray(a,h,l);else if("string"==typeof a)this._makeTextInput(a,h,l);else if("boolean"==typeof a)this._makeCheckbox(a,h,l);else if(a instanceof Object){if(!this.hideOption(e,r,this.moduleOptions))if(void 0!==a.enabled){var c=Zv(l,"enabled"),u=this._getValue(c);if(!0===u){var d=this._makeLabel(r,l,!0);this._makeItem(l,d),s=this._handleObject(a,l)||s}else this._makeCheckbox(a,u,l)}else{var p=this._makeLabel(r,l,!0);this._makeItem(l,p),s=this._handleObject(a,l)||s}}else console.error("dont know how to handle",a,r,l)}}return s}},{key:"_handleArray",value:function(t,e,i){"string"==typeof t[0]&&"color"===t[0]?(this._makeColorField(t,e,i),t[1]!==e&&this.changedOptions.push({path:i,value:e})):"string"==typeof t[0]?(this._makeDropdown(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:e})):"number"==typeof t[0]&&(this._makeRange(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:Number(e)}))}},{key:"_update",value:function(t,e){var i=this._constructOptions(t,e);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",i),this.initialized=!0,this.parent.setOptions(i)}},{key:"_constructOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i;t="false"!==(t="true"===t||t)&&t;for(var n=0;n<e.length;n++)"global"!==e[n]&&(void 0===o[e[n]]&&(o[e[n]]={}),n!==e.length-1?o=o[e[n]]:o[e[n]]=t);return i}},{key:"_printOptions",value:function(){for(var t=this.getOptions();this.optionsContainer.firstChild;)this.optionsContainer.removeChild(this.optionsContainer.firstChild);this.optionsContainer.appendChild(mb("pre","const options = "+kf(t,null,2)))}},{key:"getOptions",value:function(){for(var t={},e=0;e<this.changedOptions.length;e++)this._constructOptions(this.changedOptions[e].value,this.changedOptions[e].path,t);return t}}]),t}(),_b=function(){function t(e,i){nl(this,t),this.container=e,this.overflowMethod=i||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return ad(t,[{key:"setPosition",value:function(t,e){this.x=lf(t),this.y=lf(e)}},{key:"setText",value:function(t){if(t instanceof Element){for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(t)}else this.frame.innerText=t}},{key:"show",value:function(t){if(void 0===t&&(t=!0),!0===t){var e=this.frame.clientHeight,i=this.frame.clientWidth,o=this.frame.parentNode.clientHeight,n=this.frame.parentNode.clientWidth,s=0,r=0;if("flip"==this.overflowMethod){var a=!1,l=!0;this.y-e<this.padding&&(l=!1),this.x+i>n-this.padding&&(a=!0),s=a?this.x-i:this.x,r=l?this.y-e:this.y}else(r=this.y-e)+e+this.padding>o&&(r=o-e-this.padding),r<this.padding&&(r=this.padding),(s=this.x)+i+this.padding>n&&(s=n-i-this.padding),s<this.padding&&(s=this.padding);this.frame.style.left=s+"px",this.frame.style.top=r+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),t}(),yb=!1,Tb="background: #FFeeee; color: #dd0000",Eb=function(){function t(){nl(this,t)}return ad(t,null,[{key:"validate",value:function(e,i,o){yb=!1,vb=i;var n=i;return void 0!==o&&(n=i[o]),t.parse(e,n,[]),yb}},{key:"parse",value:function(e,i,o){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.check(n,e,i,o)}},{key:"check",value:function(e,i,o,n){if(void 0!==o[e]||void 0!==o.__any__){var s=e,r=!0;void 0===o[e]&&void 0!==o.__any__&&(s="__any__",r="object"===t.getType(i[e]));var a=o[s];r&&void 0!==a.__type__&&(a=a.__type__),t.checkFields(e,i,o,s,a,n)}else t.getSuggestion(e,o,n)}},{key:"checkFields",value:function(e,i,o,n,s,r){var a=function(i){console.error("%c"+i+t.printLocation(r,e),Tb)},l=t.getType(i[e]),h=s[l];void 0!==h?"array"===t.getType(h)&&-1===bf(h).call(h,i[e])?(a('Invalid option detected in "'+e+'". Allowed values are:'+t.print(h)+' not "'+i[e]+'". '),yb=!0):"object"===l&&"__any__"!==n&&(r=Zv(r,e),t.parse(i[e],o[n],r)):void 0===s.any&&(a('Invalid type received for "'+e+'". Expected: '+t.print(vp(s))+". Received ["+l+'] "'+i[e]+'"'),yb=!0)}},{key:"getType",value:function(t){var e=od(t);return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":lp(t)?"array":t instanceof Date?"date":void 0!==t.nodeType?"dom":!0===t._isAMomentObject?"moment":"object":"number"===e?"number":"boolean"===e?"boolean":"string"===e?"string":void 0===e?"undefined":e}},{key:"getSuggestion",value:function(e,i,o){var n,s=t.findInOptions(e,i,o,!1),r=t.findInOptions(e,vb,[],!0);n=void 0!==s.indexMatch?" in "+t.printLocation(s.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+s.indexMatch+'"?\n\n':r.distance<=4&&s.distance>r.distance?" in "+t.printLocation(s.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+t.printLocation(r.path,r.closestMatch,""):s.distance<=8?'. Did you mean "'+s.closestMatch+'"?'+t.printLocation(s.path,e):". Did you mean one of these: "+t.print(vp(i))+t.printLocation(o,e),console.error('%cUnknown option detected: "'+e+'"'+n,Tb),yb=!0}},{key:"findInOptions",value:function(e,i,o){var n,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,a="",l=[],h=e.toLowerCase(),c=void 0;for(var u in i){var d=void 0;if(void 0!==i[u].__type__&&!0===s){var p=t.findInOptions(e,i[u],Zv(o,u));r>p.distance&&(a=p.closestMatch,l=p.path,r=p.distance,c=p.indexMatch)}else{var g;-1!==bf(g=u.toLowerCase()).call(g,h)&&(c=u),r>(d=t.levenshteinDistance(e,u))&&(a=u,l=ep(n=o).call(n),r=d)}}return{closestMatch:a,path:l,distance:r,indexMatch:c}}},{key:"printLocation",value:function(t,e){for(var i="\n\n"+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n")+"options = {\n",o=0;o<t.length;o++){for(var n=0;n<o+1;n++)i+="  ";i+=t[o]+": {\n"}for(var s=0;s<t.length+1;s++)i+="  ";i+=e+"\n";for(var r=0;r<t.length+1;r++){for(var a=0;a<t.length-r;a++)i+="  ";i+="}\n"}return i+"\n\n"}},{key:"print",value:function(t){return kf(t).replace(/(")|(\[)|(\])|(,"__type__")/g,"").replace(/(,)/g,", ")}},{key:"levenshteinDistance",value:function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,o,n=[];for(i=0;i<=e.length;i++)n[i]=[i];for(o=0;o<=t.length;o++)n[0][o]=o;for(i=1;i<=e.length;i++)for(o=1;o<=t.length;o++)e.charAt(i-1)==t.charAt(o-1)?n[i][o]=n[i-1][o-1]:n[i][o]=Math.min(n[i-1][o-1]+1,Math.min(n[i][o-1]+1,n[i-1][o]+1));return n[e.length][t.length]}}]),t}(),wb=Fv,kb=bb,Ib=Bv,$b=_b,Sb=Tb,Cb=Eb;function Ob(t){return Lb=t,function(){var t={};if(Db=0,Nb=Lb.charAt(0),Xb(),"strict"===Pb&&(t.strict=!0,Xb()),"graph"!==Pb&&"digraph"!==Pb||(t.type=Pb,Xb()),Bb===Mb.IDENTIFIER&&(t.id=Pb,Xb()),"{"!=Pb)throw Qb("Angle bracket { expected");if(Xb(),Yb(t),"}"!=Pb)throw Qb("Angle bracket } expected");if(Xb(),""!==Pb)throw Qb("End of file expected");return Xb(),delete t.node,delete t.edge,delete t.graph,t}()}var Rb={fontsize:"font.size",fontcolor:"font.color",labelfontcolor:"font.color",fontname:"font.face",color:["color.border","color.background"],fillcolor:"color.background",tooltip:"title",labeltooltip:"title"},Ab=Tf(Rb);Ab.color="color.color",Ab.style="dashes";var Mb={NULL:0,DELIMITER:1,IDENTIFIER:2,UNKNOWN:3},xb={"{":!0,"}":!0,"[":!0,"]":!0,";":!0,"=":!0,",":!0,"->":!0,"--":!0},Lb="",Db=0,Nb="",Pb="",Bb=Mb.NULL;function Fb(){Db++,Nb=Lb.charAt(Db)}function Hb(){return Lb.charAt(Db+1)}function Ub(t){var e=t.charCodeAt(0);return e<47?35===e||46===e:e<59?e>47:e<91?e>64:e<96?95===e:e<123&&e>96}function Gb(t,e){if(t||(t={}),e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function Vb(t,e,i){for(var o=e.split("."),n=t;o.length;){var s=o.shift();o.length?(n[s]||(n[s]={}),n=n[s]):n[s]=i}}function Wb(t,e){for(var i,o,n=null,s=[t],r=t;r.parent;)s.push(r.parent),r=r.parent;if(r.nodes)for(i=0,o=r.nodes.length;i<o;i++)if(e.id===r.nodes[i].id){n=r.nodes[i];break}for(n||(n={id:e.id},t.node&&(n.attr=Gb(n.attr,t.node))),i=s.length-1;i>=0;i--){var a,l=s[i];l.nodes||(l.nodes=[]),-1===bf(a=l.nodes).call(a,n)&&l.nodes.push(n)}e.attr&&(n.attr=Gb(n.attr,e.attr))}function zb(t,e){if(t.edges||(t.edges=[]),t.edges.push(e),t.edge){var i=Gb({},t.edge);e.attr=Gb(i,e.attr)}}function jb(t,e,i,o,n){var s={from:e,to:i,type:o};return t.edge&&(s.attr=Gb({},t.edge)),s.attr=Gb(s.attr||{},n),null!=n&&n.hasOwnProperty("arrows")&&null!=n.arrows&&(s.arrows={to:{enabled:!0,type:n.arrows.type}},n.arrows=null),s}function Xb(){for(Bb=Mb.NULL,Pb="";" "===Nb||"\t"===Nb||"\n"===Nb||"\r"===Nb;)Fb();do{var t=!1;if("#"===Nb){for(var e=Db-1;" "===Lb.charAt(e)||"\t"===Lb.charAt(e);)e--;if("\n"===Lb.charAt(e)||""===Lb.charAt(e)){for(;""!=Nb&&"\n"!=Nb;)Fb();t=!0}}if("/"===Nb&&"/"===Hb()){for(;""!=Nb&&"\n"!=Nb;)Fb();t=!0}if("/"===Nb&&"*"===Hb()){for(;""!=Nb;){if("*"===Nb&&"/"===Hb()){Fb(),Fb();break}Fb()}t=!0}for(;" "===Nb||"\t"===Nb||"\n"===Nb||"\r"===Nb;)Fb()}while(t);if(""!==Nb){var i=Nb+Hb();if(xb[i])return Bb=Mb.DELIMITER,Pb=i,Fb(),void Fb();if(xb[Nb])return Bb=Mb.DELIMITER,Pb=Nb,void Fb();if(Ub(Nb)||"-"===Nb){for(Pb+=Nb,Fb();Ub(Nb);)Pb+=Nb,Fb();return"false"===Pb?Pb=!1:"true"===Pb?Pb=!0:isNaN(Number(Pb))||(Pb=Number(Pb)),void(Bb=Mb.IDENTIFIER)}if('"'===Nb){for(Fb();""!=Nb&&('"'!=Nb||'"'===Nb&&'"'===Hb());)'"'===Nb?(Pb+=Nb,Fb()):"\\"===Nb&&"n"===Hb()?(Pb+="\n",Fb()):Pb+=Nb,Fb();if('"'!=Nb)throw Qb('End of string " expected');return Fb(),void(Bb=Mb.IDENTIFIER)}for(Bb=Mb.UNKNOWN;""!=Nb;)Pb+=Nb,Fb();throw new SyntaxError('Syntax error in part "'+t_(Pb,30)+'"')}Bb=Mb.DELIMITER}function Yb(t){for(;""!==Pb&&"}"!=Pb;)Kb(t),";"===Pb&&Xb()}function Kb(t){var e=Jb(t);if(e)qb(t,e);else{var i=function(t){return"node"===Pb?(Xb(),t.node=Zb(),"node"):"edge"===Pb?(Xb(),t.edge=Zb(),"edge"):"graph"===Pb?(Xb(),t.graph=Zb(),"graph"):null}(t);if(!i){if(Bb!=Mb.IDENTIFIER)throw Qb("Identifier expected");var o=Pb;if(Xb(),"="===Pb){if(Xb(),Bb!=Mb.IDENTIFIER)throw Qb("Identifier expected");t[o]=Pb,Xb()}else!function(t,e){var i={id:e},o=Zb();o&&(i.attr=o),Wb(t,i),qb(t,e)}(t,o)}}}function Jb(t){var e=null;if("subgraph"===Pb&&((e={}).type="subgraph",Xb(),Bb===Mb.IDENTIFIER&&(e.id=Pb,Xb())),"{"===Pb){if(Xb(),e||(e={}),e.parent=t,e.node=t.node,e.edge=t.edge,e.graph=t.graph,Yb(e),"}"!=Pb)throw Qb("Angle bracket } expected");Xb(),delete e.node,delete e.edge,delete e.graph,delete e.parent,t.subgraphs||(t.subgraphs=[]),t.subgraphs.push(e)}return e}function qb(t,e){for(;"->"===Pb||"--"===Pb;){var i,o=Pb;Xb();var n=Jb(t);if(n)i=n;else{if(Bb!=Mb.IDENTIFIER)throw Qb("Identifier or subgraph expected");Wb(t,{id:i=Pb}),Xb()}zb(t,jb(t,e,i,o,Zb())),e=i}}function Zb(){for(var t,e,i=null,o={dashed:!0,solid:!1,dotted:[1,5]},n={dot:"circle",box:"box",crow:"crow",curve:"curve",icurve:"inv_curve",normal:"triangle",inv:"inv_triangle",diamond:"diamond",tee:"bar",vee:"vee"},s=new Array,r=new Array;"["===Pb;){for(Xb(),i={};""!==Pb&&"]"!=Pb;){if(Bb!=Mb.IDENTIFIER)throw Qb("Attribute name expected");var a=Pb;if(Xb(),"="!=Pb)throw Qb("Equal sign = expected");if(Xb(),Bb!=Mb.IDENTIFIER)throw Qb("Attribute value expected");var l=Pb;"style"===a&&(l=o[l]),"arrowhead"===a&&(a="arrows",l={to:{enabled:!0,type:n[l]}}),"arrowtail"===a&&(a="arrows",l={from:{enabled:!0,type:n[l]}}),s.push({attr:i,name:a,value:l}),r.push(a),Xb(),","==Pb&&Xb()}if("]"!=Pb)throw Qb("Bracket ] expected");Xb()}if(Cg(r).call(r,"dir")){var h={arrows:{}};for(t=0;t<s.length;t++)if("arrows"===s[t].name)if(null!=s[t].value.to)h.arrows.to=t;else{if(null==s[t].value.from)throw Qb("Invalid value of arrows");h.arrows.from=t}else"dir"===s[t].name&&(h.dir=t);var c,u,d=s[h.dir].value;if(!Cg(r).call(r,"arrows"))if("both"===d)s.push({attr:s[h.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),h.arrows.to=s.length-1,s.push({attr:s[h.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),h.arrows.from=s.length-1;else if("forward"===d)s.push({attr:s[h.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),h.arrows.to=s.length-1;else if("back"===d)s.push({attr:s[h.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),h.arrows.from=s.length-1;else{if("none"!==d)throw Qb('Invalid dir type "'+d+'"');s.push({attr:s[h.dir].attr,name:"arrows",value:""}),h.arrows.to=s.length-1}if("both"===d)h.arrows.to&&h.arrows.from?(u=s[h.arrows.to].value.to.type,c=s[h.arrows.from].value.from.type,s[h.arrows.to]={attr:s[h.arrows.to].attr,name:s[h.arrows.to].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}},hg(s).call(s,h.arrows.from,1)):h.arrows.to?(u=s[h.arrows.to].value.to.type,c="arrow",s[h.arrows.to]={attr:s[h.arrows.to].attr,name:s[h.arrows.to].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}}):h.arrows.from&&(u="arrow",c=s[h.arrows.from].value.from.type,s[h.arrows.from]={attr:s[h.arrows.from].attr,name:s[h.arrows.from].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}});else if("back"===d)h.arrows.to&&h.arrows.from?(u="",c=s[h.arrows.from].value.from.type,s[h.arrows.from]={attr:s[h.arrows.from].attr,name:s[h.arrows.from].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}}):h.arrows.to?(u="",c="arrow",h.arrows.from=h.arrows.to,s[h.arrows.from]={attr:s[h.arrows.from].attr,name:s[h.arrows.from].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}}):h.arrows.from&&(u="",c=s[h.arrows.from].value.from.type,s[h.arrows.to]={attr:s[h.arrows.from].attr,name:s[h.arrows.from].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}}),s[h.arrows.from]={attr:s[h.arrows.from].attr,name:s[h.arrows.from].name,value:{from:{enabled:!0,type:s[h.arrows.from].value.from.type}}};else if("none"===d){var p;s[p=h.arrows.to?h.arrows.to:h.arrows.from]={attr:s[p].attr,name:s[p].name,value:""}}else{if("forward"!==d)throw Qb('Invalid dir type "'+d+'"');h.arrows.to&&h.arrows.from||h.arrows.to?(u=s[h.arrows.to].value.to.type,c="",s[h.arrows.to]={attr:s[h.arrows.to].attr,name:s[h.arrows.to].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}}):h.arrows.from&&(u="arrow",c="",h.arrows.to=h.arrows.from,s[h.arrows.to]={attr:s[h.arrows.to].attr,name:s[h.arrows.to].name,value:{to:{enabled:!0,type:u},from:{enabled:!0,type:c}}}),s[h.arrows.to]={attr:s[h.arrows.to].attr,name:s[h.arrows.to].name,value:{to:{enabled:!0,type:s[h.arrows.to].value.to.type}}}}hg(s).call(s,h.dir,1)}if(Cg(r).call(r,"penwidth")){var g=[];for(e=s.length,t=0;t<e;t++)"width"!==s[t].name&&("penwidth"===s[t].name&&(s[t].name="width"),g.push(s[t]));s=g}for(e=s.length,t=0;t<e;t++)Vb(s[t].attr,s[t].name,s[t].value);return i}function Qb(t){return new SyntaxError(t+', got "'+t_(Pb,30)+'" (char '+Db+")")}function t_(t,e){return t.length<=e?t:t.substr(0,27)+"..."}function e_(t,e,i){for(var o=e.split("."),n=o.pop(),s=t,r=0;r<o.length;r++){var a=o[r];a in s||(s[a]={}),s=s[a]}return s[n]=i,t}function i_(t,e){var i={};for(var o in t)if(t.hasOwnProperty(o)){var n=e[o];lp(n)?xp(n).call(n,(function(e){e_(i,e,t[o])})):e_(i,"string"==typeof n?n:o,t[o])}return i}function o_(t){var e,i=Ob(t),o={nodes:[],edges:[],options:{}};if(i.nodes&&xp(e=i.nodes).call(e,(function(t){var e={id:t.id,label:String(t.label||t.id)};Gb(e,i_(t.attr,Rb)),e.image&&(e.shape="image"),o.nodes.push(e)})),i.edges){var n,s=function(t){var e={from:t.from,to:t.to};return Gb(e,i_(t.attr,Ab)),null==e.arrows&&"->"===t.type&&(e.arrows="to"),e};xp(n=i.edges).call(n,(function(t){var e,i,n,r,a,l,h;e=t.from instanceof Object?t.from.nodes:{id:t.from},i=t.to instanceof Object?t.to.nodes:{id:t.to},t.from instanceof Object&&t.from.edges&&xp(n=t.from.edges).call(n,(function(t){var e=s(t);o.edges.push(e)})),a=i,l=function(e,i){var n=jb(o,e.id,i.id,t.type,t.attr),r=s(n);o.edges.push(r)},lp(r=e)?xp(r).call(r,(function(t){lp(a)?xp(a).call(a,(function(e){l(t,e)})):l(t,a)})):lp(a)?xp(a).call(a,(function(t){l(r,t)})):l(r,a),t.to instanceof Object&&t.to.edges&&xp(h=t.to.edges).call(h,(function(t){var e=s(t);o.edges.push(e)}))}))}return i.attr&&(o.options=i.attr),o}var n_=Object.freeze({__proto__:null,DOTToGraph:o_,parseDOT:Ob});function s_(t,e){var i,o={edges:{inheritColor:!1},nodes:{fixed:!1,parseColor:!1}};null!=e&&(null!=e.fixed&&(o.nodes.fixed=e.fixed),null!=e.parseColor&&(o.nodes.parseColor=e.parseColor),null!=e.inheritColor&&(o.edges.inheritColor=e.inheritColor));var n=t.edges,s=gp(n).call(n,(function(t){var e={from:t.source,id:t.id,to:t.target};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),"Directed"===t.type&&(e.arrows="to"),t.color&&!1===o.edges.inheritColor&&(e.color=t.color),e}));return{nodes:gp(i=t.nodes).call(i,(function(t){var e={id:t.id,fixed:o.nodes.fixed&&null!=t.x&&null!=t.y};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.size&&(e.size=t.size),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),null!=t.title&&(e.title=t.title),null!=t.x&&(e.x=t.x),null!=t.y&&(e.y=t.y),null!=t.color&&(!0===o.nodes.parseColor?e.color=t.color:e.color={background:t.color,border:t.color,highlight:{background:t.color,border:t.color},hover:{background:t.color,border:t.color}}),e})),edges:s}}var r_=Object.freeze({__proto__:null,parseGephi:s_}),a_=Object.freeze({__proto__:null,cn:{addDescription:"åå»ç©ºç½å¤æ¾ç½®æ°èç¹ã",addEdge:"æ·»å è¿æ¥çº¿",addNode:"æ·»å èç¹",back:"è¿å",close:"éé",createEdgeError:"æ æ³å°è¿æ¥çº¿è¿æ¥å°ç¾¤éã",del:"å é¤éå®",deleteClusterError:"æ æ³å é¤ç¾¤éã",edgeDescription:"åå»æä¸ªèç¹å¹¶å°è¯¥è¿æ¥çº¿æå¨å°å¦ä¸ä¸ªèç¹ä»¥è¿æ¥å®ä»¬ã",edit:"ç¼è¾",editClusterError:"æ æ³ç¼è¾ç¾¤éã",editEdge:"ç¼è¾è¿æ¥çº¿",editEdgeDescription:"åå»æ§å¶èç¹å¹¶å°å®ä»¬æå°èç¹ä¸è¿æ¥ã",editNode:"ç¼è¾èç¹"},cs:{addDescription:"KluknutÃ­m do prÃ¡zdnÃ©ho prostoru mÅ¯Å¾ete pÅidat novÃ½ vrchol.",addEdge:"PÅidat hranu",addNode:"PÅidat vrchol",back:"ZpÄt",close:"ZavÅÃ­t",createEdgeError:"Nelze pÅipojit hranu ke shluku.",del:"Smazat vÃ½bÄr",deleteClusterError:"Nelze mazat shluky.",edgeDescription:"PÅetaÅ¾enÃ­m z jednoho vrcholu do druhÃ©ho mÅ¯Å¾ete spojit tyto vrcholy novou hranou.",edit:"Upravit",editClusterError:"Nelze upravovat shluky.",editEdge:"Upravit hranu",editEdgeDescription:"PÅetaÅ¾enÃ­m kontrolnÃ­ho vrcholu hrany ji mÅ¯Å¾ete pÅipojit k jinÃ©mu vrcholu.",editNode:"Upravit vrchol"},de:{addDescription:"Klicke auf eine freie Stelle, um einen neuen Knoten zu plazieren.",addEdge:"Kante hinzufÃ¼gen",addNode:"Knoten hinzufÃ¼gen",back:"ZurÃ¼ck",close:"SchlieÃen",createEdgeError:"Es ist nicht mÃ¶glich, Kanten mit Clustern zu verbinden.",del:"LÃ¶sche Auswahl",deleteClusterError:"Cluster kÃ¶nnen nicht gelÃ¶scht werden.",edgeDescription:"Klicke auf einen Knoten und ziehe die Kante zu einem anderen Knoten, um diese zu verbinden.",edit:"Editieren",editClusterError:"Cluster kÃ¶nnen nicht editiert werden.",editEdge:"Kante editieren",editEdgeDescription:"Klicke auf die Verbindungspunkte und ziehe diese auf einen Knoten, um sie zu verbinden.",editNode:"Knoten editieren"},en:{addDescription:"Click in an empty space to place a new node.",addEdge:"Add Edge",addNode:"Add Node",back:"Back",close:"Close",createEdgeError:"Cannot link edges to a cluster.",del:"Delete selected",deleteClusterError:"Clusters cannot be deleted.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",edit:"Edit",editClusterError:"Clusters cannot be edited.",editEdge:"Edit Edge",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",editNode:"Edit Node"},es:{addDescription:"Haga clic en un lugar vacÃ­o para colocar un nuevo nodo.",addEdge:"AÃ±adir arista",addNode:"AÃ±adir nodo",back:"AtrÃ¡s",close:"Cerrar",createEdgeError:"No se puede conectar una arista a un grupo.",del:"Eliminar selecciÃ³n",deleteClusterError:"No es posible eliminar grupos.",edgeDescription:"Haga clic en un nodo y arrastre la arista hacia otro nodo para conectarlos.",edit:"Editar",editClusterError:"No es posible editar grupos.",editEdge:"Editar arista",editEdgeDescription:"Haga clic en un punto de control y arrastrelo a un nodo para conectarlo.",editNode:"Editar nodo"},fr:{addDescription:"Cliquez dans un endroit vide pour placer un nÅud.",addEdge:"Ajouter un lien",addNode:"Ajouter un nÅud",back:"Retour",close:"Fermer",createEdgeError:"Impossible de crÃ©er un lien vers un cluster.",del:"Effacer la sÃ©lection",deleteClusterError:"Les clusters ne peuvent pas Ãªtre effacÃ©s.",edgeDescription:"Cliquez sur un nÅud et glissez le lien vers un autre nÅud pour les connecter.",edit:"Ãditer",editClusterError:"Les clusters ne peuvent pas Ãªtre Ã©ditÃ©s.",editEdge:"Ãditer le lien",editEdgeDescription:"Cliquez sur les points de contrÃ´le et glissez-les pour connecter un nÅud.",editNode:"Ãditer le nÅud"},it:{addDescription:"Clicca per aggiungere un nuovo nodo",addEdge:"Aggiungi un vertice",addNode:"Aggiungi un nodo",back:"Indietro",close:"Chiudere",createEdgeError:"Non si possono collegare vertici ad un cluster",del:"Cancella la selezione",deleteClusterError:"I cluster non possono essere cancellati",edgeDescription:"Clicca su un nodo e trascinalo ad un altro nodo per connetterli.",edit:"Modifica",editClusterError:"I clusters non possono essere modificati.",editEdge:"Modifica il vertice",editEdgeDescription:"Clicca sui Punti di controllo e trascinali ad un nodo per connetterli.",editNode:"Modifica il nodo"},nl:{addDescription:"Klik op een leeg gebied om een nieuwe node te maken.",addEdge:"Link toevoegen",addNode:"Node toevoegen",back:"Terug",close:"Sluiten",createEdgeError:"Kan geen link maken naar een cluster.",del:"Selectie verwijderen",deleteClusterError:"Clusters kunnen niet worden verwijderd.",edgeDescription:"Klik op een node en sleep de link naar een andere node om ze te verbinden.",edit:"Wijzigen",editClusterError:"Clusters kunnen niet worden aangepast.",editEdge:"Link wijzigen",editEdgeDescription:"Klik op de verbindingspunten en sleep ze naar een node om daarmee te verbinden.",editNode:"Node wijzigen"},pt:{addDescription:"Clique em um espaÃ§o em branco para adicionar um novo nÃ³",addEdge:"Adicionar aresta",addNode:"Adicionar nÃ³",back:"Voltar",close:"Fechar",createEdgeError:"NÃ£o foi possÃ­vel linkar arestas a um cluster.",del:"Remover selecionado",deleteClusterError:"Clusters nÃ£o puderam ser removidos.",edgeDescription:"Clique em um nÃ³ e arraste a aresta atÃ© outro nÃ³ para conectÃ¡-los",edit:"Editar",editClusterError:"Clusters nÃ£o puderam ser editados.",editEdge:"Editar aresta",editEdgeDescription:"Clique nos pontos de controle e os arraste para um nÃ³ para conectÃ¡-los",editNode:"Editar nÃ³"},ru:{addDescription:"ÐÐ»Ð¸ÐºÐ½Ð¸ÑÐµ Ð² ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑÐ¾, ÑÑÐ¾Ð±Ñ Ð´Ð¾Ð±Ð°Ð²Ð¸ÑÑ Ð½Ð¾Ð²ÑÐ¹ ÑÐ·ÐµÐ».",addEdge:"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÐµÐ±ÑÐ¾",addNode:"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÐ·ÐµÐ»",back:"ÐÐ°Ð·Ð°Ð´",close:"ÐÐ°ÐºÑÑÐ²Ð°ÑÑ",createEdgeError:"ÐÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ¾ÐµÐ´Ð¸Ð½Ð¸ÑÑ ÑÐµÐ±ÑÐ° Ð² ÐºÐ»Ð°ÑÑÐµÑ.",del:"Ð£Ð´Ð°Ð»Ð¸ÑÑ Ð²ÑÐ±ÑÐ°Ð½Ð½Ð¾Ðµ",deleteClusterError:"ÐÐ»Ð°ÑÑÐµÑÑ Ð½Ðµ Ð¼Ð¾Ð³ÑÑ Ð±ÑÑÑ ÑÐ´Ð°Ð»ÐµÐ½Ñ",edgeDescription:"ÐÐ»Ð¸ÐºÐ½Ð¸ÑÐµ Ð½Ð° ÑÐ·ÐµÐ» Ð¸ Ð¿ÑÐ¾ÑÑÐ½Ð¸ÑÐµ ÑÐµÐ±ÑÐ¾ Ðº Ð´ÑÑÐ³Ð¾Ð¼Ñ ÑÐ·Ð»Ñ, ÑÑÐ¾Ð±Ñ ÑÐ¾ÐµÐ´Ð¸Ð½Ð¸ÑÑ Ð¸Ñ.",edit:"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ",editClusterError:"ÐÐ»Ð°ÑÑÐµÑÑ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿Ð½Ñ Ð´Ð»Ñ ÑÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸Ñ.",editEdge:"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ ÑÐµÐ±ÑÐ¾",editEdgeDescription:"ÐÐ»Ð¸ÐºÐ½Ð¸ÑÐµ Ð½Ð° ÐºÐ¾Ð½ÑÑÐ¾Ð»ÑÐ½ÑÐµ ÑÐ¾ÑÐºÐ¸ Ð¸ Ð¿ÐµÑÐµÑÐ°ÑÐ¸ÑÐµ Ð¸Ñ Ð² ÑÐ·ÐµÐ», ÑÑÐ¾Ð±Ñ Ð¿Ð¾Ð´ÐºÐ»ÑÑÐ¸ÑÑÑÑ Ðº Ð½ÐµÐ¼Ñ.",editNode:"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ ÑÐ·ÐµÐ»"},uk:{addDescription:"KÐ»ÑÐºÐ½ÑÑÑ Ð½Ð° Ð²ÑÐ»ÑÐ½Ðµ Ð¼ÑÑÑÐµ, ÑÐ¾Ð± Ð´Ð¾Ð´Ð°ÑÐ¸ Ð½Ð¾Ð²Ð¸Ð¹ Ð²ÑÐ·Ð¾Ð».",addEdge:"ÐÐ¾Ð´Ð°ÑÐ¸ ÐºÑÐ°Ð¹",addNode:"ÐÐ¾Ð´Ð°ÑÐ¸ Ð²ÑÐ·Ð¾Ð»",back:"ÐÐ°Ð·Ð°Ð´",close:"ÐÐ°ÐºÑÐ¸ÑÐ¸",createEdgeError:"ÐÐµ Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ð¾ Ð¾Ð±'ÑÐ´Ð½Ð°ÑÐ¸ ÐºÑÐ°Ñ Ð² Ð³ÑÑÐ¿Ñ.",del:"ÐÐ¸Ð´Ð°Ð»Ð¸ÑÐ¸ Ð¾Ð±ÑÐ°Ð½Ðµ",deleteClusterError:"ÐÑÑÐ¿Ð¸ Ð½Ðµ Ð¼Ð¾Ð¶ÑÑÑ Ð±ÑÑÐ¸ Ð²Ð¸Ð´Ð°Ð»ÐµÐ½Ñ.",edgeDescription:"ÐÐ»ÑÐºÐ½ÑÑÑ Ð½Ð° Ð²ÑÐ·Ð¾Ð» Ñ Ð¿ÐµÑÐµÑÑÐ³Ð½ÑÑÑ ÐºÑÐ°Ð¹ Ð´Ð¾ ÑÐ½ÑÐ¾Ð³Ð¾ Ð²ÑÐ·Ð»Ð°, ÑÐ¾Ð± ÑÑ Ð·'ÑÐ´Ð½Ð°ÑÐ¸.",edit:"Ð ÐµÐ´Ð°Ð³ÑÐ²Ð°ÑÐ¸",editClusterError:"ÐÑÑÐ¿Ð¸ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿Ð½Ñ Ð´Ð»Ñ ÑÐµÐ´Ð°Ð³ÑÐ²Ð°Ð½Ð½Ñ.",editEdge:"Ð ÐµÐ´Ð°Ð³ÑÐ²Ð°ÑÐ¸ ÐºÑÐ°Ð¹",editEdgeDescription:"ÐÐ»ÑÐºÐ½ÑÑÑ Ð½Ð° ÐºÐ¾Ð½ÑÑÐ¾Ð»ÑÐ½Ñ ÑÐ¾ÑÐºÐ¸ Ñ Ð¿ÐµÑÐµÑÑÐ³Ð½ÑÑÑ ÑÑ Ñ Ð²ÑÐ·Ð¾Ð», ÑÐ¾Ð± Ð¿ÑÐ´ÐºÐ»ÑÑÐ¸ÑÐ¸ÑÑ Ð´Ð¾ Ð½ÑÐ¾Ð³Ð¾.",editNode:"Ð ÐµÐ´Ð°Ð³ÑÐ²Ð°ÑÐ¸ Ð²ÑÐ·Ð¾Ð»"}}),l_=function(){function t(){nl(this,t),this.NUM_ITERATIONS=4,this.image=new Image,this.canvas=document.createElement("canvas")}return ad(t,[{key:"init",value:function(){if(!this.initialized()){this.src=this.image.src;var t=this.image.width,e=this.image.height;this.width=t,this.height=e;var i=Math.floor(e/2),o=Math.floor(e/4),n=Math.floor(e/8),s=Math.floor(e/16),r=Math.floor(t/2),a=Math.floor(t/4),l=Math.floor(t/8),h=Math.floor(t/16);this.canvas.width=3*a,this.canvas.height=i,this.coordinates=[[0,0,r,i],[r,0,a,o],[r,o,l,n],[5*l,o,h,s]],this._fillMipMap()}}},{key:"initialized",value:function(){return void 0!==this.coordinates}},{key:"_fillMipMap",value:function(){var t=this.canvas.getContext("2d"),e=this.coordinates[0];t.drawImage(this.image,e[0],e[1],e[2],e[3]);for(var i=1;i<this.NUM_ITERATIONS;i++){var o=this.coordinates[i-1],n=this.coordinates[i];t.drawImage(this.canvas,o[0],o[1],o[2],o[3],n[0],n[1],n[2],n[3])}}},{key:"drawImageAtPosition",value:function(t,e,i,o,n,s){if(this.initialized())if(e>2){e*=.5;for(var r=0;e>2&&r<this.NUM_ITERATIONS;)e*=.5,r+=1;r>=this.NUM_ITERATIONS&&(r=this.NUM_ITERATIONS-1);var a=this.coordinates[r];t.drawImage(this.canvas,a[0],a[1],a[2],a[3],i,o,n,s)}else t.drawImage(this.image,i,o,n,s)}}]),t}(),h_=function(){function t(e){nl(this,t),this.images={},this.imageBroken={},this.callback=e}return ad(t,[{key:"_tryloadBrokenUrl",value:function(t,e,i){void 0!==t&&void 0!==i&&(void 0!==e?(i.image.onerror=function(){console.error("Could not load brokenImage:",e)},i.image.src=e):console.warn("No broken url image defined"))}},{key:"_redrawWithImage",value:function(t){this.callback&&this.callback(t)}},{key:"load",value:function(t,e){var i=this,o=this.images[t];if(o)return o;var n=new l_;return this.images[t]=n,n.image.onload=function(){i._fixImageCoordinates(n.image),n.init(),i._redrawWithImage(n)},n.image.onerror=function(){console.error("Could not load image:",t),i._tryloadBrokenUrl(t,e,n)},n.image.src=t,n}},{key:"_fixImageCoordinates",value:function(t){0===t.width&&(document.body.appendChild(t),t.width=t.offsetWidth,t.height=t.offsetHeight,document.body.removeChild(t))}}]),t}(),c_={exports:{}},u_=a((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),d_=a,p_=it,g_=E,f_=u_,m_=Object.isExtensible,v_=d_((function(){m_(1)}))||f_?function(t){return!!p_(t)&&(!f_||"ArrayBuffer"!==g_(t))&&(!m_||m_(t))}:m_,b_=!a((function(){return Object.isExtensible(Object.preventExtensions({}))})),__=Ci,y_=b,T_=zi,E_=it,w_=Qt,k_=qe.f,I_=Ul,$_=Wl,S_=v_,C_=b_,O_=!1,R_=ne("meta"),A_=0,M_=function(t){k_(t,R_,{value:{objectID:"O"+A_++,weakData:{}}})},x_=c_.exports={enable:function(){x_.enable=function(){},O_=!0;var t=I_.f,e=y_([].splice),i={};i[R_]=1,t(i).length&&(I_.f=function(i){for(var o=t(i),n=0,s=o.length;n<s;n++)if(o[n]===R_){e(o,n,1);break}return o},__({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:$_.f}))},fastKey:function(t,e){if(!E_(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w_(t,R_)){if(!S_(t))return"F";if(!e)return"E";M_(t)}return t[R_].objectID},getWeakData:function(t,e){if(!w_(t,R_)){if(!S_(t))return!0;if(!e)return!1;M_(t)}return t[R_].weakData},onFreeze:function(t){return C_&&O_&&S_(t)&&!w_(t,R_)&&M_(t),t}};T_[R_]=!0;var L_=c_.exports,D_=Je,N_=L,P_=ii,B_=Ot,F_=Fr,H_=Fi,U_=ht,G_=ya,V_=pa,W_=xr,z_=TypeError,j_=function(t,e){this.stopped=t,this.result=e},X_=j_.prototype,Y_=function(t,e,i){var o,n,s,r,a,l,h,c=i&&i.that,u=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_RECORD),p=!(!i||!i.IS_ITERATOR),g=!(!i||!i.INTERRUPTED),f=D_(e,c),m=function(t){return o&&W_(o,"normal",t),new j_(!0,t)},v=function(t){return u?(P_(t),g?f(t[0],t[1],m):f(t[0],t[1])):g?f(t,m):f(t)};if(d)o=t.iterator;else if(p)o=t;else{if(!(n=V_(t)))throw new z_(B_(t)+" is not iterable");if(F_(n)){for(s=0,r=H_(t);r>s;s++)if((a=v(t[s]))&&U_(X_,a))return a;return new j_(!1)}o=G_(t,n)}for(l=d?t.next:o.next;!(h=N_(l,o)).done;){try{a=v(h.value)}catch(t){W_(o,"throw",t)}if("object"==typeof a&&a&&U_(X_,a))return a}return new j_(!1)},K_=ht,J_=TypeError,q_=function(t,e){if(K_(e,t))return t;throw new J_("Incorrect invocation")},Z_=Ci,Q_=r,ty=L_,ey=a,iy=mi,oy=Y_,ny=q_,sy=O,ry=it,ay=X,ly=js,hy=qe.f,cy=wh.forEach,uy=A,dy=Bn.set,py=Bn.getterFor,gy=function(t,e,i){var o,n=-1!==t.indexOf("Map"),s=-1!==t.indexOf("Weak"),r=n?"set":"add",a=Q_[t],l=a&&a.prototype,h={};if(uy&&sy(a)&&(s||l.forEach&&!ey((function(){(new a).entries().next()})))){var c=(o=e((function(e,i){dy(ny(e,c),{type:t,collection:new a}),ay(i)||oy(i,e[r],{that:e,AS_ENTRIES:n})}))).prototype,u=py(t);cy(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(t){var e="add"===t||"set"===t;!(t in l)||s&&"clear"===t||iy(c,t,(function(i,o){var n=u(this).collection;if(!e&&s&&!ry(i))return"get"===t&&void 0;var r=n[t](0===i?0:i,o);return e?this:r}))})),s||hy(c,"size",{configurable:!0,get:function(){return u(this).collection.size}})}else o=i.getConstructor(e,t,n,r),ty.enable();return ly(o,t,!1,!0),h[t]=o,Z_({global:!0,forced:!0},h),s||i.setStrong(o,t,n),o},fy=Ss,my=function(t,e,i){for(var o in e)i&&i.unsafe&&t[o]?t[o]=e[o]:fy(t,o,e[o],i);return t},vy=lt,by=oh,_y=A,yy=pe("species"),Ty=ms,Ey=oh,wy=my,ky=Je,Iy=q_,$y=X,Sy=Y_,Cy=yr,Oy=Tr,Ry=A,Ay=L_.fastKey,My=Bn.set,xy=Bn.getterFor,Ly={getConstructor:function(t,e,i,o){var n=t((function(t,n){Iy(t,s),My(t,{type:e,index:Ty(null),first:void 0,last:void 0,size:0}),Ry||(t.size=0),$y(n)||Sy(n,t[o],{that:t,AS_ENTRIES:i})})),s=n.prototype,r=xy(e),a=function(t,e,i){var o,n,s=r(t),a=l(t,e);return a?a.value=i:(s.last=a={index:n=Ay(e,!0),key:e,value:i,previous:o=s.last,next:void 0,removed:!1},s.first||(s.first=a),o&&(o.next=a),Ry?s.size++:t.size++,"F"!==n&&(s.index[n]=a)),t},l=function(t,e){var i,o=r(t),n=Ay(e);if("F"!==n)return o.index[n];for(i=o.first;i;i=i.next)if(i.key===e)return i};return wy(s,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,Ry?t.size=0:this.size=0},delete:function(t){var e=this,i=r(e),o=l(e,t);if(o){var n=o.next,s=o.previous;delete i.index[o.index],o.removed=!0,s&&(s.next=n),n&&(n.previous=s),i.first===o&&(i.first=n),i.last===o&&(i.last=s),Ry?i.size--:e.size--}return!!o},forEach:function(t){for(var e,i=r(this),o=ky(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:i.first;)for(o(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!l(this,t)}}),wy(s,i?{get:function(t){var e=l(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),Ry&&Ey(s,"size",{configurable:!0,get:function(){return r(this).size}}),n},setStrong:function(t,e,i){var o=e+" Iterator",n=xy(e),s=xy(o);Cy(t,e,(function(t,e){My(this,{type:o,target:t,state:n(t),kind:e,last:void 0})}),(function(){for(var t=s(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?Oy("keys"===e?i.key:"values"===e?i.value:[i.key,i.value],!1):(t.target=void 0,Oy(void 0,!0))}),i?"entries":"values",!i,!0),function(t){var e=vy(t);_y&&e&&!e[yy]&&by(e,yy,{configurable:!0,get:function(){return this}})}(e)}};gy("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),Ly);var Dy=n(ot.Map),Ny=function(){function t(){nl(this,t),this.clear(),this._defaultIndex=0,this._groupIndex=0,this._defaultGroups=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}},{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}},{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}},{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}},{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}},{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}},{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}},{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}},{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}},{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}},{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}},{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}],this.options={},this.defaultOptions={useDefaultGroups:!0},bo(this.options,this.defaultOptions)}return ad(t,[{key:"setOptions",value:function(t){var e=["useDefaultGroups"];if(void 0!==t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&-1===bf(e).call(e,i)){var o=t[i];this.add(i,o)}}},{key:"clear",value:function(){this._groups=new Dy,this._groupNames=[]}},{key:"get",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._groups.get(t);if(void 0===i&&e)if(!1===this.options.useDefaultGroups&&this._groupNames.length>0){var o=this._groupIndex%this._groupNames.length;++this._groupIndex,(i={}).color=this._groups.get(this._groupNames[o]),this._groups.set(t,i)}else{var n=this._defaultIndex%this._defaultGroups.length;this._defaultIndex++,(i={}).color=this._defaultGroups[n],this._groups.set(t,i)}return i}},{key:"add",value:function(t,e){return this._groups.has(t)||this._groupNames.push(t),this._groups.set(t,e),e}}]),t}();Ci({target:"Number",stat:!0},{isNaN:function(t){return t!=t}});var Py=n(ot.Number.isNaN),By=r.isFinite,Fy=Number.isFinite||function(t){return"number"==typeof t&&By(t)};Ci({target:"Number",stat:!0},{isFinite:Fy});var Hy=n(ot.Number.isFinite),Uy=wh.some;Ci({target:"Array",proto:!0,forced:!wp("some")},{some:function(t){return Uy(this,t,arguments.length>1?arguments[1]:void 0)}});var Gy=xo("Array").some,Vy=ht,Wy=Gy,zy=Array.prototype,jy=n((function(t){var e=t.some;return t===zy||Vy(zy,t)&&e===zy.some?Wy:e})),Xy=n(ot.Object.getOwnPropertySymbols),Yy={exports:{}},Ky=Ci,Jy=a,qy=Q,Zy=R.f,Qy=A;Ky({target:"Object",stat:!0,forced:!Qy||Jy((function(){Zy(1)})),sham:!Qy},{getOwnPropertyDescriptor:function(t,e){return Zy(qy(t),e)}});var tT=ot.Object,eT=Yy.exports=function(t,e){return tT.getOwnPropertyDescriptor(t,e)};tT.getOwnPropertyDescriptor.sham&&(eT.sham=!0);var iT=Yy.exports,oT=n(iT),nT=ap,sT=Q,rT=R,aT=aa;Ci({target:"Object",stat:!0,sham:!A},{getOwnPropertyDescriptors:function(t){for(var e,i,o=sT(t),n=rT.f,s=nT(o),r={},a=0;s.length>a;)void 0!==(i=n(o,e=s[a++]))&&aT(r,e,i);return r}});var lT=n(ot.Object.getOwnPropertyDescriptors),hT={exports:{}},cT=Ci,uT=A,dT=zn.f;cT({target:"Object",stat:!0,forced:Object.defineProperties!==dT,sham:!uT},{defineProperties:dT});var pT=ot.Object,gT=hT.exports=function(t,e){return pT.defineProperties(t,e)};pT.defineProperties.sham&&(gT.sham=!0);var fT=n(hT.exports),mT=n(ul);function vT(t,e,i){return(e=sd(e))in t?dl(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var bT=r,_T=a,yT=hn,TT=Yg.trim,ET=Hg,wT=b("".charAt),kT=bT.parseFloat,IT=bT.Symbol,$T=IT&&IT.iterator,ST=1/kT(ET+"-0")!=-1/0||$T&&!_T((function(){kT(Object($T))}))?function(t){var e=TT(yT(t)),i=kT(e);return 0===i&&"-"===wT(e,0)?-0:i}:kT;Ci({global:!0,forced:parseFloat!==ST},{parseFloat:ST});var CT=n(ot.parseFloat),OT=Ci,RT=a,AT=Wl.f;OT({target:"Object",stat:!0,forced:RT((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:AT});var MT=ot.Object,xT=n((function(t){return MT.getOwnPropertyNames(t)}));function LT(t,e){var i=["node","edge","label"],o=!0,n=pb(e,"chosen");if("boolean"==typeof n)o=n;else if("object"===od(n)){if(-1===bf(i).call(i,t))throw new Error("choosify: subOption '"+t+"' should be one of '"+i.join("', '")+"'");var s=pb(e,["chosen",t]);"boolean"!=typeof s&&"function"!=typeof s||(o=s)}return o}function DT(t,e,i){if(t.width<=0||t.height<=0)return!1;if(void 0!==i){var o={x:e.x-i.x,y:e.y-i.y};if(0!==i.angle){var n=-i.angle;e={x:Math.cos(n)*o.x-Math.sin(n)*o.y,y:Math.sin(n)*o.x+Math.cos(n)*o.y}}else e=o}var s=t.x+t.width,r=t.y+t.width;return t.left<e.x&&s>e.x&&t.top<e.y&&r>e.y}function NT(t){return"string"==typeof t&&""!==t}function PT(t,e,i,o){var n=o.x,s=o.y;if("function"==typeof o.distanceToBorder){var r=o.distanceToBorder(t,e),a=Math.sin(e)*r,l=Math.cos(e)*r;l===r?(n+=r,s=o.y):a===r?(n=o.x,s-=r):(n+=l,s-=a)}else o.shape.width>o.shape.height?(n=o.x+.5*o.shape.width,s=o.y-i):(n=o.x+i,s=o.y-.5*o.shape.height);return{x:n,y:s}}var BT=xo("Array").values,FT=rn,HT=Qt,UT=ht,GT=BT,VT=Array.prototype,WT={DOMTokenList:!0,NodeList:!0},zT=n((function(t){var e=t.values;return t===VT||UT(VT,t)&&e===VT.values||HT(WT,FT(t))?GT:e})),jT=function(){function t(e){nl(this,t),this.measureText=e,this.current=0,this.width=0,this.height=0,this.lines=[]}return ad(t,[{key:"_add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";void 0===this.lines[t]&&(this.lines[t]={width:0,height:0,blocks:[]});var o=e;void 0!==e&&""!==e||(o=" ");var n=this.measureText(o,i),s=bo({},zT(n));s.text=e,s.width=n.width,s.mod=i,void 0!==e&&""!==e||(s.width=0),this.lines[t].blocks.push(s),this.lines[t].width+=s.width}},{key:"curWidth",value:function(){var t=this.lines[this.current];return void 0===t?0:t.width}},{key:"append",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this._add(this.current,t,e)}},{key:"newLine",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";this._add(this.current,t,e),this.current++}},{key:"determineLineHeights",value:function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t],i=0;if(void 0!==e.blocks)for(var o=0;o<e.blocks.length;o++){var n=e.blocks[o];i<n.height&&(i=n.height)}e.height=i}}},{key:"determineLabelSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var o=this.lines[i];o.width>t&&(t=o.width),e+=o.height}this.width=t,this.height=e}},{key:"removeEmptyBlocks",value:function(){for(var t=[],e=0;e<this.lines.length;e++){var i=this.lines[e];if(0!==i.blocks.length&&(e!==this.lines.length-1||0!==i.width)){var o={};bo(o,i),o.blocks=[];for(var n=void 0,s=[],r=0;r<i.blocks.length;r++){var a=i.blocks[r];0!==a.width?s.push(a):void 0===n&&(n=a)}0===s.length&&void 0!==n&&s.push(n),o.blocks=s,t.push(o)}}return t}},{key:"finalize",value:function(){this.determineLineHeights(),this.determineLabelSize();var t=this.removeEmptyBlocks();return{width:this.width,height:this.height,lines:t}}}]),t}(),XT={"<b>":/<b>/,"<i>":/<i>/,"<code>":/<code>/,"</b>":/<\/b>/,"</i>":/<\/i>/,"</code>":/<\/code>/,"*":/\*/,_:/_/,"`":/`/,afterBold:/[^*]/,afterItal:/[^_]/,afterMono:/[^`]/},YT=function(){function t(e){nl(this,t),this.text=e,this.bold=!1,this.ital=!1,this.mono=!1,this.spacing=!1,this.position=0,this.buffer="",this.modStack=[],this.blocks=[]}return ad(t,[{key:"mod",value:function(){return 0===this.modStack.length?"normal":this.modStack[0]}},{key:"modName",value:function(){return 0===this.modStack.length?"normal":"mono"===this.modStack[0]?"mono":this.bold&&this.ital?"boldital":this.bold?"bold":this.ital?"ital":void 0}},{key:"emitBlock",value:function(){this.spacing&&(this.add(" "),this.spacing=!1),this.buffer.length>0&&(this.blocks.push({text:this.buffer,mod:this.modName()}),this.buffer="")}},{key:"add",value:function(t){" "===t&&(this.spacing=!0),this.spacing&&(this.buffer+=" ",this.spacing=!1)," "!=t&&(this.buffer+=t)}},{key:"parseWS",value:function(t){return!!/[ \t]/.test(t)&&(this.mono?this.add(t):this.spacing=!0,!0)}},{key:"setTag",value:function(t){this.emitBlock(),this[t]=!0,this.modStack.unshift(t)}},{key:"unsetTag",value:function(t){this.emitBlock(),this[t]=!1,this.modStack.shift()}},{key:"parseStartTag",value:function(t,e){return!(this.mono||this[t]||!this.match(e)||(this.setTag(t),0))}},{key:"match",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=Xd(this.prepareRegExp(t),2),o=i[0],n=i[1],s=o.test(this.text.substr(this.position,n));return s&&e&&(this.position+=n-1),s}},{key:"parseEndTag",value:function(t,e,i){var o=this.mod()===t;return!(!(o="mono"===t?o&&this.mono:o&&!this.mono)||!this.match(e)||(void 0!==i?(this.position===this.text.length-1||this.match(i,!1))&&this.unsetTag(t):this.unsetTag(t),0))}},{key:"replace",value:function(t,e){return!!this.match(t)&&(this.add(e),this.position+=length-1,!0)}},{key:"prepareRegExp",value:function(t){var e,i;if(t instanceof RegExp)i=t,e=1;else{var o=XT[t];i=void 0!==o?o:new RegExp(t),e=t.length}return[i,e]}}]),t}(),KT=function(){function t(e,i,o,n){var s=this;nl(this,t),this.ctx=e,this.parent=i,this.selected=o,this.hover=n,this.lines=new jT((function(t,i){if(void 0===t)return 0;var r=s.parent.getFormattingValues(e,o,n,i),a=0;return""!==t&&(a=s.ctx.measureText(t).width),{width:a,values:r}}))}return ad(t,[{key:"process",value:function(t){if(!NT(t))return this.lines.finalize();var e=this.parent.fontOptions;t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");var i=String(t).split("\n"),o=i.length;if(e.multi)for(var n=0;n<o;n++){var s=this.splitBlocks(i[n],e.multi);if(void 0!==s)if(0!==s.length){if(e.maxWdt>0)for(var r=0;r<s.length;r++){var a=s[r].mod,l=s[r].text;this.splitStringIntoLines(l,a,!0)}else for(var h=0;h<s.length;h++){var c=s[h].mod,u=s[h].text;this.lines.append(u,c)}this.lines.newLine()}else this.lines.newLine("")}else if(e.maxWdt>0)for(var d=0;d<o;d++)this.splitStringIntoLines(i[d]);else for(var p=0;p<o;p++)this.lines.newLine(i[p]);return this.lines.finalize()}},{key:"decodeMarkupSystem",value:function(t){var e="none";return"markdown"===t||"md"===t?e="markdown":!0!==t&&"html"!==t||(e="html"),e}},{key:"splitHtmlBlocks",value:function(t){for(var e=new YT(t),i=function(t){return!!/&/.test(t)&&(e.replace(e.text,"&lt;","<")||e.replace(e.text,"&amp;","&")||e.add("&"),!0)};e.position<e.text.length;){var o=e.text.charAt(e.position);e.parseWS(o)||/</.test(o)&&(e.parseStartTag("bold","<b>")||e.parseStartTag("ital","<i>")||e.parseStartTag("mono","<code>")||e.parseEndTag("bold","</b>")||e.parseEndTag("ital","</i>")||e.parseEndTag("mono","</code>"))||i(o)||e.add(o),e.position++}return e.emitBlock(),e.blocks}},{key:"splitMarkdownBlocks",value:function(t){for(var e=this,i=new YT(t),o=!0,n=function(t){return!!/\\/.test(t)&&(i.position<e.text.length+1&&(i.position++,t=e.text.charAt(i.position),/ \t/.test(t)?i.spacing=!0:(i.add(t),o=!1)),!0)};i.position<i.text.length;){var s=i.text.charAt(i.position);i.parseWS(s)||n(s)||(o||i.spacing)&&(i.parseStartTag("bold","*")||i.parseStartTag("ital","_")||i.parseStartTag("mono","`"))||i.parseEndTag("bold","*","afterBold")||i.parseEndTag("ital","_","afterItal")||i.parseEndTag("mono","`","afterMono")||(i.add(s),o=!1),i.position++}return i.emitBlock(),i.blocks}},{key:"splitBlocks",value:function(t,e){var i=this.decodeMarkupSystem(e);return"none"===i?[{text:t,mod:"normal"}]:"markdown"===i?this.splitMarkdownBlocks(t):"html"===i?this.splitHtmlBlocks(t):void 0}},{key:"overMaxWidth",value:function(t){var e=this.ctx.measureText(t).width;return this.lines.curWidth()+e>this.parent.fontOptions.maxWdt}},{key:"getLongestFit",value:function(t){for(var e="",i=0;i<t.length;){var o=e+(""===e?"":" ")+t[i];if(this.overMaxWidth(o))break;e=o,i++}return i}},{key:"getLongestFitWord",value:function(t){for(var e=0;e<t.length&&!this.overMaxWidth(ep(t).call(t,0,e));)e++;return e}},{key:"splitStringIntoLines",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.parent.getFormattingValues(this.ctx,this.selected,this.hover,e);for(var o=(t=(t=t.replace(/^( +)/g,"$1\r")).replace(/([^\r][^ ]*)( +)/g,"$1\r$2\r")).split("\r");o.length>0;){var n=this.getLongestFit(o);if(0===n){var s=o[0],r=this.getLongestFitWord(s);this.lines.newLine(ep(s).call(s,0,r),e),o[0]=ep(s).call(s,r)}else{var a=n;" "===o[n-1]?n--:" "===o[a]&&a++;var l=ep(o).call(o,0,n).join("");n==o.length&&i?this.lines.append(l,e):this.lines.newLine(l,e),o=ep(o).call(o,a)}}}}]),t}(),JT=["bold","ital","boldital","mono"],qT=function(){function t(e,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];nl(this,t),this.body=e,this.pointToSelf=!1,this.baseSize=void 0,this.fontOptions={},this.setOptions(i),this.size={top:0,left:0,width:0,height:0,yLine:0},this.isEdgeLabel=o}return ad(t,[{key:"setOptions",value:function(t){if(this.elementOptions=t,this.initFontOptions(t.font),NT(t.label)?this.labelDirty=!0:t.label=void 0,void 0!==t.font&&null!==t.font)if("string"==typeof t.font)this.baseSize=this.fontOptions.size;else if("object"===od(t.font)){var e=t.font.size;void 0!==e&&(this.baseSize=e)}}},{key:"initFontOptions",value:function(e){var i=this;tb(JT,(function(t){i.fontOptions[t]={}})),t.parseFontString(this.fontOptions,e)?this.fontOptions.vadjust=0:tb(e,(function(t,e){null!=t&&"object"!==od(t)&&(i.fontOptions[e]=t)}))}},{key:"constrain",value:function(t){var e={constrainWidth:!1,maxWdt:-1,minWdt:-1,constrainHeight:!1,minHgt:-1,valign:"middle"},i=pb(t,"widthConstraint");if("number"==typeof i)e.maxWdt=Number(i),e.minWdt=Number(i);else if("object"===od(i)){var o=pb(t,["widthConstraint","maximum"]);"number"==typeof o&&(e.maxWdt=Number(o));var n=pb(t,["widthConstraint","minimum"]);"number"==typeof n&&(e.minWdt=Number(n))}var s=pb(t,"heightConstraint");if("number"==typeof s)e.minHgt=Number(s);else if("object"===od(s)){var r=pb(t,["heightConstraint","minimum"]);"number"==typeof r&&(e.minHgt=Number(r));var a=pb(t,["heightConstraint","valign"]);"string"==typeof a&&("top"!==a&&"bottom"!==a||(e.valign=a))}return e}},{key:"update",value:function(t,e){this.setOptions(t,!0),this.propagateFonts(e),qv(this.fontOptions,this.constrain(e)),this.fontOptions.chooser=LT("label",e)}},{key:"adjustSizes",value:function(t){var e=t?t.right+t.left:0;this.fontOptions.constrainWidth&&(this.fontOptions.maxWdt-=e,this.fontOptions.minWdt-=e);var i=t?t.top+t.bottom:0;this.fontOptions.constrainHeight&&(this.fontOptions.minHgt-=i)}},{key:"addFontOptionsToPile",value:function(t,e){for(var i=0;i<e.length;++i)this.addFontToPile(t,e[i])}},{key:"addFontToPile",value:function(t,e){if(void 0!==e&&void 0!==e.font&&null!==e.font){var i=e.font;t.push(i)}}},{key:"getBasicOptions",value:function(e){for(var i={},o=0;o<e.length;++o){var n=e[o],s={};t.parseFontString(s,n)&&(n=s),tb(n,(function(t,e){void 0!==t&&(Object.prototype.hasOwnProperty.call(i,e)||(-1!==bf(JT).call(JT,e)?i[e]={}:i[e]=t))}))}return i}},{key:"getFontOption",value:function(e,i,o){for(var n,s=0;s<e.length;++s){var r=e[s];if(Object.prototype.hasOwnProperty.call(r,i)){if(null==(n=r[i]))continue;var a={};if(t.parseFontString(a,n)&&(n=a),Object.prototype.hasOwnProperty.call(n,o))return n[o]}}if(Object.prototype.hasOwnProperty.call(this.fontOptions,o))return this.fontOptions[o];throw new Error("Did not find value for multi-font for property: '"+o+"'")}},{key:"getFontOptions",value:function(t,e){for(var i={},o=["color","size","face","mod","vadjust"],n=0;n<o.length;++n){var s=o[n];i[s]=this.getFontOption(t,e,s)}return i}},{key:"propagateFonts",value:function(t){var e=this,i=[];this.addFontOptionsToPile(i,t),this.fontOptions=this.getBasicOptions(i);for(var o=function(){var t=JT[n],o=e.fontOptions[t];tb(e.getFontOptions(i,t),(function(t,e){o[e]=t})),o.size=Number(o.size),o.vadjust=Number(o.vadjust)},n=0;n<JT.length;++n)o()}},{key:"draw",value:function(t,e,i,o,n){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";if(void 0!==this.elementOptions.label){var r=this.fontOptions.size*this.body.view.scale;this.elementOptions.label&&r<this.elementOptions.scaling.label.drawThreshold-1||(r>=this.elementOptions.scaling.label.maxVisible&&(r=Number(this.elementOptions.scaling.label.maxVisible)/this.body.view.scale),this.calculateLabelSize(t,o,n,e,i,s),this._drawBackground(t),this._drawText(t,e,this.size.yLine,s,r))}}},{key:"_drawBackground",value:function(t){if(void 0!==this.fontOptions.background&&"none"!==this.fontOptions.background){t.fillStyle=this.fontOptions.background;var e=this.getSize();t.fillRect(e.left,e.top,e.width,e.height)}}},{key:"_drawText",value:function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle",n=arguments.length>4?arguments[4]:void 0,s=Xd(this._setAlignment(t,e,i,o),2);e=s[0],i=s[1],t.textAlign="left",e-=this.size.width/2,this.fontOptions.valign&&this.size.height>this.size.labelHeight&&("top"===this.fontOptions.valign&&(i-=(this.size.height-this.size.labelHeight)/2),"bottom"===this.fontOptions.valign&&(i+=(this.size.height-this.size.labelHeight)/2));for(var r=0;r<this.lineCount;r++){var a=this.lines[r];if(a&&a.blocks){var l=0;this.isEdgeLabel||"center"===this.fontOptions.align?l+=(this.size.width-a.width)/2:"right"===this.fontOptions.align&&(l+=this.size.width-a.width);for(var h=0;h<a.blocks.length;h++){var c=a.blocks[h];t.font=c.font;var u=Xd(this._getColor(c.color,n,c.strokeColor),2),d=u[0],p=u[1];c.strokeWidth>0&&(t.lineWidth=c.strokeWidth,t.strokeStyle=p,t.lineJoin="round"),t.fillStyle=d,c.strokeWidth>0&&t.strokeText(c.text,e+l,i+c.vadjust),t.fillText(c.text,e+l,i+c.vadjust),l+=c.width}i+=a.height}}}},{key:"_setAlignment",value:function(t,e,i,o){return this.isEdgeLabel&&"horizontal"!==this.fontOptions.align&&!1===this.pointToSelf?(e=0,i=0,"top"===this.fontOptions.align?(t.textBaseline="alphabetic",i-=4):"bottom"===this.fontOptions.align?(t.textBaseline="hanging",i+=4):t.textBaseline="middle"):t.textBaseline=o,[e,i]}},{key:"_getColor",value:function(t,e,i){var o=t||"#000000",n=i||"#ffffff";if(e<=this.elementOptions.scaling.label.drawThreshold){var s=Math.max(0,Math.min(1,1-(this.elementOptions.scaling.label.drawThreshold-e)));o=ib(o,s),n=ib(n,s)}return[o,n]}},{key:"getTextSize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._processLabel(t,e,i),{width:this.size.width,height:this.size.height,lineCount:this.lineCount}}},{key:"getSize",value:function(){var t=this.size.left,e=this.size.top-1;if(this.isEdgeLabel){var i=.5*-this.size.width;switch(this.fontOptions.align){case"middle":t=i,e=.5*-this.size.height;break;case"top":t=i,e=-(this.size.height+2);break;case"bottom":t=i,e=2}}return{left:t,top:e,width:this.size.width,height:this.size.height}}},{key:"calculateLabelSize",value:function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";this._processLabel(t,e,i),this.size.left=o-.5*this.size.width,this.size.top=n-.5*this.size.height,this.size.yLine=n+.5*(1-this.lineCount)*this.fontOptions.size,"hanging"===s&&(this.size.top+=.5*this.fontOptions.size,this.size.top+=4,this.size.yLine+=4)}},{key:"getFormattingValues",value:function(t,e,i,o){var n=function(t,e,i){return"normal"===e?"mod"===i?"":t[i]:void 0!==t[e][i]?t[e][i]:t[i]},s={color:n(this.fontOptions,o,"color"),size:n(this.fontOptions,o,"size"),face:n(this.fontOptions,o,"face"),mod:n(this.fontOptions,o,"mod"),vadjust:n(this.fontOptions,o,"vadjust"),strokeWidth:this.fontOptions.strokeWidth,strokeColor:this.fontOptions.strokeColor};(e||i)&&("normal"===o&&!0===this.fontOptions.chooser&&this.elementOptions.labelHighlightBold?s.mod="bold":"function"==typeof this.fontOptions.chooser&&this.fontOptions.chooser(s,this.elementOptions.id,e,i));var r="";return void 0!==s.mod&&""!==s.mod&&(r+=s.mod+" "),r+=s.size+"px "+s.face,t.font=r.replace(/"/g,""),s.font=t.font,s.height=s.size,s}},{key:"differentState",value:function(t,e){return t!==this.selectedState||e!==this.hoverState}},{key:"_processLabelText",value:function(t,e,i,o){return new KT(t,this,e,i).process(o)}},{key:"_processLabel",value:function(t,e,i){if(!1!==this.labelDirty||this.differentState(e,i)){var o=this._processLabelText(t,e,i,this.elementOptions.label);this.fontOptions.minWdt>0&&o.width<this.fontOptions.minWdt&&(o.width=this.fontOptions.minWdt),this.size.labelHeight=o.height,this.fontOptions.minHgt>0&&o.height<this.fontOptions.minHgt&&(o.height=this.fontOptions.minHgt),this.lines=o.lines,this.lineCount=o.lines.length,this.size.width=o.width,this.size.height=o.height,this.selectedState=e,this.hoverState=i,this.labelDirty=!1}}},{key:"visible",value:function(){return 0!==this.size.width&&0!==this.size.height&&void 0!==this.elementOptions.label&&!(this.fontOptions.size*this.body.view.scale<this.elementOptions.scaling.label.drawThreshold-1)}}],[{key:"parseFontString",value:function(t,e){if(!e||"string"!=typeof e)return!1;var i=e.split(" ");return t.size=+i[0].replace("px",""),t.face=i[1],t.color=i[2],!0}}]),t}(),ZT=oa,QT=Ot,tE=TypeError,eE=Ci,iE=p,oE=Ro,nE=function(t){if(ZT(t))return t;throw new tE(QT(t)+" is not a constructor")},sE=ii,rE=it,aE=ms,lE=a,hE=lt("Reflect","construct"),cE=Object.prototype,uE=[].push,dE=lE((function(){function t(){}return!(hE((function(){}),[],t)instanceof t)})),pE=!lE((function(){hE((function(){}))})),gE=dE||pE;eE({target:"Reflect",stat:!0,forced:gE,sham:gE},{construct:function(t,e){nE(t),sE(e);var i=arguments.length<3?t:nE(arguments[2]);if(pE&&!dE)return hE(t,e,i);if(t===i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var o=[null];return iE(uE,o,e),new(iE(oE,t,o))}var n=i.prototype,s=aE(rE(n)?n:cE),r=iE(t,s,e);return rE(r)?r:s}});var fE=n(ot.Reflect.construct),mE=n(yf);Ci({target:"Object",stat:!0},{setPrototypeOf:rr});var vE=n(ot.Object.setPrototypeOf),bE=n(Bo);function _E(t,e){var i;return _E=vE?bE(i=vE).call(i):function(t,e){return t.__proto__=e,t},_E(t,e)}function yE(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=mE(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),dl(t,"prototype",{writable:!1}),e&&_E(t,e)}function TE(t,e){if(e&&("object"===od(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}var EE=n(Mg);function wE(t){var e;return wE=vE?bE(e=EE).call(e):function(t){return t.__proto__||EE(t)},wE(t)}var kE=function(){function t(e,i,o){nl(this,t),this.body=i,this.labelModule=o,this.setOptions(e),this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.radius=void 0,this.margin=void 0,this.refreshNeeded=!0,this.boundingBox={top:0,left:0,right:0,bottom:0}}return ad(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"_setMargins",value:function(t){this.margin={},this.options.margin&&("object"==od(this.options.margin)?(this.margin.top=this.options.margin.top,this.margin.right=this.options.margin.right,this.margin.bottom=this.options.margin.bottom,this.margin.left=this.options.margin.left):(this.margin.top=this.options.margin,this.margin.right=this.options.margin,this.margin.bottom=this.options.margin,this.margin.left=this.options.margin)),t.adjustSizes(this.margin)}},{key:"_distanceToBorder",value:function(t,e){var i=this.options.borderWidth;return t&&this.resize(t),Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}},{key:"enableShadow",value:function(t,e){e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"enableBorderDashes",value:function(t,e){if(!1!==e.borderDashes)if(void 0!==t.setLineDash){var i=e.borderDashes;!0===i&&(i=[5,15]),t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1}},{key:"disableBorderDashes",value:function(t,e){!1!==e.borderDashes&&(void 0!==t.setLineDash?t.setLineDash([0]):(console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1))}},{key:"needsRefresh",value:function(t,e){return!0===this.refreshNeeded?(this.refreshNeeded=!1,!0):void 0===this.width||this.labelModule.differentState(t,e)}},{key:"initContextForDraw",value:function(t,e){var i=e.borderWidth/this.body.view.scale;t.lineWidth=Math.min(this.width,i),t.strokeStyle=e.borderColor,t.fillStyle=e.color}},{key:"performStroke",value:function(t,e){var i=e.borderWidth/this.body.view.scale;t.save(),i>0&&(this.enableBorderDashes(t,e),t.stroke(),this.disableBorderDashes(t,e)),t.restore()}},{key:"performFill",value:function(t,e){t.save(),t.fillStyle=e.color,this.enableShadow(t,e),qf(t).call(t),this.disableShadow(t,e),t.restore(),this.performStroke(t,e)}},{key:"_addBoundingBoxMargin",value:function(t){this.boundingBox.left-=t,this.boundingBox.top-=t,this.boundingBox.bottom+=t,this.boundingBox.right+=t}},{key:"_updateBoundingBox",value:function(t,e,i,o,n){void 0!==i&&this.resize(i,o,n),this.left=t-this.width/2,this.top=e-this.height/2,this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width}},{key:"updateBoundingBox",value:function(t,e,i,o,n){this._updateBoundingBox(t,e,i,o,n)}},{key:"getDimensionsFromLabel",value:function(t,e,i){this.textSize=this.labelModule.getTextSize(t,e,i);var o=this.textSize.width,n=this.textSize.height;return 0===o&&(o=14,n=14),{width:o,height:n}}}]),t}();var IE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n))._setMargins(n),s}return ad(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var o=this.getDimensionsFromLabel(t,e,i);this.width=o.width+this.margin.right+this.margin.left,this.height=o.height+this.margin.top+this.margin.bottom,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,o,n,s){this.resize(t,o,n),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,s),Uo(t,this.left,this.top,this.width,this.height,s.borderRadius),this.performFill(t,s),this.updateBoundingBox(e,i,t,o,n),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,o,n)}},{key:"updateBoundingBox",value:function(t,e,i,o,n){this._updateBoundingBox(t,e,i,o,n);var s=this.options.shapeProperties.borderRadius;this._addBoundingBoxMargin(s)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=this.options.borderWidth;return Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}}]),i}(kE);var $E=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n)).labelOffset=0,s.selected=!1,s}return ad(i,[{key:"setOptions",value:function(t,e,i){this.options=t,void 0===e&&void 0===i||this.setImages(e,i)}},{key:"setImages",value:function(t,e){e&&this.selected?(this.imageObj=e,this.imageObjAlt=t):(this.imageObj=t,this.imageObjAlt=e)}},{key:"switchImages",value:function(t){var e=t&&!this.selected||!t&&this.selected;if(this.selected=t,void 0!==this.imageObjAlt&&e){var i=this.imageObj;this.imageObj=this.imageObjAlt,this.imageObjAlt=i}}},{key:"_getImagePadding",value:function(){var t={top:0,right:0,bottom:0,left:0};if(this.options.imagePadding){var e=this.options.imagePadding;"object"==od(e)?(t.top=e.top,t.right=e.right,t.bottom=e.bottom,t.left=e.left):(t.top=e,t.right=e,t.bottom=e,t.left=e)}return t}},{key:"_resizeImage",value:function(){var t,e;if(!1===this.options.shapeProperties.useImageSize){var i=1,o=1;this.imageObj.width&&this.imageObj.height&&(this.imageObj.width>this.imageObj.height?i=this.imageObj.width/this.imageObj.height:o=this.imageObj.height/this.imageObj.width),t=2*this.options.size*i,e=2*this.options.size*o}else{var n=this._getImagePadding();t=this.imageObj.width+n.left+n.right,e=this.imageObj.height+n.top+n.bottom}this.width=t,this.height=e,this.radius=.5*this.width}},{key:"_drawRawCircle",value:function(t,e,i,o){this.initContextForDraw(t,o),Ho(t,e,i,o.size),this.performFill(t,o)}},{key:"_drawImageAtPosition",value:function(t,e){if(0!=this.imageObj.width){t.globalAlpha=void 0!==e.opacity?e.opacity:1,this.enableShadow(t,e);var i=1;!0===this.options.shapeProperties.interpolation&&(i=this.imageObj.width/this.width/this.body.view.scale);var o=this._getImagePadding(),n=this.left+o.left,s=this.top+o.top,r=this.width-o.left-o.right,a=this.height-o.top-o.bottom;this.imageObj.drawImageAtPosition(t,i,n,s,r,a),this.disableShadow(t,e)}}},{key:"_drawImageLabel",value:function(t,e,i,o,n){var s=0;if(void 0!==this.height){s=.5*this.height;var r=this.labelModule.getTextSize(t,o,n);r.lineCount>=1&&(s+=r.height/2)}var a=i+s;this.options.label&&(this.labelOffset=s),this.labelModule.draw(t,e,a,o,n,"hanging")}}]),i}(kE);var SE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n))._setMargins(n),s}return ad(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var o=this.getDimensionsFromLabel(t,e,i),n=Math.max(o.width+this.margin.right+this.margin.left,o.height+this.margin.top+this.margin.bottom);this.options.size=n/2,this.width=n,this.height=n,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,o,n,s){this.resize(t,o,n),this.left=e-this.width/2,this.top=i-this.height/2,this._drawRawCircle(t,e,i,s),this.updateBoundingBox(e,i),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,i,o,n)}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),.5*this.width}}]),i}($E);var CE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n,s,r){var a;return nl(this,i),(a=e.call(this,t,o,n)).setImages(s,r),a}return ad(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var o=2*this.options.size;return this.width=o,this.height=o,void(this.radius=.5*this.width)}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,o,n,s){this.switchImages(o),this.resize();var r=e,a=i;"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,r+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),this._drawRawCircle(t,r,a,s),t.save(),t.clip(),this._drawImageAtPosition(t,s),t.restore(),this._drawImageLabel(t,r,a,o,n),this.updateBoundingBox(e,i)}},{key:"updateBoundingBox",value:function(t,e){"top-left"===this.options.shapeProperties.coordinateOrigin?(this.boundingBox.top=e,this.boundingBox.left=t,this.boundingBox.right=t+2*this.options.size,this.boundingBox.bottom=e+2*this.options.size):(this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size),this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),.5*this.width}}]),i}($E);var OE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:this.options.size};if(this.needsRefresh(e,i)){var n,s;this.labelModule.getTextSize(t,e,i);var r=2*o.size;this.width=null!==(n=this.customSizeWidth)&&void 0!==n?n:r,this.height=null!==(s=this.customSizeHeight)&&void 0!==s?s:r,this.radius=.5*this.width}}},{key:"_drawShape",value:function(t,e,i,o,n,s,r,a){var l,h=this;return this.resize(t,s,r,a),this.left=o-this.width/2,this.top=n-this.height/2,this.initContextForDraw(t,a),(l=e,Object.prototype.hasOwnProperty.call(zo,l)?zo[l]:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];CanvasRenderingContext2D.prototype[l].call(t,i)})(t,o,n,a.size),this.performFill(t,a),void 0!==this.options.icon&&void 0!==this.options.icon.code&&(t.font=(s?"bold ":"")+this.height/2+"px "+(this.options.icon.face||"FontAwesome"),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.options.icon.code,o,n)),{drawExternalLabel:function(){if(void 0!==h.options.label){h.labelModule.calculateLabelSize(t,s,r,o,n,"hanging");var e=n+.5*h.height+.5*h.labelModule.size.height;h.labelModule.draw(t,o,e,s,r,"hanging")}h.updateBoundingBox(o,n)}}}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height))}}]),i}(kE);function RE(t,e){var i=vp(t);if(Xy){var o=Xy(t);e&&(o=Fg(o).call(o,(function(e){return oT(t,e).enumerable}))),i.push.apply(i,o)}return i}function AE(t){for(var e=1;e<arguments.length;e++){var i,o,n=null!=arguments[e]?arguments[e]:{};e%2?xp(i=RE(Object(n),!0)).call(i,(function(e){vT(t,e,n[e])})):lT?fT(t,lT(n)):xp(o=RE(Object(n))).call(o,(function(e){mT(t,e,oT(n,e))}))}return t}var ME=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n,s){var r;return nl(this,i),(r=e.call(this,t,o,n,s)).ctxRenderer=s,r}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){this.resize(t,o,n,s),this.left=e-this.width/2,this.top=i-this.height/2,t.save();var r=this.ctxRenderer({ctx:t,id:this.options.id,x:e,y:i,state:{selected:o,hover:n},style:AE({},s),label:this.options.label});if(null!=r.drawNode&&r.drawNode(),t.restore(),r.drawExternalLabel){var a=r.drawExternalLabel;r.drawExternalLabel=function(){t.save(),a(),t.restore()}}return r.nodeDimensions&&(this.customSizeWidth=r.nodeDimensions.width,this.customSizeHeight=r.nodeDimensions.height),r}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);var xE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n))._setMargins(n),s}return ad(i,[{key:"resize",value:function(t,e,i){if(this.needsRefresh(e,i)){var o=this.getDimensionsFromLabel(t,e,i).width+this.margin.right+this.margin.left;this.width=o,this.height=o,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,o,n,s){this.resize(t,o,n),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,s),Vo(t,e-this.width/2,i-this.height/2,this.width,this.height),this.performFill(t,s),this.updateBoundingBox(e,i,t,o,n),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,o,n)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(kE);var LE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"diamond",4,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);var DE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"circle",2,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),this.options.size}}]),i}(OE);var NE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var o=this.getDimensionsFromLabel(t,e,i);this.height=2*o.height,this.width=o.width+o.height,this.radius=.5*this.width}}},{key:"draw",value:function(t,e,i,o,n,s){this.resize(t,o,n),this.left=e-.5*this.width,this.top=i-.5*this.height,this.initContextForDraw(t,s),Go(t,this.left,this.top,this.width,this.height),this.performFill(t,s),this.updateBoundingBox(e,i,t,o,n),this.labelModule.draw(t,e,i,o,n)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=.5*this.width,o=.5*this.height,n=Math.sin(e)*i,s=Math.cos(e)*o;return i*o/Math.sqrt(n*n+s*s)}}]),i}(kE);var PE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n))._setMargins(n),s}return ad(i,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.iconSize={width:Number(this.options.icon.size),height:Number(this.options.icon.size)},this.width=this.iconSize.width+this.margin.right+this.margin.left,this.height=this.iconSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,o,n,s){var r=this;return this.resize(t,o,n),this.options.icon.size=this.options.icon.size||50,this.left=e-this.width/2,this.top=i-this.height/2,this._icon(t,e,i,o,n,s),{drawExternalLabel:function(){void 0!==r.options.label&&r.labelModule.draw(t,r.left+r.iconSize.width/2+r.margin.left,i+r.height/2+5,o),r.updateBoundingBox(e,i)}}}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-.5*this.options.icon.size,this.boundingBox.left=t-.5*this.options.icon.size,this.boundingBox.right=t+.5*this.options.icon.size,this.boundingBox.bottom=e+.5*this.options.icon.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+5))}},{key:"_icon",value:function(t,e,i,o,n,s){var r=Number(this.options.icon.size);void 0!==this.options.icon.code?(t.font=[null!=this.options.icon.weight?this.options.icon.weight:o?"bold":"",(null!=this.options.icon.weight&&o?5:0)+r+"px",this.options.icon.face].join(" "),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",this.enableShadow(t,s),t.fillText(this.options.icon.code,e,i),this.disableShadow(t,s)):console.error("When using the icon shape, you need to define the code in the icon options object. This can be done per node or globally.")}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(kE);var BE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n,s,r){var a;return nl(this,i),(a=e.call(this,t,o,n)).setImages(s,r),a}return ad(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var o=2*this.options.size;return this.width=o,void(this.height=o)}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,o,n,s){t.save(),this.switchImages(o),this.resize();var r=e,a=i;if("top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,r+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),!0===this.options.shapeProperties.useBorderWithImage){var l=this.options.borderWidth,h=this.options.borderWidthSelected||2*this.options.borderWidth,c=(o?h:l)/this.body.view.scale;t.lineWidth=Math.min(this.width,c),t.beginPath();var u=o?this.options.color.highlight.border:n?this.options.color.hover.border:this.options.color.border,d=o?this.options.color.highlight.background:n?this.options.color.hover.background:this.options.color.background;void 0!==s.opacity&&(u=ib(u,s.opacity),d=ib(d,s.opacity)),t.strokeStyle=u,t.fillStyle=d,t.rect(this.left-.5*t.lineWidth,this.top-.5*t.lineWidth,this.width+t.lineWidth,this.height+t.lineWidth),qf(t).call(t),this.performStroke(t,s),t.closePath()}this._drawImageAtPosition(t,s),this._drawImageLabel(t,r,a,o,n),this.updateBoundingBox(e,i),t.restore()}},{key:"updateBoundingBox",value:function(t,e){this.resize(),"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=t,this.top=e):(this.left=t-this.width/2,this.top=e-this.height/2),this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset))}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}($E);var FE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"square",2,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);var HE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"hexagon",4,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);var UE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"star",4,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);var GE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n))._setMargins(n),s}return ad(i,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.textSize=this.labelModule.getTextSize(t,e,i),this.width=this.textSize.width+this.margin.right+this.margin.left,this.height=this.textSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,o,n,s){this.resize(t,o,n),this.left=e-this.width/2,this.top=i-this.height/2,this.enableShadow(t,s),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,o,n),this.disableShadow(t,s),this.updateBoundingBox(e,i,t,o,n)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(kE);var VE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"triangle",3,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);var WE=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"draw",value:function(t,e,i,o,n,s){return this._drawShape(t,"triangleDown",3,e,i,o,n,s)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(OE);function zE(t,e){var i=vp(t);if(Xy){var o=Xy(t);e&&(o=Fg(o).call(o,(function(e){return oT(t,e).enumerable}))),i.push.apply(i,o)}return i}function jE(t){for(var e=1;e<arguments.length;e++){var i,o,n=null!=arguments[e]?arguments[e]:{};e%2?xp(i=zE(Object(n),!0)).call(i,(function(e){vT(t,e,n[e])})):lT?fT(t,lT(n)):xp(o=zE(Object(n))).call(o,(function(e){mT(t,e,oT(n,e))}))}return t}var XE=function(){function t(e,i,o,n,s,r){nl(this,t),this.options=cb(s),this.globalOptions=s,this.defaultOptions=r,this.body=i,this.edges=[],this.id=void 0,this.imagelist=o,this.grouplist=n,this.x=void 0,this.y=void 0,this.baseSize=this.options.size,this.baseFontSize=this.options.font.size,this.predefinedPosition=!1,this.selected=!1,this.hover=!1,this.labelModule=new qT(this.body,this.options,!1),this.setOptions(e)}return ad(t,[{key:"attachEdge",value:function(t){var e;-1===bf(e=this.edges).call(e,t)&&this.edges.push(t)}},{key:"detachEdge",value:function(t){var e,i,o=bf(e=this.edges).call(e,t);-1!=o&&hg(i=this.edges).call(i,o,1)}},{key:"setOptions",value:function(e){var i=this.options.shape;if(e){if(void 0!==e.color&&(this._localColor=e.color),void 0!==e.id&&(this.id=e.id),void 0===this.id)throw new Error("Node must have an id");t.checkMass(e,this.id),void 0!==e.x&&(null===e.x?(this.x=void 0,this.predefinedPosition=!1):(this.x=lf(e.x),this.predefinedPosition=!0)),void 0!==e.y&&(null===e.y?(this.y=void 0,this.predefinedPosition=!1):(this.y=lf(e.y),this.predefinedPosition=!0)),void 0!==e.size&&(this.baseSize=e.size),void 0!==e.value&&(e.value=CT(e.value)),t.parseOptions(this.options,e,!0,this.globalOptions,this.grouplist);var o=[e,this.options,this.defaultOptions];return this.chooser=LT("node",o),this._load_images(),this.updateLabelModule(e),void 0!==e.opacity&&t.checkOpacity(e.opacity)&&(this.options.opacity=e.opacity),this.updateShape(i),void 0!==e.hidden||void 0!==e.physics}}},{key:"_load_images",value:function(){if(("circularImage"===this.options.shape||"image"===this.options.shape)&&void 0===this.options.image)throw new Error("Option image must be defined for node type '"+this.options.shape+"'");if(void 0!==this.options.image){if(void 0===this.imagelist)throw new Error("Internal Error: No images provided");if("string"==typeof this.options.image)this.imageObj=this.imagelist.load(this.options.image,this.options.brokenImage,this.id);else{if(void 0===this.options.image.unselected)throw new Error("No unselected image provided");this.imageObj=this.imagelist.load(this.options.image.unselected,this.options.brokenImage,this.id),void 0!==this.options.image.selected?this.imageObjAlt=this.imagelist.load(this.options.image.selected,this.options.brokenImage,this.id):this.imageObjAlt=void 0}}}},{key:"getFormattingValues",value:function(){var t={color:this.options.color.background,opacity:this.options.opacity,borderWidth:this.options.borderWidth,borderColor:this.options.color.border,size:this.options.size,borderDashes:this.options.shapeProperties.borderDashes,borderRadius:this.options.shapeProperties.borderRadius,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y};if(this.selected||this.hover?!0===this.chooser?this.selected?(null!=this.options.borderWidthSelected?t.borderWidth=this.options.borderWidthSelected:t.borderWidth*=2,t.color=this.options.color.highlight.background,t.borderColor=this.options.color.highlight.border,t.shadow=this.options.shadow.enabled):this.hover&&(t.color=this.options.color.hover.background,t.borderColor=this.options.color.hover.border,t.shadow=this.options.shadow.enabled):"function"==typeof this.chooser&&(this.chooser(t,this.options.id,this.selected,this.hover),!1===t.shadow&&(t.shadowColor===this.options.shadow.color&&t.shadowSize===this.options.shadow.size&&t.shadowX===this.options.shadow.x&&t.shadowY===this.options.shadow.y||(t.shadow=!0))):t.shadow=this.options.shadow.enabled,void 0!==this.options.opacity){var e=this.options.opacity;t.borderColor=ib(t.borderColor,e),t.color=ib(t.color,e),t.shadowColor=ib(t.shadowColor,e)}return t}},{key:"updateLabelModule",value:function(e){void 0!==this.options.label&&null!==this.options.label||(this.options.label=""),t.updateGroupOptions(this.options,jE(jE({},e),{},{color:e&&e.color||this._localColor||void 0}),this.grouplist);var i=this.grouplist.get(this.options.group,!1),o=[e,this.options,i,this.globalOptions,this.defaultOptions];this.labelModule.update(this.options,o),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateShape",value:function(t){if(t===this.options.shape&&this.shape)this.shape.setOptions(this.options,this.imageObj,this.imageObjAlt);else switch(this.options.shape){case"box":this.shape=new IE(this.options,this.body,this.labelModule);break;case"circle":this.shape=new SE(this.options,this.body,this.labelModule);break;case"circularImage":this.shape=new CE(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"custom":this.shape=new ME(this.options,this.body,this.labelModule,this.options.ctxRenderer);break;case"database":this.shape=new xE(this.options,this.body,this.labelModule);break;case"diamond":this.shape=new LE(this.options,this.body,this.labelModule);break;case"dot":this.shape=new DE(this.options,this.body,this.labelModule);break;case"ellipse":default:this.shape=new NE(this.options,this.body,this.labelModule);break;case"icon":this.shape=new PE(this.options,this.body,this.labelModule);break;case"image":this.shape=new BE(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"square":this.shape=new FE(this.options,this.body,this.labelModule);break;case"hexagon":this.shape=new HE(this.options,this.body,this.labelModule);break;case"star":this.shape=new UE(this.options,this.body,this.labelModule);break;case"text":this.shape=new GE(this.options,this.body,this.labelModule);break;case"triangle":this.shape=new VE(this.options,this.body,this.labelModule);break;case"triangleDown":this.shape=new WE(this.options,this.body,this.labelModule)}this.needsRefresh()}},{key:"select",value:function(){this.selected=!0,this.needsRefresh()}},{key:"unselect",value:function(){this.selected=!1,this.needsRefresh()}},{key:"needsRefresh",value:function(){this.shape.refreshNeeded=!0}},{key:"getTitle",value:function(){return this.options.title}},{key:"distanceToBorder",value:function(t,e){return this.shape.distanceToBorder(t,e)}},{key:"isFixed",value:function(){return this.options.fixed.x&&this.options.fixed.y}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"getLabelSize",value:function(){return this.labelModule.size()}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var o=this.options.scaling.customScalingFunction(t,e,i,this.options.value),n=this.options.scaling.max-this.options.scaling.min;if(!0===this.options.scaling.label.enabled){var s=this.options.scaling.label.max-this.options.scaling.label.min;this.options.font.size=this.options.scaling.label.min+o*s}this.options.size=this.options.scaling.min+o*n}else this.options.size=this.baseSize,this.options.font.size=this.baseFontSize;this.updateLabelModule()}},{key:"draw",value:function(t){var e=this.getFormattingValues();return this.shape.draw(t,this.x,this.y,this.selected,this.hover,e)||{}}},{key:"updateBoundingBox",value:function(t){this.shape.updateBoundingBox(this.x,this.y,t)}},{key:"resize",value:function(t){var e=this.getFormattingValues();this.shape.resize(t,this.selected,this.hover,e)}},{key:"getItemsOnPoint",value:function(t){var e=[];return this.labelModule.visible()&&DT(this.labelModule.getSize(),t)&&e.push({nodeId:this.id,labelId:0}),DT(this.shape.boundingBox,t)&&e.push({nodeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){return this.shape.left<t.right&&this.shape.left+this.shape.width>t.left&&this.shape.top<t.bottom&&this.shape.top+this.shape.height>t.top}},{key:"isBoundingBoxOverlappingWith",value:function(t){return this.shape.boundingBox.left<t.right&&this.shape.boundingBox.right>t.left&&this.shape.boundingBox.top<t.bottom&&this.shape.boundingBox.bottom>t.top}}],[{key:"checkOpacity",value:function(t){return 0<=t&&t<=1}},{key:"checkCoordinateOrigin",value:function(t){return void 0===t||"center"===t||"top-left"===t}},{key:"updateGroupOptions",value:function(e,i,o){var n;if(void 0!==o){var s=e.group;if(void 0!==i&&void 0!==i.group&&s!==i.group)throw new Error("updateGroupOptions: group values in options don't match.");if("number"==typeof s||"string"==typeof s&&""!=s){var r=o.get(s);void 0!==r.opacity&&void 0===i.opacity&&(t.checkOpacity(r.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+r.opacity),r.opacity=void 0));var a=Fg(n=xT(i)).call(n,(function(t){return null!=i[t]}));a.push("font"),Jv(a,e,r),e.color=nb(e.color)}}}},{key:"parseOptions",value:function(e,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;if(Jv(["color","fixed","shadow"],e,i,o),t.checkMass(i),void 0!==e.opacity&&(t.checkOpacity(e.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+e.opacity),e.opacity=void 0)),void 0!==i.opacity&&(t.checkOpacity(i.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+i.opacity),i.opacity=void 0)),i.shapeProperties&&!t.checkCoordinateOrigin(i.shapeProperties.coordinateOrigin)&&console.error("Invalid option for node coordinateOrigin, found: "+i.shapeProperties.coordinateOrigin),ub(e,i,"shadow",n),void 0!==i.color&&null!==i.color){var r=nb(i.color);Yv(e.color,r)}else!0===o&&null===i.color&&(e.color=cb(n.color));void 0!==i.fixed&&null!==i.fixed&&("boolean"==typeof i.fixed?(e.fixed.x=i.fixed,e.fixed.y=i.fixed):(void 0!==i.fixed.x&&"boolean"==typeof i.fixed.x&&(e.fixed.x=i.fixed.x),void 0!==i.fixed.y&&"boolean"==typeof i.fixed.y&&(e.fixed.y=i.fixed.y))),!0===o&&null===i.font&&(e.font=cb(n.font)),t.updateGroupOptions(e,i,s),void 0!==i.scaling&&ub(e.scaling,i.scaling,"label",n.scaling)}},{key:"checkMass",value:function(t,e){if(void 0!==t.mass&&t.mass<=0){var i="";void 0!==e&&(i=" in node id: "+e),console.error("%cNegative or zero mass disallowed"+i+", setting mass to 1.",Sb),t.mass=1}}}]),t}();function YE(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}var KE=function(){function t(e,i,o,n){var s,r=this;if(nl(this,t),this.body=e,this.images=i,this.groups=o,this.layoutEngine=n,this.body.functions.createNode=Fo(s=this.create).call(s,this),this.nodesListeners={add:function(t,e){r.add(e.items)},update:function(t,e){r.update(e.items,e.data,e.oldData)},remove:function(t,e){r.remove(e.items)}},this.defaultOptions={borderWidth:1,borderWidthSelected:void 0,brokenImage:void 0,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},opacity:void 0,fixed:{x:!1,y:!1},font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:0,strokeColor:"#ffffff",align:"center",vadjust:0,multi:!1,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"monospace",vadjust:2}},group:void 0,hidden:!1,icon:{face:"FontAwesome",code:void 0,size:50,color:"#2B7CE9"},image:void 0,imagePadding:{top:0,right:0,bottom:0,left:0},label:void 0,labelHighlightBold:!0,level:void 0,margin:{top:5,right:5,bottom:5,left:5},mass:1,physics:!0,scaling:{min:10,max:30,label:{enabled:!1,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,o){if(e===t)return.5;var n=1/(e-t);return Math.max(0,(o-t)*n)}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},shape:"ellipse",shapeProperties:{borderDashes:!1,borderRadius:6,interpolation:!0,useImageSize:!1,useBorderWithImage:!1,coordinateOrigin:"center"},size:25,title:void 0,value:void 0,x:void 0,y:void 0},this.defaultOptions.mass<=0)throw"Internal error: mass in defaultOptions of NodesHandler may not be zero or negative";this.options=cb(this.defaultOptions),this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("refreshNodes",Fo(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",Fo(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",(function(){tb(i.nodesListeners,(function(t,e){i.body.data.nodes&&i.body.data.nodes.off(e,t)})),delete i.body.functions.createNode,delete i.nodesListeners.add,delete i.nodesListeners.update,delete i.nodesListeners.remove,delete i.nodesListeners}))}},{key:"setOptions",value:function(t){if(void 0!==t){if(XE.parseOptions(this.options,t),void 0!==t.opacity&&(Py(t.opacity)||!Hy(t.opacity)||t.opacity<0||t.opacity>1?console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+t.opacity):this.options.opacity=t.opacity),void 0!==t.shape)for(var e in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&this.body.nodes[e].updateShape();if(void 0!==t.font||void 0!==t.widthConstraint||void 0!==t.heightConstraint)for(var i=0,o=vp(this.body.nodes);i<o.length;i++){var n=o[i];this.body.nodes[n].updateLabelModule(),this.body.nodes[n].needsRefresh()}if(void 0!==t.size)for(var s in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,s)&&this.body.nodes[s].needsRefresh();void 0===t.hidden&&void 0===t.physics||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.data.nodes;if(e.isDataViewLike("id",t))this.body.data.nodes=t;else if(lp(t))this.body.data.nodes=new e.DataSet,this.body.data.nodes.add(t);else{if(t)throw new TypeError("Array or DataSet expected");this.body.data.nodes=new e.DataSet}if(o&&tb(this.nodesListeners,(function(t,e){o.off(e,t)})),this.body.nodes={},this.body.data.nodes){var n=this;tb(this.nodesListeners,(function(t,e){n.body.data.nodes.on(e,t)}));var s=this.body.data.nodes.getIds();this.add(s,!0)}!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],n=0;n<t.length;n++){e=t[n];var s=this.body.data.nodes.get(e),r=this.create(s);o.push(r),this.body.nodes[e]=r}this.layoutEngine.positionInitially(o),!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t,e,i){for(var o=this.body.nodes,n=!1,s=0;s<t.length;s++){var r=t[s],a=o[r],l=e[s];void 0!==a?a.setOptions(l)&&(n=!0):(n=!0,a=this.create(l),o[r]=a)}n||void 0===i||(n=jy(e).call(e,(function(t,e){var o=i[e];return o&&o.level!==t.level}))),!0===n?this.body.emitter.emit("_dataChanged"):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(t){for(var e=this.body.nodes,i=0;i<t.length;i++)delete e[t[i]];this.body.emitter.emit("_dataChanged")}},{key:"create",value:function(t){return new(arguments.length>1&&void 0!==arguments[1]?arguments[1]:XE)(t,this.body,this.images,this.groups,this.options,this.defaultOptions)}},{key:"refresh",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];tb(this.body.nodes,(function(i,o){var n=t.body.data.nodes.get(o);void 0!==n&&(!0===e&&i.setOptions({x:null,y:null}),i.setOptions({fixed:!1}),i.setOptions(n))}))}},{key:"getPositions",value:function(t){var e={};if(void 0!==t){if(!0===lp(t)){for(var i=0;i<t.length;i++)if(void 0!==this.body.nodes[t[i]]){var o=this.body.nodes[t[i]];e[t[i]]={x:Math.round(o.x),y:Math.round(o.y)}}}else if(void 0!==this.body.nodes[t]){var n=this.body.nodes[t];e[t]={x:Math.round(n.x),y:Math.round(n.y)}}}else for(var s=0;s<this.body.nodeIndices.length;s++){var r=this.body.nodes[this.body.nodeIndices[s]];e[this.body.nodeIndices[s]]={x:Math.round(r.x),y:Math.round(r.y)}}return e}},{key:"getPosition",value:function(t){if(null==t)throw new TypeError("No id was specified for getPosition method.");if(null==this.body.nodes[t])throw new ReferenceError("NodeId provided for getPosition does not exist. Provided: ".concat(t));return{x:Math.round(this.body.nodes[t].x),y:Math.round(this.body.nodes[t].y)}}},{key:"storePositions",value:function(){var t,e=[],i=this.body.data.nodes.getDataSet(),o=function(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return YE(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?YE(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}(i.get());try{for(o.s();!(t=o.n()).done;){var n=t.value,s=n.id,r=this.body.nodes[s],a=Math.round(r.x),l=Math.round(r.y);n.x===a&&n.y===l||e.push({id:s,x:a,y:l})}}catch(t){o.e(t)}finally{o.f()}i.update(e)}},{key:"getBoundingBox",value:function(t){if(void 0!==this.body.nodes[t])return this.body.nodes[t].shape.boundingBox}},{key:"getConnectedNodes",value:function(t,e){var i=[];if(void 0!==this.body.nodes[t])for(var o=this.body.nodes[t],n={},s=0;s<o.edges.length;s++){var r=o.edges[s];"to"!==e&&r.toId==o.id?void 0===n[r.fromId]&&(i.push(r.fromId),n[r.fromId]=!0):"from"!==e&&r.fromId==o.id&&void 0===n[r.toId]&&(i.push(r.toId),n[r.toId]=!0)}return i}},{key:"getConnectedEdges",value:function(t){var e=[];if(void 0!==this.body.nodes[t])for(var i=this.body.nodes[t],o=0;o<i.edges.length;o++)e.push(i.edges[o].id);else console.error("NodeId provided for getConnectedEdges does not exist. Provided: ",t);return e}},{key:"moveNode",value:function(t,e,i){var o=this;void 0!==this.body.nodes[t]?(this.body.nodes[t].x=Number(e),this.body.nodes[t].y=Number(i),Gf((function(){o.body.emitter.emit("startSimulation")}),0)):console.error("Node id supplied to moveNode does not exist. Provided: ",t)}}]),t}(),JE=Qt,qE=L,ZE=it,QE=ii,tw=R,ew=Is;Ci({target:"Reflect",stat:!0},{get:function t(e,i){var o,n,s=arguments.length<3?e:arguments[2];return QE(e)===s?e[i]:(o=tw.f(e,i))?function(t){return void 0!==t&&(JE(t,"value")||JE(t,"writable"))}(o)?o.value:void 0===o.get?void 0:qE(o.get,s):ZE(n=ew(e))?t(n,i,s):void 0}});var iw=n(ot.Reflect.get),ow=n(iT);function nw(){var t;return nw="undefined"!=typeof Reflect&&iw?bE(t=iw).call(t):function(t,e,i){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wE(t)););return t}(t,e);if(o){var n=ow(o,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}},nw.apply(this,arguments)}var sw=Ci,rw=Math.hypot,aw=Math.abs,lw=Math.sqrt;sw({target:"Math",stat:!0,arity:2,forced:!!rw&&rw(1/0,NaN)!==1/0},{hypot:function(t,e){for(var i,o,n=0,s=0,r=arguments.length,a=0;s<r;)a<(i=aw(arguments[s++]))?(n=n*(o=a/i)*o+1,a=i):n+=i>0?(o=i/a)*o:i;return a===1/0?1/0:a*lw(n)}});var hw=n(ot.Math.hypot);function cw(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}var uw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"transform",value:function(t,e){lp(t)||(t=[t]);for(var i=e.point.x,o=e.point.y,n=e.angle,s=e.length,r=0;r<t.length;++r){var a=t[r],l=a.x*Math.cos(n)-a.y*Math.sin(n),h=a.x*Math.sin(n)+a.y*Math.cos(n);a.x=i+s*l,a.y=o+s*h}}},{key:"drawPath",value:function(t,e){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.closePath()}}]),t}(),dw=function(t){yE(i,t);var e=cw(i);function i(){return nl(this,i),e.apply(this,arguments)}return ad(i,null,[{key:"draw",value:function(t,e){if(e.image){t.save(),t.translate(e.point.x,e.point.y),t.rotate(Math.PI/2+e.angle);var i=null!=e.imageWidth?e.imageWidth:e.image.width,o=null!=e.imageHeight?e.imageHeight:e.image.height;e.image.drawImageAtPosition(t,1,-i/2,0,i,o),t.restore()}return!1}}]),i}(uw),pw=function(t){yE(i,t);var e=cw(i);function i(){return nl(this,i),e.apply(this,arguments)}return ad(i,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-1,y:.3},{x:-.9,y:0},{x:-1,y:-.3}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),i}(uw),gw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:0},{x:0,y:.3},{x:-.4,y:0},{x:0,y:-.3}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),fw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};uw.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var o=Math.PI,n=e.angle-o/2,s=e.angle+o/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,n,s,!1),t.stroke(),!0}}]),t}(),mw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i={x:-.3,y:0};uw.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var o=Math.PI,n=e.angle+o/2,s=e.angle+3*o/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,n,s,!1),t.stroke(),!0}}]),t}(),vw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:.02,y:0},{x:-1,y:.3},{x:-1,y:-.3}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),bw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-1,y:0}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),_w=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};return uw.transform(i,e),Ho(t,i.x,i.y,.4*e.length),!0}}]),t}(),yw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.5},{x:0,y:-.5},{x:-.15,y:-.5},{x:-.15,y:.5}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),Tw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-.6,y:-.3},{x:-.6,y:.3}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),Ew=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-.5,y:-.3},{x:-1,y:0},{x:-.5,y:.3}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),ww=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:.3},{x:-.5,y:0},{x:-1,y:-.3},{x:0,y:0}];return uw.transform(i,e),uw.drawPath(t,i),!0}}]),t}(),kw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"draw",value:function(t,e){var i;switch(e.type&&(i=e.type.toLowerCase()),i){case"image":return dw.draw(t,e);case"circle":return _w.draw(t,e);case"box":return Tw.draw(t,e);case"crow":return gw.draw(t,e);case"curve":return fw.draw(t,e);case"diamond":return Ew.draw(t,e);case"inv_curve":return mw.draw(t,e);case"triangle":return vw.draw(t,e);case"inv_triangle":return bw.draw(t,e);case"bar":return yw.draw(t,e);case"vee":return ww.draw(t,e);default:return pw.draw(t,e)}}}]),t}();function Iw(t,e){var i=vp(t);if(Xy){var o=Xy(t);e&&(o=Fg(o).call(o,(function(e){return oT(t,e).enumerable}))),i.push.apply(i,o)}return i}function $w(t){for(var e=1;e<arguments.length;e++){var i,o,n=null!=arguments[e]?arguments[e]:{};e%2?xp(i=Iw(Object(n),!0)).call(i,(function(e){vT(t,e,n[e])})):lT?fT(t,lT(n)):xp(o=Iw(Object(n))).call(o,(function(e){mT(t,e,oT(n,e))}))}return t}var Sw=function(){function t(e,i,o){nl(this,t),this._body=i,this._labelModule=o,this.color={},this.colorDirty=!0,this.hoverWidth=1.5,this.selectionWidth=2,this.setOptions(e),this.fromPoint=this.from,this.toPoint=this.to}return ad(t,[{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to]}},{key:"cleanup",value:function(){return!1}},{key:"setOptions",value:function(t){this.options=t,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.id=this.options.id}},{key:"drawLine",value:function(t,e,i,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getViaNode();t.strokeStyle=this.getColor(t,e),t.lineWidth=e.width,!1!==e.dashes?this._drawDashedLine(t,e,n):this._drawLine(t,e,n)}},{key:"_drawLine",value:function(t,e,i,o,n){if(this.from!=this.to)this._line(t,e,i,o,n);else{var s=Xd(this._getCircleData(t),3),r=s[0],a=s[1],l=s[2];this._circle(t,e,r,a,l)}}},{key:"_drawDashedLine",value:function(t,e,i,o,n){t.lineCap="round";var s=lp(e.dashes)?e.dashes:[5,5];if(void 0!==t.setLineDash){if(t.save(),t.setLineDash(s),t.lineDashOffset=0,this.from!=this.to)this._line(t,e,i);else{var r=Xd(this._getCircleData(t),3),a=r[0],l=r[1],h=r[2];this._circle(t,e,a,l,h)}t.setLineDash([0]),t.lineDashOffset=0,t.restore()}else{if(this.from!=this.to)Wo(t,this.from.x,this.from.y,this.to.x,this.to.y,s);else{var c=Xd(this._getCircleData(t),3),u=c[0],d=c[1],p=c[2];this._circle(t,e,u,d,p)}this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}}},{key:"findBorderPosition",value:function(t,e,i){return this.from!=this.to?this._findBorderPosition(t,e,i):this._findBorderPositionCircle(t,e,i)}},{key:"findBorderPositions",value:function(t){if(this.from!=this.to)return{from:this._findBorderPosition(this.from,t),to:this._findBorderPosition(this.to,t)};var e,i=Xd(ep(e=this._getCircleData(t)).call(e,0,2),2),o=i[0],n=i[1];return{from:this._findBorderPositionCircle(this.from,t,{x:o,y:n,low:.25,high:.6,direction:-1}),to:this._findBorderPositionCircle(this.from,t,{x:o,y:n,low:.6,high:.8,direction:1})}}},{key:"_getCircleData",value:function(t){var e=this.options.selfReference.size;void 0!==t&&void 0===this.from.shape.width&&this.from.shape.resize(t);var i=PT(t,this.options.selfReference.angle,e,this.from);return[i.x,i.y,e]}},{key:"_pointOnCircle",value:function(t,e,i,o){var n=2*o*Math.PI;return{x:t+i*Math.cos(n),y:e-i*Math.sin(n)}}},{key:"_findBorderPositionCircle",value:function(t,e,i){var o,n=i.x,s=i.y,r=i.low,a=i.high,l=i.direction,h=this.options.selfReference.size,c=.5*(r+a),u=0;!0===this.options.arrowStrikethrough&&(-1===l?u=this.options.endPointOffset.from:1===l&&(u=this.options.endPointOffset.to));var d=0;do{c=.5*(r+a),o=this._pointOnCircle(n,s,h,c);var p=Math.atan2(t.y-o.y,t.x-o.x),g=t.distanceToBorder(e,p)+u-Math.sqrt(Math.pow(o.x-t.x,2)+Math.pow(o.y-t.y,2));if(Math.abs(g)<.05)break;g>0?l>0?r=c:a=c:l>0?a=c:r=c,++d}while(r<=a&&d<10);return $w($w({},o),{},{t:c})}},{key:"getLineWidth",value:function(t,e){return!0===t?Math.max(this.selectionWidth,.3/this._body.view.scale):!0===e?Math.max(this.hoverWidth,.3/this._body.view.scale):Math.max(this.options.width,.3/this._body.view.scale)}},{key:"getColor",value:function(t,e){if(!1!==e.inheritsColor){if("both"===e.inheritsColor&&this.from.id!==this.to.id){var i=t.createLinearGradient(this.from.x,this.from.y,this.to.x,this.to.y),o=this.from.options.color.highlight.border,n=this.to.options.color.highlight.border;return!1===this.from.selected&&!1===this.to.selected?(o=ib(this.from.options.color.border,e.opacity),n=ib(this.to.options.color.border,e.opacity)):!0===this.from.selected&&!1===this.to.selected?n=this.to.options.color.border:!1===this.from.selected&&!0===this.to.selected&&(o=this.from.options.color.border),i.addColorStop(0,o),i.addColorStop(1,n),i}return"to"===e.inheritsColor?ib(this.to.options.color.border,e.opacity):ib(this.from.options.color.border,e.opacity)}return ib(e.color,e.opacity)}},{key:"_circle",value:function(t,e,i,o,n){this.enableShadow(t,e);var s=0,r=2*Math.PI;if(!this.options.selfReference.renderBehindTheNode){var a=this.options.selfReference.angle,l=this.options.selfReference.angle+Math.PI,h=this._findBorderPositionCircle(this.from,t,{x:i,y:o,low:a,high:l,direction:-1}),c=this._findBorderPositionCircle(this.from,t,{x:i,y:o,low:a,high:l,direction:1});s=Math.atan2(h.y-o,h.x-i),r=Math.atan2(c.y-o,c.x-i)}t.beginPath(),t.arc(i,o,n,s,r,!1),t.stroke(),this.disableShadow(t,e)}},{key:"getDistanceToEdge",value:function(t,e,i,o,n,s){if(this.from!=this.to)return this._getDistanceToEdge(t,e,i,o,n,s);var r=Xd(this._getCircleData(void 0),3),a=r[0],l=r[1],h=r[2],c=a-n,u=l-s;return Math.abs(Math.sqrt(c*c+u*u)-h)}},{key:"_getDistanceToLine",value:function(t,e,i,o,n,s){var r=i-t,a=o-e,l=((n-t)*r+(s-e)*a)/(r*r+a*a);l>1?l=1:l<0&&(l=0);var h=t+l*r-n,c=e+l*a-s;return Math.sqrt(h*h+c*c)}},{key:"getArrowData",value:function(t,e,i,o,n,s){var r,a,l,h,c,u,d,p=s.width;"from"===e?(l=this.from,h=this.to,c=s.fromArrowScale<0,u=Math.abs(s.fromArrowScale),d=s.fromArrowType):"to"===e?(l=this.to,h=this.from,c=s.toArrowScale<0,u=Math.abs(s.toArrowScale),d=s.toArrowType):(l=this.to,h=this.from,c=s.middleArrowScale<0,u=Math.abs(s.middleArrowScale),d=s.middleArrowType);var g=15*u+3*p;if(l!=h){var f=g/hw(l.x-h.x,l.y-h.y);if("middle"!==e)if(!0===this.options.smooth.enabled){var m=this._findBorderPosition(l,t,{via:i}),v=this.getPoint(m.t+f*("from"===e?1:-1),i);r=Math.atan2(m.y-v.y,m.x-v.x),a=m}else r=Math.atan2(l.y-h.y,l.x-h.x),a=this._findBorderPosition(l,t);else{var b=(c?-f:f)/2,_=this.getPoint(.5+b,i),y=this.getPoint(.5-b,i);r=Math.atan2(_.y-y.y,_.x-y.x),a=this.getPoint(.5,i)}}else{var T=Xd(this._getCircleData(t),3),E=T[0],w=T[1],k=T[2];if("from"===e){var I=this.options.selfReference.angle,$=this.options.selfReference.angle+Math.PI,S=this._findBorderPositionCircle(this.from,t,{x:E,y:w,low:I,high:$,direction:-1});r=-2*S.t*Math.PI+1.5*Math.PI+.1*Math.PI,a=S}else if("to"===e){var C=this.options.selfReference.angle,O=this.options.selfReference.angle+Math.PI,R=this._findBorderPositionCircle(this.from,t,{x:E,y:w,low:C,high:O,direction:1});r=-2*R.t*Math.PI+1.5*Math.PI-1.1*Math.PI,a=R}else{var A=this.options.selfReference.angle/(2*Math.PI);a=this._pointOnCircle(E,w,k,A),r=-2*A*Math.PI+1.5*Math.PI+.1*Math.PI}}return{point:a,core:{x:a.x-.9*g*Math.cos(r),y:a.y-.9*g*Math.sin(r)},angle:r,length:g,type:d}}},{key:"drawArrowHead",value:function(t,e,i,o,n){t.strokeStyle=this.getColor(t,e),t.fillStyle=t.strokeStyle,t.lineWidth=e.width,kw.draw(t,n)&&(this.enableShadow(t,e),qf(t).call(t),this.disableShadow(t,e))}},{key:"enableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"drawBackground",value:function(t,e){if(!1!==e.background){var i={strokeStyle:t.strokeStyle,lineWidth:t.lineWidth,dashes:t.dashes};t.strokeStyle=e.backgroundColor,t.lineWidth=e.backgroundSize,this.setStrokeDashed(t,e.backgroundDashes),t.stroke(),t.strokeStyle=i.strokeStyle,t.lineWidth=i.lineWidth,t.dashes=i.dashes,this.setStrokeDashed(t,e.dashes)}}},{key:"setStrokeDashed",value:function(t,e){if(!1!==e)if(void 0!==t.setLineDash){var i=lp(e)?e:[5,5];t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.");else void 0!==t.setLineDash?t.setLineDash([]):console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.")}}]),t}();function Cw(t,e){var i=vp(t);if(Xy){var o=Xy(t);e&&(o=Fg(o).call(o,(function(e){return oT(t,e).enumerable}))),i.push.apply(i,o)}return i}function Ow(t){for(var e=1;e<arguments.length;e++){var i,o,n=null!=arguments[e]?arguments[e]:{};e%2?xp(i=Cw(Object(n),!0)).call(i,(function(e){vT(t,e,n[e])})):lT?fT(t,lT(n)):xp(o=Cw(Object(n))).call(o,(function(e){mT(t,e,oT(n,e))}))}return t}var Rw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"_findBorderPositionBezier",value:function(t,e){var i,o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getViaCoordinates(),s=!1,r=1,a=0,l=this.to,h=this.options.endPointOffset?this.options.endPointOffset.to:0;t.id===this.from.id&&(l=this.from,s=!0,h=this.options.endPointOffset?this.options.endPointOffset.from:0),!1===this.options.arrowStrikethrough&&(h=0);var c=0;do{o=.5*(a+r),i=this.getPoint(o,n);var u=Math.atan2(l.y-i.y,l.x-i.x),d=l.distanceToBorder(e,u)+h-Math.sqrt(Math.pow(i.x-l.x,2)+Math.pow(i.y-l.y,2));if(Math.abs(d)<.2)break;d<0?!1===s?a=o:r=o:!1===s?r=o:a=o,++c}while(a<=r&&c<10);return Ow(Ow({},i),{},{t:o})}},{key:"_getDistanceToBezierEdge",value:function(t,e,i,o,n,s,r){var a,l,h,c,u,d=1e9,p=t,g=e;for(l=1;l<10;l++)h=.1*l,c=Math.pow(1-h,2)*t+2*h*(1-h)*r.x+Math.pow(h,2)*i,u=Math.pow(1-h,2)*e+2*h*(1-h)*r.y+Math.pow(h,2)*o,l>0&&(d=(a=this._getDistanceToLine(p,g,c,u,n,s))<d?a:d),p=c,g=u;return d}},{key:"_bezierCurve",value:function(t,e,i,o){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),null!=i&&null!=i.x?null!=o&&null!=o.x?t.bezierCurveTo(i.x,i.y,o.x,o.y,this.toPoint.x,this.toPoint.y):t.quadraticCurveTo(i.x,i.y,this.toPoint.x,this.toPoint.y):t.lineTo(this.toPoint.x,this.toPoint.y),this.drawBackground(t,e),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}}]),i}(Sw);var Aw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n)).via=s.via,s._boundFunction=function(){s.positionBezierNode()},s._body.emitter.on("_repositionBezierNodes",s._boundFunction),s}return ad(i,[{key:"setOptions",value:function(t){nw(wE(i.prototype),"setOptions",this).call(this,t);var e=!1;this.options.physics!==t.physics&&(e=!0),this.options=t,this.id=this.options.id,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.setupSupportNode(),this.connect(),!0===e&&(this.via.setOptions({physics:this.options.physics}),this.positionBezierNode())}},{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],void 0===this.from||void 0===this.to||!1===this.options.physics||this.from.id===this.to.id?this.via.setOptions({physics:!1}):this.via.setOptions({physics:!0})}},{key:"cleanup",value:function(){return this._body.emitter.off("_repositionBezierNodes",this._boundFunction),void 0!==this.via&&(delete this._body.nodes[this.via.id],this.via=void 0,!0)}},{key:"setupSupportNode",value:function(){if(void 0===this.via){var t="edgeId:"+this.id,e=this._body.functions.createNode({id:t,shape:"circle",physics:!0,hidden:!0});this._body.nodes[t]=e,this.via=e,this.via.parentEdgeId=this.id,this.positionBezierNode()}}},{key:"positionBezierNode",value:function(){void 0!==this.via&&void 0!==this.from&&void 0!==this.to?(this.via.x=.5*(this.from.x+this.to.x),this.via.y=.5*(this.from.y+this.to.y)):void 0!==this.via&&(this.via.x=0,this.via.y=0)}},{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"_getViaCoordinates",value:function(){return this.via}},{key:"getViaNode",value:function(){return this.via}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.via;if(this.from===this.to){var i=Xd(this._getCircleData(),3),o=i[0],n=i[1],s=i[2],r=2*Math.PI*(1-t);return{x:o+s*Math.sin(r),y:n+s-s*(1-Math.cos(r))}}return{x:Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*e.x+Math.pow(t,2)*this.toPoint.x,y:Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*e.y+Math.pow(t,2)*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e,this.via)}},{key:"_getDistanceToEdge",value:function(t,e,i,o,n,s){return this._getDistanceToBezierEdge(t,e,i,o,n,s,this.via)}}]),i}(Rw);var Mw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_getViaCoordinates",value:function(){var t,e,i=this.options.smooth.roundness,o=this.options.smooth.type,n=Math.abs(this.from.x-this.to.x),s=Math.abs(this.from.y-this.to.y);if("discrete"===o||"diagonalCross"===o){var r,a;r=a=n<=s?i*s:i*n,this.from.x>this.to.x&&(r=-r),this.from.y>=this.to.y&&(a=-a);var l=this.from.x+r,h=this.from.y+a;return"discrete"===o&&(n<=s?l=n<i*s?this.from.x:l:h=s<i*n?this.from.y:h),{x:l,y:h}}if("straightCross"===o){var c=(1-i)*n,u=(1-i)*s;return n<=s?(c=0,this.from.y<this.to.y&&(u=-u)):(this.from.x<this.to.x&&(c=-c),u=0),{x:this.to.x+c,y:this.to.y+u}}if("horizontal"===o){var d=(1-i)*n;return this.from.x<this.to.x&&(d=-d),{x:this.to.x+d,y:this.from.y}}if("vertical"===o){var p=(1-i)*s;return this.from.y<this.to.y&&(p=-p),{x:this.from.x,y:this.to.y+p}}if("curvedCW"===o){n=this.to.x-this.from.x,s=this.from.y-this.to.y;var g=Math.sqrt(n*n+s*s),f=Math.PI,m=(Math.atan2(s,n)+(.5*i+.5)*f)%(2*f);return{x:this.from.x+(.5*i+.5)*g*Math.sin(m),y:this.from.y+(.5*i+.5)*g*Math.cos(m)}}if("curvedCCW"===o){n=this.to.x-this.from.x,s=this.from.y-this.to.y;var v=Math.sqrt(n*n+s*s),b=Math.PI,_=(Math.atan2(s,n)+(.5*-i+.5)*b)%(2*b);return{x:this.from.x+(.5*i+.5)*v*Math.sin(_),y:this.from.y+(.5*i+.5)*v*Math.cos(_)}}t=e=n<=s?i*s:i*n,this.from.x>this.to.x&&(t=-t),this.from.y>=this.to.y&&(e=-e);var y=this.from.x+t,T=this.from.y+e;return n<=s?y=this.from.x<=this.to.x?this.to.x<y?this.to.x:y:this.to.x>y?this.to.x:y:T=this.from.y>=this.to.y?this.to.y>T?this.to.y:T:this.to.y<T?this.to.y:T,{x:y,y:T}}},{key:"_findBorderPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._findBorderPositionBezier(t,e,i.via)}},{key:"_getDistanceToEdge",value:function(t,e,i,o,n,s){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates();return this._getDistanceToBezierEdge(t,e,i,o,n,s,r)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),i=t;return{x:Math.pow(1-i,2)*this.fromPoint.x+2*i*(1-i)*e.x+Math.pow(i,2)*this.toPoint.x,y:Math.pow(1-i,2)*this.fromPoint.y+2*i*(1-i)*e.y+Math.pow(i,2)*this.toPoint.y}}}]),i}(Rw);var xw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"_getDistanceToBezierEdge2",value:function(t,e,i,o,n,s,r,a){for(var l=1e9,h=t,c=e,u=[0,0,0,0],d=1;d<10;d++){var p=.1*d;u[0]=Math.pow(1-p,3),u[1]=3*p*Math.pow(1-p,2),u[2]=3*Math.pow(p,2)*(1-p),u[3]=Math.pow(p,3);var g=u[0]*t+u[1]*r.x+u[2]*a.x+u[3]*i,f=u[0]*e+u[1]*r.y+u[2]*a.y+u[3]*o;if(d>0){var m=this._getDistanceToLine(h,c,g,f,n,s);l=m<l?m:l}h=g,c=f}return l}}]),i}(Rw);var Lw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"_line",value:function(t,e,i){var o=i[0],n=i[1];this._bezierCurve(t,e,o,n)}},{key:"_getViaCoordinates",value:function(){var t,e,i,o,n=this.from.x-this.to.x,s=this.from.y-this.to.y,r=this.options.smooth.roundness;return(Math.abs(n)>Math.abs(s)||!0===this.options.smooth.forceDirection||"horizontal"===this.options.smooth.forceDirection)&&"vertical"!==this.options.smooth.forceDirection?(e=this.from.y,o=this.to.y,t=this.from.x-r*n,i=this.to.x+r*n):(e=this.from.y-r*s,o=this.to.y+r*s,t=this.from.x,i=this.to.x),[{x:t,y:e},{x:i,y:o}]}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e)}},{key:"_getDistanceToEdge",value:function(t,e,i,o,n,s){var r=Xd(arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates(),2),a=r[0],l=r[1];return this._getDistanceToBezierEdge2(t,e,i,o,n,s,a,l)}},{key:"getPoint",value:function(t){var e=Xd(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),2),i=e[0],o=e[1],n=t,s=[Math.pow(1-n,3),3*n*Math.pow(1-n,2),3*Math.pow(n,2)*(1-n),Math.pow(n,3)];return{x:s[0]*this.fromPoint.x+s[1]*i.x+s[2]*o.x+s[3]*this.toPoint.x,y:s[0]*this.fromPoint.y+s[1]*i.y+s[2]*o.y+s[3]*this.toPoint.y}}}]),i}(xw);var Dw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"_line",value:function(t,e){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),t.lineTo(this.toPoint.x,this.toPoint.y),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){}},{key:"getPoint",value:function(t){return{x:(1-t)*this.fromPoint.x+t*this.toPoint.x,y:(1-t)*this.fromPoint.y+t*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){var i=this.to,o=this.from;t.id===this.from.id&&(i=this.from,o=this.to);var n=Math.atan2(i.y-o.y,i.x-o.x),s=i.x-o.x,r=i.y-o.y,a=Math.sqrt(s*s+r*r),l=(a-t.distanceToBorder(e,n))/a;return{x:(1-l)*o.x+l*i.x,y:(1-l)*o.y+l*i.y,t:0}}},{key:"_getDistanceToEdge",value:function(t,e,i,o,n,s){return this._getDistanceToLine(t,e,i,o,n,s)}}]),i}(Sw),Nw=function(){function t(e,i,o,n,s){if(nl(this,t),void 0===i)throw new Error("No body provided");this.options=cb(n),this.globalOptions=n,this.defaultOptions=s,this.body=i,this.imagelist=o,this.id=void 0,this.fromId=void 0,this.toId=void 0,this.selected=!1,this.hover=!1,this.labelDirty=!0,this.baseWidth=this.options.width,this.baseFontSize=this.options.font.size,this.from=void 0,this.to=void 0,this.edgeType=void 0,this.connected=!1,this.labelModule=new qT(this.body,this.options,!0),this.setOptions(e)}return ad(t,[{key:"setOptions",value:function(e){if(e){var i=void 0!==e.physics&&this.options.physics!==e.physics||void 0!==e.hidden&&(this.options.hidden||!1)!==(e.hidden||!1)||void 0!==e.from&&this.options.from!==e.from||void 0!==e.to&&this.options.to!==e.to;t.parseOptions(this.options,e,!0,this.globalOptions),void 0!==e.id&&(this.id=e.id),void 0!==e.from&&(this.fromId=e.from),void 0!==e.to&&(this.toId=e.to),void 0!==e.title&&(this.title=e.title),void 0!==e.value&&(e.value=CT(e.value));var o=[e,this.options,this.defaultOptions];return this.chooser=LT("edge",o),this.updateLabelModule(e),i=this.updateEdgeType()||i,this._setInteractionWidths(),this.connect(),i}}},{key:"getFormattingValues",value:function(){var t=!0===this.options.arrows.to||!0===this.options.arrows.to.enabled,e=!0===this.options.arrows.from||!0===this.options.arrows.from.enabled,i=!0===this.options.arrows.middle||!0===this.options.arrows.middle.enabled,o=this.options.color.inherit,n={toArrow:t,toArrowScale:this.options.arrows.to.scaleFactor,toArrowType:this.options.arrows.to.type,toArrowSrc:this.options.arrows.to.src,toArrowImageWidth:this.options.arrows.to.imageWidth,toArrowImageHeight:this.options.arrows.to.imageHeight,middleArrow:i,middleArrowScale:this.options.arrows.middle.scaleFactor,middleArrowType:this.options.arrows.middle.type,middleArrowSrc:this.options.arrows.middle.src,middleArrowImageWidth:this.options.arrows.middle.imageWidth,middleArrowImageHeight:this.options.arrows.middle.imageHeight,fromArrow:e,fromArrowScale:this.options.arrows.from.scaleFactor,fromArrowType:this.options.arrows.from.type,fromArrowSrc:this.options.arrows.from.src,fromArrowImageWidth:this.options.arrows.from.imageWidth,fromArrowImageHeight:this.options.arrows.from.imageHeight,arrowStrikethrough:this.options.arrowStrikethrough,color:o?void 0:this.options.color.color,inheritsColor:o,opacity:this.options.color.opacity,hidden:this.options.hidden,length:this.options.length,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y,dashes:this.options.dashes,width:this.options.width,background:this.options.background.enabled,backgroundColor:this.options.background.color,backgroundSize:this.options.background.size,backgroundDashes:this.options.background.dashes};if(this.selected||this.hover)if(!0===this.chooser){if(this.selected){var s=this.options.selectionWidth;"function"==typeof s?n.width=s(n.width):"number"==typeof s&&(n.width+=s),n.width=Math.max(n.width,.3/this.body.view.scale),n.color=this.options.color.highlight,n.shadow=this.options.shadow.enabled}else if(this.hover){var r=this.options.hoverWidth;"function"==typeof r?n.width=r(n.width):"number"==typeof r&&(n.width+=r),n.width=Math.max(n.width,.3/this.body.view.scale),n.color=this.options.color.hover,n.shadow=this.options.shadow.enabled}}else"function"==typeof this.chooser&&(this.chooser(n,this.options.id,this.selected,this.hover),void 0!==n.color&&(n.inheritsColor=!1),!1===n.shadow&&(n.shadowColor===this.options.shadow.color&&n.shadowSize===this.options.shadow.size&&n.shadowX===this.options.shadow.x&&n.shadowY===this.options.shadow.y||(n.shadow=!0)));else n.shadow=this.options.shadow.enabled,n.width=Math.max(n.width,.3/this.body.view.scale);return n}},{key:"updateLabelModule",value:function(t){var e=[t,this.options,this.globalOptions,this.defaultOptions];this.labelModule.update(this.options,e),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateEdgeType",value:function(){var t=this.options.smooth,e=!1,i=!0;return void 0!==this.edgeType&&((this.edgeType instanceof Aw&&!0===t.enabled&&"dynamic"===t.type||this.edgeType instanceof Lw&&!0===t.enabled&&"cubicBezier"===t.type||this.edgeType instanceof Mw&&!0===t.enabled&&"dynamic"!==t.type&&"cubicBezier"!==t.type||this.edgeType instanceof Dw&&!1===t.type.enabled)&&(i=!1),!0===i&&(e=this.cleanup())),!0===i?!0===t.enabled?"dynamic"===t.type?(e=!0,this.edgeType=new Aw(this.options,this.body,this.labelModule)):"cubicBezier"===t.type?this.edgeType=new Lw(this.options,this.body,this.labelModule):this.edgeType=new Mw(this.options,this.body,this.labelModule):this.edgeType=new Dw(this.options,this.body,this.labelModule):this.edgeType.setOptions(this.options),e}},{key:"connect",value:function(){this.disconnect(),this.from=this.body.nodes[this.fromId]||void 0,this.to=this.body.nodes[this.toId]||void 0,this.connected=void 0!==this.from&&void 0!==this.to,!0===this.connected?(this.from.attachEdge(this),this.to.attachEdge(this)):(this.from&&this.from.detachEdge(this),this.to&&this.to.detachEdge(this)),this.edgeType.connect()}},{key:"disconnect",value:function(){this.from&&(this.from.detachEdge(this),this.from=void 0),this.to&&(this.to.detachEdge(this),this.to=void 0),this.connected=!1}},{key:"getTitle",value:function(){return this.title}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var o=this.options.scaling.customScalingFunction(t,e,i,this.options.value),n=this.options.scaling.max-this.options.scaling.min;if(!0===this.options.scaling.label.enabled){var s=this.options.scaling.label.max-this.options.scaling.label.min;this.options.font.size=this.options.scaling.label.min+o*s}this.options.width=this.options.scaling.min+o*n}else this.options.width=this.baseWidth,this.options.font.size=this.baseFontSize;this._setInteractionWidths(),this.updateLabelModule()}},{key:"_setInteractionWidths",value:function(){"function"==typeof this.options.hoverWidth?this.edgeType.hoverWidth=this.options.hoverWidth(this.options.width):this.edgeType.hoverWidth=this.options.hoverWidth+this.options.width,"function"==typeof this.options.selectionWidth?this.edgeType.selectionWidth=this.options.selectionWidth(this.options.width):this.edgeType.selectionWidth=this.options.selectionWidth+this.options.width}},{key:"draw",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode();this.edgeType.drawLine(t,e,this.selected,this.hover,i),this.drawLabel(t,i)}}},{key:"drawArrows",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode(),o={};this.edgeType.fromPoint=this.edgeType.from,this.edgeType.toPoint=this.edgeType.to,e.fromArrow&&(o.from=this.edgeType.getArrowData(t,"from",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.fromPoint=o.from.core),e.fromArrowSrc&&(o.from.image=this.imagelist.load(e.fromArrowSrc)),e.fromArrowImageWidth&&(o.from.imageWidth=e.fromArrowImageWidth),e.fromArrowImageHeight&&(o.from.imageHeight=e.fromArrowImageHeight)),e.toArrow&&(o.to=this.edgeType.getArrowData(t,"to",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.toPoint=o.to.core),e.toArrowSrc&&(o.to.image=this.imagelist.load(e.toArrowSrc)),e.toArrowImageWidth&&(o.to.imageWidth=e.toArrowImageWidth),e.toArrowImageHeight&&(o.to.imageHeight=e.toArrowImageHeight)),e.middleArrow&&(o.middle=this.edgeType.getArrowData(t,"middle",i,this.selected,this.hover,e),e.middleArrowSrc&&(o.middle.image=this.imagelist.load(e.middleArrowSrc)),e.middleArrowImageWidth&&(o.middle.imageWidth=e.middleArrowImageWidth),e.middleArrowImageHeight&&(o.middle.imageHeight=e.middleArrowImageHeight)),e.fromArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,o.from),e.middleArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,o.middle),e.toArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,o.to)}}},{key:"drawLabel",value:function(t,e){if(void 0!==this.options.label){var i,o=this.from,n=this.to;if(this.labelModule.differentState(this.selected,this.hover)&&this.labelModule.getTextSize(t,this.selected,this.hover),o.id!=n.id){this.labelModule.pointToSelf=!1,i=this.edgeType.getPoint(.5,e),t.save();var s=this._getRotation(t);0!=s.angle&&(t.translate(s.x,s.y),t.rotate(s.angle)),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover),t.restore()}else{this.labelModule.pointToSelf=!0;var r=PT(t,this.options.selfReference.angle,this.options.selfReference.size,o);i=this._pointOnCircle(r.x,r.y,this.options.selfReference.size,this.options.selfReference.angle),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover)}}}},{key:"getItemsOnPoint",value:function(t){var e=[];if(this.labelModule.visible()){var i=this._getRotation();DT(this.labelModule.getSize(),t,i)&&e.push({edgeId:this.id,labelId:0})}var o={left:t.x,top:t.y};return this.isOverlappingWith(o)&&e.push({edgeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){if(this.connected){var e=this.from.x,i=this.from.y,o=this.to.x,n=this.to.y,s=t.left,r=t.top;return this.edgeType.getDistanceToEdge(e,i,o,n,s,r)<10}return!1}},{key:"_getRotation",value:function(t){var e=this.edgeType.getViaNode(),i=this.edgeType.getPoint(.5,e);void 0!==t&&this.labelModule.calculateLabelSize(t,this.selected,this.hover,i.x,i.y);var o={x:i.x,y:this.labelModule.size.yLine,angle:0};if(!this.labelModule.visible())return o;if("horizontal"===this.options.font.align)return o;var n=this.from.y-this.to.y,s=this.from.x-this.to.x,r=Math.atan2(n,s);return(r<-1&&s<0||r>0&&s<0)&&(r+=Math.PI),o.angle=r,o}},{key:"_pointOnCircle",value:function(t,e,i,o){return{x:t+i*Math.cos(o),y:e-i*Math.sin(o)}}},{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"cleanup",value:function(){return this.edgeType.cleanup()}},{key:"remove",value:function(){this.cleanup(),this.disconnect(),delete this.body.edges[this.id]}},{key:"endPointsValid",value:function(){return void 0!==this.body.nodes[this.fromId]&&void 0!==this.body.nodes[this.toId]}}],[{key:"parseOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Kv(["endPointOffset","arrowStrikethrough","id","from","hidden","hoverWidth","labelHighlightBold","length","line","opacity","physics","scaling","selectionWidth","selfReferenceSize","selfReference","to","title","value","width","font","chosen","widthConstraint"],t,e,i),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.from&&(Hy(e.endPointOffset.from)?t.endPointOffset.from=e.endPointOffset.from:(t.endPointOffset.from=void 0!==o.endPointOffset.from?o.endPointOffset.from:0,console.error("endPointOffset.from is not a valid number"))),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.to&&(Hy(e.endPointOffset.to)?t.endPointOffset.to=e.endPointOffset.to:(t.endPointOffset.to=void 0!==o.endPointOffset.to?o.endPointOffset.to:0,console.error("endPointOffset.to is not a valid number"))),NT(e.label)?t.label=e.label:NT(t.label)||(t.label=void 0),ub(t,e,"smooth",o),ub(t,e,"shadow",o),ub(t,e,"background",o),void 0!==e.dashes&&null!==e.dashes?t.dashes=e.dashes:!0===i&&null===e.dashes&&(t.dashes=Tf(o.dashes)),void 0!==e.scaling&&null!==e.scaling?(void 0!==e.scaling.min&&(t.scaling.min=e.scaling.min),void 0!==e.scaling.max&&(t.scaling.max=e.scaling.max),ub(t.scaling,e.scaling,"label",o.scaling)):!0===i&&null===e.scaling&&(t.scaling=Tf(o.scaling)),void 0!==e.arrows&&null!==e.arrows)if("string"==typeof e.arrows){var s=e.arrows.toLowerCase();t.arrows.to.enabled=-1!=bf(s).call(s,"to"),t.arrows.middle.enabled=-1!=bf(s).call(s,"middle"),t.arrows.from.enabled=-1!=bf(s).call(s,"from")}else{if("object"!==od(e.arrows))throw new Error("The arrow newOptions can only be an object or a string. Refer to the documentation. You used:"+kf(e.arrows));ub(t.arrows,e.arrows,"to",o.arrows),ub(t.arrows,e.arrows,"middle",o.arrows),ub(t.arrows,e.arrows,"from",o.arrows)}else!0===i&&null===e.arrows&&(t.arrows=Tf(o.arrows));if(void 0!==e.color&&null!==e.color){var r=zv(e.color)?{color:e.color,highlight:e.color,hover:e.color,inherit:!1,opacity:1}:e.color,a=t.color;if(n)qv(a,o.color,!1,i);else for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&delete a[l];if(zv(a))a.color=a,a.highlight=a,a.hover=a,a.inherit=!1,void 0===r.opacity&&(a.opacity=1);else{var h=!1;void 0!==r.color&&(a.color=r.color,h=!0),void 0!==r.highlight&&(a.highlight=r.highlight,h=!0),void 0!==r.hover&&(a.hover=r.hover,h=!0),void 0!==r.inherit&&(a.inherit=r.inherit),void 0!==r.opacity&&(a.opacity=Math.min(1,Math.max(0,r.opacity))),!0===h?a.inherit=!1:void 0===a.inherit&&(a.inherit="from")}}else!0===i&&null===e.color&&(t.color=cb(o.color));!0===i&&null===e.font&&(t.font=cb(o.font)),Object.prototype.hasOwnProperty.call(e,"selfReferenceSize")&&(console.warn("The selfReferenceSize property has been deprecated. Please use selfReference property instead. The selfReference can be set like thise selfReference:{size:30, angle:Math.PI / 4}"),t.selfReference.size=e.selfReferenceSize)}}]),t}(),Pw=function(){function t(e,i,o){var n,s=this;nl(this,t),this.body=e,this.images=i,this.groups=o,this.body.functions.createEdge=Fo(n=this.create).call(n,this),this.edgesListeners={add:function(t,e){s.add(e.items)},update:function(t,e){s.update(e.items)},remove:function(t,e){s.remove(e.items)}},this.options={},this.defaultOptions={arrows:{to:{enabled:!1,scaleFactor:1,type:"arrow"},middle:{enabled:!1,scaleFactor:1,type:"arrow"},from:{enabled:!1,scaleFactor:1,type:"arrow"}},endPointOffset:{from:0,to:0},arrowStrikethrough:!0,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},dashes:!1,font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:2,strokeColor:"#ffffff",align:"horizontal",multi:!1,vadjust:0,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},hidden:!1,hoverWidth:1.5,label:void 0,labelHighlightBold:!0,length:void 0,physics:!0,scaling:{min:1,max:15,label:{enabled:!0,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,o){if(e===t)return.5;var n=1/(e-t);return Math.max(0,(o-t)*n)}},selectionWidth:1.5,selfReference:{size:20,angle:Math.PI/4,renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},background:{enabled:!1,color:"rgba(111,111,111,1)",size:10,dashes:!1},smooth:{enabled:!0,type:"dynamic",forceDirection:"none",roundness:.5},title:void 0,width:1,value:void 0},qv(this.options,this.defaultOptions),this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("_forceDisableDynamicCurves",(function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"dynamic"===t&&(t="continuous");var o=!1;for(var n in i.body.edges)if(Object.prototype.hasOwnProperty.call(i.body.edges,n)){var s=i.body.edges[n],r=i.body.data.edges.get(n);if(null!=r){var a=r.smooth;void 0!==a&&!0===a.enabled&&"dynamic"===a.type&&(void 0===t?s.setOptions({smooth:!1}):s.setOptions({smooth:{type:t}}),o=!0)}}!0===e&&!0===o&&i.body.emitter.emit("_dataChanged")})),this.body.emitter.on("_dataUpdated",(function(){i.reconnectEdges()})),this.body.emitter.on("refreshEdges",Fo(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",Fo(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",(function(){tb(i.edgesListeners,(function(t,e){i.body.data.edges&&i.body.data.edges.off(e,t)})),delete i.body.functions.createEdge,delete i.edgesListeners.add,delete i.edgesListeners.update,delete i.edgesListeners.remove,delete i.edgesListeners}))}},{key:"setOptions",value:function(t){if(void 0!==t){Nw.parseOptions(this.options,t,!0,this.defaultOptions,!0);var e=!1;if(void 0!==t.smooth)for(var i in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,i)&&(e=this.body.edges[i].updateEdgeType()||e);if(void 0!==t.font)for(var o in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,o)&&this.body.edges[o].updateLabelModule();void 0===t.hidden&&void 0===t.physics&&!0!==e||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var i=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.body.data.edges;if(e.isDataViewLike("id",t))this.body.data.edges=t;else if(lp(t))this.body.data.edges=new e.DataSet,this.body.data.edges.add(t);else{if(t)throw new TypeError("Array or DataSet expected");this.body.data.edges=new e.DataSet}if(n&&tb(this.edgesListeners,(function(t,e){n.off(e,t)})),this.body.edges={},this.body.data.edges){tb(this.edgesListeners,(function(t,e){i.body.data.edges.on(e,t)}));var s=this.body.data.edges.getIds();this.add(s,!0)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===o&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.body.edges,o=this.body.data.edges,n=0;n<t.length;n++){var s=t[n],r=i[s];r&&r.disconnect();var a=o.get(s,{showInternalIds:!0});i[s]=this.create(a)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===e&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t){for(var e=this.body.edges,i=this.body.data.edges,o=!1,n=0;n<t.length;n++){var s=t[n],r=i.get(s),a=e[s];void 0!==a?(a.disconnect(),o=a.setOptions(r)||o,a.connect()):(this.body.edges[s]=this.create(r),o=!0)}!0===o?(this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),this.body.emitter.emit("_dataChanged")):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==t.length){var i=this.body.edges;tb(t,(function(t){var e=i[t];void 0!==e&&e.remove()})),e&&this.body.emitter.emit("_dataChanged")}}},{key:"refresh",value:function(){var t=this;tb(this.body.edges,(function(e,i){var o=t.body.data.edges.get(i);void 0!==o&&e.setOptions(o)}))}},{key:"create",value:function(t){return new Nw(t,this.body,this.images,this.options,this.defaultOptions)}},{key:"reconnectEdges",value:function(){var t,e=this.body.nodes,i=this.body.edges;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t].edges=[]);for(t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var o=i[t];o.from=null,o.to=null,o.connect()}}},{key:"getConnectedNodes",value:function(t){var e=[];if(void 0!==this.body.edges[t]){var i=this.body.edges[t];void 0!==i.fromId&&e.push(i.fromId),void 0!==i.toId&&e.push(i.toId)}return e}},{key:"_updateState",value:function(){this._addMissingEdges(),this._removeInvalidEdges()}},{key:"_removeInvalidEdges",value:function(){var t=this,e=[];tb(this.body.edges,(function(i,o){var n=t.body.nodes[i.toId],s=t.body.nodes[i.fromId];void 0!==n&&!0===n.isCluster||void 0!==s&&!0===s.isCluster||void 0!==n&&void 0!==s||e.push(o)})),this.remove(e,!1)}},{key:"_addMissingEdges",value:function(){var t=this.body.data.edges;if(null!=t){var e=this.body.edges,i=[];xp(t).call(t,(function(t,o){void 0===e[o]&&i.push(o)})),this.add(i,!0)}}}]),t}(),Bw=function(){function t(e,i,o){nl(this,t),this.body=e,this.physicsBody=i,this.barnesHutTree,this.setOptions(o),this._rng=Pv("BARNES HUT SOLVER")}return ad(t,[{key:"setOptions",value:function(t){this.options=t,this.thetaInversed=1/this.options.theta,this.overlapAvoidanceFactor=1-Math.max(0,Math.min(1,this.options.avoidOverlap))}},{key:"solve",value:function(){if(0!==this.options.gravitationalConstant&&this.physicsBody.physicsNodeIndices.length>0){var t,e=this.body.nodes,i=this.physicsBody.physicsNodeIndices,o=i.length,n=this._formBarnesHutTree(e,i);this.barnesHutTree=n;for(var s=0;s<o;s++)(t=e[i[s]]).options.mass>0&&this._getForceContributions(n.root,t)}}},{key:"_getForceContributions",value:function(t,e){this._getForceContribution(t.children.NW,e),this._getForceContribution(t.children.NE,e),this._getForceContribution(t.children.SW,e),this._getForceContribution(t.children.SE,e)}},{key:"_getForceContribution",value:function(t,e){if(t.childrenCount>0){var i=t.centerOfMass.x-e.x,o=t.centerOfMass.y-e.y,n=Math.sqrt(i*i+o*o);n*t.calcSize>this.thetaInversed?this._calculateForces(n,i,o,e,t):4===t.childrenCount?this._getForceContributions(t,e):t.children.data.id!=e.id&&this._calculateForces(n,i,o,e,t)}}},{key:"_calculateForces",value:function(t,e,i,o,n){0===t&&(e=t=.1),this.overlapAvoidanceFactor<1&&o.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*o.shape.radius,t-o.shape.radius));var s=this.options.gravitationalConstant*n.mass*o.options.mass/Math.pow(t,3),r=e*s,a=i*s;this.physicsBody.forces[o.id].x+=r,this.physicsBody.forces[o.id].y+=a}},{key:"_formBarnesHutTree",value:function(t,e){for(var i,o=e.length,n=t[e[0]].x,s=t[e[0]].y,r=t[e[0]].x,a=t[e[0]].y,l=1;l<o;l++){var h=t[e[l]],c=h.x,u=h.y;h.options.mass>0&&(c<n&&(n=c),c>r&&(r=c),u<s&&(s=u),u>a&&(a=u))}var d=Math.abs(r-n)-Math.abs(a-s);d>0?(s-=.5*d,a+=.5*d):(n+=.5*d,r-=.5*d);var p=Math.max(1e-5,Math.abs(r-n)),g=.5*p,f=.5*(n+r),m=.5*(s+a),v={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:f-g,maxX:f+g,minY:m-g,maxY:m+g},size:p,calcSize:1/p,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(v.root);for(var b=0;b<o;b++)(i=t[e[b]]).options.mass>0&&this._placeInTree(v.root,i);return v}},{key:"_updateBranchMass",value:function(t,e){var i=t.centerOfMass,o=t.mass+e.options.mass,n=1/o;i.x=i.x*t.mass+e.x*e.options.mass,i.x*=n,i.y=i.y*t.mass+e.y*e.options.mass,i.y*=n,t.mass=o;var s=Math.max(Math.max(e.height,e.radius),e.width);t.maxWidth=t.maxWidth<s?s:t.maxWidth}},{key:"_placeInTree",value:function(t,e,i){1==i&&void 0!==i||this._updateBranchMass(t,e);var o,n=t.children.NW.range;o=n.maxX>e.x?n.maxY>e.y?"NW":"SW":n.maxY>e.y?"NE":"SE",this._placeInRegion(t,e,o)}},{key:"_placeInRegion",value:function(t,e,i){var o=t.children[i];switch(o.childrenCount){case 0:o.children.data=e,o.childrenCount=1,this._updateBranchMass(o,e);break;case 1:o.children.data.x===e.x&&o.children.data.y===e.y?(e.x+=this._rng(),e.y+=this._rng()):(this._splitBranch(o),this._placeInTree(o,e));break;case 4:this._placeInTree(o,e)}}},{key:"_splitBranch",value:function(t){var e=null;1===t.childrenCount&&(e=t.children.data,t.mass=0,t.centerOfMass.x=0,t.centerOfMass.y=0),t.childrenCount=4,t.children.data=null,this._insertRegion(t,"NW"),this._insertRegion(t,"NE"),this._insertRegion(t,"SW"),this._insertRegion(t,"SE"),null!=e&&this._placeInTree(t,e)}},{key:"_insertRegion",value:function(t,e){var i,o,n,s,r=.5*t.size;switch(e){case"NW":i=t.range.minX,o=t.range.minX+r,n=t.range.minY,s=t.range.minY+r;break;case"NE":i=t.range.minX+r,o=t.range.maxX,n=t.range.minY,s=t.range.minY+r;break;case"SW":i=t.range.minX,o=t.range.minX+r,n=t.range.minY+r,s=t.range.maxY;break;case"SE":i=t.range.minX+r,o=t.range.maxX,n=t.range.minY+r,s=t.range.maxY}t.children[e]={centerOfMass:{x:0,y:0},mass:0,range:{minX:i,maxX:o,minY:n,maxY:s},size:.5*t.size,calcSize:2*t.calcSize,children:{data:null},maxWidth:0,level:t.level+1,childrenCount:0}}},{key:"_debug",value:function(t,e){void 0!==this.barnesHutTree&&(t.lineWidth=1,this._drawBranch(this.barnesHutTree.root,t,e))}},{key:"_drawBranch",value:function(t,e,i){void 0===i&&(i="#FF0000"),4===t.childrenCount&&(this._drawBranch(t.children.NW,e),this._drawBranch(t.children.NE,e),this._drawBranch(t.children.SE,e),this._drawBranch(t.children.SW,e)),e.strokeStyle=i,e.beginPath(),e.moveTo(t.range.minX,t.range.minY),e.lineTo(t.range.maxX,t.range.minY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.minY),e.lineTo(t.range.maxX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.maxY),e.lineTo(t.range.minX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.minX,t.range.maxY),e.lineTo(t.range.minX,t.range.minY),e.stroke()}}]),t}(),Fw=function(){function t(e,i,o){nl(this,t),this._rng=Pv("REPULSION SOLVER"),this.body=e,this.physicsBody=i,this.setOptions(o)}return ad(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,o,n,s,r,a,l=this.body.nodes,h=this.physicsBody.physicsNodeIndices,c=this.physicsBody.forces,u=this.options.nodeDistance,d=-2/3/u,p=0;p<h.length-1;p++){r=l[h[p]];for(var g=p+1;g<h.length;g++)t=(a=l[h[g]]).x-r.x,e=a.y-r.y,0===(i=Math.sqrt(t*t+e*e))&&(t=i=.1*this._rng()),i<2*u&&(s=i<.5*u?1:d*i+1.3333333333333333,o=t*(s/=i),n=e*s,c[r.id].x-=o,c[r.id].y-=n,c[a.id].x+=o,c[a.id].y+=n)}}}]),t}(),Hw=function(){function t(e,i,o){nl(this,t),this.body=e,this.physicsBody=i,this.setOptions(o)}return ad(t,[{key:"setOptions",value:function(t){this.options=t,this.overlapAvoidanceFactor=Math.max(0,Math.min(1,this.options.avoidOverlap||0))}},{key:"solve",value:function(){for(var t=this.body.nodes,e=this.physicsBody.physicsNodeIndices,i=this.physicsBody.forces,o=this.options.nodeDistance,n=0;n<e.length-1;n++)for(var s=t[e[n]],r=n+1;r<e.length;r++){var a=t[e[r]];if(s.level===a.level){var l=o+this.overlapAvoidanceFactor*((s.shape.radius||0)/2+(a.shape.radius||0)/2),h=a.x-s.x,c=a.y-s.y,u=Math.sqrt(h*h+c*c),d=void 0;d=u<l?-Math.pow(.05*u,2)+Math.pow(.05*l,2):0,0!==u&&(d/=u);var p=h*d,g=c*d;i[s.id].x-=p,i[s.id].y-=g,i[a.id].x+=p,i[a.id].y+=g}}}}]),t}(),Uw=function(){function t(e,i,o){nl(this,t),this.body=e,this.physicsBody=i,this.setOptions(o)}return ad(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,o,n,s=this.physicsBody.physicsEdgeIndices,r=this.body.edges,a=0;a<s.length;a++)!0===(e=r[s[a]]).connected&&e.toId!==e.fromId&&void 0!==this.body.nodes[e.toId]&&void 0!==this.body.nodes[e.fromId]&&(void 0!==e.edgeType.via?(t=void 0===e.options.length?this.options.springLength:e.options.length,i=e.to,o=e.edgeType.via,n=e.from,this._calculateSpringForce(i,o,.5*t),this._calculateSpringForce(o,n,.5*t)):(t=void 0===e.options.length?1.5*this.options.springLength:e.options.length,this._calculateSpringForce(e.from,e.to,t)))}},{key:"_calculateSpringForce",value:function(t,e,i){var o=t.x-e.x,n=t.y-e.y,s=Math.max(Math.sqrt(o*o+n*n),.01),r=this.options.springConstant*(i-s)/s,a=o*r,l=n*r;void 0!==this.physicsBody.forces[t.id]&&(this.physicsBody.forces[t.id].x+=a,this.physicsBody.forces[t.id].y+=l),void 0!==this.physicsBody.forces[e.id]&&(this.physicsBody.forces[e.id].x-=a,this.physicsBody.forces[e.id].y-=l)}}]),t}(),Gw=function(){function t(e,i,o){nl(this,t),this.body=e,this.physicsBody=i,this.setOptions(o)}return ad(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,o,n,s,r,a,l,h,c=this.body.edges,u=.5,d=this.physicsBody.physicsEdgeIndices,p=this.physicsBody.physicsNodeIndices,g=this.physicsBody.forces,f=0;f<p.length;f++){var m=p[f];g[m].springFx=0,g[m].springFy=0}for(var v=0;v<d.length;v++)!0===(e=c[d[v]]).connected&&(t=void 0===e.options.length?this.options.springLength:e.options.length,i=e.from.x-e.to.x,o=e.from.y-e.to.y,a=0===(a=Math.sqrt(i*i+o*o))?.01:a,n=i*(r=this.options.springConstant*(t-a)/a),s=o*r,e.to.level!=e.from.level?(void 0!==g[e.toId]&&(g[e.toId].springFx-=n,g[e.toId].springFy-=s),void 0!==g[e.fromId]&&(g[e.fromId].springFx+=n,g[e.fromId].springFy+=s)):(void 0!==g[e.toId]&&(g[e.toId].x-=u*n,g[e.toId].y-=u*s),void 0!==g[e.fromId]&&(g[e.fromId].x+=u*n,g[e.fromId].y+=u*s)));r=1;for(var b=0;b<p.length;b++){var _=p[b];l=Math.min(r,Math.max(-r,g[_].springFx)),h=Math.min(r,Math.max(-r,g[_].springFy)),g[_].x+=l,g[_].y+=h}for(var y=0,T=0,E=0;E<p.length;E++){var w=p[E];y+=g[w].x,T+=g[w].y}for(var k=y/p.length,I=T/p.length,$=0;$<p.length;$++){var S=p[$];g[S].x-=k,g[S].y-=I}}}]),t}(),Vw=function(){function t(e,i,o){nl(this,t),this.body=e,this.physicsBody=i,this.setOptions(o)}return ad(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,o,n=this.body.nodes,s=this.physicsBody.physicsNodeIndices,r=this.physicsBody.forces,a=0;a<s.length;a++)t=-(o=n[s[a]]).x,e=-o.y,i=Math.sqrt(t*t+e*e),this._calculateForces(i,t,e,r,o)}},{key:"_calculateForces",value:function(t,e,i,o,n){var s=0===t?0:this.options.centralGravity/t;o[n.id].x=e*s,o[n.id].y=i*s}}]),t}();var Ww=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){var s;return nl(this,i),(s=e.call(this,t,o,n))._rng=Pv("FORCE ATLAS 2 BASED REPULSION SOLVER"),s}return ad(i,[{key:"_calculateForces",value:function(t,e,i,o,n){0===t&&(e=t=.1*this._rng()),this.overlapAvoidanceFactor<1&&o.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*o.shape.radius,t-o.shape.radius));var s=o.edges.length+1,r=this.options.gravitationalConstant*n.mass*o.options.mass*s/Math.pow(t,2),a=e*r,l=i*r;this.physicsBody.forces[o.id].x+=a,this.physicsBody.forces[o.id].y+=l}}]),i}(Bw);var zw=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n){return nl(this,i),e.call(this,t,o,n)}return ad(i,[{key:"_calculateForces",value:function(t,e,i,o,n){if(t>0){var s=n.edges.length+1,r=this.options.centralGravity*s*n.options.mass;o[n.id].x=e*r,o[n.id].y=i*r}}}]),i}(Vw),jw=function(){function t(e){nl(this,t),this.body=e,this.physicsBody={physicsNodeIndices:[],physicsEdgeIndices:[],forces:{},velocities:{}},this.physicsEnabled=!0,this.simulationInterval=1e3/60,this.requiresTimeout=!0,this.previousStates={},this.referenceState={},this.freezeCache={},this.renderTimer=void 0,this.adaptiveTimestep=!1,this.adaptiveTimestepEnabled=!1,this.adaptiveCounter=0,this.adaptiveInterval=3,this.stabilized=!1,this.startedStabilization=!1,this.stabilizationIterations=0,this.ready=!1,this.options={},this.defaultOptions={enabled:!0,barnesHut:{theta:.5,gravitationalConstant:-2e3,centralGravity:.3,springLength:95,springConstant:.04,damping:.09,avoidOverlap:0},forceAtlas2Based:{theta:.5,gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:0},repulsion:{centralGravity:.2,springLength:200,springConstant:.05,nodeDistance:100,damping:.09,avoidOverlap:0},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.75,solver:"barnesHut",stabilization:{enabled:!0,iterations:1e3,updateInterval:50,onlyDynamicEdges:!1,fit:!0},timestep:.5,adaptiveTimestep:!0,wind:{x:0,y:0}},bo(this.options,this.defaultOptions),this.timestep=.5,this.layoutFailed=!1,this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("initPhysics",(function(){t.initPhysics()})),this.body.emitter.on("_layoutFailed",(function(){t.layoutFailed=!0})),this.body.emitter.on("resetPhysics",(function(){t.stopSimulation(),t.ready=!1})),this.body.emitter.on("disablePhysics",(function(){t.physicsEnabled=!1,t.stopSimulation()})),this.body.emitter.on("restorePhysics",(function(){t.setOptions(t.options),!0===t.ready&&t.startSimulation()})),this.body.emitter.on("startSimulation",(function(){!0===t.ready&&t.startSimulation()})),this.body.emitter.on("stopSimulation",(function(){t.stopSimulation()})),this.body.emitter.on("destroy",(function(){t.stopSimulation(!1),t.body.emitter.off()})),this.body.emitter.on("_dataChanged",(function(){t.updatePhysicsData()}))}},{key:"setOptions",value:function(t){if(void 0!==t)if(!1===t)this.options.enabled=!1,this.physicsEnabled=!1,this.stopSimulation();else if(!0===t)this.options.enabled=!0,this.physicsEnabled=!0,this.startSimulation();else{this.physicsEnabled=!0,Jv(["stabilization"],this.options,t),ub(this.options,t,"stabilization"),void 0===t.enabled&&(this.options.enabled=!0),!1===this.options.enabled&&(this.physicsEnabled=!1,this.stopSimulation());var e=this.options.wind;e&&(("number"!=typeof e.x||Py(e.x))&&(e.x=0),("number"!=typeof e.y||Py(e.y))&&(e.y=0)),this.timestep=this.options.timestep}this.init()}},{key:"init",value:function(){var t;"forceAtlas2Based"===this.options.solver?(t=this.options.forceAtlas2Based,this.nodesSolver=new Ww(this.body,this.physicsBody,t),this.edgesSolver=new Uw(this.body,this.physicsBody,t),this.gravitySolver=new zw(this.body,this.physicsBody,t)):"repulsion"===this.options.solver?(t=this.options.repulsion,this.nodesSolver=new Fw(this.body,this.physicsBody,t),this.edgesSolver=new Uw(this.body,this.physicsBody,t),this.gravitySolver=new Vw(this.body,this.physicsBody,t)):"hierarchicalRepulsion"===this.options.solver?(t=this.options.hierarchicalRepulsion,this.nodesSolver=new Hw(this.body,this.physicsBody,t),this.edgesSolver=new Gw(this.body,this.physicsBody,t),this.gravitySolver=new Vw(this.body,this.physicsBody,t)):(t=this.options.barnesHut,this.nodesSolver=new Bw(this.body,this.physicsBody,t),this.edgesSolver=new Uw(this.body,this.physicsBody,t),this.gravitySolver=new Vw(this.body,this.physicsBody,t)),this.modelOptions=t}},{key:"initPhysics",value:function(){!0===this.physicsEnabled&&!0===this.options.enabled?!0===this.options.stabilization.enabled?this.stabilize():(this.stabilized=!1,this.ready=!0,this.body.emitter.emit("fit",{},this.layoutFailed),this.startSimulation()):(this.ready=!0,this.body.emitter.emit("fit"))}},{key:"startSimulation",value:function(){var t;!0===this.physicsEnabled&&!0===this.options.enabled?(this.stabilized=!1,this.adaptiveTimestep=!1,this.body.emitter.emit("_resizeNodes"),void 0===this.viewFunction&&(this.viewFunction=Fo(t=this.simulationStep).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))):this.body.emitter.emit("_redraw")}},{key:"stopSimulation",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stabilized=!0,!0===t&&this._emitStabilized(),void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.viewFunction=void 0,!0===t&&this.body.emitter.emit("_stopRendering"))}},{key:"simulationStep",value:function(){var t=Tp();this.physicsTick(),(Tp()-t<.4*this.simulationInterval||!0===this.runDoubleSpeed)&&!1===this.stabilized&&(this.physicsTick(),this.runDoubleSpeed=!0),!0===this.stabilized&&this.stopSimulation()}},{key:"_emitStabilized",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stabilizationIterations;(this.stabilizationIterations>1||!0===this.startedStabilization)&&Gf((function(){t.body.emitter.emit("stabilized",{iterations:e}),t.startedStabilization=!1,t.stabilizationIterations=0}),0)}},{key:"physicsStep",value:function(){this.gravitySolver.solve(),this.nodesSolver.solve(),this.edgesSolver.solve(),this.moveNodes()}},{key:"adjustTimeStep",value:function(){!0===this._evaluateStepQuality()?this.timestep=1.2*this.timestep:this.timestep/1.2<this.options.timestep?this.timestep=this.options.timestep:(this.adaptiveCounter=-1,this.timestep=Math.max(this.options.timestep,this.timestep/1.2))}},{key:"physicsTick",value:function(){this._startStabilizing(),!0!==this.stabilized&&(!0===this.adaptiveTimestep&&!0===this.adaptiveTimestepEnabled?(this.adaptiveCounter%this.adaptiveInterval==0?(this.timestep=2*this.timestep,this.physicsStep(),this.revert(),this.timestep=.5*this.timestep,this.physicsStep(),this.physicsStep(),this.adjustTimeStep()):this.physicsStep(),this.adaptiveCounter+=1):(this.timestep=this.options.timestep,this.physicsStep()),!0===this.stabilized&&this.revert(),this.stabilizationIterations++)}},{key:"updatePhysicsData",value:function(){this.physicsBody.forces={},this.physicsBody.physicsNodeIndices=[],this.physicsBody.physicsEdgeIndices=[];var t=this.body.nodes,e=this.body.edges;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&!0===t[i].options.physics&&this.physicsBody.physicsNodeIndices.push(t[i].id);for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&!0===e[o].options.physics&&this.physicsBody.physicsEdgeIndices.push(e[o].id);for(var n=0;n<this.physicsBody.physicsNodeIndices.length;n++){var s=this.physicsBody.physicsNodeIndices[n];this.physicsBody.forces[s]={x:0,y:0},void 0===this.physicsBody.velocities[s]&&(this.physicsBody.velocities[s]={x:0,y:0})}for(var r in this.physicsBody.velocities)void 0===t[r]&&delete this.physicsBody.velocities[r]}},{key:"revert",value:function(){var t=vp(this.previousStates),e=this.body.nodes,i=this.physicsBody.velocities;this.referenceState={};for(var o=0;o<t.length;o++){var n=t[o];void 0!==e[n]?!0===e[n].options.physics&&(this.referenceState[n]={positions:{x:e[n].x,y:e[n].y}},i[n].x=this.previousStates[n].vx,i[n].y=this.previousStates[n].vy,e[n].x=this.previousStates[n].x,e[n].y=this.previousStates[n].y):delete this.previousStates[n]}}},{key:"_evaluateStepQuality",value:function(){var t,e,i=this.body.nodes,o=this.referenceState;for(var n in this.referenceState)if(Object.prototype.hasOwnProperty.call(this.referenceState,n)&&void 0!==i[n]&&(t=i[n].x-o[n].positions.x,e=i[n].y-o[n].positions.y,Math.sqrt(Math.pow(t,2)+Math.pow(e,2))>.3))return!1;return!0}},{key:"moveNodes",value:function(){for(var t=this.physicsBody.physicsNodeIndices,e=0,i=0,o=0;o<t.length;o++){var n=t[o],s=this._performStep(n);e=Math.max(e,s),i+=s}this.adaptiveTimestepEnabled=i/t.length<5,this.stabilized=e<this.options.minVelocity}},{key:"calculateComponentVelocity",value:function(t,e,i){t+=(e-this.modelOptions.damping*t)/i*this.timestep;var o=this.options.maxVelocity||1e9;return Math.abs(t)>o&&(t=t>0?o:-o),t}},{key:"_performStep",value:function(t){var e=this.body.nodes[t],i=this.physicsBody.forces[t];this.options.wind&&(i.x+=this.options.wind.x,i.y+=this.options.wind.y);var o=this.physicsBody.velocities[t];return this.previousStates[t]={x:e.x,y:e.y,vx:o.x,vy:o.y},!1===e.options.fixed.x?(o.x=this.calculateComponentVelocity(o.x,i.x,e.options.mass),e.x+=o.x*this.timestep):(i.x=0,o.x=0),!1===e.options.fixed.y?(o.y=this.calculateComponentVelocity(o.y,i.y,e.options.mass),e.y+=o.y*this.timestep):(i.y=0,o.y=0),Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))}},{key:"_freezeNodes",value:function(){var t=this.body.nodes;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].x&&t[e].y){var i=t[e].options.fixed;this.freezeCache[e]={x:i.x,y:i.y},i.x=!0,i.y=!0}}},{key:"_restoreFrozenNodes",value:function(){var t=this.body.nodes;for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&void 0!==this.freezeCache[e]&&(t[e].options.fixed.x=this.freezeCache[e].x,t[e].options.fixed.y=this.freezeCache[e].y);this.freezeCache={}}},{key:"stabilize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.stabilization.iterations;"number"!=typeof e&&(e=this.options.stabilization.iterations,console.error("The stabilize method needs a numeric amount of iterations. Switching to default: ",e)),0!==this.physicsBody.physicsNodeIndices.length?(this.adaptiveTimestep=this.options.adaptiveTimestep,this.body.emitter.emit("_resizeNodes"),this.stopSimulation(),this.stabilized=!1,this.body.emitter.emit("_blockRedraw"),this.targetIterations=e,!0===this.options.stabilization.onlyDynamicEdges&&this._freezeNodes(),this.stabilizationIterations=0,Gf((function(){return t._stabilizationBatch()}),0)):this.ready=!0}},{key:"_startStabilizing",value:function(){return!0!==this.startedStabilization&&(this.body.emitter.emit("startStabilizing"),this.startedStabilization=!0,!0)}},{key:"_stabilizationBatch",value:function(){var t=this,e=function(){return!1===t.stabilized&&t.stabilizationIterations<t.targetIterations},i=function(){t.body.emitter.emit("stabilizationProgress",{iterations:t.stabilizationIterations,total:t.targetIterations})};this._startStabilizing()&&i();for(var o,n=0;e()&&n<this.options.stabilization.updateInterval;)this.physicsTick(),n++;i(),e()?Gf(Fo(o=this._stabilizationBatch).call(o,this),0):this._finalizeStabilization()}},{key:"_finalizeStabilization",value:function(){this.body.emitter.emit("_allowRedraw"),!0===this.options.stabilization.fit&&this.body.emitter.emit("fit"),!0===this.options.stabilization.onlyDynamicEdges&&this._restoreFrozenNodes(),this.body.emitter.emit("stabilizationIterationsDone"),this.body.emitter.emit("_requestRedraw"),!0===this.stabilized?this._emitStabilized():this.startSimulation(),this.ready=!0}},{key:"_drawForces",value:function(t){for(var e=0;e<this.physicsBody.physicsNodeIndices.length;e++){var i=this.physicsBody.physicsNodeIndices[e],o=this.body.nodes[i],n=this.physicsBody.forces[i],s=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.x,2)),r=Math.min(Math.max(5,s),15),a=3*r,l=ab((180-180*Math.min(1,Math.max(0,.03*s)))/360,1,1),h={x:o.x+20*n.x,y:o.y+20*n.y};t.lineWidth=r,t.strokeStyle=l,t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(h.x,h.y),t.stroke();var c=Math.atan2(n.y,n.x);t.fillStyle=l,kw.draw(t,{type:"arrow",point:h,angle:c,length:a}),qf(t).call(t)}}}]),t}();let Xw;const Yw=new Uint8Array(16);function Kw(){if(!Xw&&(Xw="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Xw))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Xw(Yw)}const Jw=[];for(let t=0;t<256;++t)Jw.push((t+256).toString(16).slice(1));var qw={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Zw(t,e,i){if(qw.randomUUID&&!e&&!t)return qw.randomUUID();const o=(t=t||{}).random||(t.rng||Kw)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){i=i||0;for(let t=0;t<16;++t)e[i+t]=o[t];return e}return function(t,e=0){return Jw[t[e+0]]+Jw[t[e+1]]+Jw[t[e+2]]+Jw[t[e+3]]+"-"+Jw[t[e+4]]+Jw[t[e+5]]+"-"+Jw[t[e+6]]+Jw[t[e+7]]+"-"+Jw[t[e+8]]+Jw[t[e+9]]+"-"+Jw[t[e+10]]+Jw[t[e+11]]+Jw[t[e+12]]+Jw[t[e+13]]+Jw[t[e+14]]+Jw[t[e+15]]}(o)}var Qw=function(){function t(){nl(this,t)}return ad(t,null,[{key:"getRange",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=1e9,n=-1e9,s=1e9,r=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)s>(e=t[i[a]]).shape.boundingBox.left&&(s=e.shape.boundingBox.left),r<e.shape.boundingBox.right&&(r=e.shape.boundingBox.right),o>e.shape.boundingBox.top&&(o=e.shape.boundingBox.top),n<e.shape.boundingBox.bottom&&(n=e.shape.boundingBox.bottom);return 1e9===s&&-1e9===r&&1e9===o&&-1e9===n&&(o=0,n=0,s=0,r=0),{minX:s,maxX:r,minY:o,maxY:n}}},{key:"getRangeCore",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=1e9,n=-1e9,s=1e9,r=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)s>(e=t[i[a]]).x&&(s=e.x),r<e.x&&(r=e.x),o>e.y&&(o=e.y),n<e.y&&(n=e.y);return 1e9===s&&-1e9===r&&1e9===o&&-1e9===n&&(o=0,n=0,s=0,r=0),{minX:s,maxX:r,minY:o,maxY:n}}},{key:"findCenter",value:function(t){return{x:.5*(t.maxX+t.minX),y:.5*(t.maxY+t.minY)}}},{key:"cloneOptions",value:function(t,e){var i={};return void 0===e||"node"===e?(qv(i,t.options,!0),i.x=t.x,i.y=t.y,i.amountOfConnections=t.edges.length):qv(i,t.options,!0),i}}]),t}();var tk=function(t){yE(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}(i);function i(t,o,n,s,r,a){var l;return nl(this,i),(l=e.call(this,t,o,n,s,r,a)).isCluster=!0,l.containedNodes={},l.containedEdges={},l}return ad(i,[{key:"_openChildCluster",value:function(t){var e=this,i=this.body.nodes[t];if(void 0===this.containedNodes[t])throw new Error("node with id: "+t+" not in current cluster");if(!i.isCluster)throw new Error("node with id: "+t+" is not a cluster");delete this.containedNodes[t],tb(i.edges,(function(t){delete e.containedEdges[t.id]})),tb(i.containedNodes,(function(t,i){e.containedNodes[i]=t})),i.containedNodes={},tb(i.containedEdges,(function(t,i){e.containedEdges[i]=t})),i.containedEdges={},tb(i.edges,(function(t){tb(e.edges,(function(i){var o,n,s=bf(o=i.clusteringEdgeReplacingIds).call(o,t.id);-1!==s&&(tb(t.clusteringEdgeReplacingIds,(function(t){i.clusteringEdgeReplacingIds.push(t),e.body.edges[t].edgeReplacedById=i.id})),hg(n=i.clusteringEdgeReplacingIds).call(n,s,1))}))})),i.edges=[]}}]),i}(XE),ek=function(){function t(e){var i=this;nl(this,t),this.body=e,this.clusteredNodes={},this.clusteredEdges={},this.options={},this.defaultOptions={},bo(this.options,this.defaultOptions),this.body.emitter.on("_resetData",(function(){i.clusteredNodes={},i.clusteredEdges={}}))}return ad(t,[{key:"clusterByHubsize",value:function(t,e){void 0===t?t=this._getHubSize():"object"===od(t)&&(e=this._checkOptions(t),t=this._getHubSize());for(var i=[],o=0;o<this.body.nodeIndices.length;o++){var n=this.body.nodes[this.body.nodeIndices[o]];n.edges.length>=t&&i.push(n.id)}for(var s=0;s<i.length;s++)this.clusterByConnection(i[s],e,!0);this.body.emitter.emit("_dataChanged")}},{key:"cluster",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===e.joinCondition)throw new Error("Cannot call clusterByNodeData without a joinCondition function in the options.");e=this._checkOptions(e);var o={},n={};tb(this.body.nodes,(function(i,s){i.options&&!0===e.joinCondition(i.options)&&(o[s]=i,tb(i.edges,(function(e){void 0===t.clusteredEdges[e.id]&&(n[e.id]=e)})))})),this._cluster(o,n,e,i)}},{key:"clusterByEdgeCount",value:function(t,e){var i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e=this._checkOptions(e);for(var n,s,r,a=[],l={},h=function(){var o={},h={},u=i.body.nodeIndices[c],d=i.body.nodes[u];if(void 0===l[u]){r=0,s=[];for(var p=0;p<d.edges.length;p++)n=d.edges[p],void 0===i.clusteredEdges[n.id]&&(n.toId!==n.fromId&&r++,s.push(n));if(r===t){for(var g=function(t){if(void 0===e.joinCondition||null===e.joinCondition)return!0;var i=Qw.cloneOptions(t);return e.joinCondition(i)},f=!0,m=0;m<s.length;m++){n=s[m];var v=i._getConnectedId(n,u);if(!g(d)){f=!1;break}h[n.id]=n,o[u]=d,o[v]=i.body.nodes[v],l[u]=!0}if(vp(o).length>0&&vp(h).length>0&&!0===f){var b=function(){for(var t=0;t<a.length;++t)for(var e in o)if(void 0!==a[t].nodes[e])return a[t]}();if(void 0!==b){for(var _ in o)void 0===b.nodes[_]&&(b.nodes[_]=o[_]);for(var y in h)void 0===b.edges[y]&&(b.edges[y]=h[y])}else a.push({nodes:o,edges:h})}}}},c=0;c<this.body.nodeIndices.length;c++)h();for(var u=0;u<a.length;u++)this._cluster(a[u].nodes,a[u].edges,e,!1);!0===o&&this.body.emitter.emit("_dataChanged")}},{key:"clusterOutliers",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clusterByEdgeCount(1,t,e)}},{key:"clusterBridges",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clusterByEdgeCount(2,t,e)}},{key:"clusterByConnection",value:function(t,e){var i,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)throw new Error("No nodeId supplied to clusterByConnection!");if(void 0===this.body.nodes[t])throw new Error("The nodeId given to clusterByConnection does not exist!");var n=this.body.nodes[t];void 0===(e=this._checkOptions(e,n)).clusterNodeProperties.x&&(e.clusterNodeProperties.x=n.x),void 0===e.clusterNodeProperties.y&&(e.clusterNodeProperties.y=n.y),void 0===e.clusterNodeProperties.fixed&&(e.clusterNodeProperties.fixed={},e.clusterNodeProperties.fixed.x=n.options.fixed.x,e.clusterNodeProperties.fixed.y=n.options.fixed.y);var s={},r={},a=n.id,l=Qw.cloneOptions(n);s[a]=n;for(var h=0;h<n.edges.length;h++){var c=n.edges[h];if(void 0===this.clusteredEdges[c.id]){var u=this._getConnectedId(c,a);if(void 0===this.clusteredNodes[u])if(u!==a)if(void 0===e.joinCondition)r[c.id]=c,s[u]=this.body.nodes[u];else{var d=Qw.cloneOptions(this.body.nodes[u]);!0===e.joinCondition(l,d)&&(r[c.id]=c,s[u]=this.body.nodes[u])}else r[c.id]=c}}var p=gp(i=vp(s)).call(i,(function(t){return s[t].id}));for(var g in s)if(Object.prototype.hasOwnProperty.call(s,g))for(var f=s[g],m=0;m<f.edges.length;m++){var v=f.edges[m];bf(p).call(p,this._getConnectedId(v,f.id))>-1&&(r[v.id]=v)}this._cluster(s,r,e,o)}},{key:"_createClusterEdges",value:function(t,e,i,o){for(var n,s,r,a,l,h,c=vp(t),u=[],d=0;d<c.length;d++){r=t[s=c[d]];for(var p=0;p<r.edges.length;p++)n=r.edges[p],void 0===this.clusteredEdges[n.id]&&(n.toId==n.fromId?e[n.id]=n:n.toId==s?(a=i.id,h=l=n.fromId):(a=n.toId,l=i.id,h=a),void 0===t[h]&&u.push({edge:n,fromId:l,toId:a}))}for(var g=[],f=function(t){for(var e=0;e<g.length;e++){var i=g[e],o=t.fromId===i.fromId&&t.toId===i.toId,n=t.fromId===i.toId&&t.toId===i.fromId;if(o||n)return i}return null},m=0;m<u.length;m++){var v=u[m],b=v.edge,_=f(v);null===_?(_=this._createClusteredEdge(v.fromId,v.toId,b,o),g.push(_)):_.clusteringEdgeReplacingIds.push(b.id),this.body.edges[b.id].edgeReplacedById=_.id,this._backupEdgeOptions(b),b.setOptions({physics:!1})}}},{key:"_checkOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.clusterEdgeProperties&&(t.clusterEdgeProperties={}),void 0===t.clusterNodeProperties&&(t.clusterNodeProperties={}),t}},{key:"_cluster",value:function(t,e,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&void 0!==this.clusteredNodes[s]&&n.push(s);for(var r=0;r<n.length;++r)delete t[n[r]];if(0!=vp(t).length&&(1!=vp(t).length||1==i.clusterNodeProperties.allowSingleNodeCluster)){var a=qv({},i.clusterNodeProperties);if(void 0!==i.processProperties){var l=[];for(var h in t)if(Object.prototype.hasOwnProperty.call(t,h)){var c=Qw.cloneOptions(t[h]);l.push(c)}var u=[];for(var d in e)if(Object.prototype.hasOwnProperty.call(e,d)&&"clusterEdge:"!==d.substr(0,12)){var p=Qw.cloneOptions(e[d],"edge");u.push(p)}if(!(a=i.processProperties(a,l,u)))throw new Error("The processProperties function does not return properties!")}void 0===a.id&&(a.id="cluster:"+Zw());var g=a.id;void 0===a.label&&(a.label="cluster");var f=void 0;void 0===a.x&&(f=this._getClusterPosition(t),a.x=f.x),void 0===a.y&&(void 0===f&&(f=this._getClusterPosition(t)),a.y=f.y),a.id=g;var m=this.body.functions.createNode(a,tk);m.containedNodes=t,m.containedEdges=e,m.clusterEdgeProperties=i.clusterEdgeProperties,this.body.nodes[a.id]=m,this._clusterEdges(t,e,a,i.clusterEdgeProperties),a.id=void 0,!0===o&&this.body.emitter.emit("_dataChanged")}}},{key:"_backupEdgeOptions",value:function(t){void 0===this.clusteredEdges[t.id]&&(this.clusteredEdges[t.id]={physics:t.options.physics})}},{key:"_restoreEdge",value:function(t){var e=this.clusteredEdges[t.id];void 0!==e&&(t.setOptions({physics:e.physics}),delete this.clusteredEdges[t.id])}},{key:"isCluster",value:function(t){return void 0!==this.body.nodes[t]?!0===this.body.nodes[t].isCluster:(console.error("Node does not exist."),!1)}},{key:"_getClusterPosition",value:function(t){for(var e,i=vp(t),o=t[i[0]].x,n=t[i[0]].x,s=t[i[0]].y,r=t[i[0]].y,a=1;a<i.length;a++)o=(e=t[i[a]]).x<o?e.x:o,n=e.x>n?e.x:n,s=e.y<s?e.y:s,r=e.y>r?e.y:r;return{x:.5*(o+n),y:.5*(s+r)}}},{key:"openCluster",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)throw new Error("No clusterNodeId supplied to openCluster.");var o=this.body.nodes[t];if(void 0===o)throw new Error("The clusterNodeId supplied to openCluster does not exist.");if(!0!==o.isCluster||void 0===o.containedNodes||void 0===o.containedEdges)throw new Error("The node:"+t+" is not a valid cluster.");var n=this.findNode(t),s=bf(n).call(n,t)-1;if(s>=0){var r=n[s];return this.body.nodes[r]._openChildCluster(t),delete this.body.nodes[t],void(!0===i&&this.body.emitter.emit("_dataChanged"))}var a=o.containedNodes,l=o.containedEdges;if(void 0!==e&&void 0!==e.releaseFunction&&"function"==typeof e.releaseFunction){var h={},c={x:o.x,y:o.y};for(var u in a)if(Object.prototype.hasOwnProperty.call(a,u)){var d=this.body.nodes[u];h[u]={x:d.x,y:d.y}}var p=e.releaseFunction(c,h);for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)){var f=this.body.nodes[g];void 0!==p[g]&&(f.x=void 0===p[g].x?o.x:p[g].x,f.y=void 0===p[g].y?o.y:p[g].y)}}else tb(a,(function(t){!1===t.options.fixed.x&&(t.x=o.x),!1===t.options.fixed.y&&(t.y=o.y)}));for(var m in a)if(Object.prototype.hasOwnProperty.call(a,m)){var v=this.body.nodes[m];v.vx=o.vx,v.vy=o.vy,v.setOptions({physics:!0}),delete this.clusteredNodes[m]}for(var b=[],_=0;_<o.edges.length;_++)b.push(o.edges[_]);for(var y=0;y<b.length;y++){for(var T=b[y],E=this._getConnectedId(T,t),w=this.clusteredNodes[E],k=0;k<T.clusteringEdgeReplacingIds.length;k++){var I=T.clusteringEdgeReplacingIds[k],$=this.body.edges[I];if(void 0!==$)if(void 0!==w){var S=this.body.nodes[w.clusterId];S.containedEdges[$.id]=$,delete l[$.id];var C=$.fromId,O=$.toId;$.toId==E?O=w.clusterId:C=w.clusterId,this._createClusteredEdge(C,O,$,S.clusterEdgeProperties,{hidden:!1,physics:!0})}else this._restoreEdge($)}T.remove()}for(var R in l)Object.prototype.hasOwnProperty.call(l,R)&&this._restoreEdge(l[R]);delete this.body.nodes[t],!0===i&&this.body.emitter.emit("_dataChanged")}},{key:"getNodesInCluster",value:function(t){var e=[];if(!0===this.isCluster(t)){var i=this.body.nodes[t].containedNodes;for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&e.push(this.body.nodes[o].id)}return e}},{key:"findNode",value:function(t){for(var e,i=[],o=0;void 0!==this.clusteredNodes[t]&&o<100;){if(void 0===(e=this.body.nodes[t]))return[];i.push(e.id),t=this.clusteredNodes[t].clusterId,o++}return void 0===(e=this.body.nodes[t])?[]:(i.push(e.id),Gp(i).call(i),i)}},{key:"updateClusteredNode",value:function(t,e){if(void 0===t)throw new Error("No clusteredNodeId supplied to updateClusteredNode.");if(void 0===e)throw new Error("No newOptions supplied to updateClusteredNode.");if(void 0===this.body.nodes[t])throw new Error("The clusteredNodeId supplied to updateClusteredNode does not exist.");this.body.nodes[t].setOptions(e),this.body.emitter.emit("_dataChanged")}},{key:"updateEdge",value:function(t,e){if(void 0===t)throw new Error("No startEdgeId supplied to updateEdge.");if(void 0===e)throw new Error("No newOptions supplied to updateEdge.");if(void 0===this.body.edges[t])throw new Error("The startEdgeId supplied to updateEdge does not exist.");for(var i=this.getClusteredEdges(t),o=0;o<i.length;o++)this.body.edges[i[o]].setOptions(e);this.body.emitter.emit("_dataChanged")}},{key:"getClusteredEdges",value:function(t){for(var e=[],i=0;void 0!==t&&void 0!==this.body.edges[t]&&i<100;)e.push(this.body.edges[t].id),t=this.body.edges[t].edgeReplacedById,i++;return Gp(e).call(e),e}},{key:"getBaseEdge",value:function(t){return this.getBaseEdges(t)[0]}},{key:"getBaseEdges",value:function(t){for(var e=[t],i=[],o=[],n=0;e.length>0&&n<100;){var s=e.pop();if(void 0!==s){var r=this.body.edges[s];if(void 0!==r){n++;var a=r.clusteringEdgeReplacingIds;if(void 0===a)o.push(s);else for(var l=0;l<a.length;++l){var h=a[l];-1===bf(e).call(e,a)&&-1===bf(i).call(i,a)&&e.push(h)}i.push(s)}}}return o}},{key:"_getConnectedId",value:function(t,e){return t.toId!=e?t.toId:(t.fromId,t.fromId)}},{key:"_getHubSize",value:function(){for(var t=0,e=0,i=0,o=0,n=0;n<this.body.nodeIndices.length;n++){var s=this.body.nodes[this.body.nodeIndices[n]];s.edges.length>o&&(o=s.edges.length),t+=s.edges.length,e+=Math.pow(s.edges.length,2),i+=1}t/=i;var r=(e/=i)-Math.pow(t,2),a=Math.sqrt(r),l=Math.floor(t+2*a);return l>o&&(l=o),l}},{key:"_createClusteredEdge",value:function(t,e,i,o,n){var s=Qw.cloneOptions(i,"edge");qv(s,o),s.from=t,s.to=e,s.id="clusterEdge:"+Zw(),void 0!==n&&qv(s,n);var r=this.body.functions.createEdge(s);return r.clusteringEdgeReplacingIds=[i.id],r.connect(),this.body.edges[r.id]=r,r}},{key:"_clusterEdges",value:function(t,e,i,o){if(e instanceof Nw){var n=e,s={};s[n.id]=n,e=s}if(t instanceof XE){var r=t,a={};a[r.id]=r,t=a}if(null==i)throw new Error("_clusterEdges: parameter clusterNode required");for(var l in void 0===o&&(o=i.clusterEdgeProperties),this._createClusterEdges(t,e,i,o),e)if(Object.prototype.hasOwnProperty.call(e,l)&&void 0!==this.body.edges[l]){var h=this.body.edges[l];this._backupEdgeOptions(h),h.setOptions({physics:!1})}for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(this.clusteredNodes[c]={clusterId:i.id,node:this.body.nodes[c]},this.body.nodes[c].setOptions({physics:!1}))}},{key:"_getClusterNodeForNode",value:function(t){if(void 0!==t){var e=this.clusteredNodes[t];if(void 0!==e){var i=e.clusterId;if(void 0!==i)return this.body.nodes[i]}}}},{key:"_filter",value:function(t,e){var i=[];return tb(t,(function(t){e(t)&&i.push(t)})),i}},{key:"_updateState",value:function(){var t,e=this,i=[],o={},n=function(t){tb(e.body.nodes,(function(e){!0===e.isCluster&&t(e)}))};for(t in this.clusteredNodes)Object.prototype.hasOwnProperty.call(this.clusteredNodes,t)&&void 0===this.body.nodes[t]&&i.push(t);n((function(t){for(var e=0;e<i.length;e++)delete t.containedNodes[i[e]]}));for(var s=0;s<i.length;s++)delete this.clusteredNodes[i[s]];tb(this.clusteredEdges,(function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()||(o[t]=t)})),n((function(t){tb(t.containedEdges,(function(t,e){t.endPointsValid()||o[e]||(o[e]=e)}))})),tb(this.body.edges,(function(t,i){var n=!0,s=t.clusteringEdgeReplacingIds;if(void 0!==s){var r=0;tb(s,(function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()&&(r+=1)})),n=r>0}t.endPointsValid()&&n||(o[i]=i)})),n((function(t){tb(o,(function(i){delete t.containedEdges[i],tb(t.edges,(function(n,s){n.id!==i?n.clusteringEdgeReplacingIds=e._filter(n.clusteringEdgeReplacingIds,(function(t){return!o[t]})):t.edges[s]=null})),t.edges=e._filter(t.edges,(function(t){return null!==t}))}))})),tb(o,(function(t){delete e.clusteredEdges[t]})),tb(o,(function(t){delete e.body.edges[t]})),tb(vp(this.body.edges),(function(t){var i=e.body.edges[t],o=e._isClusteredNode(i.fromId)||e._isClusteredNode(i.toId);if(o!==e._isClusteredEdge(i.id))if(o){var n=e._getClusterNodeForNode(i.fromId);void 0!==n&&e._clusterEdges(e.body.nodes[i.fromId],i,n);var s=e._getClusterNodeForNode(i.toId);void 0!==s&&e._clusterEdges(e.body.nodes[i.toId],i,s)}else delete e._clusterEdges[t],e._restoreEdge(i)}));for(var r=!1,a=!0,l=function(){var t=[];n((function(e){var i=vp(e.containedNodes).length,o=!0===e.options.allowSingleNodeCluster;(o&&i<1||!o&&i<2)&&t.push(e.id)}));for(var i=0;i<t.length;++i)e.openCluster(t[i],{},!1);a=t.length>0,r=r||a};a;)l();r&&this._updateState()}},{key:"_isClusteredNode",value:function(t){return void 0!==this.clusteredNodes[t]}},{key:"_isClusteredEdge",value:function(t){return void 0!==this.clusteredEdges[t]}}]),t}(),ik=function(){function t(e,i){var o;nl(this,t),void 0!==window&&(o=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),window.requestAnimationFrame=void 0===o?function(t){t()}:o,this.body=e,this.canvas=i,this.redrawRequested=!1,this.renderTimer=void 0,this.requiresTimeout=!0,this.renderingActive=!1,this.renderRequests=0,this.allowRedraw=!0,this.dragging=!1,this.zooming=!1,this.options={},this.defaultOptions={hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1},bo(this.options,this.defaultOptions),this._determineBrowserMethod(),this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.on("dragStart",(function(){e.dragging=!0})),this.body.emitter.on("dragEnd",(function(){e.dragging=!1})),this.body.emitter.on("zoom",(function(){e.zooming=!0,window.clearTimeout(e.zoomTimeoutId),e.zoomTimeoutId=Gf((function(){var t;e.zooming=!1,Fo(t=e._requestRedraw).call(t,e)()}),250)})),this.body.emitter.on("_resizeNodes",(function(){e._resizeNodes()})),this.body.emitter.on("_redraw",(function(){!1===e.renderingActive&&e._redraw()})),this.body.emitter.on("_blockRedraw",(function(){e.allowRedraw=!1})),this.body.emitter.on("_allowRedraw",(function(){e.allowRedraw=!0,e.redrawRequested=!1})),this.body.emitter.on("_requestRedraw",Fo(t=this._requestRedraw).call(t,this)),this.body.emitter.on("_startRendering",(function(){e.renderRequests+=1,e.renderingActive=!0,e._startRendering()})),this.body.emitter.on("_stopRendering",(function(){e.renderRequests-=1,e.renderingActive=e.renderRequests>0,e.renderTimer=void 0})),this.body.emitter.on("destroy",(function(){e.renderRequests=0,e.allowRedraw=!1,e.renderingActive=!1,!0===e.requiresTimeout?clearTimeout(e.renderTimer):window.cancelAnimationFrame(e.renderTimer),e.body.emitter.off()}))}},{key:"setOptions",value:function(t){void 0!==t&&Kv(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag"],this.options,t)}},{key:"_requestNextFrame",value:function(t,e){if("undefined"!=typeof window){var i,o=window;return!0===this.requiresTimeout?i=Gf(t,e):o.requestAnimationFrame&&(i=o.requestAnimationFrame(t)),i}}},{key:"_startRendering",value:function(){var t;!0===this.renderingActive&&void 0===this.renderTimer&&(this.renderTimer=this._requestNextFrame(Fo(t=this._renderStep).call(t,this),this.simulationInterval))}},{key:"_renderStep",value:function(){!0===this.renderingActive&&(this.renderTimer=void 0,!0===this.requiresTimeout&&this._startRendering(),this._redraw(),!1===this.requiresTimeout&&this._startRendering())}},{key:"redraw",value:function(){this.body.emitter.emit("setSize"),this._redraw()}},{key:"_requestRedraw",value:function(){var t=this;!0!==this.redrawRequested&&!1===this.renderingActive&&!0===this.allowRedraw&&(this.redrawRequested=!0,this._requestNextFrame((function(){t._redraw(!1)}),0))}},{key:"_redraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.allowRedraw){this.body.emitter.emit("initRedraw"),this.redrawRequested=!1;var e={drawExternalLabels:null};0!==this.canvas.frame.canvas.width&&0!==this.canvas.frame.canvas.height||this.canvas.setSize(),this.canvas.setTransform();var i=this.canvas.getContext(),o=this.canvas.frame.canvas.clientWidth,n=this.canvas.frame.canvas.clientHeight;if(i.clearRect(0,0,o,n),0===this.canvas.frame.clientWidth)return;if(i.save(),i.translate(this.body.view.translation.x,this.body.view.translation.y),i.scale(this.body.view.scale,this.body.view.scale),i.beginPath(),this.body.emitter.emit("beforeDrawing",i),i.closePath(),!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawEdges(i),!1===this.dragging||!0===this.dragging&&!1===this.options.hideNodesOnDrag){var s=this._drawNodes(i,t).drawExternalLabels;e.drawExternalLabels=s}!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawArrows(i),null!=e.drawExternalLabels&&e.drawExternalLabels(),!1===t&&this._drawSelectionBox(i),i.beginPath(),this.body.emitter.emit("afterDrawing",i),i.closePath(),i.restore(),!0===t&&i.clearRect(0,0,o,n)}}},{key:"_resizeNodes",value:function(){this.canvas.setTransform();var t=this.canvas.getContext();t.save(),t.translate(this.body.view.translation.x,this.body.view.translation.y),t.scale(this.body.view.scale,this.body.view.scale);var e,i=this.body.nodes;for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&((e=i[o]).resize(t),e.updateBoundingBox(t,e.selected));t.restore()}},{key:"_drawNodes",value:function(t){for(var e,i,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.body.nodes,s=this.body.nodeIndices,r=[],a=[],l=this.canvas.DOMtoCanvas({x:-20,y:-20}),h=this.canvas.DOMtoCanvas({x:this.canvas.frame.canvas.clientWidth+20,y:this.canvas.frame.canvas.clientHeight+20}),c={top:l.y,left:l.x,bottom:h.y,right:h.x},u=[],d=0;d<s.length;d++)if((e=n[s[d]]).hover)a.push(s[d]);else if(e.isSelected())r.push(s[d]);else if(!0===o){var p=e.draw(t);null!=p.drawExternalLabel&&u.push(p.drawExternalLabel)}else if(!0===e.isBoundingBoxOverlappingWith(c)){var g=e.draw(t);null!=g.drawExternalLabel&&u.push(g.drawExternalLabel)}else e.updateBoundingBox(t,e.selected);var f=r.length,m=a.length;for(i=0;i<f;i++){var v=(e=n[r[i]]).draw(t);null!=v.drawExternalLabel&&u.push(v.drawExternalLabel)}for(i=0;i<m;i++){var b=(e=n[a[i]]).draw(t);null!=b.drawExternalLabel&&u.push(b.drawExternalLabel)}return{drawExternalLabels:function(){for(var t=0,e=u;t<e.length;t++)(0,e[t])()}}}},{key:"_drawEdges",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,o=0;o<i.length;o++){var n=e[i[o]];!0===n.connected&&n.draw(t)}}},{key:"_drawArrows",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,o=0;o<i.length;o++){var n=e[i[o]];!0===n.connected&&n.drawArrows(t)}}},{key:"_determineBrowserMethod",value:function(){if("undefined"!=typeof window){var t=navigator.userAgent.toLowerCase();this.requiresTimeout=!1,(-1!=bf(t).call(t,"msie 9.0")||-1!=bf(t).call(t,"safari")&&bf(t).call(t,"chrome")<=-1)&&(this.requiresTimeout=!0)}else this.requiresTimeout=!0}},{key:"_drawSelectionBox",value:function(t){if(this.body.selectionBox.show){t.beginPath();var e=this.body.selectionBox.position.end.x-this.body.selectionBox.position.start.x,i=this.body.selectionBox.position.end.y-this.body.selectionBox.position.start.y;t.rect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.fillStyle="rgba(151, 194, 252, 0.2)",t.fillRect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.strokeStyle="rgba(151, 194, 252, 1)",t.stroke()}else t.closePath()}}]),t}(),ok=n(ot.setInterval);function nk(t,e){e.inputHandler=function(t){t.isFirst&&e(t)},t.on("hammer.input",e.inputHandler)}function sk(t,e){return e.inputHandler=function(t){t.isFinal&&e(t)},t.on("hammer.input",e.inputHandler)}var rk=function(){function t(e){nl(this,t),this.body=e,this.pixelRatio=1,this.cameraState={},this.initialized=!1,this.canvasViewCenter={},this._cleanupCallbacks=[],this.options={},this.defaultOptions={autoResize:!0,height:"100%",width:"100%"},bo(this.options,this.defaultOptions),this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.once("resize",(function(t){0!==t.width&&(e.body.view.translation.x=.5*t.width),0!==t.height&&(e.body.view.translation.y=.5*t.height)})),this.body.emitter.on("setSize",Fo(t=this.setSize).call(t,this)),this.body.emitter.on("destroy",(function(){e.hammerFrame.destroy(),e.hammer.destroy(),e._cleanUp()}))}},{key:"setOptions",value:function(t){var e=this;if(void 0!==t&&Kv(["width","height","autoResize"],this.options,t),this._cleanUp(),!0===this.options.autoResize){var i;if(window.ResizeObserver){var o=new ResizeObserver((function(){!0===e.setSize()&&e.body.emitter.emit("_requestRedraw")})),n=this.frame;o.observe(n),this._cleanupCallbacks.push((function(){o.unobserve(n)}))}else{var s=ok((function(){!0===e.setSize()&&e.body.emitter.emit("_requestRedraw")}),1e3);this._cleanupCallbacks.push((function(){clearInterval(s)}))}var r=Fo(i=this._onResize).call(i,this);window.addEventListener("resize",r),this._cleanupCallbacks.push((function(){window.removeEventListener("resize",r)}))}}},{key:"_cleanUp",value:function(){var t,e,i;xp(t=Gp(e=hg(i=this._cleanupCallbacks).call(i,0)).call(e)).call(t,(function(t){try{t()}catch(t){console.error(t)}}))}},{key:"_onResize",value:function(){this.setSize(),this.body.emitter.emit("_redraw")}},{key:"_getCameraState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pixelRatio;!0===this.initialized&&(this.cameraState.previousWidth=this.frame.canvas.width/t,this.cameraState.previousHeight=this.frame.canvas.height/t,this.cameraState.scale=this.body.view.scale,this.cameraState.position=this.DOMtoCanvas({x:.5*this.frame.canvas.width/t,y:.5*this.frame.canvas.height/t}))}},{key:"_setCameraState",value:function(){if(void 0!==this.cameraState.scale&&0!==this.frame.canvas.clientWidth&&0!==this.frame.canvas.clientHeight&&0!==this.pixelRatio&&this.cameraState.previousWidth>0&&this.cameraState.previousHeight>0){var t=this.frame.canvas.width/this.pixelRatio/this.cameraState.previousWidth,e=this.frame.canvas.height/this.pixelRatio/this.cameraState.previousHeight,i=this.cameraState.scale;1!=t&&1!=e?i=.5*this.cameraState.scale*(t+e):1!=t?i=this.cameraState.scale*t:1!=e&&(i=this.cameraState.scale*e),this.body.view.scale=i;var o=this.DOMtoCanvas({x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight}),n={x:o.x-this.cameraState.position.x,y:o.y-this.cameraState.position.y};this.body.view.translation.x+=n.x*this.body.view.scale,this.body.view.translation.y+=n.y*this.body.view.scale}}},{key:"_prepareValue",value:function(t){if("number"==typeof t)return t+"px";if("string"==typeof t){if(-1!==bf(t).call(t,"%")||-1!==bf(t).call(t,"px"))return t;if(-1===bf(t).call(t,"%"))return t+"px"}throw new Error("Could not use the value supplied for width or height:"+t)}},{key:"_create",value:function(){for(;this.body.container.hasChildNodes();)this.body.container.removeChild(this.body.container.firstChild);if(this.frame=document.createElement("div"),this.frame.className="vis-network",this.frame.style.position="relative",this.frame.style.overflow="hidden",this.frame.tabIndex=0,this.frame.canvas=document.createElement("canvas"),this.frame.canvas.style.position="relative",this.frame.appendChild(this.frame.canvas),this.frame.canvas.getContext)this._setPixelRatio(),this.setTransform();else{var t=document.createElement("DIV");t.style.color="red",t.style.fontWeight="bold",t.style.padding="10px",t.innerText="Error: your browser does not support HTML canvas",this.frame.canvas.appendChild(t)}this.body.container.appendChild(this.frame),this.body.view.scale=1,this.body.view.translation={x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight},this._bindHammer()}},{key:"_bindHammer",value:function(){var t=this;void 0!==this.hammer&&this.hammer.destroy(),this.drag={},this.pinch={},this.hammer=new Ib(this.frame.canvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.get("pan").set({threshold:5,direction:Ib.DIRECTION_ALL}),nk(this.hammer,(function(e){t.body.eventListeners.onTouch(e)})),this.hammer.on("tap",(function(e){t.body.eventListeners.onTap(e)})),this.hammer.on("doubletap",(function(e){t.body.eventListeners.onDoubleTap(e)})),this.hammer.on("press",(function(e){t.body.eventListeners.onHold(e)})),this.hammer.on("panstart",(function(e){t.body.eventListeners.onDragStart(e)})),this.hammer.on("panmove",(function(e){t.body.eventListeners.onDrag(e)})),this.hammer.on("panend",(function(e){t.body.eventListeners.onDragEnd(e)})),this.hammer.on("pinch",(function(e){t.body.eventListeners.onPinch(e)})),this.frame.canvas.addEventListener("wheel",(function(e){t.body.eventListeners.onMouseWheel(e)})),this.frame.canvas.addEventListener("mousemove",(function(e){t.body.eventListeners.onMouseMove(e)})),this.frame.canvas.addEventListener("contextmenu",(function(e){t.body.eventListeners.onContext(e)})),this.hammerFrame=new Ib(this.frame),sk(this.hammerFrame,(function(e){t.body.eventListeners.onRelease(e)}))}},{key:"setSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.height;t=this._prepareValue(t),e=this._prepareValue(e);var i=!1,o=this.frame.canvas.width,n=this.frame.canvas.height,s=this.pixelRatio;if(this._setPixelRatio(),t!=this.options.width||e!=this.options.height||this.frame.style.width!=t||this.frame.style.height!=e)this._getCameraState(s),this.frame.style.width=t,this.frame.style.height=e,this.frame.canvas.style.width="100%",this.frame.canvas.style.height="100%",this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio),this.options.width=t,this.options.height=e,this.canvasViewCenter={x:.5*this.frame.clientWidth,y:.5*this.frame.clientHeight},i=!0;else{var r=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),a=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);this.frame.canvas.width===r&&this.frame.canvas.height===a||this._getCameraState(s),this.frame.canvas.width!==r&&(this.frame.canvas.width=r,i=!0),this.frame.canvas.height!==a&&(this.frame.canvas.height=a,i=!0)}return!0===i&&(this.body.emitter.emit("resize",{width:Math.round(this.frame.canvas.width/this.pixelRatio),height:Math.round(this.frame.canvas.height/this.pixelRatio),oldWidth:Math.round(o/this.pixelRatio),oldHeight:Math.round(n/this.pixelRatio)}),this._setCameraState()),this.initialized=!0,i}},{key:"getContext",value:function(){return this.frame.canvas.getContext("2d")}},{key:"_determinePixelRatio",value:function(){var t=this.getContext();if(void 0===t)throw new Error("Could not get canvax context");var e=1;return"undefined"!=typeof window&&(e=window.devicePixelRatio||1),e/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},{key:"_setPixelRatio",value:function(){this.pixelRatio=this._determinePixelRatio()}},{key:"setTransform",value:function(){var t=this.getContext();if(void 0===t)throw new Error("Could not get canvax context");t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}},{key:"_XconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.x)/this.body.view.scale}},{key:"_XconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.x}},{key:"_YconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.y)/this.body.view.scale}},{key:"_YconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.y}},{key:"canvasToDOM",value:function(t){return{x:this._XconvertCanvasToDOM(t.x),y:this._YconvertCanvasToDOM(t.y)}}},{key:"DOMtoCanvas",value:function(t){return{x:this._XconvertDOMtoCanvas(t.x),y:this._YconvertDOMtoCanvas(t.y)}}}]),t}(),ak=function(){function t(e,i){var o,n,s=this;nl(this,t),this.body=e,this.canvas=i,this.animationSpeed=1/this.renderRefreshRate,this.animationEasingFunction="easeInOutQuint",this.easingTime=0,this.sourceScale=0,this.targetScale=0,this.sourceTranslation=0,this.targetTranslation=0,this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0,this.touchTime=0,this.viewFunction=void 0,this.body.emitter.on("fit",Fo(o=this.fit).call(o,this)),this.body.emitter.on("animationFinished",(function(){s.body.emitter.emit("_stopRendering")})),this.body.emitter.on("unlockNode",Fo(n=this.releaseNode).call(n,this))}return ad(t,[{key:"setOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t}},{key:"fit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=function(t,e){var i=bo({nodes:e,minZoomLevel:Number.MIN_VALUE,maxZoomLevel:1},null!=t?t:{});if(!lp(i.nodes))throw new TypeError("Nodes has to be an array of ids.");if(0===i.nodes.length&&(i.nodes=e),!("number"==typeof i.minZoomLevel&&i.minZoomLevel>0))throw new TypeError("Min zoom level has to be a number higher than zero.");if(!("number"==typeof i.maxZoomLevel&&i.minZoomLevel<=i.maxZoomLevel))throw new TypeError("Max zoom level has to be a number higher than min zoom level.");return i}(t,this.body.nodeIndices);var i,o,n=this.canvas.frame.canvas.clientWidth,s=this.canvas.frame.canvas.clientHeight;if(0===n||0===s)o=1,i=Qw.getRange(this.body.nodes,t.nodes);else if(!0===e){var r=0;for(var a in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,a)&&!0===this.body.nodes[a].predefinedPosition&&(r+=1);if(r>.5*this.body.nodeIndices.length)return void this.fit(t,!1);i=Qw.getRange(this.body.nodes,t.nodes),o=12.662/(this.body.nodeIndices.length+7.4147)+.0964822,o*=Math.min(n/600,s/600)}else{this.body.emitter.emit("_resizeNodes"),i=Qw.getRange(this.body.nodes,t.nodes);var l=n/(1.1*Math.abs(i.maxX-i.minX)),h=s/(1.1*Math.abs(i.maxY-i.minY));o=l<=h?l:h}o>t.maxZoomLevel?o=t.maxZoomLevel:o<t.minZoomLevel&&(o=t.minZoomLevel);var c={position:Qw.findCenter(i),scale:o,animation:t.animation};this.moveTo(c)}},{key:"focus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==this.body.nodes[t]){var i={x:this.body.nodes[t].x,y:this.body.nodes[t].y};e.position=i,e.lockedOnNode=t,this.moveTo(e)}else console.error("Node: "+t+" cannot be found.")}},{key:"moveTo",value:function(t){if(void 0!==t){if(null!=t.offset){if(null!=t.offset.x){if(t.offset.x=+t.offset.x,!Hy(t.offset.x))throw new TypeError('The option "offset.x" has to be a finite number.')}else t.offset.x=0;if(null!=t.offset.y){if(t.offset.y=+t.offset.y,!Hy(t.offset.y))throw new TypeError('The option "offset.y" has to be a finite number.')}else t.offset.x=0}else t.offset={x:0,y:0};if(null!=t.position){if(null!=t.position.x){if(t.position.x=+t.position.x,!Hy(t.position.x))throw new TypeError('The option "position.x" has to be a finite number.')}else t.position.x=0;if(null!=t.position.y){if(t.position.y=+t.position.y,!Hy(t.position.y))throw new TypeError('The option "position.y" has to be a finite number.')}else t.position.x=0}else t.position=this.getViewPosition();if(null!=t.scale){if(t.scale=+t.scale,!(t.scale>0))throw new TypeError('The option "scale" has to be a number greater than zero.')}else t.scale=this.body.view.scale;void 0===t.animation&&(t.animation={duration:0}),!1===t.animation&&(t.animation={duration:0}),!0===t.animation&&(t.animation={}),void 0===t.animation.duration&&(t.animation.duration=1e3),void 0===t.animation.easingFunction&&(t.animation.easingFunction="easeInOutQuad"),this.animateView(t)}else t={}}},{key:"animateView",value:function(t){if(void 0!==t){this.animationEasingFunction=t.animation.easingFunction,this.releaseNode(),!0===t.locked&&(this.lockedOnNodeId=t.lockedOnNode,this.lockedOnNodeOffset=t.offset),0!=this.easingTime&&this._transitionRedraw(!0),this.sourceScale=this.body.view.scale,this.sourceTranslation=this.body.view.translation,this.targetScale=t.scale,this.body.view.scale=this.targetScale;var e,i,o=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),n=o.x-t.position.x,s=o.y-t.position.y;this.targetTranslation={x:this.sourceTranslation.x+n*this.targetScale+t.offset.x,y:this.sourceTranslation.y+s*this.targetScale+t.offset.y},0===t.animation.duration?null!=this.lockedOnNodeId?(this.viewFunction=Fo(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)):(this.body.view.scale=this.targetScale,this.body.view.translation=this.targetTranslation,this.body.emitter.emit("_requestRedraw")):(this.animationSpeed=1/(60*t.animation.duration*.001)||1/60,this.animationEasingFunction=t.animation.easingFunction,this.viewFunction=Fo(i=this._transitionRedraw).call(i,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))}}},{key:"_lockedRedraw",value:function(){var t=this.body.nodes[this.lockedOnNodeId].x,e=this.body.nodes[this.lockedOnNodeId].y,i=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),o=i.x-t,n=i.y-e,s=this.body.view.translation,r={x:s.x+o*this.body.view.scale+this.lockedOnNodeOffset.x,y:s.y+n*this.body.view.scale+this.lockedOnNodeOffset.y};this.body.view.translation=r}},{key:"releaseNode",value:function(){void 0!==this.lockedOnNodeId&&void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0)}},{key:"_transitionRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.easingTime+=this.animationSpeed,this.easingTime=!0===t?1:this.easingTime;var e,i=db[this.animationEasingFunction](this.easingTime);this.body.view.scale=this.sourceScale+(this.targetScale-this.sourceScale)*i,this.body.view.translation={x:this.sourceTranslation.x+(this.targetTranslation.x-this.sourceTranslation.x)*i,y:this.sourceTranslation.y+(this.targetTranslation.y-this.sourceTranslation.y)*i},this.easingTime>=1&&(this.body.emitter.off("initRedraw",this.viewFunction),this.easingTime=0,null!=this.lockedOnNodeId&&(this.viewFunction=Fo(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)),this.body.emitter.emit("animationFinished"))}},{key:"getScale",value:function(){return this.body.view.scale}},{key:"getViewPosition",value:function(){return this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight})}}]),t}();function lk(t){var e,i=t&&t.preventDefault||!1,o=t&&t.container||window,n={},s={keydown:{},keyup:{}},r={};for(e=97;e<=122;e++)r[String.fromCharCode(e)]={code:e-97+65,shift:!1};for(e=65;e<=90;e++)r[String.fromCharCode(e)]={code:e,shift:!0};for(e=0;e<=9;e++)r[""+e]={code:48+e,shift:!1};for(e=1;e<=12;e++)r["F"+e]={code:111+e,shift:!1};for(e=0;e<=9;e++)r["num"+e]={code:96+e,shift:!1};r["num*"]={code:106,shift:!1},r["num+"]={code:107,shift:!1},r["num-"]={code:109,shift:!1},r["num/"]={code:111,shift:!1},r["num."]={code:110,shift:!1},r.left={code:37,shift:!1},r.up={code:38,shift:!1},r.right={code:39,shift:!1},r.down={code:40,shift:!1},r.space={code:32,shift:!1},r.enter={code:13,shift:!1},r.shift={code:16,shift:void 0},r.esc={code:27,shift:!1},r.backspace={code:8,shift:!1},r.tab={code:9,shift:!1},r.ctrl={code:17,shift:!1},r.alt={code:18,shift:!1},r.delete={code:46,shift:!1},r.pageup={code:33,shift:!1},r.pagedown={code:34,shift:!1},r["="]={code:187,shift:!1},r["-"]={code:189,shift:!1},r["]"]={code:221,shift:!1},r["["]={code:219,shift:!1};var a=function(t){h(t,"keydown")},l=function(t){h(t,"keyup")},h=function(t,e){if(void 0!==s[e][t.keyCode]){for(var o=s[e][t.keyCode],n=0;n<o.length;n++)(void 0===o[n].shift||1==o[n].shift&&1==t.shiftKey||0==o[n].shift&&0==t.shiftKey)&&o[n].fn(t);1==i&&t.preventDefault()}};return n.bind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===r[t])throw new Error("unsupported key: "+t);void 0===s[i][r[t].code]&&(s[i][r[t].code]=[]),s[i][r[t].code].push({fn:e,shift:r[t].shift})},n.bindAll=function(t,e){for(var i in void 0===e&&(e="keydown"),r)r.hasOwnProperty(i)&&n.bind(i,t,e)},n.getKey=function(t){for(var e in r)if(r.hasOwnProperty(e)){if(1==t.shiftKey&&1==r[e].shift&&t.keyCode==r[e].code)return e;if(0==t.shiftKey&&0==r[e].shift&&t.keyCode==r[e].code)return e;if(t.keyCode==r[e].code&&"shift"==e)return e}return"unknown key, currently not supported"},n.unbind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===r[t])throw new Error("unsupported key: "+t);if(void 0!==e){var o=[],n=s[i][r[t].code];if(void 0!==n)for(var a=0;a<n.length;a++)n[a].fn==e&&n[a].shift==r[t].shift||o.push(s[i][r[t].code][a]);s[i][r[t].code]=o}else s[i][r[t].code]=[]},n.reset=function(){s={keydown:{},keyup:{}}},n.destroy=function(){s={keydown:{},keyup:{}},o.removeEventListener("keydown",a,!0),o.removeEventListener("keyup",l,!0)},o.addEventListener("keydown",a,!0),o.addEventListener("keyup",l,!0),n}var hk=function(){function t(e,i){var o=this;nl(this,t),this.body=e,this.canvas=i,this.iconsCreated=!1,this.navigationHammers=[],this.boundFunctions={},this.touchTime=0,this.activated=!1,this.body.emitter.on("activate",(function(){o.activated=!0,o.configureKeyboardBindings()})),this.body.emitter.on("deactivate",(function(){o.activated=!1,o.configureKeyboardBindings()})),this.body.emitter.on("destroy",(function(){void 0!==o.keycharm&&o.keycharm.destroy()})),this.options={}}return ad(t,[{key:"setOptions",value:function(t){void 0!==t&&(this.options=t,this.create())}},{key:"create",value:function(){!0===this.options.navigationButtons?!1===this.iconsCreated&&this.loadNavigationElements():!0===this.iconsCreated&&this.cleanNavigation(),this.configureKeyboardBindings()}},{key:"cleanNavigation",value:function(){if(0!=this.navigationHammers.length){for(var t=0;t<this.navigationHammers.length;t++)this.navigationHammers[t].destroy();this.navigationHammers=[]}this.navigationDOM&&this.navigationDOM.wrapper&&this.navigationDOM.wrapper.parentNode&&this.navigationDOM.wrapper.parentNode.removeChild(this.navigationDOM.wrapper),this.iconsCreated=!1}},{key:"loadNavigationElements",value:function(){var t=this;this.cleanNavigation(),this.navigationDOM={};var e=["up","down","left","right","zoomIn","zoomOut","zoomExtends"],i=["_moveUp","_moveDown","_moveLeft","_moveRight","_zoomIn","_zoomOut","_fit"];this.navigationDOM.wrapper=document.createElement("div"),this.navigationDOM.wrapper.className="vis-navigation",this.canvas.frame.appendChild(this.navigationDOM.wrapper);for(var o=0;o<e.length;o++){this.navigationDOM[e[o]]=document.createElement("div"),this.navigationDOM[e[o]].className="vis-button vis-"+e[o],this.navigationDOM.wrapper.appendChild(this.navigationDOM[e[o]]);var n,s,r=new Ib(this.navigationDOM[e[o]]);nk(r,"_fit"===i[o]?Fo(n=this._fit).call(n,this):Fo(s=this.bindToRedraw).call(s,this,i[o])),this.navigationHammers.push(r)}var a=new Ib(this.canvas.frame);sk(a,(function(){t._stopMovement()})),this.navigationHammers.push(a),this.iconsCreated=!0}},{key:"bindToRedraw",value:function(t){var e;void 0===this.boundFunctions[t]&&(this.boundFunctions[t]=Fo(e=this[t]).call(e,this),this.body.emitter.on("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_startRendering"))}},{key:"unbindFromRedraw",value:function(t){void 0!==this.boundFunctions[t]&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"),delete this.boundFunctions[t])}},{key:"_fit",value:function(){(new Date).valueOf()-this.touchTime>700&&(this.body.emitter.emit("fit",{duration:700}),this.touchTime=(new Date).valueOf())}},{key:"_stopMovement",value:function(){for(var t in this.boundFunctions)Object.prototype.hasOwnProperty.call(this.boundFunctions,t)&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"));this.boundFunctions={}}},{key:"_moveUp",value:function(){this.body.view.translation.y+=this.options.keyboard.speed.y}},{key:"_moveDown",value:function(){this.body.view.translation.y-=this.options.keyboard.speed.y}},{key:"_moveLeft",value:function(){this.body.view.translation.x+=this.options.keyboard.speed.x}},{key:"_moveRight",value:function(){this.body.view.translation.x-=this.options.keyboard.speed.x}},{key:"_zoomIn",value:function(){var t=this.body.view.scale,e=this.body.view.scale*(1+this.options.keyboard.speed.zoom),i=this.body.view.translation,o=e/t,n=(1-o)*this.canvas.canvasViewCenter.x+i.x*o,s=(1-o)*this.canvas.canvasViewCenter.y+i.y*o;this.body.view.scale=e,this.body.view.translation={x:n,y:s},this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:null})}},{key:"_zoomOut",value:function(){var t=this.body.view.scale,e=this.body.view.scale/(1+this.options.keyboard.speed.zoom),i=this.body.view.translation,o=e/t,n=(1-o)*this.canvas.canvasViewCenter.x+i.x*o,s=(1-o)*this.canvas.canvasViewCenter.y+i.y*o;this.body.view.scale=e,this.body.view.translation={x:n,y:s},this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:null})}},{key:"configureKeyboardBindings",value:function(){var t,e,i,o,n,s,r,a,l,h,c,u,d,p,g,f,m,v,b,_,y,T,E,w,k=this;void 0!==this.keycharm&&this.keycharm.destroy(),!0===this.options.keyboard.enabled&&(!0===this.options.keyboard.bindToWindow?this.keycharm=lk({container:window,preventDefault:!0}):this.keycharm=lk({container:this.canvas.frame,preventDefault:!0}),this.keycharm.reset(),!0===this.activated&&(Fo(t=this.keycharm).call(t,"up",(function(){k.bindToRedraw("_moveUp")}),"keydown"),Fo(e=this.keycharm).call(e,"down",(function(){k.bindToRedraw("_moveDown")}),"keydown"),Fo(i=this.keycharm).call(i,"left",(function(){k.bindToRedraw("_moveLeft")}),"keydown"),Fo(o=this.keycharm).call(o,"right",(function(){k.bindToRedraw("_moveRight")}),"keydown"),Fo(n=this.keycharm).call(n,"=",(function(){k.bindToRedraw("_zoomIn")}),"keydown"),Fo(s=this.keycharm).call(s,"num+",(function(){k.bindToRedraw("_zoomIn")}),"keydown"),Fo(r=this.keycharm).call(r,"num-",(function(){k.bindToRedraw("_zoomOut")}),"keydown"),Fo(a=this.keycharm).call(a,"-",(function(){k.bindToRedraw("_zoomOut")}),"keydown"),Fo(l=this.keycharm).call(l,"[",(function(){k.bindToRedraw("_zoomOut")}),"keydown"),Fo(h=this.keycharm).call(h,"]",(function(){k.bindToRedraw("_zoomIn")}),"keydown"),Fo(c=this.keycharm).call(c,"pageup",(function(){k.bindToRedraw("_zoomIn")}),"keydown"),Fo(u=this.keycharm).call(u,"pagedown",(function(){k.bindToRedraw("_zoomOut")}),"keydown"),Fo(d=this.keycharm).call(d,"up",(function(){k.unbindFromRedraw("_moveUp")}),"keyup"),Fo(p=this.keycharm).call(p,"down",(function(){k.unbindFromRedraw("_moveDown")}),"keyup"),Fo(g=this.keycharm).call(g,"left",(function(){k.unbindFromRedraw("_moveLeft")}),"keyup"),Fo(f=this.keycharm).call(f,"right",(function(){k.unbindFromRedraw("_moveRight")}),"keyup"),Fo(m=this.keycharm).call(m,"=",(function(){k.unbindFromRedraw("_zoomIn")}),"keyup"),Fo(v=this.keycharm).call(v,"num+",(function(){k.unbindFromRedraw("_zoomIn")}),"keyup"),Fo(b=this.keycharm).call(b,"num-",(function(){k.unbindFromRedraw("_zoomOut")}),"keyup"),Fo(_=this.keycharm).call(_,"-",(function(){k.unbindFromRedraw("_zoomOut")}),"keyup"),Fo(y=this.keycharm).call(y,"[",(function(){k.unbindFromRedraw("_zoomOut")}),"keyup"),Fo(T=this.keycharm).call(T,"]",(function(){k.unbindFromRedraw("_zoomIn")}),"keyup"),Fo(E=this.keycharm).call(E,"pageup",(function(){k.unbindFromRedraw("_zoomIn")}),"keyup"),Fo(w=this.keycharm).call(w,"pagedown",(function(){k.unbindFromRedraw("_zoomOut")}),"keyup")))}}]),t}();function ck(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}var uk=function(){function t(e,i,o){var n,s,r,a,l,h,c,u,d,p,g,f,m;nl(this,t),this.body=e,this.canvas=i,this.selectionHandler=o,this.navigationHandler=new hk(e,i),this.body.eventListeners.onTap=Fo(n=this.onTap).call(n,this),this.body.eventListeners.onTouch=Fo(s=this.onTouch).call(s,this),this.body.eventListeners.onDoubleTap=Fo(r=this.onDoubleTap).call(r,this),this.body.eventListeners.onHold=Fo(a=this.onHold).call(a,this),this.body.eventListeners.onDragStart=Fo(l=this.onDragStart).call(l,this),this.body.eventListeners.onDrag=Fo(h=this.onDrag).call(h,this),this.body.eventListeners.onDragEnd=Fo(c=this.onDragEnd).call(c,this),this.body.eventListeners.onMouseWheel=Fo(u=this.onMouseWheel).call(u,this),this.body.eventListeners.onPinch=Fo(d=this.onPinch).call(d,this),this.body.eventListeners.onMouseMove=Fo(p=this.onMouseMove).call(p,this),this.body.eventListeners.onRelease=Fo(g=this.onRelease).call(g,this),this.body.eventListeners.onContext=Fo(f=this.onContext).call(f,this),this.touchTime=0,this.drag={},this.pinch={},this.popup=void 0,this.popupObj=void 0,this.popupTimer=void 0,this.body.functions.getPointer=Fo(m=this.getPointer).call(m,this),this.options={},this.defaultOptions={dragNodes:!0,dragView:!0,hover:!1,keyboard:{enabled:!1,speed:{x:10,y:10,zoom:.02},bindToWindow:!0,autoFocus:!0},navigationButtons:!1,tooltipDelay:300,zoomView:!0,zoomSpeed:1},bo(this.options,this.defaultOptions),this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("destroy",(function(){clearTimeout(t.popupTimer),delete t.body.functions.getPointer}))}},{key:"setOptions",value:function(t){void 0!==t&&(Jv(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag","keyboard","multiselect","selectable","selectConnectedEdges"],this.options,t),ub(this.options,t,"keyboard"),t.tooltip&&(bo(this.options.tooltip,t.tooltip),t.tooltip.color&&(this.options.tooltip.color=nb(t.tooltip.color)))),this.navigationHandler.setOptions(this.options)}},{key:"getPointer",value:function(t){return{x:t.x-(e=this.canvas.frame.canvas,e.getBoundingClientRect().left),y:t.y-Qv(this.canvas.frame.canvas)};var e}},{key:"onTouch",value:function(t){(new Date).valueOf()-this.touchTime>50&&(this.drag.pointer=this.getPointer(t.center),this.drag.pinched=!1,this.pinch.scale=this.body.view.scale,this.touchTime=(new Date).valueOf())}},{key:"onTap",value:function(t){var e=this.getPointer(t.center),i=this.selectionHandler.options.multiselect&&(t.changedPointers[0].ctrlKey||t.changedPointers[0].metaKey);this.checkSelectionChanges(e,i),this.selectionHandler.commitAndEmit(e,t),this.selectionHandler.generateClickEvent("click",t,e)}},{key:"onDoubleTap",value:function(t){var e=this.getPointer(t.center);this.selectionHandler.generateClickEvent("doubleClick",t,e)}},{key:"onHold",value:function(t){var e=this.getPointer(t.center),i=this.selectionHandler.options.multiselect;this.checkSelectionChanges(e,i),this.selectionHandler.commitAndEmit(e,t),this.selectionHandler.generateClickEvent("click",t,e),this.selectionHandler.generateClickEvent("hold",t,e)}},{key:"onRelease",value:function(t){if((new Date).valueOf()-this.touchTime>10){var e=this.getPointer(t.center);this.selectionHandler.generateClickEvent("release",t,e),this.touchTime=(new Date).valueOf()}}},{key:"onContext",value:function(t){var e=this.getPointer({x:t.clientX,y:t.clientY});this.selectionHandler.generateClickEvent("oncontext",t,e)}},{key:"checkSelectionChanges",value:function(t){!0===(arguments.length>1&&void 0!==arguments[1]&&arguments[1])?this.selectionHandler.selectAdditionalOnPoint(t):this.selectionHandler.selectOnPoint(t)}},{key:"_determineDifference",value:function(t,e){var i=function(t,e){for(var i=[],o=0;o<t.length;o++){var n=t[o];-1===bf(e).call(e,n)&&i.push(n)}return i};return{nodes:i(t.nodes,e.nodes),edges:i(t.edges,e.edges)}}},{key:"onDragStart",value:function(t){if(!this.drag.dragging){void 0===this.drag.pointer&&this.onTouch(t);var e=this.selectionHandler.getNodeAt(this.drag.pointer);if(this.drag.dragging=!0,this.drag.selection=[],this.drag.translation=bo({},this.body.view.translation),this.drag.nodeId=void 0,t.srcEvent.shiftKey){this.body.selectionBox.show=!0;var i=this.getPointer(t.center);this.body.selectionBox.position.start={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)}}else if(void 0!==e&&!0===this.options.dragNodes){this.drag.nodeId=e.id,!1===e.isSelected()&&this.selectionHandler.setSelection({nodes:[e.id]}),this.selectionHandler.generateClickEvent("dragStart",t,this.drag.pointer);var o,n=function(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return ck(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ck(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}(this.selectionHandler.getSelectedNodes());try{for(n.s();!(o=n.n()).done;){var s=o.value,r={id:s.id,node:s,x:s.x,y:s.y,xFixed:s.options.fixed.x,yFixed:s.options.fixed.y};s.options.fixed.x=!0,s.options.fixed.y=!0,this.drag.selection.push(r)}}catch(t){n.e(t)}finally{n.f()}}else this.selectionHandler.generateClickEvent("dragStart",t,this.drag.pointer,void 0,!0)}}},{key:"onDrag",value:function(t){var e=this;if(!0!==this.drag.pinched){this.body.emitter.emit("unlockNode");var i=this.getPointer(t.center),o=this.drag.selection;if(o&&o.length&&!0===this.options.dragNodes){this.selectionHandler.generateClickEvent("dragging",t,i);var n=i.x-this.drag.pointer.x,s=i.y-this.drag.pointer.y;xp(o).call(o,(function(t){var i=t.node;!1===t.xFixed&&(i.x=e.canvas._XconvertDOMtoCanvas(e.canvas._XconvertCanvasToDOM(t.x)+n)),!1===t.yFixed&&(i.y=e.canvas._YconvertDOMtoCanvas(e.canvas._YconvertCanvasToDOM(t.y)+s))})),this.body.emitter.emit("startSimulation")}else{if(t.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(t);this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.emitter.emit("_requestRedraw")}if(!0===this.options.dragView&&!t.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(t);var r=i.x-this.drag.pointer.x,a=i.y-this.drag.pointer.y;this.body.view.translation={x:this.drag.translation.x+r,y:this.drag.translation.y+a},this.body.emitter.emit("_requestRedraw")}}}}},{key:"onDragEnd",value:function(t){var e=this;if(this.drag.dragging=!1,this.body.selectionBox.show){var i;this.body.selectionBox.show=!1;var o=this.body.selectionBox.position,n={minX:Math.min(o.start.x,o.end.x),minY:Math.min(o.start.y,o.end.y),maxX:Math.max(o.start.x,o.end.x),maxY:Math.max(o.start.y,o.end.y)},s=Fg(i=this.body.nodeIndices).call(i,(function(t){var i=e.body.nodes[t];return i.x>=n.minX&&i.x<=n.maxX&&i.y>=n.minY&&i.y<=n.maxY}));xp(s).call(s,(function(t){return e.selectionHandler.selectObject(e.body.nodes[t])}));var r=this.getPointer(t.center);this.selectionHandler.commitAndEmit(r,t),this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw")}else{var a=this.drag.selection;a&&a.length?(xp(a).call(a,(function(t){t.node.options.fixed.x=t.xFixed,t.node.options.fixed.y=t.yFixed})),this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center)),this.body.emitter.emit("startSimulation")):(this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw"))}}},{key:"onPinch",value:function(t){var e=this.getPointer(t.center);this.drag.pinched=!0,void 0===this.pinch.scale&&(this.pinch.scale=1);var i=this.pinch.scale*t.scale;this.zoom(i,e)}},{key:"zoom",value:function(t,e){if(!0===this.options.zoomView){var i=this.body.view.scale;t<1e-5&&(t=1e-5),t>10&&(t=10);var o=void 0;void 0!==this.drag&&!0===this.drag.dragging&&(o=this.canvas.DOMtoCanvas(this.drag.pointer));var n=this.body.view.translation,s=t/i,r=(1-s)*e.x+n.x*s,a=(1-s)*e.y+n.y*s;if(this.body.view.scale=t,this.body.view.translation={x:r,y:a},null!=o){var l=this.canvas.canvasToDOM(o);this.drag.pointer.x=l.x,this.drag.pointer.y=l.y}this.body.emitter.emit("_requestRedraw"),i<t?this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:e}):this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:e})}}},{key:"onMouseWheel",value:function(t){if(!0===this.options.zoomView){if(0!==t.deltaY){var e=this.body.view.scale;e*=1+(t.deltaY<0?1:-1)*(.1*this.options.zoomSpeed);var i=this.getPointer({x:t.clientX,y:t.clientY});this.zoom(e,i)}t.preventDefault()}}},{key:"onMouseMove",value:function(t){var e=this,i=this.getPointer({x:t.clientX,y:t.clientY}),o=!1;void 0!==this.popup&&(!1===this.popup.hidden&&this._checkHidePopup(i),!1===this.popup.hidden&&(o=!0,this.popup.setPosition(i.x+3,i.y-5),this.popup.show())),this.options.keyboard.autoFocus&&!1===this.options.keyboard.bindToWindow&&!0===this.options.keyboard.enabled&&this.canvas.frame.focus(),!1===o&&(void 0!==this.popupTimer&&(clearInterval(this.popupTimer),this.popupTimer=void 0),this.drag.dragging||(this.popupTimer=Gf((function(){return e._checkShowPopup(i)}),this.options.tooltipDelay))),!0===this.options.hover&&this.selectionHandler.hoverObject(t,i)}},{key:"_checkShowPopup",value:function(t){var e=this.canvas._XconvertDOMtoCanvas(t.x),i=this.canvas._YconvertDOMtoCanvas(t.y),o={left:e,top:i,right:e,bottom:i},n=void 0===this.popupObj?void 0:this.popupObj.id,s=!1,r="node";if(void 0===this.popupObj){for(var a,l=this.body.nodeIndices,h=this.body.nodes,c=[],u=0;u<l.length;u++)!0===(a=h[l[u]]).isOverlappingWith(o)&&(s=!0,void 0!==a.getTitle()&&c.push(l[u]));c.length>0&&(this.popupObj=h[c[c.length-1]],s=!0)}if(void 0===this.popupObj&&!1===s){for(var d,p=this.body.edgeIndices,g=this.body.edges,f=[],m=0;m<p.length;m++)!0===(d=g[p[m]]).isOverlappingWith(o)&&!0===d.connected&&void 0!==d.getTitle()&&f.push(p[m]);f.length>0&&(this.popupObj=g[f[f.length-1]],r="edge")}void 0!==this.popupObj?this.popupObj.id!==n&&(void 0===this.popup&&(this.popup=new $b(this.canvas.frame)),this.popup.popupTargetType=r,this.popup.popupTargetId=this.popupObj.id,this.popup.setPosition(t.x+3,t.y-5),this.popup.setText(this.popupObj.getTitle()),this.popup.show(),this.body.emitter.emit("showPopup",this.popupObj.id)):void 0!==this.popup&&(this.popup.hide(),this.body.emitter.emit("hidePopup"))}},{key:"_checkHidePopup",value:function(t){var e=this.selectionHandler._pointerToPositionObject(t),i=!1;if("node"===this.popup.popupTargetType){if(void 0!==this.body.nodes[this.popup.popupTargetId]&&!0===(i=this.body.nodes[this.popup.popupTargetId].isOverlappingWith(e))){var o=this.selectionHandler.getNodeAt(t);i=void 0!==o&&o.id===this.popup.popupTargetId}}else void 0===this.selectionHandler.getNodeAt(t)&&void 0!==this.body.edges[this.popup.popupTargetId]&&(i=this.body.edges[this.popup.popupTargetId].isOverlappingWith(e));!1===i&&(this.popupObj=void 0,this.popup.hide(),this.body.emitter.emit("hidePopup"))}}]),t}();gy("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),Ly);var dk=n(ot.Set),pk=b,gk=my,fk=L_.getWeakData,mk=q_,vk=ii,bk=X,_k=it,yk=Y_,Tk=Qt,Ek=Bn.set,wk=Bn.getterFor,kk=wh.find,Ik=wh.findIndex,$k=pk([].splice),Sk=0,Ck=function(t){return t.frozen||(t.frozen=new Ok)},Ok=function(){this.entries=[]},Rk=function(t,e){return kk(t.entries,(function(t){return t[0]===e}))};Ok.prototype={get:function(t){var e=Rk(this,t);if(e)return e[1]},has:function(t){return!!Rk(this,t)},set:function(t,e){var i=Rk(this,t);i?i[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ik(this.entries,(function(e){return e[0]===t}));return~e&&$k(this.entries,e,1),!!~e}};var Ak,Mk={getConstructor:function(t,e,i,o){var n=t((function(t,n){mk(t,s),Ek(t,{type:e,id:Sk++,frozen:void 0}),bk(n)||yk(n,t[o],{that:t,AS_ENTRIES:i})})),s=n.prototype,r=wk(e),a=function(t,e,i){var o=r(t),n=fk(vk(e),!0);return!0===n?Ck(o).set(e,i):n[o.id]=i,t};return gk(s,{delete:function(t){var e=r(this);if(!_k(t))return!1;var i=fk(t);return!0===i?Ck(e).delete(t):i&&Tk(i,e.id)&&delete i[e.id]},has:function(t){var e=r(this);if(!_k(t))return!1;var i=fk(t);return!0===i?Ck(e).has(t):i&&Tk(i,e.id)}}),gk(s,i?{get:function(t){var e=r(this);if(_k(t)){var i=fk(t);return!0===i?Ck(e).get(t):i?i[e.id]:void 0}},set:function(t,e){return a(this,t,e)}}:{add:function(t){return a(this,t,!0)}}),n}},xk=b_,Lk=r,Dk=b,Nk=my,Pk=L_,Bk=gy,Fk=Mk,Hk=it,Uk=Bn.enforce,Gk=a,Vk=Tn,Wk=Object,zk=Array.isArray,jk=Wk.isExtensible,Xk=Wk.isFrozen,Yk=Wk.isSealed,Kk=Wk.freeze,Jk=Wk.seal,qk={},Zk={},Qk=!Lk.ActiveXObject&&"ActiveXObject"in Lk,tI=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},eI=Bk("WeakMap",tI,Fk),iI=eI.prototype,oI=Dk(iI.set);if(Vk)if(Qk){Ak=Fk.getConstructor(tI,"WeakMap",!0),Pk.enable();var nI=Dk(iI.delete),sI=Dk(iI.has),rI=Dk(iI.get);Nk(iI,{delete:function(t){if(Hk(t)&&!jk(t)){var e=Uk(this);return e.frozen||(e.frozen=new Ak),nI(this,t)||e.frozen.delete(t)}return nI(this,t)},has:function(t){if(Hk(t)&&!jk(t)){var e=Uk(this);return e.frozen||(e.frozen=new Ak),sI(this,t)||e.frozen.has(t)}return sI(this,t)},get:function(t){if(Hk(t)&&!jk(t)){var e=Uk(this);return e.frozen||(e.frozen=new Ak),sI(this,t)?rI(this,t):e.frozen.get(t)}return rI(this,t)},set:function(t,e){if(Hk(t)&&!jk(t)){var i=Uk(this);i.frozen||(i.frozen=new Ak),sI(this,t)?oI(this,t,e):i.frozen.set(t,e)}else oI(this,t,e);return this}})}else xk&&Gk((function(){var t=Kk([]);return oI(new eI,t,1),!Xk(t)}))&&Nk(iI,{set:function(t,e){var i;return zk(t)&&(Xk(t)?i=qk:Yk(t)&&(i=Zk)),oI(this,t,e),i===qk&&Kk(t),i===Zk&&Jk(t),this}});var aI,lI,hI,cI,uI,dI=n(ot.WeakMap);function pI(t,e,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(t):o?o.value:e.get(t)}function gI(t,e,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(t,i):n?n.value=i:e.set(t,i),i}function fI(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return mI(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?mI(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function mI(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function vI(t,e){var i,o=new dk,n=fI(e);try{for(n.s();!(i=n.n()).done;){var s=i.value;t.has(s)||o.add(s)}}catch(t){n.e(t)}finally{n.f()}return o}"function"==typeof SuppressedError&&SuppressedError;var bI=function(){function t(){nl(this,t),aI.set(this,new dk),lI.set(this,new dk)}return ad(t,[{key:"size",get:function(){return pI(this,lI,"f").size}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var o=0,n=e;o<n.length;o++){var s=n[o];pI(this,lI,"f").add(s)}}},{key:"delete",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var o=0,n=e;o<n.length;o++){var s=n[o];pI(this,lI,"f").delete(s)}}},{key:"clear",value:function(){pI(this,lI,"f").clear()}},{key:"getSelection",value:function(){return Yd(pI(this,lI,"f"))}},{key:"getChanges",value:function(){return{added:Yd(vI(pI(this,aI,"f"),pI(this,lI,"f"))),deleted:Yd(vI(pI(this,lI,"f"),pI(this,aI,"f"))),previous:Yd(new dk(pI(this,aI,"f"))),current:Yd(new dk(pI(this,lI,"f")))}}},{key:"commit",value:function(){var t=this.getChanges();gI(this,aI,pI(this,lI,"f"),"f"),gI(this,lI,new dk(pI(this,aI,"f")),"f");var e,i=fI(t.added);try{for(i.s();!(e=i.n()).done;)e.value.select()}catch(t){i.e(t)}finally{i.f()}var o,n=fI(t.deleted);try{for(n.s();!(o=n.n()).done;)o.value.unselect()}catch(t){n.e(t)}finally{n.f()}return t}}]),t}();aI=new dI,lI=new dI;var _I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};nl(this,t),hI.set(this,new bI),cI.set(this,new bI),uI.set(this,void 0),gI(this,uI,e,"f")}return ad(t,[{key:"sizeNodes",get:function(){return pI(this,hI,"f").size}},{key:"sizeEdges",get:function(){return pI(this,cI,"f").size}},{key:"getNodes",value:function(){return pI(this,hI,"f").getSelection()}},{key:"getEdges",value:function(){return pI(this,cI,"f").getSelection()}},{key:"addNodes",value:function(){var t;(t=pI(this,hI,"f")).add.apply(t,arguments)}},{key:"addEdges",value:function(){var t;(t=pI(this,cI,"f")).add.apply(t,arguments)}},{key:"deleteNodes",value:function(t){pI(this,hI,"f").delete(t)}},{key:"deleteEdges",value:function(t){pI(this,cI,"f").delete(t)}},{key:"clear",value:function(){pI(this,hI,"f").clear(),pI(this,cI,"f").clear()}},{key:"commit",value:function(){for(var t,e,i={nodes:pI(this,hI,"f").commit(),edges:pI(this,cI,"f").commit()},o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return(t=pI(this,uI,"f")).call.apply(t,tp(e=[this,i]).call(e,n)),i}}]),t}();function yI(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return TI(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?TI(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function TI(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}hI=new dI,cI=new dI,uI=new dI;var EI=function(){function t(e,i){var o=this;nl(this,t),this.body=e,this.canvas=i,this._selectionAccumulator=new _I,this.hoverObj={nodes:{},edges:{}},this.options={},this.defaultOptions={multiselect:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0},bo(this.options,this.defaultOptions),this.body.emitter.on("_dataChanged",(function(){o.updateSelection()}))}return ad(t,[{key:"setOptions",value:function(t){void 0!==t&&Kv(["multiselect","hoverConnectedEdges","selectable","selectConnectedEdges"],this.options,t)}},{key:"selectOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);this.unselectAll(),void 0!==i&&(e=this.selectObject(i)),this.body.emitter.emit("_requestRedraw")}return e}},{key:"selectAdditionalOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);void 0!==i&&(e=!0,!0===i.isSelected()?this.deselectObject(i):this.selectObject(i),this.body.emitter.emit("_requestRedraw"))}return e}},{key:"_initBaseEvent",value:function(t,e){var i={};return i.pointer={DOM:{x:e.x,y:e.y},canvas:this.canvas.DOMtoCanvas(e)},i.event=t,i}},{key:"generateClickEvent",value:function(t,e,i,o){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this._initBaseEvent(e,i);if(!0===n)s.nodes=[],s.edges=[];else{var r=this.getSelection();s.nodes=r.nodes,s.edges=r.edges}void 0!==o&&(s.previousSelection=o),"click"==t&&(s.items=this.getClickedItems(i)),void 0!==e.controlEdge&&(s.controlEdge=e.controlEdge),this.body.emitter.emit(t,s)}},{key:"selectObject",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.selectConnectedEdges;return void 0!==t&&(t instanceof XE?(!0===i&&(e=this._selectionAccumulator).addEdges.apply(e,Yd(t.edges)),this._selectionAccumulator.addNodes(t)):this._selectionAccumulator.addEdges(t),!0)}},{key:"deselectObject",value:function(t){!0===t.isSelected()&&(t.selected=!1,this._removeFromSelection(t))}},{key:"_getAllNodesOverlappingWith",value:function(t){for(var e=[],i=this.body.nodes,o=0;o<this.body.nodeIndices.length;o++){var n=this.body.nodeIndices[o];i[n].isOverlappingWith(t)&&e.push(n)}return e}},{key:"_pointerToPositionObject",value:function(t){var e=this.canvas.DOMtoCanvas(t);return{left:e.x-1,top:e.y+1,right:e.x+1,bottom:e.y-1}}},{key:"getNodeAt",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._pointerToPositionObject(t),o=this._getAllNodesOverlappingWith(i);return o.length>0?!0===e?this.body.nodes[o[o.length-1]]:o[o.length-1]:void 0}},{key:"_getEdgesOverlappingWith",value:function(t,e){for(var i=this.body.edges,o=0;o<this.body.edgeIndices.length;o++){var n=this.body.edgeIndices[o];i[n].isOverlappingWith(t)&&e.push(n)}}},{key:"_getAllEdgesOverlappingWith",value:function(t){var e=[];return this._getEdgesOverlappingWith(t,e),e}},{key:"getEdgeAt",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.canvas.DOMtoCanvas(t),o=10,n=null,s=this.body.edges,r=0;r<this.body.edgeIndices.length;r++){var a=this.body.edgeIndices[r],l=s[a];if(l.connected){var h=l.from.x,c=l.from.y,u=l.to.x,d=l.to.y,p=l.edgeType.getDistanceToEdge(h,c,u,d,i.x,i.y);p<o&&(n=a,o=p)}}return null!==n?!0===e?this.body.edges[n]:n:void 0}},{key:"_addToHover",value:function(t){t instanceof XE?this.hoverObj.nodes[t.id]=t:this.hoverObj.edges[t.id]=t}},{key:"_removeFromSelection",value:function(t){var e;t instanceof XE?(this._selectionAccumulator.deleteNodes(t),(e=this._selectionAccumulator).deleteEdges.apply(e,Yd(t.edges))):this._selectionAccumulator.deleteEdges(t)}},{key:"unselectAll",value:function(){this._selectionAccumulator.clear()}},{key:"getSelectedNodeCount",value:function(){return this._selectionAccumulator.sizeNodes}},{key:"getSelectedEdgeCount",value:function(){return this._selectionAccumulator.sizeEdges}},{key:"_hoverConnectedEdges",value:function(t){for(var e=0;e<t.edges.length;e++){var i=t.edges[e];i.hover=!0,this._addToHover(i)}}},{key:"emitBlurEvent",value:function(t,e,i){var o=this._initBaseEvent(t,e);!0===i.hover&&(i.hover=!1,i instanceof XE?(o.node=i.id,this.body.emitter.emit("blurNode",o)):(o.edge=i.id,this.body.emitter.emit("blurEdge",o)))}},{key:"emitHoverEvent",value:function(t,e,i){var o=this._initBaseEvent(t,e),n=!1;return!1===i.hover&&(i.hover=!0,this._addToHover(i),n=!0,i instanceof XE?(o.node=i.id,this.body.emitter.emit("hoverNode",o)):(o.edge=i.id,this.body.emitter.emit("hoverEdge",o))),n}},{key:"hoverObject",value:function(t,e){var i=this.getNodeAt(e);void 0===i&&(i=this.getEdgeAt(e));var o=!1;for(var n in this.hoverObj.nodes)Object.prototype.hasOwnProperty.call(this.hoverObj.nodes,n)&&(void 0===i||i instanceof XE&&i.id!=n||i instanceof Nw)&&(this.emitBlurEvent(t,e,this.hoverObj.nodes[n]),delete this.hoverObj.nodes[n],o=!0);for(var s in this.hoverObj.edges)Object.prototype.hasOwnProperty.call(this.hoverObj.edges,s)&&(!0===o?(this.hoverObj.edges[s].hover=!1,delete this.hoverObj.edges[s]):(void 0===i||i instanceof Nw&&i.id!=s||i instanceof XE&&!i.hover)&&(this.emitBlurEvent(t,e,this.hoverObj.edges[s]),delete this.hoverObj.edges[s],o=!0));if(void 0!==i){var r=vp(this.hoverObj.edges).length,a=vp(this.hoverObj.nodes).length;(o||i instanceof Nw&&0===r&&0===a||i instanceof XE&&0===r&&0===a)&&(o=this.emitHoverEvent(t,e,i)),i instanceof XE&&!0===this.options.hoverConnectedEdges&&this._hoverConnectedEdges(i)}!0===o&&this.body.emitter.emit("_requestRedraw")}},{key:"commitWithoutEmitting",value:function(){this._selectionAccumulator.commit()}},{key:"commitAndEmit",value:function(t,e){var i=!1,o=this._selectionAccumulator.commit(),n={nodes:o.nodes.previous,edges:o.edges.previous};o.edges.deleted.length>0&&(this.generateClickEvent("deselectEdge",e,t,n),i=!0),o.nodes.deleted.length>0&&(this.generateClickEvent("deselectNode",e,t,n),i=!0),o.nodes.added.length>0&&(this.generateClickEvent("selectNode",e,t),i=!0),o.edges.added.length>0&&(this.generateClickEvent("selectEdge",e,t),i=!0),!0===i&&this.generateClickEvent("select",e,t)}},{key:"getSelection",value:function(){return{nodes:this.getSelectedNodeIds(),edges:this.getSelectedEdgeIds()}}},{key:"getSelectedNodes",value:function(){return this._selectionAccumulator.getNodes()}},{key:"getSelectedEdges",value:function(){return this._selectionAccumulator.getEdges()}},{key:"getSelectedNodeIds",value:function(){var t;return gp(t=this._selectionAccumulator.getNodes()).call(t,(function(t){return t.id}))}},{key:"getSelectedEdgeIds",value:function(){var t;return gp(t=this._selectionAccumulator.getEdges()).call(t,(function(t){return t.id}))}},{key:"setSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!t.nodes&&!t.edges)throw new TypeError("Selection must be an object with nodes and/or edges properties");if((e.unselectAll||void 0===e.unselectAll)&&this.unselectAll(),t.nodes){var i,o=yI(t.nodes);try{for(o.s();!(i=o.n()).done;){var n=i.value,s=this.body.nodes[n];if(!s)throw new RangeError('Node with id "'+n+'" not found');this.selectObject(s,e.highlightEdges)}}catch(t){o.e(t)}finally{o.f()}}if(t.edges){var r,a=yI(t.edges);try{for(a.s();!(r=a.n()).done;){var l=r.value,h=this.body.edges[l];if(!h)throw new RangeError('Edge with id "'+l+'" not found');this.selectObject(h)}}catch(t){a.e(t)}finally{a.f()}}this.body.emitter.emit("_requestRedraw"),this._selectionAccumulator.commit()}},{key:"selectNodes",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({nodes:t},{highlightEdges:e})}},{key:"selectEdges",value:function(t){if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({edges:t})}},{key:"updateSelection",value:function(){for(var t in this._selectionAccumulator.getNodes())Object.prototype.hasOwnProperty.call(this.body.nodes,t.id)||this._selectionAccumulator.deleteNodes(t);for(var e in this._selectionAccumulator.getEdges())Object.prototype.hasOwnProperty.call(this.body.edges,e.id)||this._selectionAccumulator.deleteEdges(e)}},{key:"getClickedItems",value:function(t){for(var e=this.canvas.DOMtoCanvas(t),i=[],o=this.body.nodeIndices,n=this.body.nodes,s=o.length-1;s>=0;s--){var r=n[o[s]].getItemsOnPoint(e);i.push.apply(i,r)}for(var a=this.body.edgeIndices,l=this.body.edges,h=a.length-1;h>=0;h--){var c=l[a[h]].getItemsOnPoint(e);i.push.apply(i,c)}return i}}]),t}(),wI=Jl,kI=Math.floor,II=function(t,e){var i=t.length,o=kI(i/2);return i<8?$I(t,e):SI(t,II(wI(t,0,o),e),II(wI(t,o),e),e)},$I=function(t,e){for(var i,o,n=t.length,s=1;s<n;){for(o=s,i=t[s];o&&e(t[o-1],i)>0;)t[o]=t[--o];o!==s++&&(t[o]=i)}return t},SI=function(t,e,i,o){for(var n=e.length,s=i.length,r=0,a=0;r<n||a<s;)t[r+a]=r<n&&a<s?o(e[r],i[a])<=0?e[r++]:i[a++]:r<n?e[r++]:i[a++];return t},CI=II,OI=ct.match(/firefox\/(\d+)/i),RI=!!OI&&+OI[1],AI=/MSIE|Trident/.test(ct),MI=ct.match(/AppleWebKit\/(\d+)\./),xI=!!MI&&+MI[1],LI=Ci,DI=b,NI=xt,PI=Jt,BI=Fi,FI=zp,HI=hn,UI=a,GI=CI,VI=wp,WI=RI,zI=AI,jI=vt,XI=xI,YI=[],KI=DI(YI.sort),JI=DI(YI.push),qI=UI((function(){YI.sort(void 0)})),ZI=UI((function(){YI.sort(null)})),QI=VI("sort"),t$=!UI((function(){if(jI)return jI<70;if(!(WI&&WI>3)){if(zI)return!0;if(XI)return XI<603;var t,e,i,o,n="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(o=0;o<47;o++)YI.push({k:e+o,v:i})}for(YI.sort((function(t,e){return e.v-t.v})),o=0;o<YI.length;o++)e=YI[o].k.charAt(0),n.charAt(n.length-1)!==e&&(n+=e);return"DGBEFHACIJK"!==n}}));LI({target:"Array",proto:!0,forced:qI||!ZI||!QI||!t$},{sort:function(t){void 0!==t&&NI(t);var e=PI(this);if(t$)return void 0===t?KI(e):KI(e,t);var i,o,n=[],s=BI(e);for(o=0;o<s;o++)o in e&&JI(n,e[o]);for(GI(n,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:HI(e)>HI(i)?1:-1}}(t)),i=BI(n),o=0;o<i;)e[o]=n[o++];for(;o<s;)FI(e,o++);return e}});var e$=xo("Array").sort,i$=ht,o$=e$,n$=Array.prototype,s$=n((function(t){var e=t.sort;return t===n$||i$(n$,t)&&e===n$.sort?o$:e})),r$=xt,a$=Jt,l$=j,h$=Fi,c$=TypeError,u$=function(t){return function(e,i,o,n){r$(i);var s=a$(e),r=l$(s),a=h$(s),l=t?a-1:0,h=t?-1:1;if(o<2)for(;;){if(l in r){n=r[l],l+=h;break}if(l+=h,t?l<0:a<=l)throw new c$("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=h)l in r&&(n=i(n,r[l],l,s));return n}},d$={left:u$(!1),right:u$(!0)},p$="process"===E(r.process),g$=d$.left;Ci({target:"Array",proto:!0,forced:!p$&&vt>79&&vt<83||!wp("reduce")},{reduce:function(t){var e=arguments.length;return g$(this,t,e,e>1?arguments[1]:void 0)}});var f$=xo("Array").reduce,m$=ht,v$=f$,b$=Array.prototype,_$=n((function(t){var e=t.reduce;return t===b$||m$(b$,t)&&e===b$.reduce?v$:e}));function y$(t){var e=function(){if("undefined"==typeof Reflect||!fE)return!1;if(fE.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(fE(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=wE(t);if(e){var n=wE(this).constructor;i=fE(o,arguments,n)}else i=o.apply(this,arguments);return TE(this,i)}}var T$=function(){function t(){nl(this,t)}return ad(t,[{key:"abstract",value:function(){throw new Error("Can't instantiate abstract class!")}},{key:"fake_use",value:function(){}},{key:"curveType",value:function(){return this.abstract()}},{key:"getPosition",value:function(t){return this.fake_use(t),this.abstract()}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.fake_use(t,e,i),this.abstract()}},{key:"getTreeSize",value:function(t){return this.fake_use(t),this.abstract()}},{key:"sort",value:function(t){this.fake_use(t),this.abstract()}},{key:"fix",value:function(t,e){this.fake_use(t,e),this.abstract()}},{key:"shift",value:function(t,e){this.fake_use(t,e),this.abstract()}}]),t}(),E$=function(t){yE(i,t);var e=y$(i);function i(t){var o;return nl(this,i),(o=e.call(this)).layout=t,o}return ad(i,[{key:"curveType",value:function(){return"horizontal"}},{key:"getPosition",value:function(t){return t.x}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.x=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_x,max:e.max_x}}},{key:"sort",value:function(t){s$(t).call(t,(function(t,e){return t.x-e.x}))}},{key:"fix",value:function(t,e){t.y=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.y=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].x+=e}}]),i}(T$),w$=function(t){yE(i,t);var e=y$(i);function i(t){var o;return nl(this,i),(o=e.call(this)).layout=t,o}return ad(i,[{key:"curveType",value:function(){return"vertical"}},{key:"getPosition",value:function(t){return t.y}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.y=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_y,max:e.max_y}}},{key:"sort",value:function(t){s$(t).call(t,(function(t,e){return t.y-e.y}))}},{key:"fix",value:function(t,e){t.x=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.x=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].y+=e}}]),i}(T$),k$=wh.every;Ci({target:"Array",proto:!0,forced:!wp("every")},{every:function(t){return k$(this,t,arguments.length>1?arguments[1]:void 0)}});var I$=xo("Array").every,$$=ht,S$=I$,C$=Array.prototype,O$=n((function(t){var e=t.every;return t===C$||$$(C$,t)&&e===C$.every?S$:e}));function R$(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function A$(t,e){var i=new dk;return xp(t).call(t,(function(t){var e;xp(e=t.edges).call(e,(function(t){t.connected&&i.add(t)}))})),xp(i).call(i,(function(t){var i=t.from.id,o=t.to.id;null==e[i]&&(e[i]=0),(null==e[o]||e[i]>=e[o])&&(e[o]=e[i]+1)})),e}function M$(t,e,i,o){var n,s,r=Tf(null),a=_$(n=Yd(zT(o).call(o))).call(n,(function(t,e){return t+1+e.edges.length}),0),l=i+"Id",h="to"===i?1:-1,c=function(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return R$(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?R$(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}(o);try{var u,d=function(){var n=Xd(s.value,2),c=n[0],u=n[1];if(!o.has(c)||!t(u))return 0;r[c]=0;for(var d,p,g=[u],f=0,m=function(){var t,n;if(!o.has(c))return 0;var s=r[d.id]+h;if(xp(t=Fg(n=d.edges).call(n,(function(t){return t.connected&&t.to!==t.from&&t[i]!==d&&o.has(t.toId)&&o.has(t.fromId)}))).call(t,(function(t){var o=t[l],n=r[o];(null==n||e(s,n))&&(r[o]=s,g.push(t[i]))})),f>a)return{v:{v:A$(o,r)}};++f};d=g.pop();)if(0!==(p=m())&&p)return p.v};for(c.s();!(s=c.n()).done;)if(0!==(u=d())&&u)return u.v}catch(t){c.e(t)}finally{c.f()}return r}var x$=function(){function t(){nl(this,t),this.childrenReference={},this.parentReference={},this.trees={},this.distributionOrdering={},this.levels={},this.distributionIndex={},this.isTree=!1,this.treeIndex=-1}return ad(t,[{key:"addRelation",value:function(t,e){void 0===this.childrenReference[t]&&(this.childrenReference[t]=[]),this.childrenReference[t].push(e),void 0===this.parentReference[e]&&(this.parentReference[e]=[]),this.parentReference[e].push(t)}},{key:"checkIfTree",value:function(){for(var t in this.parentReference)if(this.parentReference[t].length>1)return void(this.isTree=!1);this.isTree=!0}},{key:"numTrees",value:function(){return this.treeIndex+1}},{key:"setTreeIndex",value:function(t,e){void 0!==e&&void 0===this.trees[t.id]&&(this.trees[t.id]=e,this.treeIndex=Math.max(e,this.treeIndex))}},{key:"ensureLevel",value:function(t){void 0===this.levels[t]&&(this.levels[t]=0)}},{key:"getMaxLevel",value:function(t){var e=this,i={};return function t(o){if(void 0!==i[o])return i[o];var n=e.levels[o];if(e.childrenReference[o]){var s=e.childrenReference[o];if(s.length>0)for(var r=0;r<s.length;r++)n=Math.max(n,t(s[r]))}return i[o]=n,n}(t)}},{key:"levelDownstream",value:function(t,e){void 0===this.levels[e.id]&&(void 0===this.levels[t.id]&&(this.levels[t.id]=0),this.levels[e.id]=this.levels[t.id]+1)}},{key:"setMinLevelToZero",value:function(t){var e=1e9;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&void 0!==this.levels[i]&&(e=Math.min(this.levels[i],e));for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&void 0!==this.levels[o]&&(this.levels[o]-=e)}},{key:"getTreeSize",value:function(t,e){var i=1e9,o=-1e9,n=1e9,s=-1e9;for(var r in this.trees)if(Object.prototype.hasOwnProperty.call(this.trees,r)&&this.trees[r]===e){var a=t[r];i=Math.min(a.x,i),o=Math.max(a.x,o),n=Math.min(a.y,n),s=Math.max(a.y,s)}return{min_x:i,max_x:o,min_y:n,max_y:s}}},{key:"hasSameParent",value:function(t,e){var i=this.parentReference[t.id],o=this.parentReference[e.id];if(void 0===i||void 0===o)return!1;for(var n=0;n<i.length;n++)for(var s=0;s<o.length;s++)if(i[n]==o[s])return!0;return!1}},{key:"inSameSubNetwork",value:function(t,e){return this.trees[t.id]===this.trees[e.id]}},{key:"getLevels",value:function(){return vp(this.distributionOrdering)}},{key:"addToOrdering",value:function(t,e){void 0===this.distributionOrdering[e]&&(this.distributionOrdering[e]=[]);var i=!1,o=this.distributionOrdering[e];for(var n in o)if(o[n]===t){i=!0;break}i||(this.distributionOrdering[e].push(t),this.distributionIndex[t.id]=this.distributionOrdering[e].length-1)}}]),t}(),L$=function(){function t(e){nl(this,t),this.body=e,this._resetRNG(Math.random()+":"+Tp()),this.setPhysics=!1,this.options={},this.optionsBackup={physics:{}},this.defaultOptions={randomSeed:void 0,improvedLayout:!0,clusterThreshold:150,hierarchical:{enabled:!1,levelSeparation:150,nodeSpacing:100,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:"UD",sortMethod:"hubsize"}},bo(this.options,this.defaultOptions),this.bindEventListeners()}return ad(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("_dataChanged",(function(){t.setupHierarchicalLayout()})),this.body.emitter.on("_dataLoaded",(function(){t.layoutNetwork()})),this.body.emitter.on("_resetHierarchicalLayout",(function(){t.setupHierarchicalLayout()})),this.body.emitter.on("_adjustEdgesForHierarchicalLayout",(function(){if(!0===t.options.hierarchical.enabled){var e=t.direction.curveType();t.body.emitter.emit("_forceDisableDynamicCurves",e,!1)}}))}},{key:"setOptions",value:function(t,e){if(void 0!==t){var i=this.options.hierarchical,o=i.enabled;if(Kv(["randomSeed","improvedLayout","clusterThreshold"],this.options,t),ub(this.options,t,"hierarchical"),void 0!==t.randomSeed&&this._resetRNG(t.randomSeed),!0===i.enabled)return!0===o&&this.body.emitter.emit("refresh",!0),"RL"===i.direction||"DU"===i.direction?i.levelSeparation>0&&(i.levelSeparation*=-1):i.levelSeparation<0&&(i.levelSeparation*=-1),this.setDirectionStrategy(),this.body.emitter.emit("_resetHierarchicalLayout"),this.adaptAllOptionsForHierarchicalLayout(e);if(!0===o)return this.body.emitter.emit("refresh"),qv(e,this.optionsBackup)}return e}},{key:"_resetRNG",value:function(t){this.initialRandomSeed=t,this._rng=Pv(this.initialRandomSeed)}},{key:"adaptAllOptionsForHierarchicalLayout",value:function(t){if(!0===this.options.hierarchical.enabled){var e=this.optionsBackup.physics;void 0===t.physics||!0===t.physics?(t.physics={enabled:void 0===e.enabled||e.enabled,solver:"hierarchicalRepulsion"},e.enabled=void 0===e.enabled||e.enabled,e.solver=e.solver||"barnesHut"):"object"===od(t.physics)?(e.enabled=void 0===t.physics.enabled||t.physics.enabled,e.solver=t.physics.solver||"barnesHut",t.physics.solver="hierarchicalRepulsion"):!1!==t.physics&&(e.solver="barnesHut",t.physics={solver:"hierarchicalRepulsion"});var i=this.direction.curveType();if(void 0===t.edges)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges={smooth:!1};else if(void 0===t.edges.smooth)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges.smooth=!1;else if("boolean"==typeof t.edges.smooth)this.optionsBackup.edges={smooth:t.edges.smooth},t.edges.smooth={enabled:t.edges.smooth,type:i};else{var o=t.edges.smooth;void 0!==o.type&&"dynamic"!==o.type&&(i=o.type),this.optionsBackup.edges={smooth:{enabled:void 0===o.enabled||o.enabled,type:void 0===o.type?"dynamic":o.type,roundness:void 0===o.roundness?.5:o.roundness,forceDirection:void 0!==o.forceDirection&&o.forceDirection}},t.edges.smooth={enabled:void 0===o.enabled||o.enabled,type:i,roundness:void 0===o.roundness?.5:o.roundness,forceDirection:void 0!==o.forceDirection&&o.forceDirection}}this.body.emitter.emit("_forceDisableDynamicCurves",i)}return t}},{key:"positionInitially",value:function(t){if(!0!==this.options.hierarchical.enabled){this._resetRNG(this.initialRandomSeed);for(var e=t.length+50,i=0;i<t.length;i++){var o=t[i],n=2*Math.PI*this._rng();void 0===o.x&&(o.x=e*Math.cos(n)),void 0===o.y&&(o.y=e*Math.sin(n))}}}},{key:"layoutNetwork",value:function(){if(!0!==this.options.hierarchical.enabled&&!0===this.options.improvedLayout){for(var t=this.body.nodeIndices,e=0,i=0;i<t.length;i++)!0===this.body.nodes[t[i]].predefinedPosition&&(e+=1);if(e<.5*t.length){var o=0,n=this.options.clusterThreshold,s={clusterNodeProperties:{shape:"ellipse",label:"",group:"",font:{multi:!1}},clusterEdgeProperties:{label:"",font:{multi:!1},smooth:{enabled:!1}}};if(t.length>n){for(var r=t.length;t.length>n&&o<=10;){o+=1;var a=t.length;if(o%3==0?this.body.modules.clustering.clusterBridges(s):this.body.modules.clustering.clusterOutliers(s),a==t.length&&o%3!=0)return this._declusterAll(),this.body.emitter.emit("_layoutFailed"),void console.info("This network could not be positioned by this version of the improved layout algorithm. Please disable improvedLayout for better performance.")}this.body.modules.kamadaKawai.setOptions({springLength:Math.max(150,2*r)})}o>10&&console.info("The clustering didn't succeed within the amount of interations allowed, progressing with partial result."),this.body.modules.kamadaKawai.solve(t,this.body.edgeIndices,!0),this._shiftToCenter();for(var l=0;l<t.length;l++){var h=this.body.nodes[t[l]];!1===h.predefinedPosition&&(h.x+=70*(.5-this._rng()),h.y+=70*(.5-this._rng()))}this._declusterAll(),this.body.emitter.emit("_repositionBezierNodes")}}}},{key:"_shiftToCenter",value:function(){for(var t=Qw.getRangeCore(this.body.nodes,this.body.nodeIndices),e=Qw.findCenter(t),i=0;i<this.body.nodeIndices.length;i++){var o=this.body.nodes[this.body.nodeIndices[i]];o.x-=e.x,o.y-=e.y}}},{key:"_declusterAll",value:function(){for(var t=!0;!0===t;){t=!1;for(var e=0;e<this.body.nodeIndices.length;e++)!0===this.body.nodes[this.body.nodeIndices[e]].isCluster&&(t=!0,this.body.modules.clustering.openCluster(this.body.nodeIndices[e],{},!1));!0===t&&this.body.emitter.emit("_dataChanged")}}},{key:"getSeed",value:function(){return this.initialRandomSeed}},{key:"setupHierarchicalLayout",value:function(){if(!0===this.options.hierarchical.enabled&&this.body.nodeIndices.length>0){var t,e,i=!1,o=!1;for(e in this.lastNodeOnLevel={},this.hierarchical=new x$,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&(void 0!==(t=this.body.nodes[e]).options.level?(i=!0,this.hierarchical.levels[e]=t.options.level):o=!0);if(!0===o&&!0===i)throw new Error("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes.");if(!0===o){var n=this.options.hierarchical.sortMethod;"hubsize"===n?this._determineLevelsByHubsize():"directed"===n?this._determineLevelsDirected():"custom"===n&&this._determineLevelsCustomCallback()}for(var s in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,s)&&this.hierarchical.ensureLevel(s);var r=this._getDistribution();this._generateMap(),this._placeNodesByHierarchy(r),this._condenseHierarchy(),this._shiftToCenter()}}},{key:"_condenseHierarchy",value:function(){var t=this,e=!1,i={},o=function(e,i){var o=t.hierarchical.trees;for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&o[n]===e&&t.direction.shift(n,i)},n=function e(i,o){if(!o[i.id]&&(o[i.id]=!0,t.hierarchical.childrenReference[i.id])){var n=t.hierarchical.childrenReference[i.id];if(n.length>0)for(var s=0;s<n.length;s++)e(t.body.nodes[n[s]],o)}},s=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e9,o=1e9,n=1e9,s=1e9,r=-1e9;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var l=t.body.nodes[a],h=t.hierarchical.levels[l.id],c=t.direction.getPosition(l),u=Xd(t._getSpaceAroundNode(l,e),2),d=u[0],p=u[1];o=Math.min(d,o),n=Math.min(p,n),h<=i&&(s=Math.min(c,s),r=Math.max(c,r))}return[s,r,o,n]},r=function(e,i,o){for(var n=t.hierarchical,s=0;s<i.length;s++){var r=i[s],a=n.distributionOrdering[r];if(a.length>1)for(var l=0;l<a.length-1;l++){var h=a[l],c=a[l+1];n.hasSameParent(h,c)&&n.inSameSubNetwork(h,c)&&e(h,c,o)}}},a=function(i,o){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.direction.getPosition(i),l=t.direction.getPosition(o),h=Math.abs(l-a),c=t.options.hierarchical.nodeSpacing;if(h>c){var u={},d={};n(i,u),n(o,d);var p=function(e,i){var o=t.hierarchical.getMaxLevel(e.id),n=t.hierarchical.getMaxLevel(i.id);return Math.min(o,n)}(i,o),g=s(u,p),f=s(d,p),m=g[1],v=f[0],b=f[2];if(Math.abs(m-v)>c){var _=m-v+c;_<-b+c&&(_=-b+c),_<0&&(t._shiftBlock(o.id,_),e=!0,!0===r&&t._centerParent(o))}}},l=function(o,r){for(var a=r.id,l=r.edges,h=t.hierarchical.levels[r.id],c=t.options.hierarchical.levelSeparation*t.options.hierarchical.levelSeparation,u={},d=[],p=0;p<l.length;p++){var g=l[p];if(g.toId!=g.fromId){var f=g.toId==a?g.from:g.to;u[l[p].id]=f,t.hierarchical.levels[f.id]<h&&d.push(g)}}var m=function(e,i){for(var o=0,n=0;n<i.length;n++)if(void 0!==u[i[n].id]){var s=t.direction.getPosition(u[i[n].id])-e;o+=s/Math.sqrt(s*s+c)}return o},v=function(e,i){for(var o=0,n=0;n<i.length;n++)if(void 0!==u[i[n].id]){var s=t.direction.getPosition(u[i[n].id])-e;o-=c*Math.pow(s*s+c,-1.5)}return o},b=function(e,i){for(var o=t.direction.getPosition(r),n={},s=0;s<e;s++){var a=m(o,i),l=v(o,i);if(void 0!==n[o-=Math.max(-40,Math.min(40,Math.round(a/l)))])break;n[o]=s}return o},_=b(o,d);!function(o){var a=t.direction.getPosition(r);if(void 0===i[r.id]){var l={};n(r,l),i[r.id]=l}var h=s(i[r.id]),c=h[2],u=h[3],d=o-a,p=0;d>0?p=Math.min(d,u-t.options.hierarchical.nodeSpacing):d<0&&(p=-Math.min(-d,c-t.options.hierarchical.nodeSpacing)),0!=p&&(t._shiftBlock(r.id,p),e=!0)}(_),function(i){var o=t.direction.getPosition(r),n=Xd(t._getSpaceAroundNode(r),2),s=n[0],a=n[1],l=i-o,h=o;l>0?h=Math.min(o+(a-t.options.hierarchical.nodeSpacing),i):l<0&&(h=Math.max(o-(s-t.options.hierarchical.nodeSpacing),i)),h!==o&&(t.direction.setPosition(r,h),e=!0)}(_=b(o,l))};!0===this.options.hierarchical.blockShifting&&(function(){var i=t.hierarchical.getLevels();i=Gp(i).call(i);for(var o=0;o<5&&(e=!1,r(a,i,!0),!0===e);o++);}(),function(){for(var e in t.body.nodes)Object.prototype.hasOwnProperty.call(t.body.nodes,e)&&t._centerParent(t.body.nodes[e])}()),!0===this.options.hierarchical.edgeMinimization&&function(){var i=t.hierarchical.getLevels();i=Gp(i).call(i);for(var o=0;o<20;o++){e=!1;for(var n=0;n<i.length;n++)for(var s=i[n],r=t.hierarchical.distributionOrdering[s],a=0;a<r.length;a++)l(1e3,r[a]);if(!0!==e)break}}(),!0===this.options.hierarchical.parentCentralization&&function(){var e=t.hierarchical.getLevels();e=Gp(e).call(e);for(var i=0;i<e.length;i++)for(var o=e[i],n=t.hierarchical.distributionOrdering[o],s=0;s<n.length;s++)t._centerParent(n[s])}(),function(){for(var e=function(){for(var e=[],i=0;i<t.hierarchical.numTrees();i++)e.push(t.direction.getTreeSize(i));return e}(),i=0,n=0;n<e.length-1;n++)i+=e[n].max-e[n+1].min+t.options.hierarchical.treeSpacing,o(n+1,i)}()}},{key:"_getSpaceAroundNode",value:function(t,e){var i=!0;void 0===e&&(i=!1);var o=this.hierarchical.levels[t.id];if(void 0!==o){var n=this.hierarchical.distributionIndex[t.id],s=this.direction.getPosition(t),r=this.hierarchical.distributionOrdering[o],a=1e9,l=1e9;if(0!==n){var h=r[n-1];(!0===i&&void 0===e[h.id]||!1===i)&&(a=s-this.direction.getPosition(h))}if(n!=r.length-1){var c=r[n+1];if(!0===i&&void 0===e[c.id]||!1===i){var u=this.direction.getPosition(c);l=Math.min(l,u-s)}}return[a,l]}return[0,0]}},{key:"_centerParent",value:function(t){if(this.hierarchical.parentReference[t.id])for(var e=this.hierarchical.parentReference[t.id],i=0;i<e.length;i++){var o=e[i],n=this.body.nodes[o],s=this.hierarchical.childrenReference[o];if(void 0!==s){var r=this._getCenterPosition(s),a=this.direction.getPosition(n),l=Xd(this._getSpaceAroundNode(n),2),h=l[0],c=l[1],u=a-r;(u<0&&Math.abs(u)<c-this.options.hierarchical.nodeSpacing||u>0&&Math.abs(u)<h-this.options.hierarchical.nodeSpacing)&&this.direction.setPosition(n,r)}}}},{key:"_placeNodesByHierarchy",value:function(t){for(var e in this.positionedNodes={},t)if(Object.prototype.hasOwnProperty.call(t,e)){var i,o=vp(t[e]);o=this._indexArrayToNodes(o),s$(i=this.direction).call(i,o);for(var n=0,s=0;s<o.length;s++){var r=o[s];if(void 0===this.positionedNodes[r.id]){var a=this.options.hierarchical.nodeSpacing,l=a*n;n>0&&(l=this.direction.getPosition(o[s-1])+a),this.direction.setPosition(r,l,e),this._validatePositionAndContinue(r,e,l),n++}}}}},{key:"_placeBranchNodes",value:function(t,e){var i,o=this.hierarchical.childrenReference[t];if(void 0!==o){for(var n=[],s=0;s<o.length;s++)n.push(this.body.nodes[o[s]]);s$(i=this.direction).call(i,n);for(var r=0;r<n.length;r++){var a=n[r],l=this.hierarchical.levels[a.id];if(!(l>e&&void 0===this.positionedNodes[a.id]))return;var h,c=this.options.hierarchical.nodeSpacing;h=0===r?this.direction.getPosition(this.body.nodes[t]):this.direction.getPosition(n[r-1])+c,this.direction.setPosition(a,h,l),this._validatePositionAndContinue(a,l,h)}var u=this._getCenterPosition(n);this.direction.setPosition(this.body.nodes[t],u,e)}}},{key:"_validatePositionAndContinue",value:function(t,e,i){if(this.hierarchical.isTree){if(void 0!==this.lastNodeOnLevel[e]){var o=this.direction.getPosition(this.body.nodes[this.lastNodeOnLevel[e]]);if(i-o<this.options.hierarchical.nodeSpacing){var n=o+this.options.hierarchical.nodeSpacing-i,s=this._findCommonParent(this.lastNodeOnLevel[e],t.id);this._shiftBlock(s.withChild,n)}}this.lastNodeOnLevel[e]=t.id,this.positionedNodes[t.id]=!0,this._placeBranchNodes(t.id,e)}}},{key:"_indexArrayToNodes",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.body.nodes[t[i]]);return e}},{key:"_getDistribution",value:function(){var t,e,i={};for(t in this.body.nodes)if(Object.prototype.hasOwnProperty.call(this.body.nodes,t)){e=this.body.nodes[t];var o=void 0===this.hierarchical.levels[t]?0:this.hierarchical.levels[t];this.direction.fix(e,o),void 0===i[o]&&(i[o]={}),i[o][t]=e}return i}},{key:"_getActiveEdges",value:function(t){var e=this,i=[];return tb(t.edges,(function(t){var o;-1!==bf(o=e.body.edgeIndices).call(o,t.id)&&i.push(t)})),i}},{key:"_getHubSizes",value:function(){var t=this,e={};tb(this.body.nodeIndices,(function(i){var o=t.body.nodes[i],n=t._getActiveEdges(o).length;e[n]=!0}));var i=[];return tb(e,(function(t){i.push(Number(t))})),s$(i).call(i,(function(t,e){return e-t})),i}},{key:"_determineLevelsByHubsize",value:function(){for(var t=this,e=function(e,i){t.hierarchical.levelDownstream(e,i)},i=this._getHubSizes(),o=function(){var o=i[n];if(0===o)return 1;tb(t.body.nodeIndices,(function(i){var n=t.body.nodes[i];o===t._getActiveEdges(n).length&&t._crawlNetwork(e,i)}))},n=0;n<i.length&&!o();++n);}},{key:"_determineLevelsCustomCallback",value:function(){var t=this;this._crawlNetwork((function(e,i,o){var n=t.hierarchical.levels[e.id];void 0===n&&(n=t.hierarchical.levels[e.id]=1e5);var s=(Qw.cloneOptions(e,"node"),Qw.cloneOptions(i,"node"),void Qw.cloneOptions(o,"edge"));t.hierarchical.levels[i.id]=n+s})),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_determineLevelsDirected",value:function(){var t,e=this,i=_$(t=this.body.nodeIndices).call(t,(function(t,i){return t.set(i,e.body.nodes[i]),t}),new Dy);"roots"===this.options.hierarchical.shakeTowards?this.hierarchical.levels=function(t){return M$((function(e){var i,o;return O$(i=Fg(o=e.edges).call(o,(function(e){return t.has(e.toId)}))).call(i,(function(t){return t.from===e}))}),(function(t,e){return e<t}),"to",t)}(i):this.hierarchical.levels=function(t){return M$((function(e){var i,o;return O$(i=Fg(o=e.edges).call(o,(function(e){return t.has(e.toId)}))).call(i,(function(t){return t.to===e}))}),(function(t,e){return e>t}),"from",t)}(i),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_generateMap",value:function(){var t=this;this._crawlNetwork((function(e,i){t.hierarchical.levels[i.id]>t.hierarchical.levels[e.id]&&t.hierarchical.addRelation(e.id,i.id)})),this.hierarchical.checkIfTree()}},{key:"_crawlNetwork",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},i=arguments.length>1?arguments[1]:void 0,o={},n=function i(n,s){if(void 0===o[n.id]){var r;t.hierarchical.setTreeIndex(n,s),o[n.id]=!0;for(var a=t._getActiveEdges(n),l=0;l<a.length;l++){var h=a[l];!0===h.connected&&(r=h.toId==n.id?h.from:h.to,n.id!=r.id&&(e(n,r,h),i(r,s)))}}};if(void 0===i)for(var s=0,r=0;r<this.body.nodeIndices.length;r++){var a=this.body.nodeIndices[r];void 0===o[a]&&(n(this.body.nodes[a],s),s+=1)}else{var l=this.body.nodes[i];if(void 0===l)return void console.error("Node not found:",i);n(l)}}},{key:"_shiftBlock",value:function(t,e){var i=this,o={};!function t(n){if(!o[n]){o[n]=!0,i.direction.shift(n,e);var s=i.hierarchical.childrenReference[n];if(void 0!==s)for(var r=0;r<s.length;r++)t(s[r])}}(t)}},{key:"_findCommonParent",value:function(t,e){var i=this,o={};return function t(e,o){var n=i.hierarchical.parentReference[o];if(void 0!==n)for(var s=0;s<n.length;s++){var r=n[s];e[r]=!0,t(e,r)}}(o,t),function t(e,o){var n=i.hierarchical.parentReference[o];if(void 0!==n)for(var s=0;s<n.length;s++){var r=n[s];if(void 0!==e[r])return{foundParent:r,withChild:o};var a=t(e,r);if(null!==a.foundParent)return a}return{foundParent:null,withChild:o}}(o,e)}},{key:"setDirectionStrategy",value:function(){var t="UD"===this.options.hierarchical.direction||"DU"===this.options.hierarchical.direction;this.direction=t?new E$(this):new w$(this)}},{key:"_getCenterPosition",value:function(t){for(var e=1e9,i=-1e9,o=0;o<t.length;o++){var n=void 0;if(void 0!==t[o].id)n=t[o];else{var s=t[o];n=this.body.nodes[s]}var r=this.direction.getPosition(n);e=Math.min(e,r),i=Math.max(i,r)}return.5*(e+i)}}]),t}();function D$(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}var N$=function(){function t(e,i,o,n){var s,r,a=this;nl(this,t),this.body=e,this.canvas=i,this.selectionHandler=o,this.interactionHandler=n,this.editMode=!1,this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0,this._domEventListenerCleanupQueue=[],this.temporaryUIFunctions={},this.temporaryEventFunctions=[],this.touchTime=0,this.temporaryIds={nodes:[],edges:[]},this.guiEnabled=!1,this.inMode=!1,this.selectedControlNode=void 0,this.options={},this.defaultOptions={enabled:!1,initiallyActive:!1,addNode:!0,addEdge:!0,editNode:void 0,editEdge:!0,deleteNode:!0,deleteEdge:!0,controlNodeStyle:{shape:"dot",size:6,color:{background:"#ff0000",border:"#3c3c3c",highlight:{background:"#07f968",border:"#3c3c3c"}},borderWidth:2,borderWidthSelected:2}},bo(this.options,this.defaultOptions),this.body.emitter.on("destroy",(function(){a._clean()})),this.body.emitter.on("_dataChanged",Fo(s=this._restore).call(s,this)),this.body.emitter.on("_resetData",Fo(r=this._restore).call(r,this))}return ad(t,[{key:"_restore",value:function(){!1!==this.inMode&&(!0===this.options.initiallyActive?this.enableEditMode():this.disableEditMode())}},{key:"setOptions",value:function(t,e,i){void 0!==e&&(void 0!==e.locale?this.options.locale=e.locale:this.options.locale=i.locale,void 0!==e.locales?this.options.locales=e.locales:this.options.locales=i.locales),void 0!==t&&("boolean"==typeof t?this.options.enabled=t:(this.options.enabled=!0,qv(this.options,t)),!0===this.options.initiallyActive&&(this.editMode=!0),this._setup())}},{key:"toggleEditMode",value:function(){!0===this.editMode?this.disableEditMode():this.enableEditMode()}},{key:"enableEditMode",value:function(){this.editMode=!0,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="block",this.closeDiv.style.display="block",this.editModeDiv.style.display="none",this.showManipulatorToolbar())}},{key:"disableEditMode",value:function(){this.editMode=!1,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="none",this.closeDiv.style.display="none",this.editModeDiv.style.display="block",this._createEditButton())}},{key:"showManipulatorToolbar",value:function(){if(this._clean(),this.manipulationDOM={},!0===this.guiEnabled){var t,e;this.editMode=!0,this.manipulationDiv.style.display="block",this.closeDiv.style.display="block";var i=this.selectionHandler.getSelectedNodeCount(),o=this.selectionHandler.getSelectedEdgeCount(),n=i+o,s=this.options.locales[this.options.locale],r=!1;!1!==this.options.addNode&&(this._createAddNodeButton(s),r=!0),!1!==this.options.addEdge&&(!0===r?this._createSeperator(1):r=!0,this._createAddEdgeButton(s)),1===i&&"function"==typeof this.options.editNode?(!0===r?this._createSeperator(2):r=!0,this._createEditNodeButton(s)):1===o&&0===i&&!1!==this.options.editEdge&&(!0===r?this._createSeperator(3):r=!0,this._createEditEdgeButton(s)),0!==n&&(i>0&&!1!==this.options.deleteNode||0===i&&!1!==this.options.deleteEdge)&&(!0===r&&this._createSeperator(4),this._createDeleteButton(s)),this._bindElementEvents(this.closeDiv,Fo(t=this.toggleEditMode).call(t,this)),this._temporaryBindEvent("select",Fo(e=this.showManipulatorToolbar).call(e,this))}this.body.emitter.emit("_redraw")}},{key:"addNodeMode",value:function(){var t;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addNode",!0===this.guiEnabled){var e,i=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(i),this._createSeperator(),this._createDescription(i.addDescription||this.options.locales.en.addDescription),this._bindElementEvents(this.closeDiv,Fo(e=this.toggleEditMode).call(e,this))}this._temporaryBindEvent("click",Fo(t=this._performAddNode).call(t,this))}},{key:"editNode",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean();var e=this.selectionHandler.getSelectedNodes()[0];if(void 0!==e){if(this.inMode="editNode","function"!=typeof this.options.editNode)throw new Error("No function has been configured to handle the editing of nodes.");if(!0!==e.isCluster){var i=qv({},e.options,!1);if(i.x=e.x,i.y=e.y,2!==this.options.editNode.length)throw new Error("The function for edit does not support two arguments (data, callback)");this.options.editNode(i,(function(e){null!=e&&"editNode"===t.inMode&&t.body.data.nodes.getDataSet().update(e),t.showManipulatorToolbar()}))}else alert(this.options.locales[this.options.locale].editClusterError||this.options.locales.en.editClusterError)}else this.showManipulatorToolbar()}},{key:"addEdgeMode",value:function(){var t,e,i,o,n;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addEdge",!0===this.guiEnabled){var s,r=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(r),this._createSeperator(),this._createDescription(r.edgeDescription||this.options.locales.en.edgeDescription),this._bindElementEvents(this.closeDiv,Fo(s=this.toggleEditMode).call(s,this))}this._temporaryBindUI("onTouch",Fo(t=this._handleConnect).call(t,this)),this._temporaryBindUI("onDragEnd",Fo(e=this._finishConnect).call(e,this)),this._temporaryBindUI("onDrag",Fo(i=this._dragControlNode).call(i,this)),this._temporaryBindUI("onRelease",Fo(o=this._finishConnect).call(o,this)),this._temporaryBindUI("onDragStart",Fo(n=this._dragStartEdge).call(n,this)),this._temporaryBindUI("onHold",(function(){}))}},{key:"editEdgeMode",value:function(){if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="editEdge","object"!==od(this.options.editEdge)||"function"!=typeof this.options.editEdge.editWithoutDrag||(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0===this.edgeBeingEditedId)){if(!0===this.guiEnabled){var t,e=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(e),this._createSeperator(),this._createDescription(e.editEdgeDescription||this.options.locales.en.editEdgeDescription),this._bindElementEvents(this.closeDiv,Fo(t=this.toggleEditMode).call(t,this))}if(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0!==this.edgeBeingEditedId){var i,o,n,s,r=this.body.edges[this.edgeBeingEditedId],a=this._getNewTargetNode(r.from.x,r.from.y),l=this._getNewTargetNode(r.to.x,r.to.y);this.temporaryIds.nodes.push(a.id),this.temporaryIds.nodes.push(l.id),this.body.nodes[a.id]=a,this.body.nodeIndices.push(a.id),this.body.nodes[l.id]=l,this.body.nodeIndices.push(l.id),this._temporaryBindUI("onTouch",Fo(i=this._controlNodeTouch).call(i,this)),this._temporaryBindUI("onTap",(function(){})),this._temporaryBindUI("onHold",(function(){})),this._temporaryBindUI("onDragStart",Fo(o=this._controlNodeDragStart).call(o,this)),this._temporaryBindUI("onDrag",Fo(n=this._controlNodeDrag).call(n,this)),this._temporaryBindUI("onDragEnd",Fo(s=this._controlNodeDragEnd).call(s,this)),this._temporaryBindUI("onMouseMove",(function(){})),this._temporaryBindEvent("beforeDrawing",(function(t){var e=r.edgeType.findBorderPositions(t);!1===a.selected&&(a.x=e.from.x,a.y=e.from.y),!1===l.selected&&(l.x=e.to.x,l.y=e.to.y)})),this.body.emitter.emit("_redraw")}else this.showManipulatorToolbar()}else{var h=this.body.edges[this.edgeBeingEditedId];this._performEditEdge(h.from.id,h.to.id)}}},{key:"deleteSelected",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="delete";var e=this.selectionHandler.getSelectedNodeIds(),i=this.selectionHandler.getSelectedEdgeIds(),o=void 0;if(e.length>0){for(var n=0;n<e.length;n++)if(!0===this.body.nodes[e[n]].isCluster)return void alert(this.options.locales[this.options.locale].deleteClusterError||this.options.locales.en.deleteClusterError);"function"==typeof this.options.deleteNode&&(o=this.options.deleteNode)}else i.length>0&&"function"==typeof this.options.deleteEdge&&(o=this.options.deleteEdge);if("function"==typeof o){var s={nodes:e,edges:i};if(2!==o.length)throw new Error("The function for delete does not support two arguments (data, callback)");o(s,(function(e){null!=e&&"delete"===t.inMode?(t.body.data.edges.getDataSet().remove(e.edges),t.body.data.nodes.getDataSet().remove(e.nodes),t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar()):(t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar())}))}else this.body.data.edges.getDataSet().remove(i),this.body.data.nodes.getDataSet().remove(e),this.body.emitter.emit("startSimulation"),this.showManipulatorToolbar()}},{key:"_setup",value:function(){!0===this.options.enabled?(this.guiEnabled=!0,this._createWrappers(),!1===this.editMode?this._createEditButton():this.showManipulatorToolbar()):(this._removeManipulationDOM(),this.guiEnabled=!1)}},{key:"_createWrappers",value:function(){var t,e;void 0===this.manipulationDiv&&(this.manipulationDiv=document.createElement("div"),this.manipulationDiv.className="vis-manipulation",!0===this.editMode?this.manipulationDiv.style.display="block":this.manipulationDiv.style.display="none",this.canvas.frame.appendChild(this.manipulationDiv)),void 0===this.editModeDiv&&(this.editModeDiv=document.createElement("div"),this.editModeDiv.className="vis-edit-mode",!0===this.editMode?this.editModeDiv.style.display="none":this.editModeDiv.style.display="block",this.canvas.frame.appendChild(this.editModeDiv)),void 0===this.closeDiv&&(this.closeDiv=document.createElement("button"),this.closeDiv.className="vis-close",this.closeDiv.setAttribute("aria-label",null!==(t=null===(e=this.options.locales[this.options.locale])||void 0===e?void 0:e.close)&&void 0!==t?t:this.options.locales.en.close),this.closeDiv.style.display=this.manipulationDiv.style.display,this.canvas.frame.appendChild(this.closeDiv))}},{key:"_getNewTargetNode",value:function(t,e){var i=qv({},this.options.controlNodeStyle);i.id="targetNode"+Zw(),i.hidden=!1,i.physics=!1,i.x=t,i.y=e;var o=this.body.functions.createNode(i);return o.shape.boundingBox={left:t,right:t,top:e,bottom:e},o}},{key:"_createEditButton",value:function(){var t;this._clean(),this.manipulationDOM={},Wv(this.editModeDiv);var e=this.options.locales[this.options.locale],i=this._createButton("editMode","vis-edit vis-edit-mode",e.edit||this.options.locales.en.edit);this.editModeDiv.appendChild(i),this._bindElementEvents(i,Fo(t=this.toggleEditMode).call(t,this))}},{key:"_clean",value:function(){this.inMode=!1,!0===this.guiEnabled&&(Wv(this.editModeDiv),Wv(this.manipulationDiv),this._cleanupDOMEventListeners()),this._cleanupTemporaryNodesAndEdges(),this._unbindTemporaryUIs(),this._unbindTemporaryEvents(),this.body.emitter.emit("restorePhysics")}},{key:"_cleanupDOMEventListeners",value:function(){var t,e,i=function(t,e){var i=void 0!==Kd&&ol(t)||t["@@iterator"];if(!i){if(lp(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return D$(t,e);var o=ep(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Pa(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?D$(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}(hg(t=this._domEventListenerCleanupQueue).call(t,0));try{for(i.s();!(e=i.n()).done;)(0,e.value)()}catch(t){i.e(t)}finally{i.f()}}},{key:"_removeManipulationDOM",value:function(){this._clean(),Wv(this.manipulationDiv),Wv(this.editModeDiv),Wv(this.closeDiv),this.manipulationDiv&&this.canvas.frame.removeChild(this.manipulationDiv),this.editModeDiv&&this.canvas.frame.removeChild(this.editModeDiv),this.closeDiv&&this.canvas.frame.removeChild(this.closeDiv),this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0}},{key:"_createSeperator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.manipulationDOM["seperatorLineDiv"+t]=document.createElement("div"),this.manipulationDOM["seperatorLineDiv"+t].className="vis-separator-line",this.manipulationDiv.appendChild(this.manipulationDOM["seperatorLineDiv"+t])}},{key:"_createAddNodeButton",value:function(t){var e,i=this._createButton("addNode","vis-add",t.addNode||this.options.locales.en.addNode);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Fo(e=this.addNodeMode).call(e,this))}},{key:"_createAddEdgeButton",value:function(t){var e,i=this._createButton("addEdge","vis-connect",t.addEdge||this.options.locales.en.addEdge);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Fo(e=this.addEdgeMode).call(e,this))}},{key:"_createEditNodeButton",value:function(t){var e,i=this._createButton("editNode","vis-edit",t.editNode||this.options.locales.en.editNode);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Fo(e=this.editNode).call(e,this))}},{key:"_createEditEdgeButton",value:function(t){var e,i=this._createButton("editEdge","vis-edit",t.editEdge||this.options.locales.en.editEdge);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Fo(e=this.editEdgeMode).call(e,this))}},{key:"_createDeleteButton",value:function(t){var e,i;i=this.options.rtl?"vis-delete-rtl":"vis-delete";var o=this._createButton("delete",i,t.del||this.options.locales.en.del);this.manipulationDiv.appendChild(o),this._bindElementEvents(o,Fo(e=this.deleteSelected).call(e,this))}},{key:"_createBackButton",value:function(t){var e,i=this._createButton("back","vis-back",t.back||this.options.locales.en.back);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Fo(e=this.showManipulatorToolbar).call(e,this))}},{key:"_createButton",value:function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vis-label";return this.manipulationDOM[t+"Div"]=document.createElement("button"),this.manipulationDOM[t+"Div"].className="vis-button "+e,this.manipulationDOM[t+"Label"]=document.createElement("div"),this.manipulationDOM[t+"Label"].className=o,this.manipulationDOM[t+"Label"].innerText=i,this.manipulationDOM[t+"Div"].appendChild(this.manipulationDOM[t+"Label"]),this.manipulationDOM[t+"Div"]}},{key:"_createDescription",value:function(t){this.manipulationDOM.descriptionLabel=document.createElement("div"),this.manipulationDOM.descriptionLabel.className="vis-none",this.manipulationDOM.descriptionLabel.innerText=t,this.manipulationDiv.appendChild(this.manipulationDOM.descriptionLabel)}},{key:"_temporaryBindEvent",value:function(t,e){this.temporaryEventFunctions.push({event:t,boundFunction:e}),this.body.emitter.on(t,e)}},{key:"_temporaryBindUI",value:function(t,e){if(void 0===this.body.eventListeners[t])throw new Error("This UI function does not exist. Typo? You tried: "+t+" possible are: "+kf(vp(this.body.eventListeners)));this.temporaryUIFunctions[t]=this.body.eventListeners[t],this.body.eventListeners[t]=e}},{key:"_unbindTemporaryUIs",value:function(){for(var t in this.temporaryUIFunctions)Object.prototype.hasOwnProperty.call(this.temporaryUIFunctions,t)&&(this.body.eventListeners[t]=this.temporaryUIFunctions[t],delete this.temporaryUIFunctions[t]);this.temporaryUIFunctions={}}},{key:"_unbindTemporaryEvents",value:function(){for(var t=0;t<this.temporaryEventFunctions.length;t++){var e=this.temporaryEventFunctions[t].event,i=this.temporaryEventFunctions[t].boundFunction;this.body.emitter.off(e,i)}this.temporaryEventFunctions=[]}},{key:"_bindElementEvents",value:function(t,e){var i=new Ib(t,{});nk(i,e),this._domEventListenerCleanupQueue.push((function(){i.destroy()}));var o=function(t){var i=t.keyCode,o=t.key;"Enter"!==o&&" "!==o&&13!==i&&32!==i||e()};t.addEventListener("keyup",o,!1),this._domEventListenerCleanupQueue.push((function(){t.removeEventListener("keyup",o,!1)}))}},{key:"_cleanupTemporaryNodesAndEdges",value:function(){for(var t=0;t<this.temporaryIds.edges.length;t++){var e;this.body.edges[this.temporaryIds.edges[t]].disconnect(),delete this.body.edges[this.temporaryIds.edges[t]];var i,o=bf(e=this.body.edgeIndices).call(e,this.temporaryIds.edges[t]);-1!==o&&hg(i=this.body.edgeIndices).call(i,o,1)}for(var n=0;n<this.temporaryIds.nodes.length;n++){var s;delete this.body.nodes[this.temporaryIds.nodes[n]];var r,a=bf(s=this.body.nodeIndices).call(s,this.temporaryIds.nodes[n]);-1!==a&&hg(r=this.body.nodeIndices).call(r,a,1)}this.temporaryIds={nodes:[],edges:[]}}},{key:"_controlNodeTouch",value:function(t){this.selectionHandler.unselectAll(),this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=bo({},this.body.view.translation)}},{key:"_controlNodeDragStart",value:function(){var t=this.lastTouch,e=this.selectionHandler._pointerToPositionObject(t),i=this.body.nodes[this.temporaryIds.nodes[0]],o=this.body.nodes[this.temporaryIds.nodes[1]],n=this.body.edges[this.edgeBeingEditedId];this.selectedControlNode=void 0;var s=i.isOverlappingWith(e),r=o.isOverlappingWith(e);!0===s?(this.selectedControlNode=i,n.edgeType.from=i):!0===r&&(this.selectedControlNode=o,n.edgeType.to=o),void 0!==this.selectedControlNode&&this.selectionHandler.selectObject(this.selectedControlNode),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDrag",value:function(t){this.body.emitter.emit("disablePhysics");var e=this.body.functions.getPointer(t.center),i=this.canvas.DOMtoCanvas(e);void 0!==this.selectedControlNode?(this.selectedControlNode.x=i.x,this.selectedControlNode.y=i.y):this.interactionHandler.onDrag(t),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDragEnd",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),o=this.body.edges[this.edgeBeingEditedId];if(void 0!==this.selectedControlNode){this.selectionHandler.unselectAll();for(var n=this.selectionHandler._getAllNodesOverlappingWith(i),s=void 0,r=n.length-1;r>=0;r--)if(n[r]!==this.selectedControlNode.id){s=this.body.nodes[n[r]];break}if(void 0!==s&&void 0!==this.selectedControlNode)if(!0===s.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var a=this.body.nodes[this.temporaryIds.nodes[0]];this.selectedControlNode.id===a.id?this._performEditEdge(s.id,o.to.id):this._performEditEdge(o.from.id,s.id)}else o.updateEdgeType(),this.body.emitter.emit("restorePhysics");this.body.emitter.emit("_redraw")}}},{key:"_handleConnect",value:function(t){if((new Date).valueOf()-this.touchTime>100){this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=bo({},this.body.view.translation),this.interactionHandler.drag.pointer=this.lastTouch,this.interactionHandler.drag.translation=this.lastTouch.translation;var e=this.lastTouch,i=this.selectionHandler.getNodeAt(e);if(void 0!==i)if(!0===i.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var o=this._getNewTargetNode(i.x,i.y);this.body.nodes[o.id]=o,this.body.nodeIndices.push(o.id);var n=this.body.functions.createEdge({id:"connectionEdge"+Zw(),from:i.id,to:o.id,physics:!1,smooth:{enabled:!0,type:"continuous",roundness:.5}});this.body.edges[n.id]=n,this.body.edgeIndices.push(n.id),this.temporaryIds.nodes.push(o.id),this.temporaryIds.edges.push(n.id)}this.touchTime=(new Date).valueOf()}}},{key:"_dragControlNode",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),o=void 0;void 0!==this.temporaryIds.edges[0]&&(o=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var n=this.selectionHandler._getAllNodesOverlappingWith(i),s=void 0,r=n.length-1;r>=0;r--){var a;if(-1===bf(a=this.temporaryIds.nodes).call(a,n[r])){s=this.body.nodes[n[r]];break}}if(t.controlEdge={from:o,to:s?s.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragging",t,e),void 0!==this.temporaryIds.nodes[0]){var l=this.body.nodes[this.temporaryIds.nodes[0]];l.x=this.canvas._XconvertDOMtoCanvas(e.x),l.y=this.canvas._YconvertDOMtoCanvas(e.y),this.body.emitter.emit("_redraw")}else this.interactionHandler.onDrag(t)}},{key:"_finishConnect",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),o=void 0;void 0!==this.temporaryIds.edges[0]&&(o=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var n=this.selectionHandler._getAllNodesOverlappingWith(i),s=void 0,r=n.length-1;r>=0;r--){var a;if(-1===bf(a=this.temporaryIds.nodes).call(a,n[r])){s=this.body.nodes[n[r]];break}}this._cleanupTemporaryNodesAndEdges(),void 0!==s&&(!0===s.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):void 0!==this.body.nodes[o]&&void 0!==this.body.nodes[s.id]&&this._performAddEdge(o,s.id)),t.controlEdge={from:o,to:s?s.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragEnd",t,e),this.body.emitter.emit("_redraw")}},{key:"_dragStartEdge",value:function(t){var e=this.lastTouch;this.selectionHandler.generateClickEvent("dragStart",t,e,void 0,!0)}},{key:"_performAddNode",value:function(t){var e=this,i={id:Zw(),x:t.pointer.canvas.x,y:t.pointer.canvas.y,label:"new"};if("function"==typeof this.options.addNode){if(2!==this.options.addNode.length)throw this.showManipulatorToolbar(),new Error("The function for add does not support two arguments (data,callback)");this.options.addNode(i,(function(t){null!=t&&"addNode"===e.inMode&&e.body.data.nodes.getDataSet().add(t),e.showManipulatorToolbar()}))}else this.body.data.nodes.getDataSet().add(i),this.showManipulatorToolbar()}},{key:"_performAddEdge",value:function(t,e){var i=this,o={from:t,to:e};if("function"==typeof this.options.addEdge){if(2!==this.options.addEdge.length)throw new Error("The function for connect does not support two arguments (data,callback)");this.options.addEdge(o,(function(t){null!=t&&"addEdge"===i.inMode&&(i.body.data.edges.getDataSet().add(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())}))}else this.body.data.edges.getDataSet().add(o),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}},{key:"_performEditEdge",value:function(t,e){var i=this,o={id:this.edgeBeingEditedId,from:t,to:e,label:this.body.data.edges.get(this.edgeBeingEditedId).label},n=this.options.editEdge;if("object"===od(n)&&(n=n.editWithoutDrag),"function"==typeof n){if(2!==n.length)throw new Error("The function for edit does not support two arguments (data, callback)");n(o,(function(t){null==t||"editEdge"!==i.inMode?(i.body.edges[o.id].updateEdgeType(),i.body.emitter.emit("_redraw"),i.showManipulatorToolbar()):(i.body.data.edges.getDataSet().update(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())}))}else this.body.data.edges.getDataSet().update(o),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}}]),t}(),P$="string",B$="boolean",F$="number",H$="array",U$="object",G$=["arrow","bar","box","circle","crow","curve","diamond","image","inv_curve","inv_triangle","triangle","vee"],V$={borderWidth:{number:F$},borderWidthSelected:{number:F$,undefined:"undefined"},brokenImage:{string:P$,undefined:"undefined"},chosen:{label:{boolean:B$,function:"function"},node:{boolean:B$,function:"function"},__type__:{object:U$,boolean:B$}},color:{border:{string:P$},background:{string:P$},highlight:{border:{string:P$},background:{string:P$},__type__:{object:U$,string:P$}},hover:{border:{string:P$},background:{string:P$},__type__:{object:U$,string:P$}},__type__:{object:U$,string:P$}},opacity:{number:F$,undefined:"undefined"},fixed:{x:{boolean:B$},y:{boolean:B$},__type__:{object:U$,boolean:B$}},font:{align:{string:P$},color:{string:P$},size:{number:F$},face:{string:P$},background:{string:P$},strokeWidth:{number:F$},strokeColor:{string:P$},vadjust:{number:F$},multi:{boolean:B$,string:P$},bold:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},boldital:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},ital:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},mono:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},__type__:{object:U$,string:P$}},group:{string:P$,number:F$,undefined:"undefined"},heightConstraint:{minimum:{number:F$},valign:{string:P$},__type__:{object:U$,boolean:B$,number:F$}},hidden:{boolean:B$},icon:{face:{string:P$},code:{string:P$},size:{number:F$},color:{string:P$},weight:{string:P$,number:F$},__type__:{object:U$}},id:{string:P$,number:F$},image:{selected:{string:P$,undefined:"undefined"},unselected:{string:P$,undefined:"undefined"},__type__:{object:U$,string:P$}},imagePadding:{top:{number:F$},right:{number:F$},bottom:{number:F$},left:{number:F$},__type__:{object:U$,number:F$}},label:{string:P$,undefined:"undefined"},labelHighlightBold:{boolean:B$},level:{number:F$,undefined:"undefined"},margin:{top:{number:F$},right:{number:F$},bottom:{number:F$},left:{number:F$},__type__:{object:U$,number:F$}},mass:{number:F$},physics:{boolean:B$},scaling:{min:{number:F$},max:{number:F$},label:{enabled:{boolean:B$},min:{number:F$},max:{number:F$},maxVisible:{number:F$},drawThreshold:{number:F$},__type__:{object:U$,boolean:B$}},customScalingFunction:{function:"function"},__type__:{object:U$}},shadow:{enabled:{boolean:B$},color:{string:P$},size:{number:F$},x:{number:F$},y:{number:F$},__type__:{object:U$,boolean:B$}},shape:{string:["custom","ellipse","circle","database","box","text","image","circularImage","diamond","dot","star","triangle","triangleDown","square","icon","hexagon"]},ctxRenderer:{function:"function"},shapeProperties:{borderDashes:{boolean:B$,array:H$},borderRadius:{number:F$},interpolation:{boolean:B$},useImageSize:{boolean:B$},useBorderWithImage:{boolean:B$},coordinateOrigin:{string:["center","top-left"]},__type__:{object:U$}},size:{number:F$},title:{string:P$,dom:"dom",undefined:"undefined"},value:{number:F$,undefined:"undefined"},widthConstraint:{minimum:{number:F$},maximum:{number:F$},__type__:{object:U$,boolean:B$,number:F$}},x:{number:F$},y:{number:F$},__type__:{object:U$}},W$={configure:{enabled:{boolean:B$},filter:{boolean:B$,string:P$,array:H$,function:"function"},container:{dom:"dom"},showButton:{boolean:B$},__type__:{object:U$,boolean:B$,string:P$,array:H$,function:"function"}},edges:{arrows:{to:{enabled:{boolean:B$},scaleFactor:{number:F$},type:{string:G$},imageHeight:{number:F$},imageWidth:{number:F$},src:{string:P$},__type__:{object:U$,boolean:B$}},middle:{enabled:{boolean:B$},scaleFactor:{number:F$},type:{string:G$},imageWidth:{number:F$},imageHeight:{number:F$},src:{string:P$},__type__:{object:U$,boolean:B$}},from:{enabled:{boolean:B$},scaleFactor:{number:F$},type:{string:G$},imageWidth:{number:F$},imageHeight:{number:F$},src:{string:P$},__type__:{object:U$,boolean:B$}},__type__:{string:["from","to","middle"],object:U$}},endPointOffset:{from:{number:F$},to:{number:F$},__type__:{object:U$,number:F$}},arrowStrikethrough:{boolean:B$},background:{enabled:{boolean:B$},color:{string:P$},size:{number:F$},dashes:{boolean:B$,array:H$},__type__:{object:U$,boolean:B$}},chosen:{label:{boolean:B$,function:"function"},edge:{boolean:B$,function:"function"},__type__:{object:U$,boolean:B$}},color:{color:{string:P$},highlight:{string:P$},hover:{string:P$},inherit:{string:["from","to","both"],boolean:B$},opacity:{number:F$},__type__:{object:U$,string:P$}},dashes:{boolean:B$,array:H$},font:{color:{string:P$},size:{number:F$},face:{string:P$},background:{string:P$},strokeWidth:{number:F$},strokeColor:{string:P$},align:{string:["horizontal","top","middle","bottom"]},vadjust:{number:F$},multi:{boolean:B$,string:P$},bold:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},boldital:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},ital:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},mono:{color:{string:P$},size:{number:F$},face:{string:P$},mod:{string:P$},vadjust:{number:F$},__type__:{object:U$,string:P$}},__type__:{object:U$,string:P$}},hidden:{boolean:B$},hoverWidth:{function:"function",number:F$},label:{string:P$,undefined:"undefined"},labelHighlightBold:{boolean:B$},length:{number:F$,undefined:"undefined"},physics:{boolean:B$},scaling:{min:{number:F$},max:{number:F$},label:{enabled:{boolean:B$},min:{number:F$},max:{number:F$},maxVisible:{number:F$},drawThreshold:{number:F$},__type__:{object:U$,boolean:B$}},customScalingFunction:{function:"function"},__type__:{object:U$}},selectionWidth:{function:"function",number:F$},selfReferenceSize:{number:F$},selfReference:{size:{number:F$},angle:{number:F$},renderBehindTheNode:{boolean:B$},__type__:{object:U$}},shadow:{enabled:{boolean:B$},color:{string:P$},size:{number:F$},x:{number:F$},y:{number:F$},__type__:{object:U$,boolean:B$}},smooth:{enabled:{boolean:B$},type:{string:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"]},roundness:{number:F$},forceDirection:{string:["horizontal","vertical","none"],boolean:B$},__type__:{object:U$,boolean:B$}},title:{string:P$,undefined:"undefined"},width:{number:F$},widthConstraint:{maximum:{number:F$},__type__:{object:U$,boolean:B$,number:F$}},value:{number:F$,undefined:"undefined"},__type__:{object:U$}},groups:{useDefaultGroups:{boolean:B$},__any__:V$,__type__:{object:U$}},interaction:{dragNodes:{boolean:B$},dragView:{boolean:B$},hideEdgesOnDrag:{boolean:B$},hideEdgesOnZoom:{boolean:B$},hideNodesOnDrag:{boolean:B$},hover:{boolean:B$},keyboard:{enabled:{boolean:B$},speed:{x:{number:F$},y:{number:F$},zoom:{number:F$},__type__:{object:U$}},bindToWindow:{boolean:B$},autoFocus:{boolean:B$},__type__:{object:U$,boolean:B$}},multiselect:{boolean:B$},navigationButtons:{boolean:B$},selectable:{boolean:B$},selectConnectedEdges:{boolean:B$},hoverConnectedEdges:{boolean:B$},tooltipDelay:{number:F$},zoomView:{boolean:B$},zoomSpeed:{number:F$},__type__:{object:U$}},layout:{randomSeed:{undefined:"undefined",number:F$,string:P$},improvedLayout:{boolean:B$},clusterThreshold:{number:F$},hierarchical:{enabled:{boolean:B$},levelSeparation:{number:F$},nodeSpacing:{number:F$},treeSpacing:{number:F$},blockShifting:{boolean:B$},edgeMinimization:{boolean:B$},parentCentralization:{boolean:B$},direction:{string:["UD","DU","LR","RL"]},sortMethod:{string:["hubsize","directed"]},shakeTowards:{string:["leaves","roots"]},__type__:{object:U$,boolean:B$}},__type__:{object:U$}},manipulation:{enabled:{boolean:B$},initiallyActive:{boolean:B$},addNode:{boolean:B$,function:"function"},addEdge:{boolean:B$,function:"function"},editNode:{function:"function"},editEdge:{editWithoutDrag:{function:"function"},__type__:{object:U$,boolean:B$,function:"function"}},deleteNode:{boolean:B$,function:"function"},deleteEdge:{boolean:B$,function:"function"},controlNodeStyle:V$,__type__:{object:U$,boolean:B$}},nodes:V$,physics:{enabled:{boolean:B$},barnesHut:{theta:{number:F$},gravitationalConstant:{number:F$},centralGravity:{number:F$},springLength:{number:F$},springConstant:{number:F$},damping:{number:F$},avoidOverlap:{number:F$},__type__:{object:U$}},forceAtlas2Based:{theta:{number:F$},gravitationalConstant:{number:F$},centralGravity:{number:F$},springLength:{number:F$},springConstant:{number:F$},damping:{number:F$},avoidOverlap:{number:F$},__type__:{object:U$}},repulsion:{centralGravity:{number:F$},springLength:{number:F$},springConstant:{number:F$},nodeDistance:{number:F$},damping:{number:F$},__type__:{object:U$}},hierarchicalRepulsion:{centralGravity:{number:F$},springLength:{number:F$},springConstant:{number:F$},nodeDistance:{number:F$},damping:{number:F$},avoidOverlap:{number:F$},__type__:{object:U$}},maxVelocity:{number:F$},minVelocity:{number:F$},solver:{string:["barnesHut","repulsion","hierarchicalRepulsion","forceAtlas2Based"]},stabilization:{enabled:{boolean:B$},iterations:{number:F$},updateInterval:{number:F$},onlyDynamicEdges:{boolean:B$},fit:{boolean:B$},__type__:{object:U$,boolean:B$}},timestep:{number:F$},adaptiveTimestep:{boolean:B$},wind:{x:{number:F$},y:{number:F$},__type__:{object:U$}},__type__:{object:U$,boolean:B$}},autoResize:{boolean:B$},clickToUse:{boolean:B$},locale:{string:P$},locales:{__any__:{any:"any"},__type__:{object:U$}},height:{string:P$},width:{string:P$},__type__:{object:U$}},z$={nodes:{borderWidth:[1,0,10,1],borderWidthSelected:[2,0,10,1],color:{border:["color","#2B7CE9"],background:["color","#97C2FC"],highlight:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]},hover:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]}},opacity:[0,0,1,.1],fixed:{x:!1,y:!1},font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[0,0,50,1],strokeColor:["color","#ffffff"]},hidden:!1,labelHighlightBold:!0,physics:!0,scaling:{min:[10,0,200,1],max:[30,0,200,1],label:{enabled:!1,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},shape:["ellipse","box","circle","database","diamond","dot","square","star","text","triangle","triangleDown","hexagon"],shapeProperties:{borderDashes:!1,borderRadius:[6,0,20,1],interpolation:!0,useImageSize:!1},size:[25,0,200,1]},edges:{arrows:{to:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},middle:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},from:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"}},endPointOffset:{from:[0,-10,10,1],to:[0,-10,10,1]},arrowStrikethrough:!0,color:{color:["color","#848484"],highlight:["color","#848484"],hover:["color","#848484"],inherit:["from","to","both",!0,!1],opacity:[1,0,1,.05]},dashes:!1,font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[2,0,50,1],strokeColor:["color","#ffffff"],align:["horizontal","top","middle","bottom"]},hidden:!1,hoverWidth:[1.5,0,5,.1],labelHighlightBold:!0,physics:!0,scaling:{min:[1,0,100,1],max:[15,0,100,1],label:{enabled:!0,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},selectionWidth:[1.5,0,5,.1],selfReferenceSize:[20,0,200,1],selfReference:{size:[20,0,200,1],angle:[Math.PI/2,-6*Math.PI,6*Math.PI,Math.PI/8],renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},smooth:{enabled:!0,type:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"],forceDirection:["horizontal","vertical","none"],roundness:[.5,0,1,.05]},width:[1,0,30,1]},layout:{hierarchical:{enabled:!1,levelSeparation:[150,20,500,5],nodeSpacing:[100,20,500,5],treeSpacing:[200,20,500,5],blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:["UD","DU","LR","RL"],sortMethod:["hubsize","directed"],shakeTowards:["leaves","roots"]}},interaction:{dragNodes:!0,dragView:!0,hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1,hover:!1,keyboard:{enabled:!1,speed:{x:[10,0,40,1],y:[10,0,40,1],zoom:[.02,0,.1,.005]},bindToWindow:!0,autoFocus:!0},multiselect:!1,navigationButtons:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0,tooltipDelay:[300,0,1e3,25],zoomView:!0,zoomSpeed:[1,.1,2,.1]},manipulation:{enabled:!1,initiallyActive:!1},physics:{enabled:!0,barnesHut:{theta:[.5,.1,1,.05],gravitationalConstant:[-2e3,-3e4,0,50],centralGravity:[.3,0,10,.05],springLength:[95,0,500,5],springConstant:[.04,0,1.2,.005],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},forceAtlas2Based:{theta:[.5,.1,1,.05],gravitationalConstant:[-50,-500,0,1],centralGravity:[.01,0,1,.005],springLength:[95,0,500,5],springConstant:[.08,0,1.2,.005],damping:[.4,0,1,.01],avoidOverlap:[0,0,1,.01]},repulsion:{centralGravity:[.2,0,10,.05],springLength:[200,0,500,5],springConstant:[.05,0,1.2,.005],nodeDistance:[100,0,500,5],damping:[.09,0,1,.01]},hierarchicalRepulsion:{centralGravity:[.2,0,10,.05],springLength:[100,0,500,5],springConstant:[.01,0,1.2,.005],nodeDistance:[120,0,500,5],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},maxVelocity:[50,0,150,1],minVelocity:[.1,.01,.5,.01],solver:["barnesHut","forceAtlas2Based","repulsion","hierarchicalRepulsion"],timestep:[.5,.01,1,.01],wind:{x:[0,-10,10,.1],y:[0,-10,10,.1]}}},j$=function(t,e,i){var o;return!(!Cg(t).call(t,"physics")||!Cg(o=z$.physics.solver).call(o,e)||i.physics.solver===e||"wind"===e)},X$=Object.freeze({__proto__:null,allOptions:W$,configuratorHideOption:j$,configureOptions:z$}),Y$=function(){function t(){nl(this,t)}return ad(t,[{key:"getDistances",value:function(t,e,i){for(var o={},n=t.edges,s=0;s<e.length;s++){var r={};o[e[s]]=r;for(var a=0;a<e.length;a++)r[e[a]]=s==a?0:1e9}for(var l=0;l<i.length;l++){var h=n[i[l]];!0===h.connected&&void 0!==o[h.fromId]&&void 0!==o[h.toId]&&(o[h.fromId][h.toId]=1,o[h.toId][h.fromId]=1)}for(var c=e.length,u=0;u<c;u++)for(var d=e[u],p=o[d],g=0;g<c-1;g++)for(var f=e[g],m=o[f],v=g+1;v<c;v++){var b=e[v],_=o[b],y=Math.min(m[b],m[d]+p[b]);m[b]=y,_[f]=y}return o}}]),t}(),K$=function(){function t(e,i,o){nl(this,t),this.body=e,this.springLength=i,this.springConstant=o,this.distanceSolver=new Y$}return ad(t,[{key:"setOptions",value:function(t){t&&(t.springLength&&(this.springLength=t.springLength),t.springConstant&&(this.springConstant=t.springConstant))}},{key:"solve",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.distanceSolver.getDistances(this.body,t,e);this._createL_matrix(o),this._createK_matrix(o),this._createE_matrix();for(var n=0,s=Math.max(1e3,Math.min(10*this.body.nodeIndices.length,6e3)),r=1e9,a=0,l=0,h=0,c=0,u=0;r>.01&&n<s;){n+=1;var d=Xd(this._getHighestEnergyNode(i),4);for(a=d[0],r=d[1],l=d[2],h=d[3],c=r,u=0;c>1&&u<5;){u+=1,this._moveNode(a,l,h);var p=Xd(this._getEnergy(a),3);c=p[0],l=p[1],h=p[2]}}}},{key:"_getHighestEnergyNode",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,o=0,n=e[0],s=0,r=0,a=0;a<e.length;a++){var l=e[a];if(!0!==i[l].predefinedPosition||!0===i[l].isCluster&&!0===t||!0!==i[l].options.fixed.x||!0!==i[l].options.fixed.y){var h=Xd(this._getEnergy(l),3),c=h[0],u=h[1],d=h[2];o<c&&(o=c,n=l,s=u,r=d)}}return[n,o,s,r]}},{key:"_getEnergy",value:function(t){var e=Xd(this.E_sums[t],2),i=e[0],o=e[1];return[Math.sqrt(Math.pow(i,2)+Math.pow(o,2)),i,o]}},{key:"_moveNode",value:function(t,e,i){for(var o=this.body.nodeIndices,n=this.body.nodes,s=0,r=0,a=0,l=n[t].x,h=n[t].y,c=this.K_matrix[t],u=this.L_matrix[t],d=0;d<o.length;d++){var p=o[d];if(p!==t){var g=n[p].x,f=n[p].y,m=c[p],v=u[p],b=1/Math.pow(Math.pow(l-g,2)+Math.pow(h-f,2),1.5);s+=m*(1-v*Math.pow(h-f,2)*b),r+=m*(v*(l-g)*(h-f)*b),a+=m*(1-v*Math.pow(l-g,2)*b)}}var _=(e/s+i/r)/(r/s-a/r),y=-(r*_+e)/s;n[t].x+=y,n[t].y+=_,this._updateE_matrix(t)}},{key:"_createL_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springLength;this.L_matrix=[];for(var o=0;o<e.length;o++){this.L_matrix[e[o]]={};for(var n=0;n<e.length;n++)this.L_matrix[e[o]][e[n]]=i*t[e[o]][e[n]]}}},{key:"_createK_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springConstant;this.K_matrix=[];for(var o=0;o<e.length;o++){this.K_matrix[e[o]]={};for(var n=0;n<e.length;n++)this.K_matrix[e[o]][e[n]]=i*Math.pow(t[e[o]][e[n]],-2)}}},{key:"_createE_matrix",value:function(){var t=this.body.nodeIndices,e=this.body.nodes;this.E_matrix={},this.E_sums={};for(var i=0;i<t.length;i++)this.E_matrix[t[i]]=[];for(var o=0;o<t.length;o++){for(var n=t[o],s=e[n].x,r=e[n].y,a=0,l=0,h=o;h<t.length;h++){var c=t[h];if(c!==n){var u=e[c].x,d=e[c].y,p=1/Math.sqrt(Math.pow(s-u,2)+Math.pow(r-d,2));this.E_matrix[n][h]=[this.K_matrix[n][c]*(s-u-this.L_matrix[n][c]*(s-u)*p),this.K_matrix[n][c]*(r-d-this.L_matrix[n][c]*(r-d)*p)],this.E_matrix[c][o]=this.E_matrix[n][h],a+=this.E_matrix[n][h][0],l+=this.E_matrix[n][h][1]}}this.E_sums[n]=[a,l]}}},{key:"_updateE_matrix",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,o=this.E_matrix[t],n=this.K_matrix[t],s=this.L_matrix[t],r=i[t].x,a=i[t].y,l=0,h=0,c=0;c<e.length;c++){var u=e[c];if(u!==t){var d=o[c],p=d[0],g=d[1],f=i[u].x,m=i[u].y,v=1/Math.sqrt(Math.pow(r-f,2)+Math.pow(a-m,2)),b=n[u]*(r-f-s[u]*(r-f)*v),_=n[u]*(a-m-s[u]*(a-m)*v);o[c]=[b,_],l+=b,h+=_;var y=this.E_sums[u];y[0]+=b-p,y[1]+=_-g}}this.E_sums[t]=[l,h]}}]),t}();function J$(t,e,i){var o,n,s,r,a=this;if(!(this instanceof J$))throw new SyntaxError("Constructor must be called with the new operator");this.options={},this.defaultOptions={locale:"en",locales:a_,clickToUse:!1},bo(this.options,this.defaultOptions),this.body={container:t,nodes:{},nodeIndices:[],edges:{},edgeIndices:[],emitter:{on:Fo(o=this.on).call(o,this),off:Fo(n=this.off).call(n,this),emit:Fo(s=this.emit).call(s,this),once:Fo(r=this.once).call(r,this)},eventListeners:{onTap:function(){},onTouch:function(){},onDoubleTap:function(){},onHold:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},onMouseWheel:function(){},onPinch:function(){},onMouseMove:function(){},onRelease:function(){},onContext:function(){}},data:{nodes:null,edges:null},functions:{createNode:function(){},createEdge:function(){},getPointer:function(){}},modules:{},view:{scale:1,translation:{x:0,y:0}},selectionBox:{show:!1,position:{start:{x:0,y:0},end:{x:0,y:0}}}},this.bindEventListeners(),this.images=new h_((function(){return a.body.emitter.emit("_requestRedraw")})),this.groups=new Ny,this.canvas=new rk(this.body),this.selectionHandler=new EI(this.body,this.canvas),this.interactionHandler=new uk(this.body,this.canvas,this.selectionHandler),this.view=new ak(this.body,this.canvas),this.renderer=new ik(this.body,this.canvas),this.physics=new jw(this.body),this.layoutEngine=new L$(this.body),this.clustering=new ek(this.body),this.manipulation=new N$(this.body,this.canvas,this.selectionHandler,this.interactionHandler),this.nodesHandler=new KE(this.body,this.images,this.groups,this.layoutEngine),this.edgesHandler=new Pw(this.body,this.images,this.groups),this.body.modules.kamadaKawai=new K$(this.body,150,.05),this.body.modules.clustering=this.clustering,this.canvas._create(),this.setOptions(i),this.setData(e)}Xo(J$.prototype),J$.prototype.setOptions=function(t){var e=this;if(null===t&&(t=void 0),void 0!==t){if(!0===Cb.validate(t,W$)&&console.error("%cErrors have been found in the supplied options object.",Sb),Kv(["locale","locales","clickToUse"],this.options,t),void 0!==t.locale&&(t.locale=function(t,e){try{var i=Xd(e.split(/[-_ /]/,2),2),o=i[0],n=i[1],s=null!=o?o.toLowerCase():null,r=null!=n?n.toUpperCase():null;if(s&&r){var a,l=s+"-"+r;if(Object.prototype.hasOwnProperty.call(t,l))return l;console.warn(tp(a="Unknown variant ".concat(r," of language ")).call(a,s,"."))}if(s){var h=s;if(Object.prototype.hasOwnProperty.call(t,h))return h;console.warn("Unknown language ".concat(s))}return console.warn("Unknown locale ".concat(e,", falling back to English.")),"en"}catch(t){return console.error(t),console.warn("Unexpected error while normalizing locale ".concat(e,", falling back to English.")),"en"}}(t.locales||this.options.locales,t.locale)),t=this.layoutEngine.setOptions(t.layout,t),this.canvas.setOptions(t),this.groups.setOptions(t.groups),this.nodesHandler.setOptions(t.nodes),this.edgesHandler.setOptions(t.edges),this.physics.setOptions(t.physics),this.manipulation.setOptions(t.manipulation,t,this.options),this.interactionHandler.setOptions(t.interaction),this.renderer.setOptions(t.interaction),this.selectionHandler.setOptions(t.interaction),void 0!==t.groups&&this.body.emitter.emit("refreshNodes"),"configure"in t&&(this.configurator||(this.configurator=new kb(this,this.body.container,z$,this.canvas.pixelRatio,j$)),this.configurator.setOptions(t.configure)),this.configurator&&!0===this.configurator.options.enabled){var i={nodes:{},edges:{},layout:{},interaction:{},manipulation:{},physics:{},global:{}};qv(i.nodes,this.nodesHandler.options),qv(i.edges,this.edgesHandler.options),qv(i.layout,this.layoutEngine.options),qv(i.interaction,this.selectionHandler.options),qv(i.interaction,this.renderer.options),qv(i.interaction,this.interactionHandler.options),qv(i.manipulation,this.manipulation.options),qv(i.physics,this.physics.options),qv(i.global,this.canvas.options),qv(i.global,this.options),this.configurator.setModuleOptions(i)}void 0!==t.clickToUse?!0===t.clickToUse?void 0===this.activator&&(this.activator=new wb(this.canvas.frame),this.activator.on("change",(function(){e.body.emitter.emit("activate")}))):(void 0!==this.activator&&(this.activator.destroy(),delete this.activator),this.body.emitter.emit("activate")):this.body.emitter.emit("activate"),this.canvas.setSize(),this.body.emitter.emit("startSimulation")}},J$.prototype._updateVisibleIndices=function(){var t=this.body.nodes,e=this.body.edges;for(var i in this.body.nodeIndices=[],this.body.edgeIndices=[],t)Object.prototype.hasOwnProperty.call(t,i)&&(this.clustering._isClusteredNode(i)||!1!==t[i].options.hidden||this.body.nodeIndices.push(t[i].id));for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=e[o],s=t[n.fromId],r=t[n.toId],a=void 0!==s&&void 0!==r;!this.clustering._isClusteredEdge(o)&&!1===n.options.hidden&&a&&!1===s.options.hidden&&!1===r.options.hidden&&this.body.edgeIndices.push(n.id)}},J$.prototype.bindEventListeners=function(){var t=this;this.body.emitter.on("_dataChanged",(function(){t.edgesHandler._updateState(),t.body.emitter.emit("_dataUpdated")})),this.body.emitter.on("_dataUpdated",(function(){t.clustering._updateState(),t._updateVisibleIndices(),t._updateValueRange(t.body.nodes),t._updateValueRange(t.body.edges),t.body.emitter.emit("startSimulation"),t.body.emitter.emit("_requestRedraw")}))},J$.prototype.setData=function(t){if(this.body.emitter.emit("resetPhysics"),this.body.emitter.emit("_resetData"),this.selectionHandler.unselectAll(),t&&t.dot&&(t.nodes||t.edges))throw new SyntaxError('Data must contain either parameter "dot" or  parameter pair "nodes" and "edges", but not both.');if(this.setOptions(t&&t.options),t&&t.dot){console.warn("The dot property has been deprecated. Please use the static convertDot method to convert DOT into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertDot(dotString);");var e=o_(t.dot);this.setData(e)}else if(t&&t.gephi){console.warn("The gephi property has been deprecated. Please use the static convertGephi method to convert gephi into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertGephi(gephiJson);");var i=s_(t.gephi);this.setData(i)}else this.nodesHandler.setData(t&&t.nodes,!0),this.edgesHandler.setData(t&&t.edges,!0),this.body.emitter.emit("_dataChanged"),this.body.emitter.emit("_dataLoaded"),this.body.emitter.emit("initPhysics")},J$.prototype.destroy=function(){for(var t in this.body.emitter.emit("destroy"),this.body.emitter.off(),this.off(),delete this.groups,delete this.canvas,delete this.selectionHandler,delete this.interactionHandler,delete this.view,delete this.renderer,delete this.physics,delete this.layoutEngine,delete this.clustering,delete this.manipulation,delete this.nodesHandler,delete this.edgesHandler,delete this.configurator,delete this.images,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,t)&&delete this.body.nodes[t];for(var e in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,e)&&delete this.body.edges[e];Wv(this.body.container)},J$.prototype._updateValueRange=function(t){var e,i=void 0,o=void 0,n=0;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var s=t[e].getValue();void 0!==s&&(i=void 0===i?s:Math.min(s,i),o=void 0===o?s:Math.max(s,o),n+=s)}if(void 0!==i&&void 0!==o)for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e].setValueRange(i,o,n)},J$.prototype.isActive=function(){return!this.activator||this.activator.active},J$.prototype.setSize=function(){return this.canvas.setSize.apply(this.canvas,arguments)},J$.prototype.canvasToDOM=function(){return this.canvas.canvasToDOM.apply(this.canvas,arguments)},J$.prototype.DOMtoCanvas=function(){return this.canvas.DOMtoCanvas.apply(this.canvas,arguments)},J$.prototype.findNode=function(){return this.clustering.findNode.apply(this.clustering,arguments)},J$.prototype.isCluster=function(){return this.clustering.isCluster.apply(this.clustering,arguments)},J$.prototype.openCluster=function(){return this.clustering.openCluster.apply(this.clustering,arguments)},J$.prototype.cluster=function(){return this.clustering.cluster.apply(this.clustering,arguments)},J$.prototype.getNodesInCluster=function(){return this.clustering.getNodesInCluster.apply(this.clustering,arguments)},J$.prototype.clusterByConnection=function(){return this.clustering.clusterByConnection.apply(this.clustering,arguments)},J$.prototype.clusterByHubsize=function(){return this.clustering.clusterByHubsize.apply(this.clustering,arguments)},J$.prototype.updateClusteredNode=function(){return this.clustering.updateClusteredNode.apply(this.clustering,arguments)},J$.prototype.getClusteredEdges=function(){return this.clustering.getClusteredEdges.apply(this.clustering,arguments)},J$.prototype.getBaseEdge=function(){return this.clustering.getBaseEdge.apply(this.clustering,arguments)},J$.prototype.getBaseEdges=function(){return this.clustering.getBaseEdges.apply(this.clustering,arguments)},J$.prototype.updateEdge=function(){return this.clustering.updateEdge.apply(this.clustering,arguments)},J$.prototype.clusterOutliers=function(){return this.clustering.clusterOutliers.apply(this.clustering,arguments)},J$.prototype.getSeed=function(){return this.layoutEngine.getSeed.apply(this.layoutEngine,arguments)},J$.prototype.enableEditMode=function(){return this.manipulation.enableEditMode.apply(this.manipulation,arguments)},J$.prototype.disableEditMode=function(){return this.manipulation.disableEditMode.apply(this.manipulation,arguments)},J$.prototype.addNodeMode=function(){return this.manipulation.addNodeMode.apply(this.manipulation,arguments)},J$.prototype.editNode=function(){return this.manipulation.editNode.apply(this.manipulation,arguments)},J$.prototype.editNodeMode=function(){return console.warn("Deprecated: Please use editNode instead of editNodeMode."),this.manipulation.editNode.apply(this.manipulation,arguments)},J$.prototype.addEdgeMode=function(){return this.manipulation.addEdgeMode.apply(this.manipulation,arguments)},J$.prototype.editEdgeMode=function(){return this.manipulation.editEdgeMode.apply(this.manipulation,arguments)},J$.prototype.deleteSelected=function(){return this.manipulation.deleteSelected.apply(this.manipulation,arguments)},J$.prototype.getPositions=function(){return this.nodesHandler.getPositions.apply(this.nodesHandler,arguments)},J$.prototype.getPosition=function(){return this.nodesHandler.getPosition.apply(this.nodesHandler,arguments)},J$.prototype.storePositions=function(){return this.nodesHandler.storePositions.apply(this.nodesHandler,arguments)},J$.prototype.moveNode=function(){return this.nodesHandler.moveNode.apply(this.nodesHandler,arguments)},J$.prototype.getBoundingBox=function(){return this.nodesHandler.getBoundingBox.apply(this.nodesHandler,arguments)},J$.prototype.getConnectedNodes=function(t){return void 0!==this.body.nodes[t]?this.nodesHandler.getConnectedNodes.apply(this.nodesHandler,arguments):this.edgesHandler.getConnectedNodes.apply(this.edgesHandler,arguments)},J$.prototype.getConnectedEdges=function(){return this.nodesHandler.getConnectedEdges.apply(this.nodesHandler,arguments)},J$.prototype.startSimulation=function(){return this.physics.startSimulation.apply(this.physics,arguments)},J$.prototype.stopSimulation=function(){return this.physics.stopSimulation.apply(this.physics,arguments)},J$.prototype.stabilize=function(){return this.physics.stabilize.apply(this.physics,arguments)},J$.prototype.getSelection=function(){return this.selectionHandler.getSelection.apply(this.selectionHandler,arguments)},J$.prototype.setSelection=function(){return this.selectionHandler.setSelection.apply(this.selectionHandler,arguments)},J$.prototype.getSelectedNodes=function(){return this.selectionHandler.getSelectedNodeIds.apply(this.selectionHandler,arguments)},J$.prototype.getSelectedEdges=function(){return this.selectionHandler.getSelectedEdgeIds.apply(this.selectionHandler,arguments)},J$.prototype.getNodeAt=function(){var t=this.selectionHandler.getNodeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},J$.prototype.getEdgeAt=function(){var t=this.selectionHandler.getEdgeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},J$.prototype.selectNodes=function(){return this.selectionHandler.selectNodes.apply(this.selectionHandler,arguments)},J$.prototype.selectEdges=function(){return this.selectionHandler.selectEdges.apply(this.selectionHandler,arguments)},J$.prototype.unselectAll=function(){this.selectionHandler.unselectAll.apply(this.selectionHandler,arguments),this.selectionHandler.commitWithoutEmitting.apply(this.selectionHandler),this.redraw()},J$.prototype.redraw=function(){return this.renderer.redraw.apply(this.renderer,arguments)},J$.prototype.getScale=function(){return this.view.getScale.apply(this.view,arguments)},J$.prototype.getViewPosition=function(){return this.view.getViewPosition.apply(this.view,arguments)},J$.prototype.fit=function(){return this.view.fit.apply(this.view,arguments)},J$.prototype.moveTo=function(){return this.view.moveTo.apply(this.view,arguments)},J$.prototype.focus=function(){return this.view.focus.apply(this.view,arguments)},J$.prototype.releaseNode=function(){return this.view.releaseNode.apply(this.view,arguments)},J$.prototype.getOptionsFromConfigurator=function(){var t={};return this.configurator&&(t=this.configurator.getOptions.apply(this.configurator)),t};var q$=o_;t.Network=J$,t.NetworkImages=h_,t.networkDOTParser=n_,t.networkGephiParser=r_,t.networkOptions=X$,t.parseDOTNetwork=q$,t.parseGephiNetwork=s_}(e,i(107))},500:function(t,e,i){var o,n;void 0===(n="function"==typeof(o=function(){var t,e,o,n,s,r,a,l,h,c,u,d,p,g,f,m,v,b,_,y,T,E,w,k,I,$,S,C,O,R,A,M,x,L,D,N,P,B,F,H,U,G,V,W,z,j,X,Y,K,J,q,Z,Q,tt,et,it,ot,nt,st,rt,at,lt,ht,ct,ut,dt,pt,gt,ft,mt,vt,bt,_t,yt,Tt,Et,wt,kt,It,$t,St,Ct,Ot,Rt,At,Mt,xt,Lt,Dt,Nt,Pt,Bt,Ft,Ht,Ut,Gt,Vt,Wt,zt,jt,Xt,Yt,Kt,Jt,qt,Zt,Qt,te,ee,ie,oe,ne,se,re,ae,le,he,ce,ue,de,pe,ge,fe,me,ve,be,_e,ye,Te,Ee,we,ke,Ie,$e,Se,Ce,Oe,Re,Ae,Me,xe,Le,De,Ne,Pe,Be,Fe,He,Ue,Ge,Ve,We,ze,je,Xe,Ye,Ke,Je,qe,Ze,Qe,ti,ei,ii,oi,ni,si,ri,ai,li,hi,ci,ui,di,pi,gi,fi,mi,vi,bi,_i,yi,Ti,Ei,wi,ki,Ii,$i,Si,Ci,Oi,Ri,Ai,Mi,xi,Li,Di,Ni,Pi,Bi,Fi,Hi,Ui,Gi,Vi,Wi,zi,ji,Xi,Yi,Ki,Ji,qi,Zi,Qi,to,eo,io,oo,no,so,ro,ao,lo,ho,co,uo,po,go,fo,mo,vo,bo,_o,yo,To,Eo,wo,ko,Io,$o,So,Co,Oo,Ro,Ao,Mo,xo,Lo,Do,No,Po,Bo,Fo,Ho,Uo,Go,Vo,Wo,zo,jo,Xo,Yo,Ko,Jo,qo,Zo,Qo,tn,en,on,nn,sn,rn,an,ln,hn,cn,un,dn,pn,gn,fn,mn,vn,bn,_n,yn,Tn,En,wn,kn,In,$n,Sn,Cn,On,Rn,An,Mn,xn,Ln,Dn,Nn,Pn,Bn,Fn,Hn,Un,Gn,Vn,Wn,zn,jn,Xn,Yn,Kn,Jn,qn,Zn,Qn,ts,es,is,os,ns,ss,rs,as,ls,hs,cs,us,ds,ps,gs,fs,ms,vs,bs,_s,ys,Ts,Es,ws,ks,Is,$s,Ss,Cs,Os,Rs,As,Ms,xs,Ls,Ds,Ns,Ps,Bs,Fs,Hs,Us,Gs,Vs,Ws,zs,js,Xs,Ys,Ks,Js,qs,Zs,Qs,tr,er,ir,or,nr,sr,rr,ar,lr,hr,cr,ur,dr,pr,gr,fr,mr,vr,br,_r,yr,Tr,Er,wr,kr,Ir,$r,Sr,Cr,Or,Rr,Ar,Mr,xr,Lr,Dr,Nr,Pr,Br,Fr,Hr,Ur={};t=function(t,i,o,n){if(!(t instanceof jr)&&"string"!=typeof t||""===`${t}`.trim())throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=`${t}`.toLowerCase(),"string"!=typeof i||""===i.trim())throw Error('Invalid name "'+i+'". The name must be a non-empty string.');const s=i.toLowerCase();if(!o)throw Error("Can not register a null value");let r=Gr[t],a=Wr[t];if(r||(r=Gr[t]=Object.create(null),a=Wr[t]=Object.create(null)),e(t,o),!n&&r[s]&&r[s]!==o)throw Error('Name "'+s+'" with type "'+t+'" already registered.');r[s]=o,a[s]=i},e=function(t,e){if(t===String(jr.FIELD)&&"function"!=typeof e.fromJson)throw Error('Type "'+t+'" must have a fromJson function')},o=function(t,e){t=`${t}`.toLowerCase(),e=e.toLowerCase();const i=Gr[t];i&&i[e]?(delete Gr[t][e],delete Wr[t][e]):console.warn("Unable to unregister ["+e+"]["+t+"] from the registry.")},n=function(t,e,i){t=`${t}`.toLowerCase(),e=e.toLowerCase();const o=Gr[t];if(!o||!o[e]){if(e="Unable to find ["+e+"]["+t+"] in the registry.",i)throw Error(e+" You must require or register a "+t+" plugin.");return console.warn(e),null}return o[e]},s=function(t,e){return t=`${t}`.toLowerCase(),e=e.toLowerCase(),!!(t=Gr[t])&&!!t[e]},r=function(t,e,i){return n(t,e,i)},a=function(t,e,i){return n(t,e,i)},l=function(t,e,i){t=`${t}`.toLowerCase();var o=Gr[t];if(!o){if(o=`Unable to find [${t}] in the registry.`,i)throw Error(`${o} You must require or register a ${t} plugin.`);return console.warn(o),null}if(!e)return o;t=Wr[t],i=Object.create(null);for(const e of Object.keys(o))i[t[e]]=o[e];return i},h=function(t,e,i){return"function"==typeof(e=e.plugins[String(t)]||zr)?e:r(t,e,i)},c=function(){return"blockly-"+(Ia++).toString(36)},u=function(){return ka.genUid()},Ur.setRecordUndo$$module$build$src$core$events$utils=function(t){Kr=t},d=function(){return Kr},p=function(t){ya.fireInternal(t)},g=function(t){if(b()){if(!_a.length)try{requestAnimationFrame((()=>{setTimeout(f,0)}))}catch(t){setTimeout(f,0)}_a.push(t)}},f=function(){var t=m(_a,!0);_a.length=0;for(let i,o=0;i=t[o];o++)if(i.workspaceId){var e=k(i.workspaceId);e&&e.fireChangeListener(i)}t=new Set(t.map((t=>t.workspaceId)));for(const i of t){if(!i)continue;if(!(t=k(i)))continue;let o;for(e=(t=t.getUndoStack()).length;0<e;e--){const i=t[e-1];if(""===i.group)break;if(void 0===o)o=i.group;else if(i.group!==o)break}o&&e!=t.length-1&&(e=t.splice(e,t.length-e),e=m(e,!0),t.push(...e))}},m=function(t,e){t=t.slice(),e||t.reverse();const i=[],o=Object.create(null);for(let e,r=0;e=t[r];r++)if(!e.isNull()){var n=[e.isUiEvent?ea:e.type,e.blockId,e.workspaceId].join(" "),s=o[n];const t=s?s.event:null;s?e.type===Ur.MOVE$$module$build$src$core$events$utils&&s.index===r-1?(n=e,t.newParentId=n.newParentId,t.newInputName=n.newInputName,t.newCoordinate=n.newCoordinate,n.reason&&(t.reason?(n=new Set(n.reason.concat(t.reason)),t.reason=Array.from(n)):t.reason=n.reason),s.index=r):e.type===Ur.CHANGE$$module$build$src$core$events$utils&&e.element===t.element&&e.name===t.name?t.newValue=e.newValue:e.type===ca?(s=e,t.viewTop=s.viewTop,t.viewLeft=s.viewLeft,t.scale=s.scale,t.oldScale=s.oldScale):e.type===na&&t.type===ra||(o[n]={event:e,index:r},i.push(e)):(o[n]={event:e,index:r},i.push(e))}t=i.filter((function(t){return!t.isNull()})),e||t.reverse();for(let e,i=1;e=t[i];i++)e.type===Ur.CHANGE$$module$build$src$core$events$utils&&"mutation"===e.element&&t.unshift(t.splice(i,1)[0]);return t},v=function(){for(let t,e=0;t=_a[e];e++)t.recordUndo=!1},Ur.disable$$module$build$src$core$events$utils=function(){Jr++},Ur.enable$$module$build$src$core$events$utils=function(){Jr--},b=function(){return 0===Jr},Ur.getGroup$$module$build$src$core$events$utils=function(){return Yr},Ur.setGroup$$module$build$src$core$events$utils=function(t){ya.setGroupInternal(t)},_=function(t){Yr="boolean"==typeof t?t?u():"":t},y=function(t){const e=[];t=t.getDescendants(!1);for(let i,o=0;i=t[o];o++)e[o]=i.id;return e},T=function(t,e){const i=E(t.type);if(!i)throw Error("Unknown event type.");return i.fromJson(t,e)},E=function(t){const e=r(jr.EVENT,t);if(!e)throw Error(`Event type ${t} not found in registry.`);return e},w=function(t){if((t.type===Ur.MOVE$$module$build$src$core$events$utils||t.type===Ur.CREATE$$module$build$src$core$events$utils)&&t.workspaceId){var e=k(t.workspaceId);if(!t.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(t=e.getBlockById(t.blockId)){const i=Kr;try{Kr=!1;const i=t.getParent();if(i&&!i.hasDisabledReason(va)){const e=t.getDescendants(!1);for(let t,i=0;t=e[i];i++)t.setDisabledReason(!1,va)}else if((t.outputConnection||t.previousConnection)&&!e.isDragging())do{t.setDisabledReason(!0,va),t=t.getNextBlock()}while(t)}finally{Kr=i}}}},k=function(t){return Oa[t]||null},I=function(){const t=[];for(const e in Oa)t.push(Oa[e]);return t},$=function(t){Oa[t.id]=t},S=function(t){delete Oa[t.id]},C=function(){return Sa},O=function(t){Sa=t},R=function(){return Ra},Ur.setSelected$$module$build$src$core$common=function(t){if(Ra!==t){var e,i,o,n,s,r,a,l,h=new(E(oa))(null!=(o=null==(e=Ra)?void 0:e.id)?o:null,null!=(n=null==t?void 0:t.id)?n:null,null!=(r=null!=(s=null==t?void 0:t.workspace.id)?s:null==(i=Ra)?void 0:i.workspace.id)?r:"");p(h),null==(a=Ra)||a.unselect(),null==(l=Ra=t)||l.select()}},A=function(){return Ca},M=function(t){Ca=t},x=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;const e=t.getParentSvg(),i=t.getCachedParentSvgSize();var o=e.parentElement;if(o instanceof HTMLElement){var n=o.offsetWidth;o=o.offsetHeight,i.width!==n&&(e.setAttribute("width",n+"px"),t.setCachedParentSvgSize(n,null)),i.height!==o&&(e.setAttribute("height",o+"px"),t.setCachedParentSvgSize(null,o)),t.resize()}},L=function(t,e){const i=Object.create(null),o=t.getDescendants(!0);e&&(t=t.getNextBlock())&&(t=o.indexOf(t),o.splice(t,o.length-t));for(let t,e=0;t=o[e];e++)i[t.type]?i[t.type]++:i[t.type]=1;return i},D=function(t){return function(){this.jsonInit(t)}},N=function(t){Ma.defineBlocksWithJsonArrayInternal(t)},P=function(t){Ur.defineBlocks$$module$build$src$core$common(Ur.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(t))},Ur.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(t){const e={};for(let i=0;i<t.length;i++){const o=t[i];if(!o){console.warn(`Block definition #${i} in JSON array is ${o}. Skipping`);continue}const n=o.type;n?e[n]={init:D(o)}:console.warn(`Block definition #${i} in JSON array is missing a type attribute. Skipping.`)}return e},Ur.defineBlocks$$module$build$src$core$common=function(t){for(const e of Object.keys(t)){const i=t[e];e in Ea&&console.warn(`Block definition "${e}" overwrites previous definition.`),Ea[e]=i}},B=function(t,e){F(),tl=setTimeout((function(){e&&e.handleRightClick(t)}),Ja)},F=function(){tl&&(clearTimeout(tl),tl=0)},H=function(){Za=null},U=function(t){return!t.type.startsWith("pointer")||t instanceof PointerEvent&&V(t)},G=function(t){return`${t.pointerId}`},V=function(t){const e=G(t);return Za?Za===e:"pointerdown"===t.type&&(Za=e,!0)},W=function(t,e,i,o,n){function s(t){(n||U(t))&&(i?o.call(i,t):o(t))}const r=[];if(e in Qa)for(let i=0;i<Qa[e].length;i++){const o=Qa[e][i];t.addEventListener(o,s,!1),r.push([t,o,s])}else t.addEventListener(e,s,!1),r.push([t,e,s]);return r},z=function(t,e,i,o){function n(t){i?o.call(i,t):o(t)}const s=[];if(e in Qa)for(let i=0;i<Qa[e].length;i++){const o=Qa[e][i];t.addEventListener(o,n,!1),s.push([t,o,n])}else t.addEventListener(e,n,!1),s.push([t,e,n]);return s},j=function(t){const e=t[t.length-1][2];for(;t.length;){const[e,i,o]=t.pop();e.removeEventListener(i,o,!1)}return e},X=function(t){if(t.target instanceof HTMLElement){if(t.target.isContentEditable||"true"===t.target.getAttribute("data-is-text-input"))return!0;if(t.target instanceof HTMLInputElement)return"text"===(t=t.target).type||"number"===t.type||"email"===t.type||"password"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type;if(t.target instanceof HTMLTextAreaElement)return!0}return!1},Y=function(t){return!(!t.ctrlKey||!al)||2===t.button},K=function(t,e,i){const o=e.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,i||(i=e.getScreenCTM().inverse()),o.matrixTransform(i)},J=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*cl,y:t.deltaY*cl};case 2:return{x:t.deltaX*ul,y:t.deltaY*ul}}},q=function(t,e){return-1!==(e=t.indexOf(e))&&(t.splice(e,1),!0)},Z=function(t){if(ml)throw Error("CSS already injected");vl+="\n"+t},Q=function(t,e){ml||(ml=!0,t&&(t=e.replace(/[\\/]$/,""),e=vl.replace(/<<<PATH>>>/g,t),vl="",(t=document.createElement("style")).id="blockly-common-style",e=document.createTextNode(e),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild)))},tt=function(t,e,i){t=document.createElementNS(Tl,`${t}`);for(const i in e)t.setAttribute(i,`${e[i]}`);return i&&i.appendChild(t),t},et=function(t,e){return!(e=e.split(" ")).every((e=>t.classList.contains(e)))&&(t.classList.add(...e),!0)},it=function(t,e){t.classList.remove(...e.split(" "))},ot=function(t,e){return!(e=e.split(" ")).every((e=>!t.classList.contains(e)))&&(t.classList.remove(...e),!0)},nt=function(t,e){return t.classList.contains(e)},st=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},rt=function(t,e){const i=e.nextSibling;if(!(e=e.parentNode))throw Error("Reference node has no parent.");i?e.insertBefore(t,i):e.appendChild(t)},at=function(t,e){t.style.transform=e,t.style["-webkit-transform"]=e},lt=function(){Il++,kl||(kl=Object.create(null))},ht=function(){--Il||(kl=null)},ct=function(t){const e=t.textContent+"\n"+t.className.baseVal;let i;if(kl&&(i=kl[e]))return i;try{i=t.getComputedTextLength()}catch(e){return 8*t.textContent.length}return kl&&(kl[e]=i),i},ut=function(t,e,i,o){return dt(t,e+"pt",i,o)},dt=function(t,e,i,o){const n=t.textContent;var s;return t=n+"\n"+t.className.baseVal,kl&&(s=kl[t])||($l||((s=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(s),$l=s.getContext("2d")),$l.font=i+" "+e+" "+o,s=n?$l.measureText(n).width:0,kl&&(kl[t]=s)),s},pt=function(t,e,i,o){const n=document.createElement("span");n.style.font=i+" "+e+" "+o,n.textContent=t,(t=document.createElement("div")).style.width="1px",t.style.height="0",(e=document.createElement("div")).style.display="flex",e.style.position="fixed",e.style.top="0",e.style.left="0",e.appendChild(n),e.appendChild(t),document.body.appendChild(e),i={height:0,baseline:0};try{e.style.alignItems="baseline",i.baseline=t.offsetTop-n.offsetTop,e.style.alignItems="flex-end",i.height=t.offsetTop-n.offsetTop}finally{document.body.removeChild(e)}return i},gt=function(t){return Al.getSizeInternal(t)},ft=function(t){if("none"!==vt(t,"display"))return mt(t);const e=t.style,i=e.display,o=e.visibility,n=e.position;e.visibility="hidden",e.position="absolute",e.display="inline";const s=t.offsetWidth;return t=t.offsetHeight,e.display=i,e.position=n,e.visibility=o,new Rl(s,t)},mt=function(t){return new Rl(t.offsetWidth,t.offsetHeight)},vt=function(t,e){return(t=window.getComputedStyle(t))[e]||t.getPropertyValue(e)},bt=function(t){const e=new yl(0,0);t=t.getBoundingClientRect();var i=document.documentElement;return i=new yl(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),e.x=t.left+i.x,e.y=t.top+i.y,e},_t=function(){const t=document.body,e=document.documentElement;return new yl(t.scrollLeft||e.scrollLeft,t.scrollTop||e.scrollTop)},yt=function(t){const e=parseFloat(vt(t,"borderLeftWidth")),i=parseFloat(vt(t,"borderRightWidth")),o=parseFloat(vt(t,"borderTopWidth"));return t=parseFloat(vt(t,"borderBottomWidth")),new Ol(o,t,e,i)},Tt=function(t,e,i){t=Et(t,e,i),e.scrollLeft=t.x,e.scrollTop=t.y},Et=function(t,e,i){var o=bt(t),n=bt(e),s=yt(e);const r=o.x-n.x-s.left;return o=o.y-n.y-s.top,n=mt(t),t=e.clientWidth-n.width,n=e.clientHeight-n.height,s=e.scrollLeft,e=e.scrollTop,i?(s+=r-t/2,e+=o-n/2):(s+=Math.min(r,Math.max(r-t,0)),e+=Math.min(o,Math.max(o-n,0))),new yl(s,e)},wt=function(t){const e=new yl(0,0);var i=t.x&&t.getAttribute("x");const o=t.y&&t.getAttribute("y");return i&&(e.x=parseInt(i)),o&&(e.y=parseInt(o)),(i=(i=t.getAttribute("transform"))&&i.match(xl))&&(e.x+=Number(i[1]),i[3]&&(e.y+=Number(i[3]))),(t=t.getAttribute("style"))&&t.includes("translate")&&(t=t.match(Ll))&&(e.x+=Number(t[1]),t[3]&&(e.y+=Number(t[3]))),e},kt=function(t){let e=0,i=0;for(;t;){const o=wt(t);if(e+=o.x,i+=o.y,(" "+(t.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;t=t.parentNode}return new yl(e,i)},It=function(){const t=_t();return new Ol(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},$t=function(){const t=document.documentElement,e=window;return new yl(e.pageXOffset||t.scrollLeft,e.pageYOffset||t.scrollTop)},St=function(t,e){var i=e.x;e=e.y;const o=t.getInjectionDiv().getBoundingClientRect();return i=new yl(i-o.left,e-o.top),e=t.getOriginOffsetInPixels(),yl.difference(i,e).scale(1/t.scale)},Ct=function(t,e){var i=e.scale(t.scale);e=i.x,i=i.y;const o=t.getInjectionDiv().getBoundingClientRect();return t=t.getOriginOffsetInPixels(),new yl(e+o.left+t.x,i+o.top+t.y)},Ot=function(t){({document:Fl=Fl,DOMParser:Hl=Hl,XMLSerializer:Ul=Ul}=t),Pl=new Hl,Bl=new Ul},Ur.createElement$$module$build$src$core$utils$xml=function(t){return Fl.createElementNS(Gl,t)},Ur.createTextNode$$module$build$src$core$utils$xml=function(t){return Fl.createTextNode(t)},Ur.textToDom$$module$build$src$core$utils$xml=function(t){let e=Pl.parseFromString(t,"text/xml");if(e&&e.documentElement&&!e.getElementsByTagName("parsererror").length)return e.documentElement;if((e=Pl.parseFromString(t,"text/html"))&&e.body.firstChild&&"xml"===e.body.firstChild.nodeName.toLowerCase())return e.body.firstChild;throw Error(`DOMParser was unable to parse: ${t}`)},Rt=function(t){return At(Bl.serializeToString(t))},At=function(t){return t.replace(Vl,(t=>`&#${t.charCodeAt(0)};`))},Mt=function(t){return t?((t instanceof Element||"string"==typeof t)&&(t=Ut(t),t=Bt(t)),xt(t),t):null},xt=function(t){const e=t.kind;if(t=t.contents,e&&e!==Xl&&e!==jl)throw Error("Invalid toolbox kind "+e+". Please supply either "+Xl+" or "+jl);if(!t)throw Error("Toolbox must have a contents attribute.")},Lt=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:Ft(t):[]},Dt=function(t){return ql.hasCategoriesInternal(t)},Nt=function(t){if(!t)return!1;const e=t.kind;return e?e===jl:!!t.contents.filter((function(t){return"CATEGORY"===t.kind.toUpperCase()})).length},Pt=function(t){return!(!t||!t.contents||!t.contents.filter((function(t){return"CATEGORY"===t.kind.toUpperCase()})).length)},Bt=function(t){const e={contents:Ft(t)};return t instanceof Node&&Ht(t,e),e},Ft=function(t){const e=[];let i=t.childNodes;i||(i=t);for(let o,n=0;o=i[n];n++){if(!o.tagName)continue;t={};const i=o.tagName.toUpperCase();t.kind=i,"BLOCK"===i?t.blockxml=o:o.childNodes&&0<o.childNodes.length&&(t.contents=Ft(o)),Ht(o,t),e.push(t)}return e},Ht=function(t,e){for(let i=0;i<t.attributes.length;i++){const o=t.attributes[i];o.nodeName.includes("css-")?(e.cssconfig=e.cssconfig||{},e.cssconfig[o.nodeName.replace("css-","")]=o.value):e[o.nodeName]=o.value}},Ut=function(t){let e=null;if(t)if("string"==typeof t){if(e=Ur.textToDom$$module$build$src$core$utils$xml(t),"xml"!==e.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t instanceof Element&&(e=t);return e},Gt=function(t,e,i,o,n,s){const r=s.scrollbar&&s.scrollbar.canScrollVertically();return t.horizontal===Kl.LEFT?(i=n.absoluteMetrics.left+i,r&&s.RTL&&(i+=Nl.scrollbarThickness)):(i=n.absoluteMetrics.left+n.viewMetrics.width-e.width-i,r&&!s.RTL&&(i-=Nl.scrollbarThickness)),t.vertical===Yl.TOP?t=n.absoluteMetrics.top+o:(t=n.absoluteMetrics.top+n.viewMetrics.height-e.height-o,s.scrollbar&&s.scrollbar.canScrollHorizontally()&&(t-=Nl.scrollbarThickness)),new Ol(t,t+e.height,i,i+e.width)},Vt=function(t,e){return{horizontal:e.toolboxMetrics.position===zl.LEFT||t.horizontalLayout&&!t.RTL?Kl.RIGHT:Kl.LEFT,vertical:e.toolboxMetrics.position===zl.BOTTOM?Yl.TOP:Yl.BOTTOM}},Wt=function(t,e,i,o){const n=t.left,s=t.right-t.left,r=t.bottom-t.top;for(let a=0;a<o.length;a++){const l=o[a];t.intersects(l)&&(t=i===Jl.UP?l.top-r-e:l.bottom+e,t=new Ol(t,t+r,n,n+s),a=-1)}return t},zt=function(t,e){uh(t,e)},jt=function(t){uh=t},Xt=function(t,e){gh.confirmInternal(t,e)},Yt=function(t,e){dh(t,e)},Kt=function(t){dh=t},Jt=function(t,e,i){ph(t,e,i)},qt=function(t){ph=t},Zt=function(t){return void 0!==t.getVariableModel},Qt=function(t){return void 0!==t.getProcedureDef},te=function(t){return void 0!==t.getProcedureCall&&void 0!==t.renameProcedure},Ur.allUsedVarModels$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const e=new Set;for(let i=0;i<t.length;i++){const o=t[i].getVarModels();if(o)for(let t=0;t<o.length;t++){const i=o[t];i.getId()&&e.add(i)}}return Array.from(e.values())},Ur.allDeveloperVariables$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const e=new Set;for(let o,n=0;o=t[n];n++){var i=o.getDeveloperVariables;if(i){i=i();for(let t=0;t<i.length;t++)e.add(i[t])}}return Array.from(e.values())},ee=function(t){let e=[];const i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",(function(t){re(t.getTargetWorkspace())})),e.push(i),t=ie(t),e.concat(t)},ie=function(t){const e=[];if(0<(t=t.getVariablesOfType("")).length){var i=t[t.length-1];if(Ea.variables_set){var o=Ur.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type","variables_set"),o.setAttribute("gap",Ea.math_change?"8":"24"),o.appendChild(pe(i)),e.push(o)}if(Ea.math_change&&((o=Ur.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),o.setAttribute("gap",Ea.variables_get?"20":"8"),o.appendChild(pe(i)),i=Ur.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),o.appendChild(i),e.push(o)),Ea.variables_get){t.sort(_h.compareByName);for(let o,n=0;o=t[n];n++)(i=Ur.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild(pe(o)),e.push(i)}}return e},oe=function(t){return Eh.generateUniqueNameInternal(t)},ne=function(t){return se(Th.charAt(0),t.getAllVariableNames())},se=function(t,e){if(!e.length)return t;const i=Th;let o="",n=i.indexOf(t);for(;;){let s=!1;for(let i=0;i<e.length;i++)if(e[i].toLowerCase()===t){s=!0;break}if(!s)break;n++,n===i.length&&(n=0,o=`${Number(o)+1}`),t=i.charAt(n)+o}return t},re=function(t,e,i){const o=i||"";!function i(n){ae(Ur.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,n,(function(n){if(n){var s=he(n,t);if(s){if(s.type===o)var r=Ur.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",s.name);else r=(r=Ur.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",s.name).replace("%2",s.type);zt(r,(function(){i(n)}))}else t.createVariable(n,o),e&&e(n)}else e&&e(null)}))}("")},Ur.renameVariable$$module$build$src$core$variables=function(t,e,i){!function o(n){const s=Ur.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",e.name);ae(s,n,(function(n){if(n){var s=le(n,e.type,t),r=ce(e.name,n,t);if(s||r){var a="";s?a=Ur.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",s.name).replace("%2",s.type):r&&(a=Ur.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",n).replace("%2",r)),zt(a,(function(){o(n)}))}else t.renameVariableById(e.getId(),n),i&&i(n)}else i&&i(null)}))}("")},ae=function(t,e,i){Jt(t,e,(function(t){t&&((t=t.replace(/[\s\xa0]+/g," ").trim())===Ur.Msg$$module$build$src$core$msg.RENAME_VARIABLE||t===Ur.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(t=null),i(t)}))},le=function(t,e,i){i=i.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let o,n=0;o=i[n];n++)if(o.name.toLowerCase()===t&&o.type!==e)return o;return null},he=function(t,e){e=e.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let i,o=0;i=e[o];o++)if(i.name.toLowerCase()===t)return i;return null},ce=function(t,e,i){return i.getProcedureMap().getProcedures().length?ue(t,e,i):de(t,e,i)},ue=function(t,e,i){t=t.toLowerCase(),e=e.toLowerCase(),i=i.getProcedureMap().getProcedures();for(const n of i){var o=n.getParameters().filter(Zt).map((t=>t.getVariableModel().name));if(o&&(i=o.some((e=>e.toLowerCase()===t)),o=o.some((t=>t.toLowerCase()===e)),i&&o))return n.getName()}return null},de=function(t,e,i){t=t.toLowerCase(),e=e.toLowerCase(),i=i.getAllBlocks(!1);for(const n of i){if(!Qt(n))continue;var o=(i=n.getProcedureDef())[1];const s=o.some((e=>e.toLowerCase()===t));if(o=o.some((t=>t.toLowerCase()===e)),s&&o)return i[0]}return null},pe=function(t){const e=Ur.createElement$$module$build$src$core$utils$xml("field");return e.setAttribute("name","VAR"),e.setAttribute("id",t.getId()),e.setAttribute("variabletype",t.type),t=Ur.createTextNode$$module$build$src$core$utils$xml(t.name),e.appendChild(t),e},Ur.getOrCreateVariablePackage$$module$build$src$core$variables=function(t,e,i,o){let n=Ur.getVariable$$module$build$src$core$variables(t,e,i,o);return n||(n=ge(t,e,i,o)),n},Ur.getVariable$$module$build$src$core$variables=function(t,e,i,o){const n=t.getPotentialVariableMap();let s=null;if(e&&(s=t.getVariableById(e),!s&&n&&(s=n.getVariableById(e)),s))return s;if(i){if(void 0===o)throw Error("Tried to look up a variable by name without a type");s=t.getVariable(i,o),!s&&n&&(s=n.getVariable(i,o))}return s},ge=function(t,e,i,o){const n=t.getPotentialVariableMap();return i||(i=oe(t.isFlyout?t.targetWorkspace:t)),n?n.createVariable(i,o,e):t.createVariable(i,o,e)},fe=function(t,e){t=t.getAllVariables();const i=[];if(e.length!==t.length)for(let o=0;o<t.length;o++){const n=t[o];e.includes(n)||i.push(n)}return i},me=function(t){return ye(t),_e()?(Te(),Promise.resolve()):(Sh||(Sh=new Promise((t=>{Ch=t,Oh=window.requestAnimationFrame((()=>{Te(),t()}))}))),Sh)},ve=function(){return Sh||Promise.resolve()},be=function(t){t||window.cancelAnimationFrame(Oh),Te(t),!t&&Ch&&Ch()},_e=function(){return il},ye=function(t){Ih.add(t),$h.set(t,Ur.getGroup$$module$build$src$core$events$utils());const e=t.getParent();e?ye(e):kh.add(t)},Te=function(t){const e=t?new Set([t]):new Set([...kh].map((t=>t.workspace))),i=[...kh].filter(we).filter((t=>e.has(t.workspace)));for(var o of i)ke(o);for(const t of e)t.resizeContents();for(var n of i)o=n.getRelativeToSurfaceXY(),n.updateComponentLocations(o);for(const t of i)n=Ur.getGroup$$module$build$src$core$events$utils(),(o=$h.get(t))&&Ur.setGroup$$module$build$src$core$events$utils(o),t.bumpNeighbours(),Ur.setGroup$$module$build$src$core$events$utils(n);for(const t of i)Ee(t);t||(Sh=null)},Ee=function(t){kh.delete(t),Ih.delete(t),$h.delete(t);for(const e of t.getChildren(!1))Ee(e)},we=function(t){return!t.isDisposed()&&!t.getParent()},ke=function(t){if(Ih.has(t)&&t.initialized){for(const e of t.getChildren(!1))ke(e);t.renderEfficiently()}},Ie=function(e,i){t(jr.SERIALIZER,e,i)},$e=function(t){o(jr.SERIALIZER,t)},Se=function(t,{addCoordinates:e=!1,saveIds:i=!0}={}){const o=t.workspace,n=Object.create(null);return n.height=t.getSize().height,n.width=t.getSize().width,i&&(n.id=t.id),e&&(e=t.getRelativeToSurfaceXY(),n.x=o.RTL?o.getWidth()-e.x:e.x,n.y=e.y),t.getText()&&(n.text=t.getText()),t.isCollapsed()&&(n.collapsed=!0),t.isOwnEditable()||(n.editable=!1),t.isOwnMovable()||(n.movable=!1),t.isOwnDeletable()||(n.deletable=!1),n},Ce=function(t,e,{recordUndo:i=!1}={}){const o=d();if(Ur.setRecordUndo$$module$build$src$core$events$utils(i),i=e.newComment(t.id),void 0!==t.text&&i.setText(t.text),void 0!==t.x||void 0!==t.y){const o=i.getRelativeToSurfaceXY();let s,r=null!=(s=t.x)?s:o.x;var n;r=e.RTL?e.getWidth()-r:r,e=null!=(n=t.y)?n:o.y,i.moveTo(new yl(r,e))}if(void 0!==t.width||t.height){let e,o;n=i.getSize(),i.setSize(new Rl(null!=(e=t.width)?e:n.width,null!=(o=t.height)?o:n.height))}return void 0!==t.collapsed&&i.setCollapsed(t.collapsed),void 0!==t.editable&&i.setEditable(t.editable),void 0!==t.movable&&i.setMovable(t.movable),void 0!==t.deletable&&i.setDeletable(t.deletable),Ur.setRecordUndo$$module$build$src$core$events$utils(o),i},Oe=function(e,i){t(jr.PASTER,e,i)},Re=function(t){o(jr.PASTER,t)},Ae=function(t){const e=t.workspace,i=t.getRelativeToSurfaceXY(),o=new yl(0,0),n=e.getTopComments(!1).filter((e=>e.id!==t.id)).map((t=>t.getRelativeToSurfaceXY()));for(;Me(yl.sum(i,o),n);)o.translate(e.RTL?-30:30,30);t.moveTo(yl.sum(i,o))},Me=function(t,e){return e.some((e=>1>=Math.abs(e.x-t.x)&&1>=Math.abs(e.y-t.y)))},xe=function(t,e){t.setAttribute(Wh,e)},Le=function(t,e,i){Array.isArray(i)&&(i=i.join(" ")),t.setAttribute(Vh+e,`${i}`)},De=function(t){return void 0!==t.saveState&&void 0!==t.loadState},Ne=function(t,{addCoordinates:e=!1,addInputBlocks:i=!0,addNextBlocks:o=!0,doFullSerialization:n=!0,saveIds:s=!0}={}){if(t.isInsertionMarker())return null;const r={type:t.type,id:s?t.id:void 0};return e&&Be(t,r),Pe(t,r),Fe(t,r,n),He(t,r,n),Ue(t,r,n),i&&Ge(t,r,n,s),o&&Ve(t,r,n,s),r},Pe=function(t,e){t.isCollapsed()&&(e.collapsed=!0),t.isEnabled()||(e.disabledReasons=Array.from(t.getDisabledReasons())),t.isOwnDeletable()||(e.deletable=!1),t.isOwnMovable()||(e.movable=!1),t.isOwnEditable()||(e.editable=!1),void 0!==t.inputsInline&&t.inputsInline!==t.inputsInlineDefault&&(e.inline=t.inputsInline),t.data&&(e.data=t.data)},Be=function(t,e){const i=t.workspace;t=t.getRelativeToSurfaceXY(),e.x=Math.round(i.RTL?i.getWidth()-t.x:t.x),e.y=Math.round(t.y)},Fe=function(t,e,i){t.saveExtraState?null!==(t=t.saveExtraState(i))&&(e.extraState=t):t.mutationToDom&&null!==(t=t.mutationToDom())&&(e.extraState=qo(t).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},He=function(t,e,i){const o=Object.create(null);for(const e of t.getIcons())De(e)&&(t=e.saveState(i))&&(o[e.getType().toString()]=t);Object.keys(o).length&&(e.icons=o)},Ue=function(t,e,i){const o=Object.create(null);for(let e=0;e<t.inputList.length;e++){const n=t.inputList[e];for(let t=0;t<n.fieldRow.length;t++){const e=n.fieldRow[t];e.isSerializable()&&(o[e.name]=e.saveState(i))}}Object.keys(o).length&&(e.fields=o)},Ge=function(t,e,i,o){const n=Object.create(null);for(let e=0;e<t.inputList.length;e++){const s=t.inputList[e];if(!s.connection)continue;const r=We(s.connection,i,o);r&&(n[s.name]=r)}Object.keys(n).length&&(e.inputs=n)},Ve=function(t,e,i,o){t.nextConnection&&(t=We(t.nextConnection,i,o))&&(e.next=t)},We=function(t,e,i){const o=t.getShadowState(!0);if(t=t.targetBlock(),!o&&!t)return null;const n=Object.create(null);return o&&(n.shadow=o),t&&!t.isShadow()&&(n.block=Ne(t,{doFullSerialization:e,saveIds:i})),n},ze=function(t,e,{recordUndo:i=!1}={}){return t=je(t,e,{recordUndo:i}),e.rendered&&be(),t},je=function(t,e,{parentConnection:i,isShadow:o=!1,recordUndo:n=!1}={}){const s=d();Ur.setRecordUndo$$module$build$src$core$events$utils(n),(n=Ur.getGroup$$module$build$src$core$events$utils())||Ur.setGroup$$module$build$src$core$events$utils(!0),Ur.disable$$module$build$src$core$events$utils();const r=e.getAllVariables();let a;try{a=Xe(t,e,{parentConnection:i,isShadow:o})}finally{Ur.enable$$module$build$src$core$events$utils()}if(Ye(e,r),b()&&p(new(E(Ur.CREATE$$module$build$src$core$events$utils))(a)),Ur.setGroup$$module$build$src$core$events$utils(n),Ur.setRecordUndo$$module$build$src$core$events$utils(s),e.rendered){const t=a;setTimeout((()=>{t.disposed||t.setConnectionTracking(!0)}),1)}return a},Xe=function(t,e,{parentConnection:i,isShadow:o=!1}={}){if(!t.type)throw new Kh(t);const n=e.newBlock(t.type,t.id);return n.setShadow(o),Ke(n,t),Je(n,t),qe(n,t),Ze(i,n,t),Qe(n,t),ti(n,t),ei(n,t),ii(n,t),ni(n,e.rendered),n},Ye=function(t,e){if(b())for(t=fe(t,e),e=0;e<t.length;e++){const i=t[e];p(new(E(Zr))(i))}},Ke=function(t,e){let i=void 0===e.x?0:e.x;e=void 0===e.y?0:e.y;const o=t.workspace;i=o.RTL?o.getWidth()-i:i,t.moveBy(i,e)},Je=function(t,e){if(e.collapsed&&t.setCollapsed(!0),!1===e.deletable&&t.setDeletable(!1),!1===e.movable&&t.setMovable(!1),!1===e.editable&&t.setEditable(!1),!1===e.enabled&&t.setDisabledReason(!0,rh),Array.isArray(e.disabledReasons))for(const i of e.disabledReasons)t.setDisabledReason(!0,i);void 0!==e.inline&&t.setInputsInline(e.inline),void 0!==e.data&&(t.data=e.data)},qe=function(t,e){e.extraState&&(t.loadExtraState?t.loadExtraState(e.extraState):t.domToMutation&&t.domToMutation(Ur.textToDom$$module$build$src$core$utils$xml(e.extraState)))},Ze=function(t,e,i){if(t){if(t.getSourceBlock().isShadow()&&!e.isShadow())throw new Zh(i);if(t.type===Ur.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var o=e.outputConnection;if(!o)throw new Jh("output",e,i)}else if(!(o=e.previousConnection))throw new Jh("previous",e,i);if(!t.connect(o)){const n=e.workspace.connectionChecker;throw new qh(n.getErrorMessage(n.canConnectWithReason(o,t,!1),o,t),t.type===Ur.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",e,i)}}},Qe=function(t,e){if(e.icons){var i=Object.keys(e.icons);for(const n of i){i=e.icons[n];var o=t.getIcon(n);if(!o){if(!(o=r(jr.ICON,n,!1)))throw new Qh(n,t,e);o=new o(t),t.addIcon(o)}De(o)&&o.loadState(i)}}},ti=function(t,e){if(e.fields){var i=Object.keys(e.fields);for(let o=0;o<i.length;o++){const n=i[o],s=e.fields[n],r=t.getField(n);r?r.loadState(s):console.warn(`Ignoring non-existant field ${n} in block ${t.type}`)}}},ei=function(t,e){if(e.inputs){var i=Object.keys(e.inputs);for(let o=0;o<i.length;o++){const n=i[o],s=t.getInput(n);if(!s||!s.connection)throw new Jh(n,t,e);oi(s.connection,e.inputs[n])}}},ii=function(t,e){if(e.next){if(!t.nextConnection)throw new Jh("next",t,e);oi(t.nextConnection,e.next)}},oi=function(t,e){e.shadow&&t.setShadowState(e.shadow),e.block&&Xe(e.block,t.getSourceBlock().workspace,{parentConnection:t})},ni=function(t,e){if(e){t.setConnectionTracking(!1),t.initSvg(),t.queueRender();for(const e of t.getIcons())e.onLocationChange(t.getRelativeToSurfaceXY())}else t.initModel()},si=function(t){return void 0!==t.bubbleIsVisible&&void 0!==t.setBubbleVisible},ri=function(t){return t*Math.PI/180},ai=function(t){return 180*t/Math.PI},li=function(t,e,i){if(i<t){const e=i;i=t,t=e}return Math.max(t,Math.min(e,i))},hi=function(){document.querySelector(".blocklyDropDownDiv")||((rc=document.createElement("div")).className="blocklyDropDownDiv",(A()||document.body).appendChild(rc),(ac=document.createElement("div")).className="blocklyDropDownContent",rc.appendChild(ac),(lc=document.createElement("div")).className="blocklyDropDownArrow",rc.appendChild(lc),rc.style.opacity="0",rc.style.transition="transform "+pc+"s, opacity "+pc+"s",rc.addEventListener("focusin",(function(){et(rc,"blocklyFocused")})),rc.addEventListener("focusout",(function(){ot(rc,"blocklyFocused")})))},ci=function(t){bc=t},ui=function(){return _c},di=function(){return ac},pi=function(){ac.textContent="",ac.style.width=""},gi=function(t,e){rc.style.backgroundColor=t,rc.style.borderColor=e},fi=function(t,e,i,o){return _i(vi(e),t,i,o)},mi=function(t,e,i){return yc=!0,_i(bi(t),t,e,i)},vi=function(t){var e=t.getSvgRoot();const i=t.workspace.scale,o=t.height*i;return t=t.width*i,e=bt(e),new Ol(e.y,e.y+o,e.x,e.x+t)},bi=function(t){return t=t.getScaledBBox(),new Ol(t.top,t.bottom,t.left,t.right)},_i=function(t,e,i,o){const n=t.left+(t.right-t.left)/2,s=t.bottom;t=t.top,o&&(t+=o);let r=(o=e.getSourceBlock()).workspace;for(;r.options.parentWorkspace;)r=r.options.parentWorkspace;return ci(r.getParentSvg().parentNode),yi(e,o.RTL,n,s,n,t,i)},yi=function(t,e,i,o,n,s,r){return _c=t,fc=r||null,rc.style.direction=e?"rtl":"ltr",t=C(),mc=t.getRenderer().getClassName(),vc=t.getTheme().getClassName(),mc&&et(rc,mc),vc&&et(rc,vc),Oi(i,o,n,s)},Ti=function(t,e,i,o){return{initialX:(t=ki(t,i.left,i.right,o.width)).divX,initialY:e,finalX:t.divX,finalY:e+dc,arrowX:t.arrowX,arrowY:-(hc/2+cc),arrowAtTop:!0,arrowVisible:!0}},Ei=function(t,e,i,o){return{initialX:(t=ki(t,i.left,i.right,o.width)).divX,initialY:e-o.height,finalX:t.divX,finalY:e-o.height-dc,arrowX:t.arrowX,arrowY:o.height-2*cc-hc/2,arrowAtTop:!1,arrowVisible:!0}},wi=function(t,e,i){return{initialX:(t=ki(t,e.left,e.right,i.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},ki=function(t,e,i,o){return e=li(e,t-o/2,i-o),{arrowX:t=li(i=uc,t=t-hc/2-e,o-i-hc),divX:e}},Ii=function(){return!!_c},$i=function(t,e){return _c===t&&(e?Ci():Si(),!0)},Si=function(){rc.style.transform="translate(0, 0)",rc.style.opacity="0",gc=setTimeout((function(){Ci()}),1e3*pc),fc&&(fc(),fc=null)},Ci=function(){Ii()&&(gc&&clearTimeout(gc),rc.style.transform="",rc.style.left="",rc.style.top="",rc.style.opacity="0",rc.style.display="none",rc.style.backgroundColor="",rc.style.borderColor="",fc&&(fc(),fc=null),pi(),_c=null,mc&&(ot(rc,mc),mc=""),vc&&(ot(rc,vc),vc=""),C().markFocused())},Oi=function(t,e,i,o){(t=Tc.getPositionMetrics(t,e,i,o)).arrowVisible?(lc.style.display="",lc.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",lc.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):lc.style.display="none",e=Math.floor(t.initialX),i=Math.floor(t.initialY),o=Math.floor(t.finalX);const n=Math.floor(t.finalY);return rc.style.left=e+"px",rc.style.top=i+"px",rc.style.display="block",rc.style.opacity="1",rc.style.transform="translate("+(o-e)+"px,"+(n-i)+"px)",!!t.arrowAtTop},Ri=function(){if(_c){var t=_c.getSourceBlock();const e=(t=yc?bi(_c):vi(t)).left+(t.right-t.left)/2;Oi(e,t.bottom,e,t.top)}else Si()},Ai=function(t){return t.length?t.reduce((function(t,e){return t.length<e.length?t:e})).length:0},Mi=function(t,e){if(!t.length)return 0;if(1===t.length)return t[0].length;let i,o=0;for(e=e||Ai(t),i=0;i<e;i++){for(var n=t[0][i],s=1;s<t.length;s++)if(n!==t[s][i])return o;" "===n&&(o=i+1)}for(n=1;n<t.length;n++)if((s=t[n][i])&&" "!==s)return o;return e},xi=function(t,e){if(!t.length)return 0;if(1===t.length)return t[0].length;let i,o=0;for(e=e||Ai(t),i=0;i<e;i++){for(var n=t[0].substr(-i-1,1),s=1;s<t.length;s++)if(n!==t[s].substr(-i-1,1))return o;" "===n&&(o=i+1)}for(n=1;n<t.length;n++)if((s=t[n].charAt(t[n].length-i-1))&&" "!==s)return o;return e},Ur.wrap$$module$build$src$core$utils$string=function(t,e){t=t.split("\n");for(let i=0;i<t.length;i++)t[i]=Li(t[i],e);return t.join("\n")},Li=function(t,e){if(t.length<=e)return t;const i=t.trim().split(/\s+/);for(var o=0;o<i.length;o++)i[o].length>e&&(e=i[o].length);var n=-1/0;let s,r=1;do{o=n,s=t,t=[],n=i.length/r;let a=1;for(let e=0;e<i.length-1;e++)a<(e+1.5)/n?(a++,t[e]=!0):t[e]=!1;t=Ni(i,t,e),n=Di(i,t,e),t=Pi(i,t),r++}while(n>o);return s},Di=function(t,e,i){const o=[0],n=[];for(var s=0;s<t.length;s++)o[o.length-1]+=t[s].length,!0===e[s]?(o.push(0),n.push(t[s].charAt(t[s].length-1))):!1===e[s]&&o[o.length-1]++;for(t=Math.max(...o),e=0,s=0;s<o.length;s++)e-=2*Math.pow(Math.abs(i-o[s]),1.5),e-=Math.pow(t-o[s],1.5),".?!".includes(n[s])?e+=i/3:",;)]}".includes(n[s])&&(e+=i/4);return 1<o.length&&o[o.length-1]<=o[o.length-2]&&(e+=.5),e},Ni=function(t,e,i){let o,n=Di(t,e,i);for(let s=0;s<e.length-1;s++){if(e[s]===e[s+1])continue;const r=[].concat(e);r[s]=!r[s],r[s+1]=!r[s+1];const a=Di(t,r,i);a>n&&(n=a,o=r)}return o?Ni(t,o,i):e},Pi=function(t,e){const i=[];for(let o=0;o<t.length;o++)i.push(t[o]),void 0!==e[o]&&i.push(e[o]?"\n":" ");return i.join("")},Ur.isNumber$$module$build$src$core$utils$string=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},Bi=function(t){Ic=t},Fi=function(){return Ic},Hi=function(){return $c},Ui=function(){return Hc},Gi=function(t){if(t=Vi(t)){for(t=t.tooltip;"function"==typeof t;)t=t();if("string"!=typeof t)throw Error("Tooltip function must return a string.");return t}return""},Vi=function(t){for(;t&&t.tooltip;){if("string"==typeof t.tooltip||"function"==typeof t.tooltip)return t;t=t.tooltip}return null},Wi=function(){document.querySelector(".blocklyTooltipDiv")||((Hc=document.createElement("div")).className="blocklyTooltipDiv",(A()||document.body).appendChild(Hc))},zi=function(t){t.mouseOverWrapper_=z(t,"pointerover",null,Xi),t.mouseOutWrapper_=z(t,"pointerout",null,Yi),t.addEventListener("pointermove",Ki,!1)},ji=function(t){t&&(j(t.mouseOverWrapper_),j(t.mouseOutWrapper_),t.removeEventListener("pointermove",Ki))},Xi=function(t){Sc||(t=Vi(t.currentTarget),xc!==t&&(qi(),Lc=null,xc=t),clearTimeout(Oc))},Yi=function(t){Sc||(Oc=setTimeout((function(){Lc=xc=null,qi()}),1),clearTimeout(Rc),Rc=0)},Ki=function(t){if(xc&&xc.tooltip&&!Sc)if($c){const e=Ac-t.pageX;t=Mc-t.pageY,Math.sqrt(e*e+t*t)>Pc&&qi()}else Lc!==xc&&(clearTimeout(Rc),Ac=t.pageX,Mc=t.pageY,Rc=setTimeout(oo,Bc))},Ji=function(){Lc=xc=null,qi()},qi=function(){$c&&($c=!1,Hc&&(Hc.style.display="none")),Rc&&(clearTimeout(Rc),Rc=0)},Zi=function(){qi(),Sc=!0},Qi=function(){Sc=!1},to=function(){Hc&&xc&&("function"==typeof Ic?Ic(Hc,xc):eo())},eo=function(){var t=Gi(xc);t=(t=Ur.wrap$$module$build$src$core$utils$string(t,Cc)).split("\n");for(let e=0;e<t.length;e++){const i=document.createElement("div");i.appendChild(document.createTextNode(t[e])),Hc.appendChild(i)}},io=function(t){const e=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let o=Ac;o=t?o-(Dc+Hc.offsetWidth):o+Dc;let n=Mc+Nc;return n+Hc.offsetHeight>i+window.scrollY&&(n-=Hc.offsetHeight+2*Nc),t?o=Math.max(Fc-window.scrollX,o):o+Hc.offsetWidth>e+window.scrollX-2*Fc&&(o=e-Hc.offsetWidth-2*Fc),{x:o,y:n}},oo=function(){if(!Sc&&(Lc=xc,Hc)){Hc.textContent="",to();var t=xc.RTL;Hc.style.direction=t?"rtl":"ltr",Hc.style.display="block",$c=!0;var{x:e,y:i}=io(t);Hc.style.left=e+"px",Hc.style.top=i+"px"}},no=function(){return Gc},so=function(t){Gc=t},ro=function(){return Vc},ao=function(t){Vc=t},lo=function(t){t=`${t}`.toLowerCase().trim();var e=Wc[t];if(e)return e;if(e="#"===(e="0x"===t.substring(0,2)?"#"+t.substring(2):t)[0]?e:"#"+e,/^#[0-9a-f]{6}$/.test(e))return e;if(/^#[0-9a-f]{3}$/.test(e))return["#",e[1],e[1],e[2],e[2],e[3],e[3]].join("");var i=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(t=Number(i[1]),e=Number(i[2]),i=Number(i[3]),0<=t&&256>t&&0<=e&&256>e&&0<=i&&256>i)?ho(t,e,i):null},ho=function(t,e,i){return e=t<<16|e<<8|i,16>t?"#"+(16777216|e).toString(16).substr(1):"#"+e.toString(16)},co=function(t){return(t=lo(t))?[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]:[0,0,0]},uo=function(t,e,i){let o=0,n=0,s=0;if(0===e)s=n=o=i;else{const r=Math.floor(t/60),a=t/60-r;t=i*(1-e);const l=i*(1-e*a);switch(e=i*(1-e*(1-a)),r){case 1:o=l,n=i,s=t;break;case 2:o=t,n=i,s=e;break;case 3:o=t,n=l,s=i;break;case 4:o=e,n=t,s=i;break;case 5:o=i,n=t,s=l;break;case 6:case 0:o=i,n=e,s=t}}return ho(Math.floor(o),Math.floor(n),Math.floor(s))},po=function(t,e,i){return(t=lo(t))&&(e=lo(e))?(t=co(t),e=co(e),ho(Math.round(e[0]+i*(t[0]-e[0])),Math.round(e[1]+i*(t[1]-e[1])),Math.round(e[2]+i*(t[2]-e[2])))):null},go=function(t){return uo(t,Gc,255*Vc)},fo=function(t,e,i){const o=[];var n=t.split("");n.push("");var s=0;t=[];let r=null;for(let h=0;h<n.length;h++){var a=n[h];if(0===s)if("%"===a)(s=t.join(""))&&o.push(s),t.length=0,s=1;else if(i&&"\n"===a){const e=t.join("");e&&o.push(e),t.length=0,o.push(a)}else t.push(a);else if(1===s)"%"===a?(t.push(a),s=0):e&&"0"<=a&&"9">=a?(s=2,r=a,(a=t.join(""))&&o.push(a),t.length=0):"{"===a?s=3:(t.push("%",a),s=0);else if(2===s)if("0"<=a&&"9">=a)r+=a;else{var l=void 0;o.push(parseInt(null!=(l=r)?l:"",10)),h--,s=0}else 3===s&&(""===a?(t.splice(0,0,"%{"),h--,s=0):"}"!==a?t.push(a):(s=t.join(""),/[A-Z]\w*/i.test(s)&&(a=(a=s.toUpperCase()).startsWith("BKY_")?a.substring(4):null)&&a in Ur.Msg$$module$build$src$core$msg?"string"==typeof(s=Ur.Msg$$module$build$src$core$msg[a])?Array.prototype.push.apply(o,fo(s,e,i)):e?o.push(`${s}`):o.push(s):o.push("%{"+s+"}"),s=t.length=0))}for((e=t.join(""))&&o.push(e),l=[],t.length=0,n=0;n<o.length;n++)"string"!=typeof o[n]||i&&"\n"===o[n]?((e=t.join(""))&&l.push(e),t.length=0,l.push(o[n])):t.push(o[n]);return(e=t.join(""))&&l.push(e),t.length=0,l},mo=function(t){return fo(t,!0,!0)},vo=function(t){return"string"!=typeof t?t:(t=fo(t,!1,!1)).length?String(t[0]):""},bo=function(t){let e=!0;const i=Ur.Msg$$module$build$src$core$msg,o=t.match(/%{BKY_[A-Z]\w*}/gi);if(o)for(let n=0;n<o.length;n++)void 0===i[o[n].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+o[n]+" in "+t),e=!1);return e},_o=function(t){const e="string"==typeof t?vo(t):t;var i=Number(e);if(!isNaN(i)&&0<=i&&360>=i)return{hue:i,hex:uo(i,no(),255*ro())};if(i=lo(e))return{hue:null,hex:i};throw i='Invalid colour: "'+e+'"',t!==e&&(i+=' (from "'+t+'")'),Error(i)},yo=function(){return Jc},To=function(t){if(Jc=t,null===t){let t;null==(t=document.querySelector("."+tu))||t.remove()}},Eo=function(){const t=A()||document.body;document.querySelector("."+tu)?Jc=document.querySelector("."+tu):(Jc=document.createElement("div")).className=tu,t.appendChild(Jc)},wo=function(t,e,i,o){if(ko(),qc=t,Qc=i,i=Jc){if(i.style.direction=e?"rtl":"ltr",i.style.display="block",!o&&t instanceof Xc){let e;o=null==(e=t.getSourceBlock())?void 0:e.workspace}var n,s;Zc=null!=(n=o)?n:null,t=null!=(s=o)?s:C(),eu=t.getRenderer().getClassName(),iu=t.getTheme().getClassName(),eu&&et(i,eu),iu&&et(i,iu)}},ko=function(){if(Io()){qc=null;var t=Jc;t&&(t.style.display="none",t.style.left="",t.style.top="",Qc&&Qc(),Qc=null,t.textContent="",eu&&(ot(t,eu),eu=""),iu&&(ot(t,iu),iu=""),C().markFocused())}},Io=function(){return!!qc},$o=function(t){qc===t&&ko()},So=function(t){null!==Zc&&Zc!==t||ko()},Co=function(t,e,i){Jc.style.left=t+"px",Jc.style.top=e+"px",Jc.style.height=i+"px"},Oo=function(t,e,i,o){const n=Ao(t,e,i);t=Ro(t,e,i,o),0>n?Co(t,0,i.height+n):Co(t,n,i.height)},Ro=function(t,e,i,o){return o?Math.min(Math.max(e.right-i.width,t.left),t.right-i.width):Math.max(Math.min(e.left,t.right-i.width),t.left)},Ao=function(t,e,i){return e.bottom+i.height>=t.bottom?e.top-i.height:e.bottom},Mo=function(t){return!(null==t||!t.repositionForWindowResize)},xo=function(){Mo(qc)&&qc.repositionForWindowResize()||ko()},Lo=function(){return nu},Do=function(t){nu=t},No=function(t,e,i,o){if(wo(su,i,Go,o),e.length){var n=Po(e,i,t);ru=n,Bo(n,t,i),setTimeout((function(){n.focus()}),1),nu=null}else Uo()},Po=function(t,e,i){const o=new jh;o.setRole(Uh.MENU);for(let n=0;n<t.length;n++){const s=t[n],r=new Xh(s.text);r.setRightToLeft(e),r.setRole(Uh.MENUITEM),o.addChild(r),r.setEnabled(s.enabled),s.enabled&&r.onAction((function(){Uo(),requestAnimationFrame((()=>{setTimeout((()=>{s.callback(s.scope,i)}),0)}))}),{})}return o},Bo=function(t,e,i){const o=It();e=new Ol(e.clientY+o.top,e.clientY+o.top,e.clientX+o.left,e.clientX+o.left),Fo(t);const n=t.getSize();i&&(e.left+=n.width,e.right+=n.width,o.left+=n.width,o.right+=n.width),Oo(o,e,n,i),t.focus()},Fo=function(t){var e=yo();if(!e)throw Error("Attempting to create a context menu when widget div is null");e=t.render(e),et(e,"blocklyContextMenu"),W(e,"contextmenu",null,Ho),t.focus()},Ho=function(t){t.preventDefault(),t.stopPropagation()},Uo=function(){$o(su),nu=null},Go=function(){ru&&(ru.dispose(),ru=null)},Ur.callbackFactory$$module$build$src$core$contextmenu=function(t,e){return()=>{let i;Ur.disable$$module$build$src$core$events$utils();try{i=e instanceof Element?on(e,t.workspace):je(e,t.workspace);const o=t.getRelativeToSurfaceXY();o.x=t.RTL?o.x-Ur.config$$module$build$src$core$config.snapRadius:o.x+Ur.config$$module$build$src$core$config.snapRadius,o.y+=2*Ur.config$$module$build$src$core$config.snapRadius,i.moveBy(o.x,o.y)}finally{Ur.enable$$module$build$src$core$events$utils()}return b()&&!i.isShadow()&&p(new(E(Ur.CREATE$$module$build$src$core$events$utils))(i)),Ur.setSelected$$module$build$src$core$common(i),i}},Vo=function(t,e=!1){const i=Ur.createElement$$module$build$src$core$utils$xml("xml");var o=zo(Ur.allUsedVarModels$$module$build$src$core$variables(t));o.hasChildNodes()&&i.appendChild(o);for(const o of t.getTopComments())i.appendChild(Wo(o,e));for(t=t.getTopBlocks(!0),o=0;o<t.length;o++)i.appendChild(jo(t[o],e));return i},Wo=function(t,e=!1){const i=Ur.createElement$$module$build$src$core$utils$xml("comment");e||i.setAttribute("id",t.id),e=t.workspace;const o=t.getRelativeToSurfaceXY();return o.x=e.RTL?e.getWidth()-o.x:o.x,i.setAttribute("x",`${o.x}`),i.setAttribute("y",`${o.y}`),i.setAttribute("w",`${t.getSize().width}`),i.setAttribute("h",`${t.getSize().height}`),t.getText()&&(i.textContent=t.getText()),t.isCollapsed()&&i.setAttribute("collapsed","true"),t.isOwnEditable()||i.setAttribute("editable","false"),t.isOwnMovable()||i.setAttribute("movable","false"),t.isOwnDeletable()||i.setAttribute("deletable","false"),i},zo=function(t){const e=Ur.createElement$$module$build$src$core$utils$xml("variables");for(let i=0;i<t.length;i++){const o=t[i],n=Ur.createElement$$module$build$src$core$utils$xml("variable");n.appendChild(Ur.createTextNode$$module$build$src$core$utils$xml(o.name)),o.type&&n.setAttribute("type",o.type),n.id=o.getId(),e.appendChild(n)}return e},jo=function(t,e){if(t.isInsertionMarker()&&!(t=t.getChildren(!1)[0]))return new DocumentFragment;let i=0;if(t.workspace.RTL&&(i=t.workspace.getWidth()),e=Ko(t,e),mn(e)){const o=t.getRelativeToSurfaceXY();e.setAttribute("x",String(Math.round(t.workspace.RTL?i-o.x:o.x))),e.setAttribute("y",String(Math.round(o.y)))}return e},Xo=function(t){if(t.isSerializable()){const e=Ur.createElement$$module$build$src$core$utils$xml("field");return e.setAttribute("name",t.name||""),t.toXml(e)}return null},Yo=function(t,e){for(let i=0;i<t.inputList.length;i++){const o=t.inputList[i];for(let t=0;t<o.fieldRow.length;t++){const i=Xo(o.fieldRow[t]);i&&e.appendChild(i)}}},Ko=function(t,e){if(t.isInsertionMarker())return(e=t.getChildren(!1)[0])?Ko(e):new DocumentFragment;const i=Ur.createElement$$module$build$src$core$utils$xml(t.isShadow()?"shadow":"block");if(i.setAttribute("type",t.type),e||(i.id=t.id),t.mutationToDom){var o=t.mutationToDom();o&&(o.hasChildNodes()||o.hasAttributes())&&i.appendChild(o)}if(Yo(t,i),o=t.getCommentText()){var n=t.getIcon(lh.COMMENT),s=n.getBubbleSize();n=n.bubbleIsVisible();var r=Ur.createElement$$module$build$src$core$utils$xml("comment");r.appendChild(Ur.createTextNode$$module$build$src$core$utils$xml(o)),r.setAttribute("pinned",`${n}`),r.setAttribute("h",String(s.height)),r.setAttribute("w",String(s.width)),i.appendChild(r)}for(t.data&&((o=Ur.createElement$$module$build$src$core$utils$xml("data")).appendChild(Ur.createTextNode$$module$build$src$core$utils$xml(t.data)),i.appendChild(o)),o=0;o<t.inputList.length;o++){var a=void 0;if(n=!0,(s=t.inputList[o]).type!==Ur.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&s.type!==Ur.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){r=s.connection.targetBlock(),s.type===Ur.inputTypes$$module$build$src$core$inputs$input_types.VALUE?a=Ur.createElement$$module$build$src$core$utils$xml("value"):s.type===Ur.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(a=Ur.createElement$$module$build$src$core$utils$xml("statement"));const t=s.connection.getShadowDom();!t||r&&r.isShadow()||a.appendChild(Jo(t,e)),r&&(r=Ko(r,e)).nodeType===_l.ELEMENT_NODE&&(a.appendChild(r),n=!1),a.setAttribute("name",s.name),n||i.appendChild(a)}}let l;return void 0!==t.inputsInline&&t.inputsInline!==t.inputsInlineDefault&&i.setAttribute("inline",String(t.inputsInline)),t.isCollapsed()&&i.setAttribute("collapsed","true"),t.isEnabled()||i.setAttribute("disabled-reasons",Array.from(t.getDisabledReasons()).map(encodeURIComponent).join(",")),t.isOwnDeletable()||i.setAttribute("deletable","false"),t.isOwnMovable()||i.setAttribute("movable","false"),t.isOwnEditable()||i.setAttribute("editable","false"),(a=t.getNextBlock())&&(o=Ko(a,e)).nodeType===_l.ELEMENT_NODE&&(l=Ur.createElement$$module$build$src$core$utils$xml("next"),l.appendChild(o),i.appendChild(l)),!(t=t.nextConnection&&t.nextConnection.getShadowDom())||a&&a.isShadow()||l.appendChild(Jo(t,e)),i},Jo=function(t,e){let i,o=t=t.cloneNode(!0);for(;o;)if(e&&"shadow"===o.nodeName&&o.removeAttribute("id"),o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;){let t;i=o,o=o.parentNode,i.nodeType===_l.TEXT_NODE&&""===i.data.trim()&&(null==(t=o)?void 0:t.firstChild)!==i&&st(i)}o&&(i=o,o=o.nextSibling,i.nodeType===_l.TEXT_NODE&&""===i.data.trim()&&st(i))}return t},qo=function(t){return Rt(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Zo=function(t){t=qo(t).split("<");let e="";for(let i=1;i<t.length;i++){const o=t[i];"/"===o[0]&&(e=e.substring(2)),t[i]=e+"<"+o,"/"!==o[0]&&"/>"!==o.slice(-2)&&(e+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Qo=function(t,e){return e.setResizesEnabled(!1),e.clear(),t=Ur.domToWorkspace$$module$build$src$core$xml(t,e),e.setResizesEnabled(!0),t},Ur.domToWorkspace$$module$build$src$core$xml=function(t,e){let i=0;e.RTL&&(i=e.getWidth());const o=[];lt();const n=Ur.getGroup$$module$build$src$core$events$utils();n||Ur.setGroup$$module$build$src$core$events$utils(!0),e.setResizesEnabled&&e.setResizesEnabled(!1);let s=!0;try{for(let n,r=0;n=t.childNodes[r];r++){const t=n.nodeName.toLowerCase(),r=n;if("block"===t||"shadow"===t&&!d()){const t=on(r,e);let n;o.push(t.id);const a=parseInt(null!=(n=r.getAttribute("x"))?n:"10",10);let l;const h=parseInt(null!=(l=r.getAttribute("y"))?l:"10",10);isNaN(a)||isNaN(h)||t.moveBy(e.RTL?i-a:a,h,["create"]),s=!1}else{if("shadow"===t)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===t)tn(r,e);else if("variables"===t){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");nn(r,e),s=!1}}}}finally{Ur.setGroup$$module$build$src$core$events$utils(n),e.setResizesEnabled&&e.setResizesEnabled(!0),e.rendered&&be(),ht()}return p(new(E(ma))(e)),o},tn=function(t,e){var i;const o=null!=(i=t.getAttribute("id"))?i:void 0;var n,s;let r;var a;let l;return(i=e.rendered?new uu(e,o):new Ah(e,o)).setText(null!=(n=t.textContent)?n:""),n=parseInt(null!=(s=t.getAttribute("x"))?s:"",10),s=parseInt(null!=(r=t.getAttribute("y"))?r:"",10),isNaN(n)||isNaN(s)||(n=e.RTL?e.getWidth()-n:n,i.moveTo(new yl(n,s))),e=parseInt(null!=(a=t.getAttribute("w"))?a:"",10),a=parseInt(null!=(l=t.getAttribute("h"))?l:"",10),isNaN(e)||isNaN(a)||i.setSize(new Rl(e,a)),"true"===t.getAttribute("collapsed")&&i.setCollapsed(!0),"false"===t.getAttribute("editable")&&i.setEditable(!1),"false"===t.getAttribute("movable")&&i.setMovable(!1),"false"===t.getAttribute("deletable")&&i.setDeletable(!1),i},en=function(t,e){if(!e.getBlocksBoundingBox)return Ur.domToWorkspace$$module$build$src$core$xml(t,e);var i=e.getBlocksBoundingBox();if(t=Ur.domToWorkspace$$module$build$src$core$xml(t,e),i&&i.top!==i.bottom){var o=i.bottom;i=e.RTL?i.right:i.left;var n=1/0;let s=-1/0,r=1/0;for(let i=0;i<t.length;i++){const o=e.getBlockById(t[i]).getRelativeToSurfaceXY();o.y<r&&(r=o.y),o.x<n&&(n=o.x),o.x>s&&(s=o.x)}for(o=o-r+10,i=e.RTL?i-s:i-n,n=0;n<t.length;n++)e.getBlockById(t[n]).moveBy(i,o,["create"])}return t},Ur.domToBlock$$module$build$src$core$xml=function(t,e){return t=on(t,e),e.rendered&&be(),t},on=function(t,e){Ur.disable$$module$build$src$core$events$utils();var i=e.getAllVariables();let o;try{if(o=pn(t,e),e.rendered){const t=o,i=o.getDescendants(!1);t.setConnectionTracking(!1);for(let t=i.length-1;0<=t;t--)i[t].initSvg();for(let t=i.length-1;0<=t;t--)i[t].queueRender();setTimeout((function(){t.disposed||t.setConnectionTracking(!0)}),1),e.resizeContents()}else{const t=o.getDescendants(!1);for(let e=t.length-1;0<=e;e--)t[e].initModel()}}finally{Ur.enable$$module$build$src$core$events$utils()}if(b()){for(t=fe(e,i),e=0;e<t.length;e++)i=t[e],p(new(E(Zr))(i));p(new(E(Ur.CREATE$$module$build$src$core$events$utils))(o))}return o},nn=function(t,e){for(let o=0;o<t.children.length;o++){var i=t.children[o];const n=i.getAttribute("type"),s=i.getAttribute("id");if(!(i=i.textContent))break;e.createVariable(i,n,s)}},sn=function(t){const e={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let i=0;i<t.children.length;i++){const o=t.children[i];if(o.nodeType!==_l.TEXT_NODE)switch(o.nodeName.toLowerCase()){case"mutation":e.mutation.push(o);break;case"comment":e.comment.push(o);break;case"data":e.data.push(o);break;case"title":case"field":e.field.push(o);break;case"value":case"statement":e.input.push(o);break;case"next":e.next.push(o);break;default:console.warn("Ignoring unknown tag: "+o.nodeName)}}return e},rn=function(t,e){let i=!1;for(let o=0;o<t.length;o++){const n=t[o];e.domToMutation&&(e.domToMutation(n),e.initSvg&&(i=!0))}return i},an=function(t,e){for(let o=0;o<t.length;o++){var i=t[o];const n=i.textContent,s="true"===i.getAttribute("pinned");let r;const a=parseInt(null!=(r=i.getAttribute("w"))?r:"50",10);let l;i=parseInt(null!=(l=i.getAttribute("h"))?l:"50",10),e.setCommentText(n);const h=e.getIcon(lh.COMMENT);isNaN(a)||isNaN(i)||h.setBubbleSize(new Rl(a,i)),h.setBubbleVisible(s),setTimeout((()=>h.setBubbleVisible(s)),1)}},ln=function(t,e){for(let i=0;i<t.length;i++)e.data=t[i].textContent},hn=function(t,e){for(let i=0;i<t.length;i++){const o=t[i],n=o.getAttribute("name");n?gn(e,n,o):console.warn(`Ignoring unnamed field in block ${e.type}`)}},cn=function(t){let e=null,i=null;for(let o=0;o<t.childNodes.length;o++){const n=t.childNodes[o];mn(n)&&("block"===n.nodeName.toLowerCase()?e=n:"shadow"===n.nodeName.toLowerCase()&&(i=n))}return{childBlockElement:e,childShadowElement:i}},un=function(t,e,i,o){for(let s=0;s<t.length;s++){var n=t[s];const r=n.getAttribute("name"),a=r?i.getInput(r):null;if(!a){console.warn("Ignoring non-existent input "+r+" in block "+o);break}if((n=cn(n)).childBlockElement){if(!a.connection)throw TypeError("Input connection does not exist.");pn(n.childBlockElement,e,a.connection,!1)}if(n.childShadowElement){let t;null==(t=a.connection)||t.setShadowDom(n.childShadowElement)}}},dn=function(t,e,i){for(let o=0;o<t.length;o++){const n=cn(t[o]);if(n.childBlockElement){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");pn(n.childBlockElement,e,i.nextConnection,!0)}n.childShadowElement&&i.nextConnection&&i.nextConnection.setShadowDom(n.childShadowElement)}},pn=function(t,e,i,o){var n;const s=t.getAttribute("type");if(!s)throw TypeError("Block type unspecified: "+t.outerHTML);var r=null!=(n=t.getAttribute("id"))?n:void 0;n=e.newBlock(s,r),r=sn(t);const a=rn(r.mutation,n);if(an(r.comment,n),ln(r.data,n),i)if(o){if(!n.previousConnection)throw TypeError("Next block does not have previous statement.");i.connect(n.previousConnection)}else if(n.outputConnection)i.connect(n.outputConnection);else{if(!n.previousConnection)throw TypeError("Child block does not have output or previous statement.");i.connect(n.previousConnection)}if(hn(r.field,n),un(r.input,e,n,s),dn(r.next,e,n),a&&n.initSvg(),(e=t.getAttribute("inline"))&&n.setInputsInline("true"===e),(e=t.getAttribute("disabled"))&&n.setDisabledReason("true"===e||"disabled"===e,rh),null!==(e=t.getAttribute("disabled-reasons")))for(var l of e.split(","))n.setDisabledReason(!0,decodeURIComponent(l));if((l=t.getAttribute("deletable"))&&n.setDeletable("true"===l),(l=t.getAttribute("movable"))&&n.setMovable("true"===l),(l=t.getAttribute("editable"))&&n.setEditable("true"===l),(l=t.getAttribute("collapsed"))&&n.setCollapsed("true"===l),"shadow"===t.nodeName.toLowerCase()){for(t=n.getChildren(!1),l=0;l<t.length;l++)if(!t[l].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");n.setShadow(!0)}return n},gn=function(t,e,i){const o=t.getField(e);o?o.fromXml(i):console.warn("Ignoring non-existent field "+e+" in block "+t.type)},fn=function(t){for(let e=0;e<t.childNodes.length;e++){const i=t.childNodes[e];if("next"===i.nodeName.toLowerCase()){t.removeChild(i);break}}},mn=function(t){return t.nodeType===_l.ELEMENT_NODE},vn=function(t){if(!(100<t.getDescendants(!1).length)){var e=t.workspace,i=t.getSvgRoot();e.getAudioManager().play("delete");var o,n=t.getRelativeToSurfaceXY(),s=i.cloneNode(!0);s.setAttribute("transform","translate("+n.x+","+n.y+")"),null==(o=e.getLayerManager())||o.appendToAnimationLayer({getSvgRoot:()=>s}),bn(s,{x:n.x,y:n.y,width:t.width,height:t.height},e.RTL,new Date)}},bn=function(t,e,i,o){const n=((new Date).getTime()-o.getTime())/150;1<n?st(t):(t.setAttribute("transform","translate("+(e.x+(i?-1:1)*e.width/2*n)+","+(e.y+e.height/2*n)+") scale("+(1-n)+")"),setTimeout(bn,10,t,e,i,o))},_n=function(t){var e=t.workspace;const i=e.scale;if(e.getAudioManager().play("click"),!(1>i)){var o=e.getSvgXY(t.getSvgRoot());t.outputConnection?(o.x+=(t.RTL?3:-3)*i,o.y+=13*i):t.previousConnection&&(o.x+=(t.RTL?-23:23)*i,o.y+=3*i);var n=tt(Cl.CIRCLE,{cx:o.x,cy:o.y,r:0,fill:"none",stroke:"#888","stroke-width":10},e.getParentSvg());t=tt(Cl.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},n),e=tt(Cl.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},n),t.beginElement(),e.beginElement(),setTimeout((()=>{st(n)}),150)}},yn=function(t){if(En(),t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var e=t.getHeightWidth().height;e=Math.atan(10/e)/Math.PI*180,t.RTL||(e*=-1),yu=t,Tn(t,e,new Date)}},Tn=function(t,e,i){const o=((new Date).getTime()-i.getTime())/200;let n="";1>=o&&(n=`skewX(${Math.round(Math.sin(o*Math.PI*3)*(1-o)*e)})`,_u=setTimeout(Tn,10,t,e,i)),t.getSvgRoot().setAttribute("transform",`${t.getTranslation()} ${n}`)},En=function(){yu&&(_u&&(clearTimeout(_u),_u=null),yu.getSvgRoot().setAttribute("transform",yu.getTranslation()),yu=null)},wn=function(t){return void 0!==t.getRelativeToSurfaceXY&&void 0!==t.isMovable&&void 0!==t.startDrag&&void 0!==t.drag&&void 0!==t.endDrag&&void 0!==t.revertDrag},kn=function(t,e){for(const i in e)t[i]=null!==e[i]&&"object"==typeof e[i]?kn(t[i]||Object.create(null),e[i]):e[i];return t},In=function(t){return void 0!==t.getProcedureModel&&void 0!==t.doProcedureUpdate&&void 0!==t.isProcedureDef},$n=function(t){return void 0!==t.startPublishing&&void 0!==t.stopPublishing},Sn=function(e,i){t(jr.FIELD,e,i)},Cn=function(t){o(jr.FIELD,t)},Ur.fromJson$$module$build$src$core$field_registry=function(t){return Au.fromJsonInternal(t)},On=function(t){const e=a(jr.FIELD,t.type);return e?e.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Rn=function(t){let e=!1;const i=t.map((([t,i])=>"string"==typeof t?[vo(t),i]:(e=!0,[null!==t.alt?Object.assign({},t,{alt:vo(t.alt)}):Object.assign({},t),i])));if(e||2>t.length)return{options:i};var o=i.map((([t])=>t)),n=Ai(o);t=Mi(o,n);const s=xi(o,n);return!t&&!s||n<=t+s?{options:i}:(n=t?o[0].substring(0,t-1):void 0,o=s?o[0].substr(1-s):void 0,{options:An(i,t,s),prefix:n,suffix:o})},An=function(t,e,i){return t.map((([t,o])=>[t.substring(e,t.length-i),o]))},Mn=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let e=!1;for(let i=0;i<t.length;i++){const o=t[i];Array.isArray(o)?"string"!=typeof o[1]?(e=!0,console.error("Invalid option["+i+"]: Each FieldDropdown option id must be a string. Found "+o[1]+" in: ",o)):o[0]&&"string"!=typeof o[0]&&"string"!=typeof o[0].src&&(e=!0,console.error("Invalid option["+i+"]: Each FieldDropdown option must have a string label or image description. Found"+o[0]+" in: ",o)):(e=!0,console.error("Invalid option["+i+"]: Each FieldDropdown option must be an array. Found: ",o))}if(e)throw TypeError("Found invalid FieldDropdown options.")},Ur.register$$module$build$src$core$extensions=function(t,e){if("string"!=typeof t||""===t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(Fu[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof e)throw Error('Error: Extension "'+t+'" must be a function');Fu[t]=e},Ur.registerMixin$$module$build$src$core$extensions=function(t,e){if(!e||"object"!=typeof e)throw Error('Error: Mixin "'+t+'" must be a object');Ur.register$$module$build$src$core$extensions(t,(function(){this.mixin(e)}))},Ur.registerMutator$$module$build$src$core$extensions=function(t,e,i,o){const n='Error when registering mutator "'+t+'": ';Un(n,e);const s=Fn(e,n);if(i&&"function"!=typeof i)throw Error(n+'Extension "'+t+'" is not a function');Ur.register$$module$build$src$core$extensions(t,(function(){s&&this.setMutator(new Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon(o||[],this)),this.mixin(e),i&&i.apply(this)}))},xn=function(t){Ln(t)?delete Fu[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},Ln=function(t){return!!Fu[t]},Dn=function(t,e,i){const o=Fu[t];if("function"!=typeof o)throw Error('Error: Extension "'+t+'" not found.');let n;if(i?Nn(t,e):n=Gn(e),o.apply(e),i)Un('Error after applying mutator "'+t+'": ',e);else if(!Vn(n,e))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},Nn=function(t,e){if(Gn(e).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+e.id)},Pn=function(t,e){return Hn(t.mutationToDom,t.domToMutation,e+" mutationToDom/domToMutation")},Bn=function(t,e){return Hn(t.saveExtraState,t.loadExtraState,e+" saveExtraState/loadExtraState")},Fn=function(t,e){return Hn(t.compose,t.decompose,e+" compose/decompose")},Hn=function(t,e,i){if(t&&e){if("function"!=typeof t||"function"!=typeof e)throw Error(i+" must be a function");return!0}if(!t&&!e)return!1;throw Error(i+"Must have both or neither functions")},Un=function(t,e){const i=Pn(e,t),o=Bn(e,t);if(!i&&!o)throw Error(t+"Mutations must contain either XML hooks, or JSON hooks, or both");Fn(e,t)},Gn=function(t){const e=[];return void 0!==t.domToMutation&&e.push(t.domToMutation),void 0!==t.mutationToDom&&e.push(t.mutationToDom),void 0!==t.saveExtraState&&e.push(t.saveExtraState),void 0!==t.loadExtraState&&e.push(t.loadExtraState),void 0!==t.compose&&e.push(t.compose),void 0!==t.decompose&&e.push(t.decompose),e},Vn=function(t,e){if((e=Gn(e)).length!==t.length)return!1;for(let i=0;i<e.length;i++)if(t[i]!==e[i])return!1;return!0},Wn=function(t){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)t();else{const e=setInterval((function(){"complete"===document.readyState&&(clearInterval(e),t())}),10)}},Ur.buildTooltipForDropdown$$module$build$src$core$extensions=function(t,e){const i=[];return function(){i.includes(this.type)||(zn(this,t,e),i.push(this.type)),this.setTooltip(function(){const i=String(this.getFieldValue(t));return vo(e[i])}.bind(this))}},zn=function(t,e,i){var o=t.getField(e);if(o instanceof xu&&!o.isOptionListDynamic()){o=o.getOptions();for(const[,n]of o)void 0===i[n]&&console.warn(`No tooltip mapping for value ${n} of field ${e} of block type ${t.type}.`)}},Ur.buildTooltipWithFieldText$$module$build$src$core$extensions=function(t,e){return function(){this.setTooltip(function(){const i=this.getField(e);return vo(t).replace("%1",i?i.getText():"")}.bind(this))}},jn=function(){const t=this.tooltip;this.setTooltip(function(){const e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||t}.bind(this))},Xn=function(t,e,i,o){t=t+" was deprecated in "+e+" and will be deleted in "+i+".",o&&(t+="\nUse "+o+" instead."),Vu.has(t)||(Vu.add(t),console.warn(t))},Yn=function(t,e){return" "+t+","+e+" "},Kn=function(t,e){return" "+t+e.join("")},Jn=function(t,e){return" M "+t+","+e+" "},qn=function(t,e){return" m "+t+","+e+" "},Zn=function(t,e){return" l "+t+","+e+" "},Qn=function(t){return" l"+t.join("")},ts=function(t,e){return" "+t+" "+e+" "},es=function(t,e,i,o){return t+" "+i+" "+i+" "+e+o},is=function(e,i){t(jr.ICON,e.toString(),i)},os=function(t){o(jr.ICON,t)},ns=function(t){const e=t.getProcedureMap().getProcedures().filter((t=>!t.getReturnTypes())).map((t=>[t.getName(),t.getParameters().map((t=>t.getName())),!1]));t.getBlocksByType("procedures_defnoreturn",!1).forEach((t=>{!In(t)&&Qt(t)&&e.push(t.getProcedureDef())}));const i=t.getProcedureMap().getProcedures().filter((t=>!!t.getReturnTypes())).map((t=>[t.getName(),t.getParameters().map((t=>t.getName())),!0]));return t.getBlocksByType("procedures_defreturn",!1).forEach((t=>{!In(t)&&Qt(t)&&i.push(t.getProcedureDef())})),e.sort(ss),i.sort(ss),[e,i]},ss=function(t,e){return t[0].localeCompare(e[0],void 0,{sensitivity:"base"})},Ur.findLegalName$$module$build$src$core$procedures=function(t,e){if(e.isInFlyout)return t;for(t=t||Ur.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!rs(t,e.workspace,e);){const e=t.match(/^(.*?)(\d+)$/);t=e?e[1]+(parseInt(e[2])+1):t+"2"}return t},rs=function(t,e,i){return!as(t,e,i)},as=function(t,e,i){for(const o of e.getAllBlocks(!1))if(o!==i&&Qt(o)&&Ur.Names$$module$build$src$core$names.equals(o.getProcedureDef()[0],t))return!0;i=i&&In(i)?null==i?void 0:i.getProcedureModel():void 0;for(const o of e.getProcedureMap().getProcedures())if(o!==i&&Ur.Names$$module$build$src$core$names.equals(o.getName(),t))return!0;return!1},Ur.rename$$module$build$src$core$procedures=function(t){var e=this.getSourceBlock();if(!e)throw new Yc;t=t.trim();const i=Ur.findLegalName$$module$build$src$core$procedures(t,e);In(e)&&!e.isInsertionMarker()&&e.getProcedureModel().setName(i);const o=this.getValue();if(o!==t&&o!==i)for(t=e.workspace.getAllBlocks(!1),e=0;e<t.length;e++){const n=t[e];n.renameProcedure&&n.renameProcedure(o,i)}return i},ls=function(t){function e(t,e){for(let n=0;n<t.length;n++){var o=t[n][0];const s=t[n][1],r=Ur.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type",e),r.setAttribute("gap","16");const a=Ur.createElement$$module$build$src$core$utils$xml("mutation");for(a.setAttribute("name",o),r.appendChild(a),o=0;o<s.length;o++){const t=Ur.createElement$$module$build$src$core$utils$xml("arg");t.setAttribute("name",s[o]),a.appendChild(t)}i.push(r)}}const i=[];if(Ea.procedures_defnoreturn){var o=Ur.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type","procedures_defnoreturn"),o.setAttribute("gap","16");var n=Ur.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),n.appendChild(Ur.createTextNode$$module$build$src$core$utils$xml(Ur.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),o.appendChild(n),i.push(o)}return Ea.procedures_defreturn&&((o=Ur.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),o.setAttribute("gap","16"),(n=Ur.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(Ur.createTextNode$$module$build$src$core$utils$xml(Ur.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),o.appendChild(n),i.push(o)),Ea.procedures_ifreturn&&((o=Ur.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),o.setAttribute("gap","16"),i.push(o)),i.length&&i[i.length-1].setAttribute("gap","24"),e((t=ns(t))[0],"procedures_callnoreturn"),e(t[1],"procedures_callreturn"),i},hs=function(t){var e=[],i=t.getBlocksByType("procedures_mutatorarg",!1);for(let t,o=0;t=i[o];o++)e.push(t.getFieldValue("NAME"));i=Ur.createElement$$module$build$src$core$utils$xml("xml");const o=Ur.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type","procedures_mutatorarg");const n=Ur.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),e=se(Ur.DEFAULT_ARG$$module$build$src$core$procedures,e),e=Ur.createTextNode$$module$build$src$core$utils$xml(e),n.appendChild(e),o.appendChild(n),i.appendChild(o),t.updateToolbox(i)},cs=function(t){if(t.type===ra&&"mutator"===t.bubbleType&&t.isOpen&&t.blockId){var e=(t=k(t.workspaceId).getBlockById(t.blockId)).type;"procedures_defnoreturn"!==e&&"procedures_defreturn"!==e||(t=t.getIcon(Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),hs(t),t.addChangeListener(us))}},us=function(t){t.type!==Ur.CREATE$$module$build$src$core$events$utils&&t.type!==Ur.DELETE$$module$build$src$core$events$utils&&t.type!==Ur.CHANGE$$module$build$src$core$events$utils&&t.type!==qr||(t=k(t.workspaceId),hs(t))},ds=function(t,e){return e.getAllBlocks(!1).filter((e=>ps(e,t)||te(e)&&Ur.Names$$module$build$src$core$names.equals(e.getProcedureCall(),t)))},ps=function(t,e){return In(t)&&!t.isProcedureDef()&&t.getProcedureModel()&&Ur.Names$$module$build$src$core$names.equals(t.getProcedureModel().getName(),e)},Ur.mutateCallers$$module$build$src$core$procedures=function(t){const e=d();var i=t.getProcedureDef()[0];const o=t.mutationToDom(!0);t=ds(i,t.workspace);for(let s,r=0;s=t[r];r++){i=(i=s.mutationToDom())&&Rt(i),s.domToMutation&&s.domToMutation(o);var n=s.mutationToDom();i!==(n=n&&Rt(n))&&(Ur.setRecordUndo$$module$build$src$core$events$utils(!1),p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(s,"mutation",null,i,n)),Ur.setRecordUndo$$module$build$src$core$events$utils(e))}},Ur.getDefinition$$module$build$src$core$procedures=function(t,e){for(const i of e.getAllBlocks(!1))if(In(i)&&i.isProcedureDef()&&Ur.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),t)||Qt(i)&&Ur.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],t))return i;return null},gs=function(t){return t.isDynamic},fs=function(t){return void 0!==t.pathDown&&void 0!==t.pathUp},ms=function(t){return void 0!==t.pathLeft&&void 0!==t.pathRight},vs=function(t,e){if(!t||!e)throw Error("Cannot connect null connections.");t.targetConnection=e,e.targetConnection=t},bs=function(t,e){let i=null;const o=null==(e=e.outputConnection)?void 0:e.getConnectionChecker();for(let n,s=0;n=t.inputList[s];s++){const t=n.connection;let s;if(t&&null!=(s=o)&&s.canConnect(e,t,!1)){if(i)return null;i=t}}return i},_s=function(t,e){let i;for(;i=bs(t,e);)if(!(t=i.targetBlock())||t.isShadow())return i;return null},ys=function(t){return void 0!==t.getType&&void 0!==t.initView&&void 0!==t.dispose&&void 0!==t.getWeight&&void 0!==t.getSize&&void 0!==t.applyColour&&void 0!==t.hideForInsertionMarker&&void 0!==t.updateEditable&&void 0!==t.updateCollapsed&&void 0!==t.isShownWhenCollapsed&&void 0!==t.setOffsetInBlock&&void 0!==t.onLocationChange&&void 0!==t.onClick},Ts=function(t){return ys(t)&&si(t)&&De(t)&&void 0!==t.setText&&void 0!==t.getText&&void 0!==t.setBubbleSize&&void 0!==t.getBubbleSize&&t.getType()===lh.COMMENT},Es=function(t){let e=t.outputConnection;return(!e||t.previousConnection&&t.previousConnection.isConnected())&&(e=t.previousConnection),e},ws=function(e,i){t(jr.RENDERER,e,i)},ks=function(t){o(jr.RENDERER,t)},Is=function(t,e,i){return(t=new(r(jr.RENDERER,t))(t)).init(e,i),t},$s=function(t){re(t.getTargetWorkspace(),void 0,"String")},Ss=function(t){re(t.getTargetWorkspace(),void 0,"Number")},Cs=function(t){re(t.getTargetWorkspace(),void 0,"Colour")},Os=function(t){let e=[],i=document.createElement("button");return i.setAttribute("text",Ur.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),e.push(i),i=document.createElement("button"),i.setAttribute("text",Ur.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),e.push(i),i=document.createElement("button"),i.setAttribute("text",Ur.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),e.push(i),t.registerButtonCallback("CREATE_VARIABLE_STRING",$s),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",Ss),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",Cs),t=Rs(t),e.concat(t)},Rs=function(t){const e=[];if(0<(t=t.getAllVariables()).length){if(Ea.variables_set_dynamic){var i=t[t.length-1];const o=Ur.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type","variables_set_dynamic"),o.setAttribute("gap","24"),o.appendChild(pe(i)),e.push(o)}if(Ea.variables_get_dynamic){t.sort(_h.compareByName);for(let o,n=0;o=t[n];n++)(i=Ur.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),i.setAttribute("gap","8"),i.appendChild(pe(o)),e.push(i)}}return e},As=function(t){t.resizeContents()},Ms=function(t,e){const i=t.workspace,o=Ur.config$$module$build$src$core$config.snapRadius,n=yl.difference(e,t.getRelativeToSurfaceXY()),s=new yl(0,0),r=i.getAllBlocks(!1).filter((e=>e.id!=t.id)).map((t=>t.getRelativeToSurfaceXY()));for(;xs(yl.sum(e,s),r)||Ls(t,yl.sum(n,s),o);)i.RTL?s.translate(-o,2*o):s.translate(o,2*o);t.moveTo(yl.sum(e,s))},xs=function(t,e){return e.some((e=>1>=Math.abs(e.x-t.x)&&1>=Math.abs(e.y-t.y)))},Ls=function(t,e,i){return t.getConnections_(!1).some((t=>!!t.closest(i,e).connection))},Ds=function(t,e,i){const o=i.getBoundingRectangle(),n=o.right-o.left,s=li(e.top,o.top,e.top+e.height-(o.bottom-o.top))-o.top;let r=e.left;return e=e.left+e.width-n,t.RTL?r=Math.min(e,r):e=Math.max(r,e),!(!(t=li(r,o.left,e)-o.left)&&!s||(i.moveBy(t,s,["inbounds"]),0))},Ns=function(t){return e=>{var i,o=t.getMetricsManager();if(o.hasFixedEdges()&&!t.isDragging())if(ba.includes(null!=(i=e.type)?i:"")){i=o.getScrollMetrics(!0);const n=Ps(t,e);n&&(o=Ur.getGroup$$module$build$src$core$events$utils()||!1,Ur.setGroup$$module$build$src$core$events$utils(e.group),Ds(t,i,n)&&!e.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),Ur.setGroup$$module$build$src$core$events$utils(o))}else e.type===ca&&e.scale&&e.oldScale&&e.scale>e.oldScale&&Bs(t)}},Ps=function(t,e){let i=null;switch(e.type){case Ur.CREATE$$module$build$src$core$events$utils:case Ur.MOVE$$module$build$src$core$events$utils:(i=t.getBlockById(e.blockId))&&(i=i.getRootBlock());break;case ua:case ga:i=t.getCommentById(e.commentId)}return i},Bs=function(t){var e=t.getMetricsManager();if(e.hasFixedEdges()&&!t.isDragging()){e=e.getScrollMetrics(!0);var i=t.getTopBoundedElements();for(let o,n=0;o=i[n];n++)Ds(t,e,o)}},Fs=function(t){return void 0!==t.isDeletable&&void 0!==t.dispose&&void 0!==t.setDeleteStyle},Hs=function(t){const e=t.toCopyData();let i;return Up=e,Gp=null!=(i=t.workspace)?i:null,e},Us=function(t,e,i){return t&&e?Gs(t,e,i):Up&&Gp?Gs(Up,Gp):null},Gs=function(t,e,i){let o,n,s;return e=null!=(o=e.getRootWorkspace())?o:e,null!=(s=null==(n=a(jr.PASTER,t.paster,!1))?void 0:n.paste(t,e,i))?s:null},Vs=function(t){const e=t.toCopyData();return e?Us(e,t.workspace):null},Ws=function(t){return void 0!==t.toCopyData},zs=function(){Fp.registry.register({name:Hp.ESCAPE,preconditionFn:t=>!t.options.readOnly,callback:t=>(t.hideChaff(),!0),keyCodes:[Gu.ESC]})},js=function(){Fp.registry.register({name:Hp.DELETE,preconditionFn(t){const e=R();return!t.options.readOnly&&null!=e&&Fs(e)&&e.isDeletable()&&!wu.inProgress()},callback:(t,e)=>(e.preventDefault(),(t=R())instanceof Tp?t.checkAndDelete():Fs(t)&&t.isDeletable()&&(Ur.setGroup$$module$build$src$core$events$utils(!0),t.dispose(),Ur.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[Gu.DELETE,Gu.BACKSPACE]})},Xs=function(){const t=Fp.registry.createSerializedKey(Gu.C,[Gu.CTRL]),e=Fp.registry.createSerializedKey(Gu.C,[Gu.ALT]),i=Fp.registry.createSerializedKey(Gu.C,[Gu.META]);Fp.registry.register({name:Hp.COPY,preconditionFn(t){const e=R();return!t.options.readOnly&&!wu.inProgress()&&null!=e&&Fs(e)&&e.isDeletable()&&wn(e)&&e.isMovable()&&Ws(e)},callback:(t,e)=>(e.preventDefault(),t.hideChaff(),!(!(e=R())||!Ws(e)||(zp=e.toCopyData(),jp=t,Xp=wn(e)?e.getRelativeToSurfaceXY():null,!zp))),keyCodes:[t,e,i]})},Ys=function(){const t=Fp.registry.createSerializedKey(Gu.X,[Gu.CTRL]),e=Fp.registry.createSerializedKey(Gu.X,[Gu.ALT]),i=Fp.registry.createSerializedKey(Gu.X,[Gu.META]);Fp.registry.register({name:Hp.CUT,preconditionFn(t){const e=R();return!t.options.readOnly&&!wu.inProgress()&&null!=e&&Fs(e)&&e.isDeletable()&&wn(e)&&e.isMovable()&&!e.workspace.isFlyout},callback(t){const e=R();return e instanceof Tp?(zp=e.toCopyData(),jp=t,Xp=e.getRelativeToSurfaceXY(),e.checkAndDelete(),!0):!!(Fs(e)&&e.isDeletable()&&Ws(e))&&(zp=e.toCopyData(),jp=t,Xp=wn(e)?e.getRelativeToSurfaceXY():null,e.dispose(),!0)},keyCodes:[t,e,i]})},Ks=function(){const t=Fp.registry.createSerializedKey(Gu.V,[Gu.CTRL]),e=Fp.registry.createSerializedKey(Gu.V,[Gu.ALT]),i=Fp.registry.createSerializedKey(Gu.V,[Gu.META]);Fp.registry.register({name:Hp.PASTE,preconditionFn:t=>!t.options.readOnly&&!wu.inProgress(),callback(){if(!zp||!jp)return!1;if(!Xp)return!!Us(zp,jp);const{left:t,top:e,width:i,height:o}=jp.getMetricsManager().getViewMetrics(!0);if(new Ol(e,e+o,t,t+i).contains(Xp.x,Xp.y))return!!Us(zp,jp);const n=new yl(t+i/2,e+o/2);return!!Us(zp,jp,n)},keyCodes:[t,e,i]})},Js=function(){const t=Fp.registry.createSerializedKey(Gu.Z,[Gu.CTRL]),e=Fp.registry.createSerializedKey(Gu.Z,[Gu.ALT]),i=Fp.registry.createSerializedKey(Gu.Z,[Gu.META]);Fp.registry.register({name:Hp.UNDO,preconditionFn:t=>!t.options.readOnly&&!wu.inProgress(),callback:(t,e)=>(t.hideChaff(),t.undo(!1),e.preventDefault(),!0),keyCodes:[t,e,i]})},qs=function(){const t=Fp.registry.createSerializedKey(Gu.Z,[Gu.SHIFT,Gu.CTRL]),e=Fp.registry.createSerializedKey(Gu.Z,[Gu.SHIFT,Gu.ALT]),i=Fp.registry.createSerializedKey(Gu.Z,[Gu.SHIFT,Gu.META]),o=Fp.registry.createSerializedKey(Gu.Y,[Gu.CTRL]);Fp.registry.register({name:Hp.REDO,preconditionFn:t=>!wu.inProgress()&&!t.options.readOnly,callback:(t,e)=>(t.hideChaff(),t.undo(!0),e.preventDefault(),!0),keyCodes:[t,e,i,o]})},Zs=function(){zs(),js(),Xs(),Ys(),Ks(),Js(),qs()},Qs=function(t){const e=t.saveState();return t.getParameters().length?(e.parameters=t.getParameters().map((t=>t.saveState())),e):e},tr=function(t,e,i,o){if(t=t.loadState(i,o),!i.parameters)return t;for(const[n,s]of i.parameters.entries())t.insertParameter(e.loadState(s,o),n);return t},er=function(t){const e=Object.create(null),i=l(jr.SERIALIZER,!0);for(const o in i){let n;const s=null==(n=i[o])?void 0:n.save(t);s&&(e[o]=s)}return e},ir=function(t,e,{recordUndo:i=!1}={}){var o=l(jr.SERIALIZER,!0);if(o){o=Object.entries(o).sort(((t,e)=>e[1].priority-t[1].priority));var n=d();Ur.setRecordUndo$$module$build$src$core$events$utils(i),(i=Ur.getGroup$$module$build$src$core$events$utils())||Ur.setGroup$$module$build$src$core$events$utils(!0),lt(),e instanceof rp&&e.setResizesEnabled(!1);for(const[,t]of o.reverse()){let i;null==(i=t)||i.clear(e)}for(const[i,n]of o.reverse())if(t[i]){let o;null==(o=n)||o.load(t[i],e)}e instanceof rp&&e.setResizesEnabled(!0),ht(),p(new(E(ma))(e)),Ur.setGroup$$module$build$src$core$events$utils(i),Ur.setRecordUndo$$module$build$src$core$events$utils(n)}},or=function(t,e){let i=null;var o;if(i="string"==typeof t?document.getElementById(t)||document.querySelector(t):t,!document.contains(i)&&document!==(null==(o=i)?void 0:o.ownerDocument))throw Error("Error: container is not in current document");t=new Cu(e||{}),o=document.createElement("div"),et(o,"injectionDiv"),null!=e&&e.rtl&&et(o,"blocklyRTL"),o.tabIndex=0,Le(o,Gh.LABEL,Ur.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),i.appendChild(o),e=nr(o,t);const n=sr(o,e,t);return rr(n),O(n),x(n),o.addEventListener("focusin",(function(){O(n)})),n},nr=function(t,e){t.setAttribute("dir","LTR"),Q(e.hasCss,e.pathToMedia),t=tt(Cl.SVG,{xmlns:Tl,"xmlns:html":El,"xmlns:xlink":wl,version:"1.1",class:"blocklySvg",tabindex:"0"},t);const i=tt(Cl.DEFS,{},t),o=String(Math.random()).substring(2);return e.gridPattern=ku.createDom(o,e.gridOptions,i),t},sr=function(t,e,i){i.parentWorkspace=null;const o=(i=new rp(i)).options;i.scale=o.zoomOptions.startScale,e.appendChild(i.createDom("blocklyMainBackground",t));var n=i.getRenderer().getClassName();return n&&et(t,n),(n=i.getTheme().getClassName())&&et(t,n),!o.hasCategories&&o.languageTree&&(t=i.addFlyout(Cl.SVG),rt(t,e)),o.hasTrashcan&&i.addTrashcan(),o.zoomOptions&&o.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(e,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(Ns(i)),x(i),Eo(),hi(),Wi(),i},rr=function(t){const e=t.options;var i=t.getParentSvg();if(W(i.parentNode,"contextmenu",null,(function(t){X(t)||t.preventDefault()})),i=W(window,"resize",null,(function(){qi(),t.hideComponents(!0),Ri(),xo(),x(t),Bs(t)})),t.setResizeHandlerWrapper(i),lr(),e.languageTree){i=t.getToolbox();const o=t.getFlyout(!0);i?i.init():o&&(o.init(t),o.show(e.languageTree),"function"==typeof o.scrollToStart&&o.scrollToStart())}e.hasTrashcan&&t.trashcan.init(),e.zoomOptions&&e.zoomOptions.controls&&t.zoomControls_.init(),e.moveOptions&&e.moveOptions.scrollbars?(t.scrollbar=new tg(t,!0===e.moveOptions.scrollbars||!!e.moveOptions.scrollbars.horizontal,!0===e.moveOptions.scrollbars||!!e.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),e.hasSounds&&hr(e.pathToMedia,t)},ar=function(t){const e=C();e&&!(X(t)||e.rendered&&!e.isVisible())&&Fp.registry.onKeyDown(e,t)},lr=function(){vg||(W(document,"scroll",null,(function(){const t=I();for(let e,i=0;e=t[i];i++)e instanceof rp&&e.updateInverseScreenCTM()})),W(document,"keydown",null,ar),z(document,"touchend",null,F),z(document,"touchcancel",null,F),sl&&W(window,"orientationchange",document,(function(){x(C())}))),vg=!0},hr=function(t,e){function i(){for(;n.length;){const t=n.pop();t&&j(t)}o.preload()}const o=e.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");const n=[];n.push(W(document,"pointermove",null,i,!0)),n.push(W(document,"touchstart",null,i,!0))},cr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.UNDO,preconditionFn:t=>0<t.workspace.getUndoStack().length?"enabled":"disabled",callback(t){t.workspace.undo(!1)},scopeType:lu.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},ur=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.REDO,preconditionFn:t=>0<t.workspace.getRedoStack().length?"enabled":"disabled",callback(t){t.workspace.undo(!0)},scopeType:lu.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},dr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:t=>t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden",callback(t){t.workspace.cleanUp()},scopeType:lu.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},pr=function(t,e){function i(e){n--,e.setCollapsed(t),0===n&&Ur.setGroup$$module$build$src$core$events$utils(!1)}let o=0,n=0;Ur.setGroup$$module$build$src$core$events$utils(!0);for(let t=0;t<e.length;t++){let s=e[t];for(;s;)n++,setTimeout(i.bind(null,s),o),s=s.getNextBlock(),o+=10}},gr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let e=0;e<t.length;e++){let i=t[e];for(;i;){if(!i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(t){pr(!0,t.workspace.getTopBlocks(!0))},scopeType:lu.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},fr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let e=0;e<t.length;e++){let i=t[e];for(;i;){if(i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(t){pr(!1,t.workspace.getTopBlocks(!0))},scopeType:lu.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},mr=function(t,e){if(t.isDeletable())Array.prototype.push.apply(e,t.getDescendants(!1));else{t=t.getChildren(!1);for(let i=0;i<t.length;i++)mr(t[i],e)}},vr=function(t){const e=[];t=t.getTopBlocks(!0);for(let i=0;i<t.length;i++)mr(t[i],e);return e},br=function(t,e){e?Ur.setGroup$$module$build$src$core$events$utils(e):(Ur.setGroup$$module$build$src$core$events$utils(!0),e=Ur.getGroup$$module$build$src$core$events$utils());const i=t.shift();i&&(i.isDeadOrDying()?br(t,e):(i.dispose(!1,!0),setTimeout(br,10,t,e))),Ur.setGroup$$module$build$src$core$events$utils(!1)},_r=function(){lu.registry.register({displayText:t=>t.workspace?1===(t=vr(t.workspace).length)?Ur.Msg$$module$build$src$core$msg.DELETE_BLOCK:Ur.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`):"",preconditionFn:t=>t.workspace&&0<vr(t.workspace).length?"enabled":"disabled",callback(t){if(t.workspace){t.workspace.cancelCurrentGesture();var e=vr(t.workspace);2>e.length?br(e):Xt(Ur.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(e.length)),(function(t){t&&br(e)}))}},scopeType:lu.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},yr=function(){cr(),ur(),dr(),gr(),fr(),_r()},Tr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:t=>!(t=t.block).isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden",callback(t){if(t.block){var e=t.block.toCopyData();e&&Us(e,t.block.workspace)}},scopeType:lu.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Er=function(){lu.registry.register({displayText:t=>t.block.hasIcon(Ju.TYPE)?Ur.Msg$$module$build$src$core$msg.REMOVE_COMMENT:Ur.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:t=>!(t=t.block).isInFlyout&&t.workspace.options.comments&&!t.isCollapsed()&&t.isEditable()?"enabled":"hidden",callback(t){(t=t.block).hasIcon(Ju.TYPE)?t.setCommentText(null):t.setCommentText("")},scopeType:lu.ScopeType.BLOCK,id:"blockComment",weight:2})},wr=function(){lu.registry.register({displayText:t=>t.block.getInputsInline()?Ur.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:Ur.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(let e=1;e<t.inputList.length;e++)if(!(t.inputList[e-1]instanceof lg||t.inputList[e]instanceof lg))return"enabled";return"hidden"},callback(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:lu.ScopeType.BLOCK,id:"blockInline",weight:3})},kr=function(){lu.registry.register({displayText:t=>t.block.isCollapsed()?Ur.Msg$$module$build$src$core$msg.EXPAND_BLOCK:Ur.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:t=>!(t=t.block).isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden",callback(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:lu.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Ir=function(){lu.registry.register({displayText:t=>t.block.hasDisabledReason(rh)?Ur.Msg$$module$build$src$core$msg.ENABLE_BLOCK:Ur.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(t){if(!(t=t.block).isInFlyout&&t.workspace.options.disable&&t.isEditable()){var e=t.getDisabledReasons();return e=e.size>(e.has(rh)?1:0),t.getInheritedDisabled()||e?"disabled":"enabled"}return"hidden"},callback(t){t=t.block;const e=Ur.getGroup$$module$build$src$core$events$utils();e||Ur.setGroup$$module$build$src$core$events$utils(!0),t.setDisabledReason(!t.hasDisabledReason(rh),rh),Ur.setGroup$$module$build$src$core$events$utils(e)},scopeType:lu.ScopeType.BLOCK,id:"blockDisable",weight:5})},$r=function(){lu.registry.register({displayText(t){var e=t.block;return t=e.getDescendants(!1).length,(e=e.getNextBlock())&&(t-=e.getDescendants(!1).length),1===t?Ur.Msg$$module$build$src$core$msg.DELETE_BLOCK:Ur.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)},preconditionFn:t=>!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden",callback(t){t.block&&t.block.checkAndDelete()},scopeType:lu.ScopeType.BLOCK,id:"blockDelete",weight:6})},Sr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.HELP,preconditionFn:t=>("function"==typeof(t=t.block).helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden",callback(t){t.block.showHelp()},scopeType:lu.ScopeType.BLOCK,id:"blockHelp",weight:7})},Cr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(t){let e;return null!=(e=t.comment)&&e.isDeletable()?"enabled":"hidden"},callback(t){let e;Ur.setGroup$$module$build$src$core$events$utils(!0),null==(e=t.comment)||e.dispose(),Ur.setGroup$$module$build$src$core$events$utils(!1)},scopeType:lu.ScopeType.COMMENT,id:"commentDelete",weight:6})},Or=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(t){let e;return null!=(e=t.comment)&&e.isMovable()?"enabled":"hidden"},callback(t){if(t.comment){var e=t.comment.toCopyData();e&&Us(e,t.comment.workspace)}},scopeType:lu.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Rr=function(){lu.registry.register({displayText:()=>Ur.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:()=>"enabled",callback:(t,e)=>{if(t=t.workspace){Ur.setGroup$$module$build$src$core$events$utils(!0);var i=new uu(t);i.setText(Ur.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),i.moveTo(Ar(new yl(e.clientX,e.clientY),t)),Ur.setSelected$$module$build$src$core$common(i),Ur.setGroup$$module$build$src$core$events$utils(!1)}},scopeType:lu.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},Ar=function(t,e){var i=e.getInjectionDiv().getBoundingClientRect();return t=new yl(t.x-i.left,t.y-i.top),i=e.getOriginOffsetInPixels(),(t=yl.difference(t,i)).scale(1/e.scale),t},Mr=function(){Tr(),Er(),wr(),kr(),Ir(),$r(),Sr()},xr=function(){Or(),Cr(),Rr()},Lr=function(){yr(),Mr()},Dr=function(t){return void 0!==t.paste},Nr=function(t){return void 0!==t.getSvgRoot},Pr=function(t){return"string"==typeof t.id&&void 0!==t.workspace&&void 0!==t.select&&void 0!==t.unselect},Br=function(t){return t.isSelectable()},Fr=function(t){C().hideChaff(t)},(Hr=Hr||{}).scope={},Hr.ASSUME_ES5=!1,Hr.ASSUME_NO_NATIVE_MAP=!1,Hr.ASSUME_NO_NATIVE_SET=!1,Hr.SIMPLE_FROUND_POLYFILL=!1,Hr.ISOLATE_POLYFILLS=!1,Hr.FORCE_POLYFILL_PROMISE=!1,Hr.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Hr.defineProperty=Hr.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){return t==Array.prototype||t==Object.prototype||(t[e]=i.value),t},Hr.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof i.g&&i.g];for(var e=0;e<t.length;++e){var o=t[e];if(o&&o.Math==Math)return o}throw Error("Cannot find global object")},Hr.global=Hr.getGlobal(this),Hr.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),Hr.TRUST_ES6_POLYFILLS=!Hr.ISOLATE_POLYFILLS||Hr.IS_SYMBOL_NATIVE,Hr.polyfills={},Hr.propertyToPolyfillSymbol={},Hr.POLYFILL_PREFIX="$jscp$",Hr.polyfill=function(t,e,i,o){e&&(Hr.ISOLATE_POLYFILLS?Hr.polyfillIsolated(t,e,i,o):Hr.polyfillUnisolated(t,e,i,o))},Hr.polyfillUnisolated=function(t,e,i,o){for(i=Hr.global,t=t.split("."),o=0;o<t.length-1;o++){var n=t[o];if(!(n in i))return;i=i[n]}(e=e(o=i[t=t[t.length-1]]))!=o&&null!=e&&Hr.defineProperty(i,t,{configurable:!0,writable:!0,value:e})},Hr.polyfillIsolated=function(t,e,i,o){var n=t.split(".");t=1===n.length,o=n[0],o=!t&&o in Hr.polyfills?Hr.polyfills:Hr.global;for(var s=0;s<n.length-1;s++){var r=n[s];if(!(r in o))return;o=o[r]}n=n[n.length-1],null!=(e=e(i=Hr.IS_SYMBOL_NATIVE&&"es6"===i?o[n]:null))&&(t?Hr.defineProperty(Hr.polyfills,n,{configurable:!0,writable:!0,value:e}):e!==i&&(void 0===Hr.propertyToPolyfillSymbol[n]&&(i=1e9*Math.random()>>>0,Hr.propertyToPolyfillSymbol[n]=Hr.IS_SYMBOL_NATIVE?Hr.global.Symbol(n):Hr.POLYFILL_PREFIX+i+"$"+n),Hr.defineProperty(o,Hr.propertyToPolyfillSymbol[n],{configurable:!0,writable:!0,value:e})))},Hr.underscoreProtoCanBeSet=function(){var t={};try{return t.__proto__={a:!0},t.a}catch(t){}return!1},Hr.setPrototypeOf=Hr.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:Hr.underscoreProtoCanBeSet()?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null,Hr.arrayIteratorImpl=function(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}},Hr.arrayIterator=function(t){return{next:Hr.arrayIteratorImpl(t)}},Hr.makeIterator=function(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];if(e)return e.call(t);if("number"==typeof t.length)return Hr.arrayIterator(t);throw Error(String(t)+" is not an iterable or ArrayLike")},Hr.generator={},Hr.generator.ensureIteratorResultIsObject_=function(t){if(!(t instanceof Object))throw new TypeError("Iterator result "+t+" is not an object")},Hr.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},Hr.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},Hr.generator.Context.prototype.stop_=function(){this.isRunning_=!1},Hr.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},Hr.generator.Context.prototype.next_=function(t){this.yieldResult=t},Hr.generator.Context.prototype.throw_=function(t){this.abruptCompletion_={exception:t,isException:!0},this.jumpToErrorHandler_()},Hr.generator.Context.prototype.return=function(t){this.abruptCompletion_={return:t},this.nextAddress=this.finallyAddress_},Hr.generator.Context.prototype.jumpThroughFinallyBlocks=function(t){this.abruptCompletion_={jumpTo:t},this.nextAddress=this.finallyAddress_},Hr.generator.Context.prototype.yield=function(t,e){return this.nextAddress=e,{value:t}},Hr.generator.Context.prototype.yieldAll=function(t,e){var i=(t=Hr.makeIterator(t)).next();if(Hr.generator.ensureIteratorResultIsObject_(i),!i.done)return this.yieldAllIterator_=t,this.yield(i.value,e);this.yieldResult=i.value,this.nextAddress=e},Hr.generator.Context.prototype.jumpTo=function(t){this.nextAddress=t},Hr.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},Hr.generator.Context.prototype.setCatchFinallyBlocks=function(t,e){this.catchAddress_=t,null!=e&&(this.finallyAddress_=e)},Hr.generator.Context.prototype.setFinallyBlock=function(t){this.catchAddress_=0,this.finallyAddress_=t||0},Hr.generator.Context.prototype.leaveTryBlock=function(t,e){this.nextAddress=t,this.catchAddress_=e||0},Hr.generator.Context.prototype.enterCatchBlock=function(t){return this.catchAddress_=t||0,t=this.abruptCompletion_.exception,this.abruptCompletion_=null,t},Hr.generator.Context.prototype.enterFinallyBlock=function(t,e,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=t||0,this.finallyAddress_=e||0},Hr.generator.Context.prototype.leaveFinallyBlock=function(t,e){if(e=this.finallyContexts_.splice(e||0)[0],e=this.abruptCompletion_=this.abruptCompletion_||e){if(e.isException)return this.jumpToErrorHandler_();null!=e.jumpTo&&this.finallyAddress_<e.jumpTo?(this.nextAddress=e.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=t},Hr.generator.Context.prototype.forIn=function(t){return new Hr.generator.Context.PropertyIterator(t)},Hr.generator.Context.PropertyIterator=function(t){for(var e in this.object_=t,this.properties_=[],t)this.properties_.push(e);this.properties_.reverse()},Hr.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var t=this.properties_.pop();if(t in this.object_)return t}return null},Hr.generator.Engine_=function(t){this.context_=new Hr.generator.Context,this.program_=t},Hr.generator.Engine_.prototype.next_=function(t){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,t,this.context_.next_):(this.context_.next_(t),this.nextStep_())},Hr.generator.Engine_.prototype.return_=function(t){this.context_.start_();var e=this.context_.yieldAllIterator_;return e?this.yieldAllStep_("return"in e?e.return:function(t){return{value:t,done:!0}},t,this.context_.return):(this.context_.return(t),this.nextStep_())},Hr.generator.Engine_.prototype.throw_=function(t){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,t,this.context_.next_):(this.context_.throw_(t),this.nextStep_())},Hr.generator.Engine_.prototype.yieldAllStep_=function(t,e,i){try{var o=t.call(this.context_.yieldAllIterator_,e);if(Hr.generator.ensureIteratorResultIsObject_(o),!o.done)return this.context_.stop_(),o;var n=o.value}catch(t){return this.context_.yieldAllIterator_=null,this.context_.throw_(t),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,n),this.nextStep_()},Hr.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var t=this.program_(this.context_);if(t)return this.context_.stop_(),{value:t.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(t=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,t.isException)throw t.exception;return{value:t.return,done:!0}}return{value:void 0,done:!0}},Hr.generator.Generator_=function(t){this.next=function(e){return t.next_(e)},this.throw=function(e){return t.throw_(e)},this.return=function(e){return t.return_(e)},this[Symbol.iterator]=function(){return this}},Hr.generator.createGenerator=function(t,e){return e=new Hr.generator.Generator_(new Hr.generator.Engine_(e)),Hr.setPrototypeOf&&t.prototype&&Hr.setPrototypeOf(e,t.prototype),e},Hr.asyncExecutePromiseGenerator=function(t){function e(e){return t.next(e)}function i(e){return t.throw(e)}return new Promise((function(o,n){!function t(s){s.done?o(s.value):Promise.resolve(s.value).then(e,i).then(t,n)}(t.next())}))},Hr.asyncExecutePromiseGeneratorFunction=function(t){return Hr.asyncExecutePromiseGenerator(t())},Hr.asyncExecutePromiseGeneratorProgram=function(t){return Hr.asyncExecutePromiseGenerator(new Hr.generator.Generator_(new Hr.generator.Engine_(t)))},Hr.polyfill("globalThis",(function(t){return t||Hr.global}),"es_2020","es3"),Hr.polyfill("Array.prototype.includes",(function(t){return t||function(t,e){var i=this;i instanceof String&&(i=String(i));var o=i.length;for(0>(e=e||0)&&(e=Math.max(e+o,0));e<o;e++){var n=i[e];if(n===t||Object.is(n,t))return!0}return!1}}),"es7","es3"),Hr.initSymbol=function(){},Hr.iteratorPrototype=function(t){return(t={next:t})[Symbol.iterator]=function(){return this},t},Hr.iteratorFromArray=function(t,e){t instanceof String&&(t+="");var i=0,o=!1,n={next:function(){if(!o&&i<t.length){var n=i++;return{value:e(n,t[n]),done:!1}}return o=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n},Hr.polyfill("Array.prototype.values",(function(t){return t||function(){return Hr.iteratorFromArray(this,(function(t,e){return e}))}}),"es8","es3"),Hr.polyfill("Array.prototype.flat",(function(t){return t||function(t){t=void 0===t?1:t;var e=[];return Array.prototype.forEach.call(this,(function(i){Array.isArray(i)&&0<t?(i=Array.prototype.flat.call(i,t-1),e.push.apply(e,i)):e.push(i)})),e}}),"es9","es5"),Hr.polyfill("Array.prototype.flatMap",(function(t){return t||function(t,e){var i=[];return Array.prototype.forEach.call(this,(function(o,n){o=t.call(e,o,n,this),Array.isArray(o)?i.push.apply(i,o):i.push(o)})),i}}),"es9","es5"),Hr.owns=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Hr.polyfill("Object.entries",(function(t){return t||function(t){var e,i=[];for(e in t)Hr.owns(t,e)&&i.push([e,t[e]]);return i}}),"es8","es3"),Hr.polyfill("Object.values",(function(t){return t||function(t){var e,i=[];for(e in t)Hr.owns(t,e)&&i.push(t[e]);return i}}),"es8","es3");var Gr=Object.create(null),Vr={typeMap:Gr},Wr=Object.create(null),zr="default",jr=class{constructor(t){this.name=t}toString(){return this.name}};jr.CONNECTION_CHECKER=new jr("connectionChecker"),jr.CONNECTION_PREVIEWER=new jr("connectionPreviewer"),jr.CURSOR=new jr("cursor"),jr.EVENT=new jr("event"),jr.FIELD=new jr("field"),jr.INPUT=new jr("input"),jr.RENDERER=new jr("renderer"),jr.TOOLBOX=new jr("toolbox"),jr.THEME=new jr("theme"),jr.TOOLBOX_ITEM=new jr("toolboxItem"),jr.FLYOUTS_VERTICAL_TOOLBOX=new jr("flyoutsVerticalToolbox"),jr.FLYOUTS_HORIZONTAL_TOOLBOX=new jr("flyoutsHorizontalToolbox"),jr.METRICS_MANAGER=new jr("metricsManager"),jr.BLOCK_DRAGGER=new jr("blockDragger"),jr.SERIALIZER=new jr("serializer"),jr.ICON=new jr("icon"),jr.PASTER=new jr("paster");var Xr={DEFAULT:zr,TEST_ONLY:Vr};Xr.Type=jr,Xr.getAllItems=l,Xr.getClass=r,Xr.getClassFromOptions=h,Xr.getObject=a,Xr.hasItem=s,Xr.register=t,Xr.unregister=o;var Yr,Kr,Jr,qr,Zr,Qr,ta,ea,ia,oa,na,sa,ra,aa,la,ha,ca,ua,da,pa,ga,fa,ma,va,ba,_a,ya,Ta,Ea=Object.create(null),wa="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",ka={genUid:()=>{const t=[];for(let e=0;20>e;e++)t[e]=wa.charAt(88*Math.random());return t.join("")}},Ia=0,$a={TEST_ONLY:ka};$a.genUid=u,$a.getNextUniqueId=c,Yr="",Kr=!0,Jr=0,Ur.CREATE$$module$build$src$core$events$utils="create",Ur.CREATE$$module$build$src$core$events$utils,Ur.DELETE$$module$build$src$core$events$utils="delete",Ur.DELETE$$module$build$src$core$events$utils,Ur.CHANGE$$module$build$src$core$events$utils="change",Ur.CHANGE$$module$build$src$core$events$utils,qr="block_field_intermediate_change",Ur.MOVE$$module$build$src$core$events$utils="move",Ur.MOVE$$module$build$src$core$events$utils,Zr="var_create",Qr="var_delete",ta="var_rename",ea="ui",ia="drag",oa="selected",na="click",sa="marker_move",ra="bubble_open",aa="trashcan_open",la="toolbox_item_select",ha="theme_change",ca="viewport_change",ua="comment_create",da="comment_delete",pa="comment_change",ga="comment_move",fa="comment_collapse",ma="finished_loading",va="ORPHANED_BLOCK",ba=[Ur.CREATE$$module$build$src$core$events$utils,Ur.MOVE$$module$build$src$core$events$utils,ua,ga],ya={FIRE_QUEUE:_a=[],fireNow:f,fireInternal:g,setGroupInternal:_},(Ta={BLOCK_CHANGE:Ur.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:Ur.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:Ur.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:ia,BLOCK_FIELD_INTERMEDIATE_CHANGE:qr,BLOCK_MOVE:Ur.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:ra,BUMP_EVENTS:ba,CHANGE:Ur.CHANGE$$module$build$src$core$events$utils,CLICK:na,COMMENT_CHANGE:pa,COMMENT_COLLAPSE:fa,COMMENT_CREATE:ua,COMMENT_DELETE:da,COMMENT_MOVE:ga,CREATE:Ur.CREATE$$module$build$src$core$events$utils,DELETE:Ur.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:ma,MARKER_MOVE:sa,MOVE:Ur.MOVE$$module$build$src$core$events$utils,SELECTED:oa,TEST_ONLY:ya,THEME_CHANGE:ha,TOOLBOX_ITEM_SELECT:la,TRASHCAN_OPEN:aa,UI:ea,VAR_CREATE:Zr,VAR_DELETE:Qr,VAR_RENAME:ta,VIEWPORT_CHANGE:ca}).clearPendingUndo=v,Ta.disable=Ur.disable$$module$build$src$core$events$utils,Ta.disableOrphans=w,Ta.enable=Ur.enable$$module$build$src$core$events$utils,Ta.filter=m,Ta.fire=p,Ta.fromJson=T,Ta.get=E,Ta.getDescendantIds=y,Ta.getGroup=Ur.getGroup$$module$build$src$core$events$utils,Ta.getRecordUndo=d,Ta.isEnabled=b,Ta.setGroup=Ur.setGroup$$module$build$src$core$events$utils,Ta.setRecordUndo=Ur.setRecordUndo$$module$build$src$core$events$utils;var Sa,Ca,Oa=Object.create(null),Ra=null,Aa=[],Ma={defineBlocksWithJsonArrayInternal:P},xa={TEST_ONLY:Ma};xa.createBlockDefinitionsFromJsonArray=Ur.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,xa.defineBlocks=Ur.defineBlocks$$module$build$src$core$common,xa.defineBlocksWithJsonArray=N,xa.draggingConnections=Aa,xa.getAllWorkspaces=I,xa.getBlockTypeCounts=L,xa.getMainWorkspace=C,xa.getParentContainer=A,xa.getSelected=R,xa.getWorkspaceById=k,xa.registerWorkspace=$,xa.setMainWorkspace=O,xa.setParentContainer=M,xa.setSelected=Ur.setSelected$$module$build$src$core$common,xa.svgResize=x,xa.unregisterWorkpace=S;var La,Da,Na=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=Ur.getGroup$$module$build$src$core$events$utils(),this.recordUndo=d()}toJson(){return{type:this.type,group:this.group}}static fromJson(t,e,i){return i.isBlank=!1,i.group=t.group||"",i.workspaceId=e.id,i}isNull(){return!1}run(t){}getEventWorkspace_(){let t;if(this.workspaceId&&(t=k(this.workspaceId)),!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t}},Pa=class extends Na{constructor(t){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===t,this.workspaceId=t||""}},Ba=class extends Pa{constructor(t,e,i){null===(e=t?t.workspace.id:e)&&(e=void 0),super(e),this.type=na,this.blockId=t?t.id:void 0,this.targetType=i}toJson(){const t=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return t.targetType=this.targetType,t.blockId=this.blockId,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Ba)).targetType=t.targetType,e.blockId=t.blockId,e}};(Da=La||(La={})).BLOCK="block",Da.WORKSPACE="workspace",Da.ZOOM_CONTROLS="zoom_controls",t(jr.EVENT,na,Ba);var Fa={};Fa.Click=Ba,Fa.ClickTarget=La;var Ha,Ua,Ga,Va,Wa,za,ja,Xa,Ya,Ka,Ja=750,qa="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Za=null,Qa={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},tl=0,el={TOUCH_ENABLED:qa,TOUCH_MAP:Qa};el.checkTouchIdentifier=V,el.clearTouchIdentifier=H,el.getTouchIdentifierFromEvent=G,el.longStart=B,el.longStop=F,el.shouldHandleEvent=U,function(t){function e(t){return i.includes(t.toUpperCase())}const i=(Ha=t).toUpperCase();Ua=e("JavaFX"),Ga=e("WebKit"),Va=e("Gecko")&&!Ga,Wa=e("Android"),t=globalThis.navigator&&globalThis.navigator.maxTouchPoints,za=e("iPad")||e("Macintosh")&&0<t,ja=e("iPhone")&&!za,Xa=e("Macintosh"),Ya=za||Wa&&!e("Mobile")||e("Silk"),Ka=!Ya&&(ja||Wa)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var il=Ua,ol=Va,nl=Wa,sl=za,rl=ja,al=Xa,ll=Ka,hl={ANDROID:nl,GECKO:ol,IPAD:sl,IPHONE:rl,JavaFx:il,MAC:al,MOBILE:ll,raw:Ha},cl=40,ul=125,dl={};dl.bind=z,dl.conditionalBind=W,dl.getScrollDeltaPixels=J,dl.isRightButton=Y,dl.isTargetInput=X,dl.mouseToSvg=K,dl.unbind=j;var pl={};pl.removeElem=q;var gl=class{constructor(t){this.name_=t}toString(){return this.name_}};gl.POSITIONABLE=new gl("positionable"),gl.DRAG_TARGET=new gl("drag_target"),gl.DELETE_AREA=new gl("delete_area"),gl.AUTOHIDEABLE=new gl("autohideable");var fl=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(t,e){const i=t.component.id;var o;if(!e&&this.componentData.has(i))throw Error('Plugin "'+i+'" with capabilities "'+(null==(o=this.componentData.get(i))?void 0:o.capabilities)+'" already added.');for(this.componentData.set(i,t),e=[],o=0;o<t.capabilities.length;o++){const n=String(t.capabilities[o]).toLowerCase();if(e.push(n),this.capabilityToComponentIds.has(n)){let t;null==(t=this.capabilityToComponentIds.get(n))||t.push(i)}else this.capabilityToComponentIds.set(n,[i])}this.componentData.get(i).capabilities=e}removeComponent(t){const e=this.componentData.get(t);if(e){for(let i=0;i<e.capabilities.length;i++){const o=String(e.capabilities[i]).toLowerCase();q(this.capabilityToComponentIds.get(o),t)}this.componentData.delete(t)}}addCapability(t,e){if(!this.getComponent(t))throw Error('Cannot add capability, "'+e+'". Plugin "'+t+'" has not been added to the ComponentManager');var i,o;this.hasCapability(t,e)?console.warn('Plugin "'+t+'already has capability "'+e+'"'):(e=`${e}`.toLowerCase(),null==(i=this.componentData.get(t))||i.capabilities.push(e),null==(o=this.capabilityToComponentIds.get(e))||o.push(t))}removeCapability(t,e){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+e+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,e)?(e=`${e}`.toLowerCase(),q(this.componentData.get(t).capabilities,e),q(this.capabilityToComponentIds.get(e),t)):console.warn('Plugin "'+t+"doesn't have capability \""+e+'" to remove')}hasCapability(t,e){return e=`${e}`.toLowerCase(),this.componentData.has(t)&&this.componentData.get(t).capabilities.includes(e)}getComponent(t){let e;return null==(e=this.componentData.get(t))?void 0:e.component}getComponents(t,e){if(t=`${t}`.toLowerCase(),!(t=this.capabilityToComponentIds.get(t)))return[];const i=[];if(e){const e=[];t.forEach((t=>{e.push(this.componentData.get(t))})),e.sort((function(t,e){return t.weight-e.weight})),e.forEach((function(t){i.push(t.component)}))}else t.forEach((t=>{i.push(this.componentData.get(t).component)}));return i}};fl.Capability=gl;var ml=!1,vl='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n',bl={};bl.inject=Q,bl.register=Z;var _l,yl=class{constructor(t,e){this.x=t,this.y=e}clone(){return new yl(this.x,this.y)}scale(t){return this.x*=t,this.y*=t,this}translate(t,e){return this.x+=t,this.y+=e,this}static equals(t,e){return t===e||!(!t||!e)&&t.x===e.x&&t.y===e.y}static distance(t,e){const i=t.x-e.x;return t=t.y-e.y,Math.sqrt(i*i+t*t)}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static difference(t,e){return new yl(t.x-e.x,t.y-e.y)}static sum(t,e){return new yl(t.x+e.x,t.y+e.y)}},Tl="http://www.w3.org/2000/svg",El="http://www.w3.org/1999/xhtml",wl="http://www.w3.org/1999/xlink";!function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE"}(_l||(_l={}));var kl=null,Il=0,$l=null,Sl={HTML_NS:El};Sl.NodeType=_l,Sl.SVG_NS=Tl,Sl.XLINK_NS=wl,Sl.addClass=et,Sl.createSvgElement=tt,Sl.getFastTextWidth=ut,Sl.getFastTextWidthWithSizeString=dt,Sl.getTextWidth=ct,Sl.hasClass=nt,Sl.insertAfter=rt,Sl.measureFontMetrics=pt,Sl.removeClass=ot,Sl.removeClasses=it,Sl.removeNode=st,Sl.setCssTransform=at,Sl.startTextWidthCache=lt,Sl.stopTextWidthCache=ht;var Cl=class{constructor(t){this.tagName=t}toString(){return this.tagName}};Cl.ANIMATE=new Cl("animate"),Cl.CIRCLE=new Cl("circle"),Cl.CLIPPATH=new Cl("clipPath"),Cl.DEFS=new Cl("defs"),Cl.FECOMPOSITE=new Cl("feComposite"),Cl.FECOMPONENTTRANSFER=new Cl("feComponentTransfer"),Cl.FEFLOOD=new Cl("feFlood"),Cl.FEFUNCA=new Cl("feFuncA"),Cl.FEGAUSSIANBLUR=new Cl("feGaussianBlur"),Cl.FEPOINTLIGHT=new Cl("fePointLight"),Cl.FESPECULARLIGHTING=new Cl("feSpecularLighting"),Cl.FILTER=new Cl("filter"),Cl.FOREIGNOBJECT=new Cl("foreignObject"),Cl.G=new Cl("g"),Cl.IMAGE=new Cl("image"),Cl.LINE=new Cl("line"),Cl.PATH=new Cl("path"),Cl.PATTERN=new Cl("pattern"),Cl.POLYGON=new Cl("polygon"),Cl.RECT=new Cl("rect"),Cl.SVG=new Cl("svg"),Cl.TEXT=new Cl("text"),Cl.TSPAN=new Cl("tspan");var Ol=class{constructor(t,e,i,o){this.top=t,this.bottom=e,this.left=i,this.right=o}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom}intersects(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)}},Rl=class{constructor(t,e){this.width=t,this.height=e}static equals(t,e){return t===e||!(!t||!e)&&t.width===e.width&&t.height===e.height}static max(t,e){return new Rl(Math.max(t.width,e.width),Math.max(t.height,e.height))}static min(t,e){return new Rl(Math.min(t.width,e.width),Math.min(t.height,e.height))}},Al={getSizeInternal:ft},Ml={TEST_ONLY:Al};Ml.getBorderBox=yt,Ml.getComputedStyle=vt,Ml.getContainerOffsetToScrollInto=Et,Ml.getPageOffset=bt,Ml.getSize=gt,Ml.getViewportPageOffset=_t,Ml.scrollIntoContainerView=Tt;var xl=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Ll=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Dl={TEST_ONLY:{XY_REGEX:xl,XY_STYLE_REGEX:Ll}};Dl.getDocumentScroll=$t,Dl.getInjectionDivXY=kt,Dl.getRelativeXY=wt,Dl.getViewportBBox=It,Dl.screenToWsCoordinates=St,Dl.wsToScreenCoordinates=Ct;var Nl=class{constructor(t,e,i,o,n){this.workspace=t,this.horizontal=e,this.oldHostMetrics=null,this.ratio=1,this.origin=new yl(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new yl(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=void 0!==n?n:Nl.DEFAULT_SCROLLBAR_MARGIN,t="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),o&&(t+=" "+o),this.outerSvg=tt(Cl.SVG,{class:t}),o=tt(Cl.G,{},this.outerSvg),this.svgBackground=tt(Cl.RECT,{class:"blocklyScrollbarBackground"},o),t=Math.floor((Nl.scrollbarThickness-5)/2),this.svgHandle=tt(Cl.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},o),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),rt(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),e?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=W(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=W(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const t=Nl.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(t)),this.outerSvg.setAttribute("height",String(t)),this.svgHandle.setAttribute("height",String(t-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(t)),this.outerSvg.setAttribute("width",String(t)),this.svgHandle.setAttribute("width",String(t-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),j(this.onMouseDownBarWrapper_),j(this.onMouseDownHandleWrapper_),st(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength)}setHandleLength(t){this.handleLength=t,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength-this.handleLength)}setHandlePosition(t){this.handlePosition=t,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(t){this.scrollbarLength=t,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(t,e){this.position.x=t,this.position.y=e,at(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(t){(t||(t=this.workspace.getMetrics()))&&(this.oldHostMetrics&&Nl.metricsAreEquivalent(t,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(t):this.resizeVertical(t),this.oldHostMetrics=t,this.updateMetrics()))}requiresViewResize(t){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==t.viewWidth||this.oldHostMetrics.viewHeight!==t.viewHeight||this.oldHostMetrics.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics.absoluteTop!==t.absoluteTop}resizeHorizontal(t){this.requiresViewResize(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)}resizeViewHorizontal(t){var e=t.viewWidth-2*this.margin;this.pair&&(e-=Nl.scrollbarThickness),this.setScrollbarLength(Math.max(0,e)),e=t.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(e+=Nl.scrollbarThickness),this.setPosition(e,t.absoluteTop+t.viewHeight-Nl.scrollbarThickness-this.margin),this.resizeContentHorizontal(t)}resizeContentHorizontal(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var e=this.scrollbarLength*t.viewWidth/t.scrollWidth;e=this.constrainHandleLength(e),this.setHandleLength(e),e=t.scrollWidth-t.viewWidth;var i=this.scrollbarLength-this.handleLength;t=(t.viewLeft-t.scrollLeft)/e*i,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=i/e}}resizeVertical(t){this.requiresViewResize(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)}resizeViewVertical(t){let e=t.viewHeight-2*this.margin;this.pair&&(e-=Nl.scrollbarThickness),this.setScrollbarLength(Math.max(0,e)),this.setPosition(this.workspace.RTL?t.absoluteLeft+this.margin:t.absoluteLeft+t.viewWidth-Nl.scrollbarThickness-this.margin,t.absoluteTop+this.margin),this.resizeContentVertical(t)}resizeContentVertical(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var e=this.scrollbarLength*t.viewHeight/t.scrollHeight;e=this.constrainHandleLength(e),this.setHandleLength(e),e=t.scrollHeight-t.viewHeight;var i=this.scrollbarLength-this.handleLength;t=(t.viewTop-t.scrollTop)/e*i,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=i/e}}isVisible(){return this.isHandleVisible}setContainerVisible(t){const e=t!==this.containerVisible;this.containerVisible=t,e&&this.updateDisplay_()}setVisible(t){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(t)}setVisibleInternal(t){const e=t!==this.isVisible();this.isHandleVisible=t,e&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(t){if(this.workspace.markFocused(),H(),this.cleanUp(),Y(t))t.stopPropagation();else{var e=K(t,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());e=this.horizontal?e.x:e.y;var i=kt(this.svgHandle);i=this.horizontal?i.x:i.y;var o=this.handlePosition,n=.95*this.handleLength;e<=i?o-=n:e>=i+this.handleLength&&(o+=n),this.setHandlePosition(this.constrainHandlePosition(o)),this.updateMetrics(),t.stopPropagation(),t.preventDefault()}}onMouseDownHandle(t){this.workspace.markFocused(),this.cleanUp(),Y(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?t.clientX:t.clientY,this.onMouseUpWrapper_=W(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=W(document,"pointermove",this,this.onMouseMoveHandle),t.stopPropagation(),t.preventDefault())}onMouseMoveHandle(t){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?t.clientX:t.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){H(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(j(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(j(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let t=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(t)&&(t=0),t}updateMetrics(){const t=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:t}):this.workspace.setMetrics({y:t})}set(t,e){this.setHandlePosition(this.constrainHandlePosition(t*this.ratio)),(e||void 0===e)&&this.updateMetrics()}setOrigin(t,e){this.origin=new yl(t,e)}static metricsAreEquivalent(t,e){return t.viewWidth===e.viewWidth&&t.viewHeight===e.viewHeight&&t.viewLeft===e.viewLeft&&t.viewTop===e.viewTop&&t.absoluteTop===e.absoluteTop&&t.absoluteLeft===e.absoluteLeft&&t.scrollWidth===e.scrollWidth&&t.scrollHeight===e.scrollHeight&&t.scrollLeft===e.scrollLeft&&t.scrollTop===e.scrollTop}};Nl.scrollbarThickness=qa?25:15,Nl.DEFAULT_SCROLLBAR_MARGIN=.5;var Pl={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},Bl={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Fl,DOMParser:Hl,XMLSerializer:Ul}=globalThis;Hl&&(Pl=new Hl),Ul&&(Bl=new Ul);var Gl="https://developers.google.com/blockly/xml",Vl=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Wl={NAME_SPACE:Gl};Wl.createElement=Ur.createElement$$module$build$src$core$utils$xml,Wl.createTextNode=Ur.createTextNode$$module$build$src$core$utils$xml,Wl.domToText=Rt,Wl.injectDependencies=Ot,Wl.textToDom=Ur.textToDom$$module$build$src$core$utils$xml;var zl,jl="categoryToolbox",Xl="flyoutToolbox";!function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(zl||(zl={}));var Yl,Kl,Jl,ql={hasCategoriesInternal:Nt},Zl={};Zl.Position=zl,Zl.TEST_ONLY=ql,Zl.convertFlyoutDefToJsonArray=Lt,Zl.convertToolboxDefToJson=Mt,Zl.hasCategories=Dt,Zl.isCategoryCollapsible=Pt,Zl.parseToolboxTree=Ut,function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"}(Yl||(Yl={})),function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(Kl||(Kl={})),function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN"}(Jl||(Jl={}));var Ql={};Ql.bumpDirection=Jl,Ql.bumpPositionRect=Wt,Ql.getCornerOppositeToolbox=Vt,Ql.getStartPositionRect=Gt,Ql.horizontalPosition=Kl,Ql.verticalPosition=Yl;var th=96,eh=124,ih="sprites.png",oh=class{constructor(t){this.workspace=t,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=tt(Cl.G,{});const t=String(Math.random()).substring(2);return this.createZoomOutSvg(t),this.createZoomInSvg(t),this.workspace.isMovable()&&this.createZoomResetSvg(t),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[fl.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&st(this.svgGroup);for(const t of this.boundEvents)j(t);this.boundEvents.length=0}getBoundingRectangle(){let t=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(t+=this.LARGE_SPACING+this.HEIGHT),new Ol(this.top,this.top+t,this.left,this.left+this.WIDTH)}position(t,e){if(this.initialized){var i,o=Vt(this.workspace,t),n=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(n+=this.LARGE_SPACING+this.HEIGHT),t=Gt(o,new Rl(this.WIDTH,n),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,t,this.workspace),o=o.vertical,e=Wt(t,this.MARGIN_VERTICAL,o===Yl.TOP?Jl.DOWN:Jl.UP,e),o===Yl.TOP){var s,r=this.SMALL_SPACING+this.HEIGHT;null==(s=this.zoomInGroup)||s.setAttribute("transform","translate(0, "+r+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(r+this.LARGE_SPACING+this.HEIGHT)+")")}else{let t;s=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(t=this.zoomInGroup)||t.setAttribute("transform","translate(0, "+s+")"),s=s+this.SMALL_SPACING+this.HEIGHT,null==(r=this.zoomOutGroup)||r.setAttribute("transform","translate(0, "+s+")")}this.top=e.top,this.left=e.left,null==(i=this.svgGroup)||i.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(t){this.zoomOutGroup=tt(Cl.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const e=tt(Cl.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup);tt(Cl.RECT,{width:32,height:32},e),tt(Cl.IMAGE,{width:th,height:eh,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup).setAttributeNS(wl,"xlink:href",this.workspace.options.pathToMedia+ih),this.boundEvents.push(W(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(t){this.zoomInGroup=tt(Cl.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const e=tt(Cl.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup);tt(Cl.RECT,{width:32,height:32},e),tt(Cl.IMAGE,{width:th,height:eh,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup).setAttributeNS(wl,"xlink:href",this.workspace.options.pathToMedia+ih),this.boundEvents.push(W(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(t,e){this.workspace.markFocused(),this.workspace.zoomCenter(t),this.fireZoomEvent(),H(),e.stopPropagation(),e.preventDefault()}createZoomResetSvg(t){this.zoomResetGroup=tt(Cl.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const e=tt(Cl.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup);tt(Cl.RECT,{width:32,height:32},e),tt(Cl.IMAGE,{width:th,height:eh,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup).setAttributeNS(wl,"xlink:href",this.workspace.options.pathToMedia+ih),this.boundEvents.push(W(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(t){this.workspace.markFocused();const e=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(e),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),H(),t.stopPropagation(),t.preventDefault()}fireZoomEvent(){const t=new(E(na))(null,this.workspace.id,"zoom_controls");p(t)}};Z("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var nh="_TEMP_COLLAPSED_INPUT",sh="_TEMP_COLLAPSED_FIELD",rh="MANUALLY_DISABLED",ah={COLLAPSED_FIELD_NAME:sh,COLLAPSED_INPUT_NAME:nh,MANUALLY_DISABLED:rh},lh=class{constructor(t){this.name=t}toString(){return this.name}equals(t){return this.name===t.toString()}};lh.MUTATOR=new lh("mutator"),lh.WARNING=new lh("warning"),lh.COMMENT=new lh("comment"),function(t){t[t.VALUE=1]="VALUE",t[t.STATEMENT=3]="STATEMENT",t[t.DUMMY=5]="DUMMY",t[t.CUSTOM=6]="CUSTOM",t[t.END_ROW=7]="END_ROW"}(Ur.inputTypes$$module$build$src$core$inputs$input_types||(Ur.inputTypes$$module$build$src$core$inputs$input_types={})),Ur.inputTypes$$module$build$src$core$inputs$input_types;var hh,ch,uh=function(t,e){window.alert(t),e&&e()},dh=function(t,e){e(window.confirm(t))},ph=function(t,e,i){i(window.prompt(t,e))},gh={confirmInternal:Yt},fh={TEST_ONLY:gh};fh.alert=zt,fh.confirm=Xt,fh.prompt=Jt,fh.setAlert=jt,fh.setConfirm=Kt,fh.setPrompt=qt,Ur.Msg$$module$build$src$core$msg=Object.create(null),hh=function(t){Object.keys(t).forEach((function(e){Ur.Msg$$module$build$src$core$msg[e]=t[e]}))},ch={Msg:Ur.Msg$$module$build$src$core$msg,setLocale:hh};var mh={};mh.isLegacyProcedureCallBlock=te,mh.isLegacyProcedureDefBlock=Qt;var vh=class extends Na{constructor(t){super(),this.isBlank=void 0===t,t&&(this.varId=t.getId(),this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return t.varId=this.varId,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new vh)).varId=t.varId,e}},bh=class extends vh{constructor(t){super(t),this.type=Zr,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new bh)).varType=t.varType,e.varName=t.varName,e}run(t){const e=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?e.createVariable(this.varName,this.varType,this.varId):e.deleteVariableById(this.varId)}};t(jr.EVENT,Zr,bh);var _h=class{constructor(t,e,i,o){this.workspace=t,this.name=e,this.type=i||"",this.id_=o||u()}getId(){return this.id_}static compareByName(t,e){return t.name.localeCompare(e.name,void 0,{sensitivity:"base"})}},yh="VARIABLE",Th="ijkmnopqrstuvwxyzabcdefgh",Eh={generateUniqueNameInternal:ne},wh={CATEGORY_NAME:yh,TEST_ONLY:Eh,VAR_LETTER_OPTIONS:Th};wh.allDeveloperVariables=Ur.allDeveloperVariables$$module$build$src$core$variables,wh.allUsedVarModels=Ur.allUsedVarModels$$module$build$src$core$variables,wh.createVariableButtonHandler=re,wh.flyoutCategory=ee,wh.flyoutCategoryBlocks=ie,wh.generateUniqueName=oe,wh.generateUniqueNameFromOptions=se,wh.generateVariableFieldDom=pe,wh.getAddedVariables=fe,wh.getOrCreateVariablePackage=Ur.getOrCreateVariablePackage$$module$build$src$core$variables,wh.getVariable=Ur.getVariable$$module$build$src$core$variables,wh.nameUsedWithAnyType=he,wh.nameUsedWithConflictingParam=ce,wh.promptName=ae,wh.renameVariable=Ur.renameVariable$$module$build$src$core$variables;var kh=new Set,Ih=new WeakSet,$h=new WeakMap,Sh=null,Ch=null,Oh=0,Rh={};Rh.finishQueuedRenders=ve,Rh.queueRender=me,Rh.triggerQueuedRenders=be;var Ah=class{constructor(t,e){this.workspace=t,this.text="",this.size=new Rl(120,100),this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new yl(0,0),this.disposing=this.disposed=!1,this.id=e&&!t.getCommentById(e)?e:u(),t.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){b()&&p(new(E(ua))(this))}fireDeleteEvent(){b()&&p(new(E(da))(this))}fireChangeEvent(t,e){b()&&p(new(E(pa))(this,t,e))}fireCollapseEvent(t){b()&&p(new(E(fa))(this,t))}setText(t){const e=this.text;this.text=t,this.fireChangeEvent(e,t)}getText(){return this.text}setSize(t){this.size=t}getSize(){return this.size}setCollapsed(t){this.collapsed=t,this.fireCollapseEvent(t)}isCollapsed(){return this.collapsed}setEditable(t){this.editable=t}isEditable(){return this.isOwnEditable()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable}setMovable(t){this.movable=t}isMovable(){return this.isOwnMovable()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable}setDeletable(t){this.deletable=t}isDeletable(){return this.isOwnDeletable()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable}moveTo(t,e){const i=new(E(ga))(this);e&&i.setReason(e),this.location=t,i.recordNew(),b()&&p(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},Mh=50,xh=class{constructor(t){let e;this.workspace=t,this.size=new Rl(120,100),this.collapsed=!1,this.editable=!0,this.location=new yl(0,0),this.text="",this.textChangeListeners=[],this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=tt(Cl.G,{class:"blocklyComment blocklyEditable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteIcon:this.deleteIcon,foldoutIcon:this.foldoutIcon,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot,t)),({foreignObject:this.foreignObject,textArea:this.textArea}=this.createTextArea(this.svgRoot)),this.resizeHandle=this.createResizeHandle(this.svgRoot,t),null==(e=t.getLayerManager())||e.append(this,Mh),this.setSize(this.size),this.moveTo(new yl(0,0))}createHighlightRect(t){return tt(Cl.RECT,{class:"blocklyCommentHighlight"},t)}createTopBar(t,e){t=tt(Cl.G,{class:"blocklyCommentTopbar"},t);const i=tt(Cl.RECT,{class:"blocklyCommentTopbarBackground"},t),o=tt(Cl.IMAGE,{class:"blocklyDeleteIcon",href:`${e.options.pathToMedia}delete-icon.svg`},t);e=tt(Cl.IMAGE,{class:"blocklyFoldoutIcon",href:`${e.options.pathToMedia}foldout-icon.svg`},t);const n=tt(Cl.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},t),s=document.createTextNode("");return n.appendChild(s),W(e,"pointerdown",this,this.onFoldoutDown),W(o,"pointerdown",this,this.onDeleteDown),{topBarGroup:t,topBarBackground:i,deleteIcon:o,foldoutIcon:e,textPreview:n,textPreviewNode:s}}createTextArea(t){t=tt(Cl.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"},t);const e=document.createElementNS(El,"body");e.setAttribute("xmlns",El),e.className="blocklyMinimalBody";const i=document.createElementNS(El,"textarea");return et(i,"blocklyCommentText"),et(i,"blocklyTextarea"),et(i,"blocklyText"),e.appendChild(i),t.appendChild(e),W(i,"change",this,this.onTextChange),{foreignObject:t,textArea:i}}createResizeHandle(t,e){return t=tt(Cl.IMAGE,{class:"blocklyResizeHandle",href:`${e.options.pathToMedia}resize-handle.svg`},t),W(t,"pointerdown",this,this.onResizePointerDown),t}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSize(t){const e=this.topBarBackground.getBBox(),i=this.deleteIcon.getBBox(),o=this.foldoutIcon.getBBox(),n=this.textPreview.getBBox(),s=this.resizeHandle.getBBox();t=Rl.max(t,this.calcMinSize(e,o,i));const r=this.size;this.size=t,this.svgRoot.setAttribute("height",`${t.height}`),this.svgRoot.setAttribute("width",`${t.width}`),this.updateHighlightRect(t),this.updateTopBarSize(t),this.updateTextAreaSize(t,e),this.updateDeleteIconPosition(t,e,i),this.updateFoldoutIconPosition(e,o),this.updateTextPreviewSize(t,e,n,i,s),this.updateResizeHandlePosition(t,s),this.onSizeChange(r,this.size)}calcMinSize(t,e,i){var o;this.updateTextPreview(null!=(o=this.textArea.value)?o:""),o=ct(this.textPreview);const n=this.calcFoldoutMargin(t,e),s=this.calcDeleteMargin(t,i);let r=o;return this.foldoutIcon.checkVisibility()?r+=e.width+2*n:o&&(r+=4),this.deleteIcon.checkVisibility()?r+=i.width+2*s:o&&(r+=4),new Rl(r,t.height+20)}calcDeleteMargin(t,e){return(t.height-e.height)/2}calcFoldoutMargin(t,e){return(t.height-e.height)/2}updateHighlightRect(t){this.highlightRect.setAttribute("height",`${t.height}`),this.highlightRect.setAttribute("width",`${t.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-t.width)}updateTopBarSize(t){this.topBarBackground.setAttribute("width",`${t.width}`)}updateTextAreaSize(t,e){this.foreignObject.setAttribute("height",""+(t.height-e.height)),this.foreignObject.setAttribute("width",`${t.width}`),this.foreignObject.setAttribute("y",`${e.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-t.width)}updateDeleteIconPosition(t,e,i){e=this.calcDeleteMargin(e,i),this.deleteIcon.setAttribute("y",`${e}`),this.deleteIcon.setAttribute("x",""+(t.width-i.width-e))}updateFoldoutIconPosition(t,e){t=this.calcFoldoutMargin(t,e),this.foldoutIcon.setAttribute("y",`${t}`),this.foldoutIcon.setAttribute("x",`${t}`)}updateTextPreviewSize(t,e,i,o,n){const s=(e.height-i.height)/2,r=this.calcDeleteMargin(e,o);e=this.calcFoldoutMargin(e,n),t=t.width-n.width-2*e-o.width-2*r,this.textPreview.setAttribute("x",`${n.width+2*e*(this.workspace.RTL?-1:1)}`),this.textPreview.setAttribute("y",`${s+i.height/2}`),this.textPreview.setAttribute("width",`${t}`)}updateResizeHandlePosition(t,e){this.resizeHandle.setAttribute("y",""+(t.height-e.height)),this.resizeHandle.setAttribute("x",""+(t.width-e.width))}onSizeChange(t,e){for(let i=this.sizeChangeListeners.length-1;0<=i;i--)this.sizeChangeListeners[i](t,e)}addSizeChangeListener(t){this.sizeChangeListeners.push(t)}removeSizeChangeListener(t){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(t),1)}onResizePointerDown(t){this.isEditable()&&(this.bringToFront(),Y(t)||(this.workspace.startDrag(t,new yl(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=W(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=W(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),t.stopPropagation())}onResizePointerUp(t){H(),this.resizePointerUpListener&&(j(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(j(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(t){t=this.workspace.moveDrag(t),this.setSize(new Rl(this.workspace.RTL?-t.x:t.x,t.y))}isCollapsed(){return this.collapsed}setCollapsed(t){(this.collapsed=t)?et(this.svgRoot,"blocklyCollapsed"):ot(this.svgRoot,"blocklyCollapsed"),this.setSize(this.size),this.onCollapse()}onCollapse(){for(let t=this.collapseChangeListeners.length-1;0<=t;t--)this.collapseChangeListeners[t](this.collapsed)}addOnCollapseListener(t){this.collapseChangeListeners.push(t)}removeOnCollapseListener(t){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(t),1)}onFoldoutDown(t){this.bringToFront(),Y(t)||(this.setCollapsed(!this.collapsed),this.workspace.hideChaff()),t.stopPropagation()}isEditable(){return this.editable}setEditable(t){(this.editable=t)?(et(this.svgRoot,"blocklyEditable"),ot(this.svgRoot,"blocklyReadonly"),this.textArea.removeAttribute("readonly")):(ot(this.svgRoot,"blocklyEditable"),et(this.svgRoot,"blocklyReadonly"),this.textArea.setAttribute("readonly","true"))}getRelativeToSurfaceXY(){return this.location}moveTo(t){this.location=t,this.svgRoot.setAttribute("transform",`translate(${t.x}, ${t.y})`)}getText(){return this.text}setText(t){this.textArea.value=t,this.onTextChange()}addTextChangeListener(t){this.textChangeListeners.push(t)}removeTextChangeListener(t){this.textChangeListeners.splice(this.textChangeListeners.indexOf(t),1)}onTextChange(){const t=this.text;this.text=this.textArea.value,this.updateTextPreview(this.text),this.setSize(this.size);for(let e=this.textChangeListeners.length-1;0<=e;e--)this.textChangeListeners[e](t,this.text)}updateTextPreview(t){this.textPreviewNode.textContent=this.truncateText(t)}truncateText(t){return 12<=t.length?`${t.substring(0,9)}...`:t}bringToFront(){const t=this.svgRoot.parentNode,e=t.childNodes;e[e.length-1]!==this.svgRoot&&t.appendChild(this.svgRoot)}onDeleteDown(t){Y(t)||this.dispose(),t.stopPropagation()}dispose(){this.disposing=!0,st(this.svgRoot);for(let t=this.disposeListeners.length-1;0<=t;t--)this.disposeListeners[t]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(t){this.disposeListeners.push(t)}removeDisposeListener(t){this.disposeListeners.splice(this.disposeListeners.indexOf(t),1)}};Z("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  cursor: grab;\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var Lh=class{constructor(t){this.comment=t,this.startLoc=null,this.workspace=t.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.workspace.options.readOnly}startDrag(){let t;Ur.getGroup$$module$build$src$core$events$utils()||Ur.setGroup$$module$build$src$core$events$utils(!0),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(t=this.workspace.getLayerManager())||t.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(t){this.comment.moveDuringDrag(t)}endDrag(){let t;this.fireMoveEvent(),null==(t=this.workspace.getLayerManager())||t.moveOffDragLayer(this.comment,Mh),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0),Ur.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var t=new(E(ga))(this.comment);t.setReason(["drag"]),t.oldCoordinate_=this.startLoc,t.recordNew(),p(t)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},Dh={BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},Nh={};Nh.register=Ie,Nh.unregister=$e;var Ph=class{constructor(){this.priority=25}save(t){const e=[];for(const i of t.getTopComments())(t=Se(i,{addCoordinates:!0,saveIds:!0}))&&e.push(t);return e.length?e:null}load(t,e){for(const i of t)Ce(i,e,{recordUndo:d()})}clear(t){for(const e of t.getTopComments())e.dispose()}};Ie("workspaceComments",new Ph);var Bh={};Bh.WorkspaceCommentSerializer=Ph,Bh.append=Ce,Bh.save=Se;var Fh={};Fh.register=Oe,Fh.unregister=Re;var Hh=class{paste(t,e,i){let o;t=t.commentState,i&&(t.x=i.x,t.y=i.y),Ur.disable$$module$build$src$core$events$utils();try{o=Ce(t,e),Ae(o)}finally{Ur.enable$$module$build$src$core$events$utils()}return o?(b()&&p(new(E(ua))(o)),Ur.setSelected$$module$build$src$core$common(o),o):null}};Hh.TYPE="workspace-comment",Oe(Hh.TYPE,new Hh),Ur.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},Ur.config$$module$build$src$core$config;var Uh,Gh,Vh="aria-",Wh="role";(function(t){t.GRID="grid",t.GRIDCELL="gridcell",t.GROUP="group",t.LISTBOX="listbox",t.MENU="menu",t.MENUITEM="menuitem",t.MENUITEMCHECKBOX="menuitemcheckbox",t.OPTION="option",t.PRESENTATION="presentation",t.ROW="row",t.TREE="tree",t.TREEITEM="treeitem"})(Uh||(Uh={})),function(t){t.ACTIVEDESCENDANT="activedescendant",t.COLCOUNT="colcount",t.DISABLED="disabled",t.EXPANDED="expanded",t.INVALID="invalid",t.LABEL="label",t.LABELLEDBY="labelledby",t.LEVEL="level",t.ORIENTATION="orientation",t.POSINSET="posinset",t.ROWCOUNT="rowcount",t.SELECTED="selected",t.SETSIZE="setsize",t.VALUEMAX="valuemax",t.VALUEMIN="valuemin"}(Gh||(Gh={}));var zh={};zh.Role=Uh,zh.State=Gh,zh.setRole=xe,zh.setState=Le;var jh=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(t){this.menuItems.push(t)}render(t){const e=document.createElement("div");e.className="blocklyMenu goog-menu blocklyNonSelectable",e.tabIndex=0,this.roleName&&xe(e,this.roleName),this.element=e;for(let t,i=0;t=this.menuItems[i];i++)e.appendChild(t.createDom());return this.mouseOverHandler=W(e,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=W(e,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=W(e,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=W(e,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=W(e,"keydown",this,this.handleKeyEvent),t.appendChild(e),e}getElement(){return this.element}focus(){const t=this.getElement();t&&(t.focus({preventScroll:!0}),et(t,"blocklyFocused"))}blur(){const t=this.getElement();t&&(t.blur(),ot(t,"blocklyFocused"))}setRole(t){this.roleName=t}dispose(){this.mouseOverHandler&&(j(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(j(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(j(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(j(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(j(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t,e=0;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(t){const e=this.getElement();for(;t&&t!==e;){if(t.classList.contains("blocklyMenuItem"))for(let e,i=0;e=this.menuItems[i];i++)if(e.getElement()===t)return e;t=t.parentElement}return null}setHighlighted(t){var e=this.highlightedItem;e&&(e.setHighlighted(!1),this.highlightedItem=null),t&&(t.setHighlighted(!0),this.highlightedItem=t,e=this.getElement(),Tt(t.getElement(),e),Le(e,Gh.ACTIVEDESCENDANT,t.getId()))}highlightNext(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(t,1)}highlightPrevious(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>t?this.menuItems.length:t,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(t,e){let i;for(t+=e;i=this.menuItems[t];){if(i.isEnabled()){this.setHighlighted(i);break}t+=e}}handleMouseOver(t){(t=this.getMenuItem(t.target))&&(t.isEnabled()?this.highlightedItem!==t&&this.setHighlighted(t):this.setHighlighted(null))}handleClick(t){const e=this.openingCoords;if(this.openingCoords=null,e&&"number"==typeof t.clientX){const i=new yl(t.clientX,t.clientY);if(1>yl.distance(e,i))return}(t=this.getMenuItem(t.target))&&t.performAction()}handleMouseEnter(t){this.focus()}handleMouseLeave(t){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(t){if(this.menuItems.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var e=this.highlightedItem;switch(t.key){case"Enter":case" ":e&&e.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}t.preventDefault(),t.stopPropagation()}}getSize(){const t=this.getElement(),e=gt(t);return e.height=t.scrollHeight,e}},Xh=class{constructor(t,e){this.content=t,this.opt_value=e,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const t=document.createElement("div");t.id=c(),this.element=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const e=document.createElement("div");if(e.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",e.appendChild(i)}return i=this.content,"string"==typeof this.content&&(i=document.createTextNode(this.content)),e.appendChild(i),t.appendChild(e),this.roleName&&xe(t,this.roleName),Le(t,Gh.SELECTED,this.checkable&&this.checked||!1),Le(t,Gh.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let t;return null!=(t=this.opt_value)?t:null}setRightToLeft(t){this.rightToLeft=t}setRole(t){this.roleName=t}setCheckable(t){this.checkable=t}setChecked(t){this.checked=t}setHighlighted(t){this.highlight=t;const e=this.getElement();e&&this.isEnabled()&&(t?(et(e,"blocklyMenuItemHighlight"),et(e,"goog-menuitem-highlight")):(ot(e,"blocklyMenuItemHighlight"),ot(e,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(t,e){this.actionHandler=t.bind(e)}},Yh=class extends Error{},Kh=class extends Yh{constructor(t){super("Expected to find a 'type' property, defining the block type"),this.state=t}},Jh=class extends Yh{constructor(t,e,i){super(`The block ${e.toDevString()} is missing a(n) ${t}\nconnection`),this.block=e,this.state=i}},qh=class extends Yh{constructor(t,e,i,o){super(`The block ${i.toDevString()} could not connect its\n${e} to its parent, because: ${t}`),this.childBlock=i,this.childState=o}},Zh=class extends Yh{constructor(t){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=t}},Qh=class extends Yh{constructor(t,e,i){super(`Cannot add an icon of type '${t}' to the block ${e.toDevString()}, because there is no icon registered with type '${t}'. Make sure that all of your icons have been registered.`),this.block=e,this.state=i}},tc={};tc.BadConnectionCheck=qh,tc.DeserializationError=Yh,tc.MissingBlockType=Kh,tc.MissingConnection=Jh,tc.RealChildOfShadow=Zh,tc.UnregisteredIcon=Qh;var ec=class{constructor(){this.priority=50}save(t){const e=[];for(const i of t.getTopBlocks(!1))(t=Ne(i,{addCoordinates:!0,doFullSerialization:!1}))&&e.push(t);return e.length?{languageVersion:0,blocks:e}:null}load(t,e){t=t.blocks;for(const i of t)ze(i,e,{recordUndo:d()})}clear(t){for(const e of t.getTopBlocks(!1))e.dispose(!1)}};Ie("blocks",new ec);var ic={};ic.BlockSerializer=ec,ic.append=ze,ic.appendInternal=je,ic.save=Ne;var oc=class extends Na{constructor(t){super(),this.isBlank=!t,t&&(this.blockId=t.id,this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.blockId=this.blockId,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new oc)).blockId=t.blockId,e}},nc=class extends oc{constructor(t,e,i,o,n){super(t),this.type=Ur.CHANGE$$module$build$src$core$events$utils,t&&(this.element=e,this.name=i||void 0,this.oldValue=o,this.newValue=n)}toJson(){const t=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return t.element=this.element,t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,this.disabledReason&&(t.disabledReason=this.disabledReason),t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new nc)).element=t.element,e.name=t.name,e.oldValue=t.oldValue,e.newValue=t.newValue,void 0!==t.disabledReason&&(e.disabledReason=t.disabledReason),e}setDisabledReason(t){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=t}isNull(){return this.oldValue===this.newValue}run(t){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(e=e.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const i=e.getIcon(lh.MUTATOR);switch(i&&si(i)&&i.bubbleIsVisible()&&i.setBubbleVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(e=e.getField(this.name))?e.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":e.setCommentText(t||null);break;case"collapsed":e.setCollapsed(!!t);break;case"disabled":var o;e.setDisabledReason(!!t,null!=(o=this.disabledReason)?o:rh);break;case"inline":e.setInputsInline(!!t);break;case"mutation":o=nc.getExtraBlockState_(e),e.loadExtraState?e.loadExtraState(JSON.parse(t||"{}")):e.domToMutation&&e.domToMutation(Ur.textToDom$$module$build$src$core$utils$xml(t||"<mutation/>")),p(new nc(e,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(t){return t.saveExtraState?(t=t.saveExtraState(!0))?JSON.stringify(t):"":t.mutationToDom&&(t=t.mutationToDom())?qo(t):""}};t(jr.EVENT,Ur.CHANGE$$module$build$src$core$events$utils,nc);var sc={};sc.clamp=li,sc.toDegrees=ai,sc.toRadians=ri;var rc,ac,lc,hc=16,cc=1,uc=12,dc=16,pc=.25,gc=null,fc=null,mc="",vc="",bc=null,_c=null,yc=null,Tc={getBoundsInfo:function(){const t=bt(bc),e=gt(bc);return{left:t.x,right:t.x+e.width,top:t.y,bottom:t.y+e.height,width:e.width,height:e.height}},getPositionMetrics:function(t,e,i,o){const n=Tc.getBoundsInfo(),s=gt(rc);return e+s.height<n.bottom?Ti(t,e,n,s):o-s.height>n.top?Ei(i,o,n,s):e+s.height<document.documentElement.clientHeight?Ti(t,e,n,s):o-s.height>document.documentElement.clientTop?Ei(i,o,n,s):wi(t,n,s)}},Ec={ANIMATION_TIME:pc,ARROW_HORIZONTAL_PADDING:uc,ARROW_SIZE:hc,BORDER_SIZE:cc,PADDING_Y:dc,TEST_ONLY:Tc};Ec.clearContent=pi,Ec.createDom=hi,Ec.getContentDiv=di,Ec.getOwner=ui,Ec.getPositionX=ki,Ec.hide=Si,Ec.hideIfOwner=$i,Ec.hideWithoutAnimation=Ci,Ec.isVisible=Ii,Ec.repositionForWindowResize=Ri,Ec.setBoundsElement=ci,Ec.setColour=gi,Ec.show=yi,Ec.showPositionedByBlock=fi,Ec.showPositionedByField=mi;var wc=class{constructor(t){this.workspace=t,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(t,e){this.markers.has(t)&&this.unregisterMarker(t),e.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,e)),this.setMarkerSvg(e.getDrawer().createDom()),this.markers.set(t,e)}unregisterMarker(t){const e=this.markers.get(t);if(!e)throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.");e.dispose(),this.markers.delete(t)}getCursor(){return this.cursor_}getMarker(t){return this.markers.get(t)||null}setCursor(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(t){t?(this.workspace.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null}setMarkerSvg(t){t?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(t)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const t=Object.keys(this.markers);for(let e,i=0;e=t[i];i++)this.unregisterMarker(e);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};wc.LOCAL_MARKER="local_marker_1";var kc={};kc.commonWordPrefix=Mi,kc.commonWordSuffix=xi,kc.isNumber=Ur.isNumber$$module$build$src$core$utils$string,kc.shortestStringLength=Ai,kc.wrap=Ur.wrap$$module$build$src$core$utils$string;var Ic=void 0,$c=!1,Sc=!1,Cc=50,Oc=0,Rc=0,Ac=0,Mc=0,xc=null,Lc=null,Dc=0,Nc=10,Pc=10,Bc=750,Fc=5,Hc=null,Uc={HOVER_MS:Bc,LIMIT:Cc,MARGINS:Fc,OFFSET_X:Dc,OFFSET_Y:Nc,RADIUS_OK:Pc};Uc.bindMouseEvents=zi,Uc.block=Zi,Uc.createDom=Wi,Uc.dispose=Ji,Uc.getCustomTooltip=Fi,Uc.getDiv=Ui,Uc.getTooltipOfObject=Gi,Uc.hide=qi,Uc.isVisible=Hi,Uc.setCustomTooltip=Bi,Uc.unbindMouseEvents=ji,Uc.unblock=Qi;var Gc=.45,Vc=.65,Wc={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},zc={};zc.blend=po,zc.getHsvSaturation=no,zc.getHsvValue=ro,zc.hexToRgb=co,zc.hsvToHex=uo,zc.hueToHex=go,zc.names=Wc,zc.parse=lo,zc.rgbToHex=ho,zc.setHsvSaturation=so,zc.setHsvValue=ao;var jc={};jc.checkMessageReferences=bo,jc.parseBlockColour=_o,jc.replaceMessageReferences=vo,jc.tokenizeInterpolation=mo;var Xc=class{constructor(t,e,i){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Rl(0,0),t!==Xc.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(t),e&&this.setValidator(e))}configure_(t){t.tooltip&&this.setTooltip(vo(t.tooltip))}setSourceBlock(t){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=t}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=tt(Cl.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel(),this.applyColour())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=tt(Cl.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=tt(Cl.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const t=this.getClickTarget_();if(!t)throw Error("A click target has not been set.");zi(t),this.mouseDownWrapper_=W(t,"pointerdown",this,this.onMouseDown_)}fromXml(t){this.setValue(t.textContent)}toXml(t){return t.textContent=this.getValue(),t}saveState(t){return null!==(t=this.saveLegacyState(Xc))?t:this.getValue()}loadState(t){this.loadLegacyState(Xc,t)||this.setValue(t)}saveLegacyState(t){return t.prototype.saveState===this.saveState&&t.prototype.toXml!==this.toXml?((t=Ur.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Rt(this.toXml(t)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(t,e){return t.prototype.loadState===this.loadState&&t.prototype.fromXml!==this.fromXml&&(this.fromXml(Ur.textToDom$$module$build$src$core$utils$xml(e)),!0)}dispose(){let t;$i(this),$o(this),null!=(t=this.getSourceBlock())&&t.isDeadOrDying()||st(this.fieldGroup_),this.disposed=!0}updateEditable(){const t=this.fieldGroup_,e=this.getSourceBlock();this.EDITABLE&&t&&e&&(this.enabled_&&e.isEditable()?(et(t,"blocklyEditableText"),ot(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(et(t,"blocklyNonEditableText"),ot(t,"blocklyEditableText"),t.style.cursor=""))}setEnabled(t){this.enabled_=t,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Xc.prototype.showEditor_}isClickableInFlyout(t){return!t}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t}isVisible(){return this.visible_}setVisible(t){if(this.visible_!==t){this.visible_=t;var e=this.fieldGroup_;e&&(e.style.display=t?"block":"none")}}setValidator(t){this.validator_=t}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(t){this.isClickable()&&this.showEditor_(t)}showEditor_(t){}repositionForWindowResize(){return!1}updateSize_(t){const e=this.getConstants();let i=2*(t=void 0!==t?t:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),o=e.FIELD_TEXT_HEIGHT,n=0;this.textElement_&&(n=ut(this.textElement_,e.FIELD_TEXT_FONTSIZE,e.FIELD_TEXT_FONTWEIGHT,e.FIELD_TEXT_FONTFAMILY),i+=n),this.isFullBlockField()||(o=Math.max(o,e.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=o,this.size_.width=i,this.positionTextElement_(t,n),this.positionBorderRect_()}positionTextElement_(t,e){if(this.textElement_){var i,o=this.getConstants(),n=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(i=this.getSourceBlock())&&i.RTL?this.size_.width-e-t:t)),this.textElement_.setAttribute("y",String(o.FIELD_TEXT_BASELINE_CENTER?n:n-o.FIELD_TEXT_HEIGHT/2+o.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(this.render_(),0!==this.size_.width&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Rl(0,0)}getScaledBBox(){let t;var e=this.getSourceBlock();if(!e)throw new Yc;if(this.isFullBlockField()){var i=this.sourceBlock_.getHeightWidth();const o=e.workspace.scale;t=this.getAbsoluteXY_(),e=(i.width+1)*o,i=(i.height+1)*o,ol?(t.x+=1.5*o,t.y+=1.5*o):(t.x-=.5*o,t.y-=.5*o)}else i=this.borderRect_.getBoundingClientRect(),t=bt(this.borderRect_),e=i.width,i=i.height;return new Ol(t.y,t.y+i,t.x,t.x+e)}onLocationChange(t){}getDisplayText_(){let t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"â¦"),t=t.replace(/\s/g,Xc.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="â"),t):Xc.NBSP}getText(){const t=this.getText_();return String(null!==t?t:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(t,e=!0){if(null!==t){var i,o=this.doClassValidation_(t);(t=this.processValidation_(t,o,e))instanceof Error||(o=null==(i=this.getValidator())?void 0:i.call(this,t),(i=this.processValidation_(t,o,e))instanceof Error||(t=this.sourceBlock_)&&t.disposed||((o=this.getValue())===i?this.doValueUpdate_(i):(this.doValueUpdate_(i),e&&t&&b()&&p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(t,"field",this.name||null,o,i)),this.isDirty_&&this.forceRerender())))}}processValidation_(t,e,i){return null===e?(this.doValueInvalid_(t,i),this.isDirty_&&this.forceRerender(),Error()):void 0===e?t:e}getValue(){return this.value_}doClassValidation_(t){return null==t?null:t}doValueUpdate_(t){this.value_=t,this.isDirty_=!0}doValueInvalid_(t,e){}onMouseDown_(t){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)}setTooltip(t){t||""===t||(t=this.sourceBlock_);const e=this.getClickTarget_();e?e.tooltip=t:this.tooltip_=t}getTooltip(){const t=this.getClickTarget_();return Gi(t||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return bt(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;const e=this.getSourceBlock();if(!e)throw new Yc;const i=e.inputList;for(let o=0;o<e.inputList.length;o++){const e=i[o],n=e.fieldRow;for(let i=0;i<n.length;i++)if(n[i]===this){t=e;break}}return t}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(t){return!1}setCursorSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.cursorSvg_=t}else this.cursorSvg_=null}setMarkerSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.markerSvg_=t}else this.markerSvg_=null}updateMarkers_(){var t=this.getSourceBlock();if(!t)throw new Yc;(t=t.workspace).keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(wc.LOCAL_MARKER).draw()}static fromJson(t){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};Xc.NBSP="Â ",Xc.SKIP_SETUP=Symbol("SKIP_SETUP");var Yc=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Kc={};Kc.Field=Xc,Kc.UnattachedFieldError=Yc;var Jc,qc=null,Zc=null,Qc=null,tu="blocklyWidgetDiv",eu="",iu="",ou={};ou.createDom=Eo,ou.getDiv=yo,ou.hide=ko,ou.hideIfOwner=$o,ou.hideIfOwnerIsInWorkspace=So,ou.isVisible=Io,ou.positionWithAnchor=Oo,ou.repositionForWindowResize=xo,ou.show=wo,ou.testOnly_setDiv=To;var nu=null,su={},ru=null,au={};au.callbackFactory=Ur.callbackFactory$$module$build$src$core$contextmenu,au.dispose=Go,au.getCurrentBlock=Lo,au.hide=Uo,au.setCurrentBlock=Do,au.show=No;var lu=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(t){if(this.registry_.has(t.id))throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_.set(t.id,t)}unregister(t){if(!this.registry_.has(t))throw Error('Menu item with ID "'+t+'" not found.');this.registry_.delete(t)}getItem(t){let e;return null!=(e=this.registry_.get(t))?e:null}getContextMenuOptions(t,e){const i=[];for(const n of this.registry_.values())if(t===n.scopeType){var o=n.preconditionFn(e);"hidden"!==o&&(o={text:"function"==typeof n.displayText?n.displayText(e):n.displayText,enabled:"enabled"===o,callback:n.callback,scope:e,weight:n.weight},i.push(o))}return i.sort((function(t,e){return t.weight-e.weight})),i}};!function(t){var e=t.ScopeType||(t.ScopeType={});e.BLOCK="block",e.WORKSPACE="workspace",e.COMMENT="comment",t.registry=new t}(lu||(lu={}));var hu=lu.ScopeType,cu={};cu.ContextMenuRegistry=lu,cu.ScopeType=hu;var uu=class extends Ah{constructor(t,e){super(t,e),this.dragStrategy=new Lh(this),this.workspace=t,this.view=new xh(t),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.addModelUpdateBindings(),W(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),W(this.view.getSvgRoot(),"wheel",this,(t=>{t.stopPropagation()}))}addModelUpdateBindings(){this.view.addTextChangeListener(((t,e)=>{super.setText(e)})),this.view.addSizeChangeListener(((t,e)=>{super.setSize(e)})),this.view.addOnCollapseListener((()=>{super.setCollapsed(this.view.isCollapsed())})),this.view.addDisposeListener((()=>{this.isDeadOrDying()||this.dispose()}))}setText(t){this.view.setText(t)}setSize(t){this.view.setSize(t)}setCollapsed(t){this.view.setCollapsed(t)}setEditable(t){super.setEditable(t),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY();var e,i;const o=null!=(i=null==(e=this.view)?void 0:e.getSize())?i:this.getSize();return this.workspace.RTL?(e=t.x-o.width,i=t.x):(e=t.x,i=t.x+o.width),new Ol(t.y,t.y+o.height,e,i)}moveBy(t,e,i){const o=this.getRelativeToSurfaceXY();t=new yl(o.x+t,o.y+e),this.moveTo(t,i)}moveTo(t,e){super.moveTo(t,e),this.view.moveTo(t)}moveDuringDrag(t){this.location=t,this.view.moveTo(t)}setDragging(t){t?et(this.getSvgRoot(),"blocklyDragging"):ot(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0,this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(t){const e=this.workspace.getGesture(t);e&&(e.handleCommentStart(t,this),Ur.setSelected$$module$build$src$core$common(this))}setDeleteStyle(t){t?et(this.getSvgRoot(),"blocklyDraggingDelete"):ot(this.getSvgRoot(),"blocklyDraggingDelete")}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(t){this.dragStrategy.drag(t)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){et(this.getSvgRoot(),"blocklySelected")}unselect(){ot(this.getSvgRoot(),"blocklySelected")}toCopyData(){return{paster:Hh.TYPE,commentState:Se(this,{addCoordinates:!0})}}showContextMenu(t){const e=lu.registry.getContextMenuOptions(lu.ScopeType.COMMENT,{comment:this});No(t,e,this.workspace.RTL,this.workspace)}snapToGrid(){if(!this.isDeadOrDying()){var t=this.workspace.getGrid();if(null!=t&&t.shouldSnap()){var e=this.getRelativeToSurfaceXY();(t=t.alignXY(e))!==e&&this.moveTo(t,["snap"])}}}},du={};du.appendDomToWorkspace=en,du.blockToDom=Ko,du.blockToDomWithXY=jo,du.clearWorkspaceAndLoadFromXml=Qo,du.deleteNext=fn,du.domToBlock=Ur.domToBlock$$module$build$src$core$xml,du.domToBlockInternal=on,du.domToPrettyText=Zo,du.domToText=qo,du.domToVariables=nn,du.domToWorkspace=Ur.domToWorkspace$$module$build$src$core$xml,du.loadWorkspaceComment=tn,du.saveWorkspaceComment=Wo,du.variablesToDom=zo,du.workspaceToDom=Vo;var pu=class extends oc{constructor(t){super(t),this.type=Ur.CREATE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=jo(t),this.ids=y(t),this.json=Ne(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=qo(this.xml),t.ids=this.ids,t.json=this.json,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new pu)).xml=Ur.textToDom$$module$build$src$core$utils$xml(t.xml),e.ids=t.ids,e.json=t.json,void 0!==t.recordUndo&&(e.recordUndo=t.recordUndo),e}run(t){const e=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!gu(e,this.ids))if(t)ze(this.json,e);else for(t=0;t<this.ids.length;t++){const i=this.ids[t],o=e.getBlockById(i);o?o.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},gu=function(t,e){return e.map((e=>t.getBlockById(e))).filter((t=>t&&t.isShadow())).length===e.length};t(jr.EVENT,Ur.CREATE$$module$build$src$core$events$utils,pu);var fu=class extends Pa{constructor(t,e){super(e),this.type=ha,this.themeName=t}toJson(){const t=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return t.themeName=this.themeName,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new fu)).themeName=t.themeName,e}};t(jr.EVENT,ha,fu);var mu,vu=class extends Pa{constructor(t,e,i,o,n){super(o),this.type=ca,this.viewTop=t,this.viewLeft=e,this.scale=i,this.oldScale=n}toJson(){const t=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new vu)).viewTop=t.viewTop,e.viewLeft=t.viewLeft,e.scale=t.scale,e.oldScale=t.oldScale,e}};t(jr.EVENT,ca,vu),function(t){t[t.INPUT_VALUE=1]="INPUT_VALUE",t[t.OUTPUT_VALUE=2]="OUTPUT_VALUE",t[t.NEXT_STATEMENT=3]="NEXT_STATEMENT",t[t.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"}(mu||(mu={}));var bu=class{constructor(t){this.connectionChecker=t,this.connections=[]}addConnection(t,e){e=this.calculateIndexForYPos(e),this.connections.splice(e,0,t)}findIndexOfConnection(t,e){if(!this.connections.length)return-1;const i=this.calculateIndexForYPos(e);if(i>=this.connections.length)return-1;e=t.y;let o=i;for(;0<=o&&this.connections[o].y===e;){if(this.connections[o]===t)return o;o--}for(o=i;o<this.connections.length&&this.connections[o].y===e;){if(this.connections[o]===t)return o;o++}return-1}calculateIndexForYPos(t){if(!this.connections.length)return 0;let e=0,i=this.connections.length;for(;e<i;){const o=Math.floor((e+i)/2);if(this.connections[o].y<t)e=o+1;else{if(!(this.connections[o].y>t)){e=o;break}i=o}}return e}removeConnection(t,e){if(-1===(t=this.findIndexOfConnection(t,e)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(t,1)}getNeighbours(t,e){function i(t){const i=n-o[t].x,r=s-o[t].y;return Math.sqrt(i*i+r*r)<=e&&l.push(o[t]),r<e}const o=this.connections,n=t.x,s=t.y;t=0;let r=o.length-2,a=r;for(;t<a;)o[a].y<s?t=a:r=a,a=Math.floor((t+r)/2);const l=[];if(r=t=a,o.length){for(;0<=t&&i(t);)t--;do{r++}while(r<o.length&&i(r))}return l}isInYRange(t,e,i){return Math.abs(this.connections[t].y-e)<=i}searchForClosest(t,e,i){if(!this.connections.length)return{connection:null,radius:e};const o=t.y,n=t.x;t.x=n+i.x,t.y=o+i.y;var s=this.calculateIndexForYPos(t.y);i=null;let r,a=e,l=s-1;for(;0<=l&&this.isInYRange(l,t.y,e);)r=this.connections[l],this.connectionChecker.canConnect(t,r,!0,a)&&(i=r,a=r.distanceFrom(t)),l--;for(;s<this.connections.length&&this.isInYRange(s,t.y,e);)r=this.connections[s],this.connectionChecker.canConnect(t,r,!0,a)&&(i=r,a=r.distanceFrom(t)),s++;return t.x=n,t.y=o,{connection:i,radius:a}}static init(t){const e=[];return e[mu.INPUT_VALUE]=new bu(t),e[mu.OUTPUT_VALUE]=new bu(t),e[mu.NEXT_STATEMENT]=new bu(t),e[mu.PREVIOUS_STATEMENT]=new bu(t),e}},_u=null,yu=null,Tu={};Tu.connectionUiEffect=_n,Tu.disconnectUiEffect=yn,Tu.disconnectUiStop=En,Tu.disposeUiEffect=vn;var Eu=class{constructor(t){this.workspace=t,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new yl(t.scrollX,t.scrollY)}dispose(){this.workspace=null}startDrag(){R()&&R().unselect()}endDrag(t){this.drag(t)}drag(t){if(t=yl.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(t.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,t.y)}}},wu=class{constructor(t,e){this.creatorWorkspace=e,this.mouseDownXY=new yl(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=t,this.currentDragDeltaXY=new yl(0,0)}dispose(){H(),Qi(),this.creatorWorkspace.clearGesture();for(const t of this.boundEvents)j(t);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(t){const e=new yl(t.clientX,t.clientY);this.updateDragDelta(e)&&(this.updateIsDragging(t),F()),this.mostRecentEvent=t}updateDragDelta(t){return this.currentDragDeltaXY=yl.difference(t,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=yl.magnitude(this.currentDragDeltaXY)>(this.flyout?Ur.config$$module$build$src$core$config.flyoutDragRadius:Ur.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let t;if(!this.targetBlock||null==(t=this.flyout)||!t.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Ur.getGroup$$module$build$src$core$events$utils()||Ur.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),Ur.setSelected$$module$build$src$core$common(this.targetBlock),0))}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Eu(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(t){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const e=R();e&&wn(e)&&e.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(e,this.startWorkspace_),this.dragger.onDragStart(t),this.dragger.onDrag(t,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(t,e){return new(h(jr.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(t,e)}doStart(t){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,X(t)?this.cancel():(this.gestureHasStarted=!0,En(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=ui(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=t,Zi(),Y(t)?this.handleRightClick(t):("pointerdown"===t.type.toLowerCase()&&"mouse"!==t.pointerType&&B(t,this),this.mouseDownXY=new yl(t.clientX,t.clientY),this.bindMouseEvents(t),this.isEnding_||this.handleTouchStart(t)))}bindMouseEvents(t){this.boundEvents.push(W(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(W(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(W(document,"pointerup",null,this.handleUp.bind(this),!0)),t.preventDefault(),t.stopPropagation()}handleStart(t){this.isDragging()||(this.handleTouchStart(t),this.isMultiTouch()&&F())}handleMove(t){this.isDragging()&&U(t)||!this.isMultiTouch()?(this.updateFromEvent(t),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),t.preventDefault(),t.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(t),F())}handleUp(t){if(this.isDragging()||this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()){if(!U(t))return;if(this.updateFromEvent(t),F(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?this.dragger.onDragEnd(t,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(t))}t.preventDefault(),t.stopPropagation(),this.dispose()}handleTouchStart(t){var e=G(t);this.cachedPoints.set(e,this.getTouchPoint(t));var i=Array.from(this.cachedPoints.keys());2===i.length&&(e=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=yl.distance(e,i),this.isMultiTouch_=!0,t.preventDefault())}handleTouchMove(t){const e=G(t);this.cachedPoints.set(e,this.getTouchPoint(t)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(t):this.handleMove(t)}handlePinch(t){var e=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(e[0]);if(e=this.cachedPoints.get(e[1]),i=yl.distance(i,e)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(e=0<(e=i-this.previousScale)?5*e:6*e,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const o=this.startWorkspace_,n=K(t,o.getParentSvg(),o.getInverseScreenCTM());o.zoom(n.x,n.y,e)}this.previousScale=i,t.preventDefault()}handleTouchEnd(t){t=G(t),this.cachedPoints.has(t)&&this.cachedPoints.delete(t),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(t){return this.startWorkspace_?new yl(t.pageX,t.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(F(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(t){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(t)):this.startBubble?this.startBubble.showContextMenu(t):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(t)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()}handleWsStart(t,e){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(e),this.mostRecentEvent=t,this.startBlock||this.startBubble||this.startComment||Ur.setSelected$$module$build$src$core$common(null),this.doStart(t)}fireWorkspaceClick(t){p(new(E(na))(null,t.id,"workspace"))}handleFlyoutStart(t,e){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(e),this.handleWsStart(t,e.getWorkspace())}handleBlockStart(t,e){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(e),this.mostRecentEvent=t}handleBubbleStart(t,e){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(e),this.mostRecentEvent=t}handleCommentStart(t,e){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(e),this.mostRecentEvent=t}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.targetBlock.isEnabled()){Ur.getGroup$$module$build$src$core$events$utils()||Ur.setGroup$$module$build$src$core$events$utils(!0);var t=this.flyout.createBlock(this.targetBlock);t.snapToGrid(),t.bumpNeighbours()}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");t=new(E(na))(this.startBlock,this.startWorkspace_.id,"block"),p(t)}this.bringBlockToFront(),Ur.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(t){t=this.creatorWorkspace,R()&&R().unselect(),this.fireWorkspaceClick(this.startWorkspace_||t)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=t)}setStartIcon(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=t)}setStartBubble(t){this.startBubble||(this.startBubble=t)}setStartComment(t){this.startComment||(this.startComment=t)}setStartBlock(t){this.startBlock||this.startBubble||(this.startBlock=t,Ur.setSelected$$module$build$src$core$common(this.startBlock),t.isInFlyout&&t!==t.getRootBlock()?this.setTargetBlock(t.getRootBlock()):this.setTargetBlock(t))}setTargetBlock(t){t.isShadow()?this.setTargetBlock(t.getParent()):this.targetBlock=t}setStartWorkspace(t){this.startWorkspace_||(this.startWorkspace_=t)}setStartFlyout(t){this.flyout||(this.flyout=t)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const t=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&t}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){let t,e;return null!=(e=null!=(t=this.workspaceDragger)?t:this.dragger)?e:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const t=I();for(let e,i=0;e=t[i];i++)if(e.currentGesture_)return!0;return!1}},ku=class{constructor(t,e){let i,o,n;this.pattern=t,this.scale=1,this.spacing=null!=(i=e.spacing)?i:0,this.length=null!=(o=e.length)?o:1,this.line2=(this.line1=t.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(n=e.snap)&&n}setSpacing(t){this.spacing=t,this.update(this.scale)}getSpacing(){return this.spacing}setLength(t){this.length=t,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(t){this.snapToGrid=t}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(t){this.scale=t;var e=this.spacing*t;this.pattern.setAttribute("width",`${e}`),this.pattern.setAttribute("height",`${e}`);let i=(e=Math.floor(this.spacing/2)+.5)-this.length/2,o=e+this.length/2;e*=t,i*=t,o*=t,this.setLineAttributes(this.line1,t,i,o,e,e),this.setLineAttributes(this.line2,t,e,e,i,o)}setLineAttributes(t,e,i,o,n,s){t&&(t.setAttribute("stroke-width",`${e}`),t.setAttribute("x1",`${i}`),t.setAttribute("y1",`${n}`),t.setAttribute("x2",`${o}`),t.setAttribute("y2",`${s}`))}moveTo(t,e){this.pattern.setAttribute("x",`${t}`),this.pattern.setAttribute("y",`${e}`)}alignXY(t){var e=this.getSpacing();const i=e/2,o=Math.round(Math.round((t.x-i)/e)*e+i);return e=Math.round(Math.round((t.y-i)/e)*e+i),o===t.x&&e===t.y?t:new yl(o,e)}static createDom(t,e,i){let o,n;if(t=tt(Cl.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},i),0<(null!=(o=e.length)?o:1)&&0<(null!=(n=e.spacing)?n:0)){let i;tt(Cl.LINE,{stroke:e.colour},t),null!=(i=e.length)&&i&&tt(Cl.LINE,{stroke:e.colour},t)}else tt(Cl.LINE,{},t);return t}},Iu={};Iu.deepMerge=kn;var $u=class{constructor(e,i,o,n){this.name=e,this.startHats=!1,this.blockStyles=i||Object.create(null),this.categoryStyles=o||Object.create(null),this.componentStyles=n||Object.create(null),this.fontStyle=Object.create(null),t(jr.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(t,e){this.blockStyles[t]=e}setCategoryStyle(t,e){this.categoryStyles[t]=e}getComponentStyle(t){if(!(t=this.componentStyles[t]))return null;if("string"==typeof t){const e=this.getComponentStyle(t);if(e)return e}return`${t}`}setComponentStyle(t,e){this.componentStyles[t]=e}setFontStyle(t){this.fontStyle=t}setStartHats(t){this.startHats=t}static defineTheme(t,e){t=t.toLowerCase();const i=new $u(t);let o=e.base;if(o){if("string"==typeof o){let t;o=null!=(t=a(jr.THEME,o))?t:void 0}o instanceof $u&&(kn(i,o),i.name=t)}return kn(i.blockStyles,e.blockStyles),kn(i.categoryStyles,e.categoryStyles),kn(i.componentStyles,e.componentStyles),kn(i.fontStyle,e.fontStyle),null!==e.startHats&&(i.startHats=e.startHats),i}},Su=new $u("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Cu=class{constructor(t){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let e=null,i=!1;var o=!1,n=!1,s=!1,r=!1,a=!1;const l=!!t.readOnly;var h;l||(e=Mt(null!=(h=t.toolbox)?h:null),i=Dt(e),o=void 0===(o=t.trashcan)?i:o,n=void 0===(n=t.collapse)?i:n,s=void 0===(s=t.comments)?i:s,r=void 0===(r=t.disable)?i:r,a=void 0===(a=t.sounds)||a),h=t.maxTrashcanContents,o?void 0===h&&(h=32):h=0;const c=!!t.rtl;let u=t.horizontalLayout;void 0===u&&(u=!1);var d="end"!==t.toolboxPosition;d=u?d?zl.TOP:zl.BOTTOM:d===c?zl.RIGHT:zl.LEFT;let p=t.css;void 0===p&&(p=!0);let g="https://blockly-demo.appspot.com/static/media/";t.media&&(g=t.media.endsWith("/")?t.media:t.media+"/");const f=t.oneBasedIndex,m=t.renderer||"geras",v=t.plugins||{};let b,_,y,T=t.modalInputs;void 0===T&&(T=!0),this.RTL=c,this.oneBasedIndex=void 0===f||f,this.collapse=n,this.comments=s,this.disable=r,this.readOnly=l,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=null!=(b=t.maxInstances)?b:null,this.modalInputs=T,this.pathToMedia=g,this.hasCategories=i,this.moveOptions=Cu.parseMoveOptions_(t,i),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=o,this.maxTrashcanContents=h,this.hasSounds=a,this.hasCss=p,this.horizontalLayout=u,this.languageTree=e,this.gridOptions=Cu.parseGridOptions_(t),this.zoomOptions=Cu.parseZoomOptions_(t),this.toolboxPosition=d,this.theme=Cu.parseThemeOptions_(t),this.renderer=m,this.rendererOverrides=null!=(_=t.rendererOverrides)?_:null,this.parentWorkspace=null!=(y=t.parentWorkspace)?y:null,this.plugins=v}static parseMoveOptions_(t,e){const i=t.move||{},o={};return void 0===i.scrollbars&&void 0===t.scrollbars?o.scrollbars=e:"object"==typeof i.scrollbars?(o.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},o.scrollbars.horizontal&&o.scrollbars.vertical?o.scrollbars=!0:o.scrollbars.horizontal||o.scrollbars.vertical||(o.scrollbars=!1)):o.scrollbars=!!i.scrollbars||!!t.scrollbars,o.wheel=o.scrollbars&&void 0!==i.wheel?!!i.wheel:"object"==typeof o.scrollbars,o.drag=!(!o.scrollbars||void 0!==i.drag&&!i.drag),o}static parseZoomOptions_(t){t=t.zoom||{};const e={};return e.controls=void 0!==t.controls&&!!t.controls,e.wheel=void 0!==t.wheel&&!!t.wheel,e.startScale=void 0===t.startScale?1:Number(t.startScale),e.maxScale=void 0===t.maxScale?3:Number(t.maxScale),e.minScale=void 0===t.minScale?.3:Number(t.minScale),e.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),e.pinch=void 0===t.pinch?e.wheel||e.controls:!!t.pinch,e}static parseGridOptions_(t){t=t.grid||{};const e={};return e.spacing=Number(t.spacing)||0,e.colour=t.colour||"#888",e.length=void 0===t.length?1:Number(t.length),e.snap=0<e.spacing&&!!t.snap,e}static parseThemeOptions_(t){return"string"==typeof(t=t.theme||Su)?a(jr.THEME,t):t instanceof $u?t:$u.defineTheme(t.name||"builtin"+c(),t)}};Ur.Names$$module$build$src$core$names=class{constructor(t,e){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=e||"",this.reservedWords=new Set(t?t.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(t){this.variableMap=t}getNameForUserVariable(t){return this.variableMap?(t=this.variableMap.getVariableById(t))?t.name:null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(t){t=Ur.allUsedVarModels$$module$build$src$core$variables(t);for(let e=0;e<t.length;e++)this.getName(t[e].getId(),Ur.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(t){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(t,e){let i=t;e===Ur.NameType$$module$build$src$core$names.VARIABLE&&(t=this.getNameForUserVariable(t))&&(i=t),t=i.toLowerCase();const o=e===Ur.NameType$$module$build$src$core$names.VARIABLE||e===Ur.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(e)||this.db.set(e,new Map);const n=this.db.get(e);return n.has(t)?o+n.get(t):(e=this.getDistinctName(i,e),n.set(t,e.substr(o.length)),e)}getUserNames(t){let e;return(t=null==(e=this.db.get(t))?void 0:e.keys())?Array.from(t):[]}getDistinctName(t,e){t=this.safeName(t);let i,o,n,s=null;for(;this.dbReverse.has(t+(null!=(i=s)?i:""))||this.reservedWords.has(t+(null!=(o=s)?o:""));)s=s?s+1:2;return t+=null!=(n=s)?n:"",this.dbReverse.add(t),(e===Ur.NameType$$module$build$src$core$names.VARIABLE||e===Ur.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+t}safeName(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(t[0])&&(t="my_"+t)):t=Ur.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",t}static equals(t,e){return t.toLowerCase()===e.toLowerCase()}},function(t){(t=t.NameType||(t.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",t.VARIABLE="VARIABLE",t.PROCEDURE="PROCEDURE"}(Ur.Names$$module$build$src$core$names||(Ur.Names$$module$build$src$core$names={})),Ur.NameType$$module$build$src$core$names=Ur.Names$$module$build$src$core$names.NameType,Ur.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=Ur.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:Ur.NameType$$module$build$src$core$names}.Names=Ur.Names$$module$build$src$core$names;var Ou=class extends Map{constructor(){super()}set(t,e){return this.get(t)===e||(super.set(t,e),$n(e)&&e.startPublishing()),this}delete(t){const e=this.get(t);return(t=super.delete(t))?($n(e)&&e.stopPublishing(),t):t}clear(){if(this.size)for(const t of this.keys())this.delete(t)}add(t){return this.set(t.getId(),t)}getProcedures(){return[...this.values()]}},Ru=class{constructor(t){this.sourceBlock=t,this.offsetInBlock=new yl(0,0),this.workspaceLocation=new yl(0,0),this.svgRoot=null,this.tooltip=t}getType(){throw Error("Icons must implement getType")}initView(t){if(!this.svgRoot){var e=this.sourceBlock;this.svgRoot=tt(Cl.G,{class:"blocklyIconGroup"}),e.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),W(this.svgRoot,"pointerdown",this,t),this.svgRoot.tooltip=this,zi(this.svgRoot)}}dispose(){ji(this.svgRoot),st(this.svgRoot)}getWeight(){return-1}getSize(){return new Rl(0,0)}setTooltip(t){this.tooltip=null!=t?t:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",si(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(t){this.offsetInBlock=t,this.updateSvgRootOffset()}updateSvgRootOffset(){let t;null==(t=this.svgRoot)||t.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(t){this.workspaceLocation=yl.sum(t,this.offsetInBlock)}onClick(){}isClickableInFlyout(t){return!0}},Au={fromJsonInternal:On},Mu={TEST_ONLY:Au};Mu.fromJson=Ur.fromJson$$module$build$src$core$field_registry,Mu.register=Sn,Mu.unregister=Cn;var xu=class extends Xc{constructor(t,e,i){super(Xc.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,t!==Xc.SKIP_SETUP&&(Array.isArray(t)?(Mn(t),t=Rn(t),this.menuGenerator_=t.options,this.prefixField=t.prefix||null,this.suffixField=t.suffix||null):this.menuGenerator_=t,this.selectedOption=this.getOptions(!1)[0],i&&this.configure_(i),this.setValue(this.selectedOption[1]),e&&this.setValidator(e))}fromXml(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)}loadState(t){this.loadLegacyState(xu,t)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=tt(Cl.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&et(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let t;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(t=this.getSourceBlock())&&t.isShadow())}createTextArrow_(){let t,e;this.arrow=tt(Cl.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(t=this.getSourceBlock())&&t.RTL?xu.ARROW_CHAR+" ":" "+xu.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(e=this.getSourceBlock())&&e.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=tt(Cl.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(wl,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(t){var e=this.getSourceBlock();if(!e)throw new Yc;this.dropdownCreate(),this.menu_.openingCoords=t&&"number"==typeof t.clientX?new yl(t.clientX,t.clientY):null,pi(),t=this.menu_.render(di()),et(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(e=e.getColour(),gi(e,this.sourceBlock_.style.colourTertiary)),mi(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Tt(this.selectedMenuItem.getElement(),di(),!0)),this.applyColour()}dropdownCreate(){const t=this.getSourceBlock();if(!t)throw new Yc;const e=new jh;e.setRole(Uh.LISTBOX),this.menu_=e;const i=this.getOptions(!1);this.selectedMenuItem=null;for(let n=0;n<i.length;n++){const[s,r]=i[n];if("object"==typeof s){var o=new Image(s.width,s.height);o.src=s.src,o.alt=s.alt||""}else o=s;(o=new Xh(o,r)).setRole(Uh.OPTION),o.setRightToLeft(t.RTL),o.setCheckable(!0),e.addChild(o),o.setChecked(r===this.value_),r===this.value_&&(this.selectedMenuItem=o),o.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(t){$i(this,!0),this.onItemSelected_(this.menu_,t)}onItemSelected_(t,e){this.setValue(e.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(t){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(t&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),Mn(this.generatedOptions)),this.generatedOptions)}doClassValidation_(t){return this.getOptions(!0).some((e=>e[1]===t))?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(t){super.doValueUpdate_(t),t=this.getOptions(!0);for(let e,i=0;e=t[i];i++)e[1]===this.value_&&(this.selectedOption=e)}applyColour(){const t=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",t.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",t.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=t.colourSecondary:this.arrow.style.fill=t.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const t=this.selectedOption&&this.selectedOption[0];t&&"object"==typeof t?this.renderSelectedImage(t):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(t){const e=this.getSourceBlock();if(!e)throw new Yc;this.imageElement.style.display="",this.imageElement.setAttributeNS(wl,"xlink:href",t.src),this.imageElement.setAttribute("height",String(t.height)),this.imageElement.setAttribute("width",String(t.width));const i=Number(t.height);t=Number(t.width);var o=!!this.borderRect_;const n=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,i+Lu);let s;o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.svgArrow?this.positionSVGArrow(t+o,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):ut(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=t+s+2*o,this.size_.height=n;let r=0;e.RTL?this.imageElement.setAttribute("x",`${o+s}`):(r=t+s,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${o}`)),this.imageElement.setAttribute("y",String(n/2-i/2)),this.positionTextElement_(r+o,t+s)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var t=this.getTextElement();et(t,"blocklyDropdownText"),t.setAttribute("text-anchor","start");var e=!!this.borderRect_;t=Math.max(e?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const i=ut(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);e=e?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let o=0;this.svgArrow&&(o=this.positionSVGArrow(i+e,t/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+o+2*e,this.size_.height=t,this.positionTextElement_(e,i)}positionSVGArrow(t,e){if(!this.svgArrow)return 0;const i=this.getSourceBlock();if(!i)throw new Yc;const o=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,s=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(i.RTL?o:t+n)+","+e+")"),s+n}getText_(){if(!this.selectedOption)return null;const t=this.selectedOption[0];return"object"==typeof t?t.alt:t}static fromJson(t){if(!t.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(t.options,void 0,t)}};xu.CHECKMARK_OVERHANG=25,xu.MAX_MENU_HEIGHT_VH=.45,xu.ARROW_CHAR="â¾";var Lu=10;Sn("field_dropdown",xu);var Du,Nu=class{constructor(t,e){this.bubble=t,this.workspace=e,this.startLoc=null}isMovable(){return!0}startDrag(){let t;Ur.getGroup$$module$build$src$core$events$utils()||Ur.setGroup$$module$build$src$core$events$utils(!0),this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(t=this.workspace.getLayerManager())||t.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(t){this.bubble.moveDuringDrag(t)}endDrag(){let t;this.workspace.setResizesEnabled(!0),Ur.setGroup$$module$build$src$core$events$utils(!1),null==(t=this.workspace.getLayerManager())||t.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},Pu=class{constructor(t,e,i){this.workspace=t,this.anchor=e,this.ownerRect=i,this.size=new Rl(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Nu(this,this.workspace),this.id=c(),this.svgRoot=tt(Cl.G,{class:"blocklyBubble"},t.getBubbleCanvas()),t=tt(Cl.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=tt(Cl.PATH,{class:"blocklyBubbleTail"},t),this.background=tt(Cl.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Du.BORDER_WIDTH,ry:Du.BORDER_WIDTH},t),this.contentContainer=tt(Cl.G,{},this.svgRoot),W(this.background,"pointerdown",this,this.onMouseDown)}dispose(){st(this.svgRoot),this.disposed=!0}setAnchorLocation(t,e=!1){this.anchor=t,e?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(t,e){this.relativeLeft=t,this.relativeTop=e,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(t,e=!1){t.width=Math.max(t.width,Du.MIN_SIZE),t.height=Math.max(t.height,Du.MIN_SIZE),this.size=t,this.background.setAttribute("width",`${t.width}`),this.background.setAttribute("height",`${t.height}`),e?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(t){this.colour=t,this.tail.setAttribute("fill",t),this.background.setAttribute("fill",t)}onMouseDown(t){let e;null==(e=this.workspace.getGesture(t))||e.handleBubbleStart(t,this),Ur.setSelected$$module$build$src$core$common(this)}positionRelativeToAnchor(){let t=this.anchor.x;t=this.workspace.RTL?t-(this.relativeLeft+this.size.width):t+this.relativeLeft,this.moveTo(t,this.relativeTop+this.anchor.y)}moveTo(t,e){this.svgRoot.setAttribute("transform",`translate(${t}, ${e})`)}positionByRect(t=new Ol(0,0,0,0)){var e=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(e),o=this.getOptimalRelativeTop(e);const n={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},s={x:-this.size.width-30,y:o};o={x:t.getWidth(),y:o};var r={x:i,y:t.getHeight()};i=t.getWidth()<t.getHeight()?o:r,t=t.getWidth()<t.getHeight()?r:o,o=this.getOverlap(n,e),r=this.getOverlap(s,e);const a=this.getOverlap(i,e);e=this.getOverlap(t,e),o===(e=Math.max(o,r,a,e))?(this.relativeLeft=n.x,this.relativeTop=n.y):r===e?(this.relativeLeft=s.x,this.relativeTop=s.y):a===e?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=t.x,this.relativeTop=t.y),this.positionRelativeToAnchor()}getOverlap(t,e){var i=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x+this.anchor.x;return t=t.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,e.left+e.width)-Math.max(i,e.left))*(Math.min(t+this.size.height,e.top+e.height)-Math.max(t,e.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(t){let e=-this.size.width/4;if(this.size.width>t.width)return e;if(t=this.getWorkspaceViewRect(t),this.workspace.RTL){var i=this.anchor.x-e;i-this.size.width<t.left?e=-(t.left-this.anchor.x+this.size.width):i>t.right&&(e=-(t.right-this.anchor.x))}else{const o=(i=e+this.anchor.x)+this.size.width;i<t.left?e=t.left-this.anchor.x:o>t.right&&(e=t.right-this.anchor.x-this.size.width)}return e}getOptimalRelativeTop(t){let e=-this.size.height/4;if(this.size.height>t.height)return e;const i=this.anchor.y+e,o=i+this.size.height;return i<(t=this.getWorkspaceViewRect(t)).top?e=t.top-this.anchor.y:o>t.bottom&&(e=t.bottom-this.anchor.y-this.size.height),e}getWorkspaceViewRect(t){const e=t.top;let i=t.top+t.height,o=t.left;return t=t.left+t.width,i-=this.getScrollbarThickness(),this.workspace.RTL?o-=this.getScrollbarThickness():t-=this.getScrollbarThickness(),new Ol(e,i,o,t)}getScrollbarThickness(){return Nl.scrollbarThickness/this.workspace.scale}renderTail(){const t=[];var e=this.size.width/2,i=this.size.height/2,o=-this.relativeLeft,n=-this.relativeTop;if(e===o&&i===n)t.push("M "+e+","+i);else{n-=i,o-=e,this.workspace.RTL&&(o*=-1);var s=Math.sqrt(n*n+o*o),r=Math.acos(o/s);0>n&&(r=2*Math.PI-r);var a=r+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a);const h=Math.cos(a);let c=(this.size.width+this.size.height)/Du.TAIL_THICKNESS;c=Math.min(c,this.size.width,this.size.height)/4,o=e+(a=1-Du.ANCHOR_RADIUS/s)*o,n=i+a*n,a=e+c*h;const u=i+c*l;e-=c*h,i-=c*l,(l=r+(l=ri(this.workspace.RTL?-Du.TAIL_ANGLE:Du.TAIL_ANGLE)))>2*Math.PI&&(l-=2*Math.PI),r=Math.sin(l)*s/Du.TAIL_BEND,s=Math.cos(l)*s/Du.TAIL_BEND,t.push("M"+a+","+u),t.push("C"+(a+s)+","+(u+r)+" "+o+","+n+" "+o+","+n),t.push("C"+o+","+n+" "+(e+s)+","+(i+r)+" "+e+","+i)}let h;t.push("z"),null==(h=this.tail)||h.setAttribute("d",t.join(" "))}bringToFront(){let t;const e=null==(t=this.svgRoot)?void 0:t.parentNode;return!(!this.svgRoot||(null==e?void 0:e.lastChild)===this.svgRoot||(null==e||e.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new yl(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(t){this.moveTo(t.x,t.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x-this.anchor.x,this.relativeTop=t.y-this.anchor.y,this.renderTail()}setDragging(t){}setDeleteStyle(t){}isDeletable(){return!1}showContextMenu(t){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(t){this.dragStrategy.drag(t)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){}unselect(){}};Du=Pu,Pu.BORDER_WIDTH=6,Pu.DOUBLE_BORDER=2*Du.BORDER_WIDTH,Pu.MIN_SIZE=Du.DOUBLE_BORDER,Pu.TAIL_THICKNESS=1,Pu.TAIL_ANGLE=20,Pu.TAIL_BEND=4,Pu.ANCHOR_RADIUS=8;var Bu=class extends Pu{constructor(t,e,i,o){let n,s;super(e,i,o),this.workspace=e,this.anchor=i,this.ownerRect=o,this.autoLayout=!0,e=new Cu(t),this.validateWorkspaceOptions(e),this.svgDialog=tt(Cl.SVG,{x:Pu.BORDER_WIDTH,y:Pu.BORDER_WIDTH},this.contentContainer),t.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Cu(t)),this.miniWorkspace.internalIsMutator=!0,t=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(t),e.languageTree&&(t.insertBefore(this.miniWorkspace.addFlyout(Cl.G),this.miniWorkspace.getCanvas()),null==(t=this.miniWorkspace.getFlyout())||t.init(this.miniWorkspace),null==t||t.show(e.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(n=this.miniWorkspace.getFlyout())||null==(s=n.getWorkspace())||s.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(t){this.miniWorkspace.addChangeListener(t)}validateWorkspaceOptions(t){if(t.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(t.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(t.zoomOptions.controls||t.zoomOptions.wheel||t.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(t.moveOptions.scrollbars||t.moveOptions.wheel||t.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(t.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const t of this.miniWorkspace.getTopBlocks(!1)){const e=t.getRelativeToSurfaceXY();if(20>e.y&&t.moveBy(0,20-e.y),t.RTL){let i=-20;const o=this.miniWorkspace.getFlyout();o&&(i-=o.getWidth()),e.x>i&&t.moveBy(i-e.x,0)}else 20>e.x&&t.moveBy(20-e.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var t=this.getSize(),e=this.calculateWorkspaceSize();Math.abs(t.width-e.width)<Bu.MINIMUM_VIEW_CHANGE&&Math.abs(t.height-e.height)<Bu.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${e.width}px`),this.svgDialog.setAttribute("height",`${e.height}px`),this.miniWorkspace.setCachedParentSvgSize(e.width,e.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${e.width}, 0)`),this.setSize(new Rl(e.width+Pu.DOUBLE_BORDER,e.height+Pu.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var t=this.miniWorkspace.getCanvas().getBBox();let e=t.width+Bu.MARGIN;t=t.height+Bu.MARGIN;const i=this.miniWorkspace.getFlyout();if(i){const o=i.getWorkspace().getMetricsManager().getScrollMetrics();t=Math.max(t,o.height+20),e+=i.getWidth()}return new Rl(e,t)}updateBlockStyles(){for(var t of this.miniWorkspace.getAllBlocks(!1))t.setStyle(t.getStyleName());let e;if(t=null==(e=this.miniWorkspace.getFlyout())?void 0:e.getWorkspace())for(const e of t.getAllBlocks(!1))e.setStyle(e.getStyleName())}moveDuringDrag(t){super.moveDuringDrag(t),this.autoLayout=!1}moveTo(t,e){super.moveTo(t,e),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(t){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};Bu.MINIMUM_VIEW_CHANGE=10,Bu.MARGIN=3*Pu.DOUBLE_BORDER,Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Ru{constructor(t,e){super(e),this.flyoutBlockTypes=t,this.sourceBlock=e,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(t){this.svgRoot||(super.initView(t),tt(Cl.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),tt(Cl.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),tt(Cl.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),et(this.svgRoot,"blockly-icon-mutator"))}dispose(){let t;super.dispose(),null==(t=this.miniWorkspaceBubble)||t.dispose()}getWeight(){return Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Rl(17,17)}applyColour(){let t,e;super.applyColour(),null==(t=this.miniWorkspaceBubble)||t.setColour(this.sourceBlock.style.colourPrimary),null==(e=this.miniWorkspaceBubble)||e.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(t){let e;super.onLocationChange(t),null==(e=this.miniWorkspaceBubble)||e.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(t){const e=this;return Hr.asyncExecutePromiseGeneratorFunction((function*(){if(e.bubbleIsVisible()!==t){if(yield ve(),t){let t;e.miniWorkspaceBubble=new Bu(e.getMiniWorkspaceConfig(),e.sourceBlock.workspace,e.getAnchorLocation(),e.getBubbleOwnerRect()),e.applyColour(),e.createRootBlock(),e.addSaveConnectionsListener(),null==(t=e.miniWorkspaceBubble)||t.addWorkspaceChangeListener(e.createMiniWorkspaceChangeListener())}else{let t;null==(t=e.miniWorkspaceBubble)||t.dispose(),e.miniWorkspaceBubble=null,e.saveConnectionsListener&&e.sourceBlock.workspace.removeChangeListener(e.saveConnectionsListener),e.saveConnectionsListener=null}p(new(E(ra))(e.sourceBlock,t,"mutator"))}}))}getMiniWorkspaceConfig(){let t;const e={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(t=this.sourceBlock.workspace.options.rendererOverrides)?t:void 0};return this.flyoutBlockTypes.length&&(e.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map((t=>({kind:"block",type:t})))}),e}getAnchorLocation(){return yl.sum(this.workspaceLocation,new yl(8.5,8.5))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new Ol(t.y,t.y+t.height,t.x,t.x+t.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var t of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))t.queueRender();let e,i,o,n;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),t=null!=(n=null==(e=this.miniWorkspaceBubble)||null==(i=e.getWorkspace())||null==(o=i.getFlyout())?void 0:o.getWidth())?n:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(t+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return t=>{Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(t)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout((()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()}),0))}}static isIgnorableMutatorEvent(t){return t.isUiEvent||t.type===Ur.CREATE$$module$build$src$core$events$utils||t.type===Ur.CHANGE$$module$build$src$core$events$utils&&"disabled"===t.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var t=Ur.getGroup$$module$build$src$core$events$utils();t||Ur.setGroup$$module$build$src$core$events$utils(!0);var e=nc.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var i=nc.getExtraBlockState_(this.sourceBlock);e!==i&&p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,e,i)),Ur.setGroup$$module$build$src$core$events$utils(t)}}getWorkspace(){let t;return null==(t=this.miniWorkspaceBubble)?void 0:t.getWorkspace()}},Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=lh.MUTATOR,Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Fu=Object.create(null),Hu={allExtensions:Fu};Ur.register$$module$build$src$core$extensions("parent_tooltip_when_inline",jn);var Uu={TEST_ONLY:Hu};Uu.apply=Dn,Uu.buildTooltipForDropdown=Ur.buildTooltipForDropdown$$module$build$src$core$extensions,Uu.buildTooltipWithFieldText=Ur.buildTooltipWithFieldText$$module$build$src$core$extensions,Uu.isRegistered=Ln,Uu.register=Ur.register$$module$build$src$core$extensions,Uu.registerMixin=Ur.registerMixin$$module$build$src$core$extensions,Uu.registerMutator=Ur.registerMutator$$module$build$src$core$extensions,Uu.runAfterPageLoad=Wn,Uu.unregister=xn;var Gu,Vu=new Set,Wu={};Wu.warn=Xn,function(t){t[t.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",t[t.MAC_ENTER=3]="MAC_ENTER",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.NUM_CENTER=12]="NUM_CENTER",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PLUS_SIGN=43]="PLUS_SIGN",t[t.PRINT_SCREEN=44]="PRINT_SCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.FF_SEMICOLON=59]="FF_SEMICOLON",t[t.FF_EQUALS=61]="FF_EQUALS",t[t.FF_DASH=173]="FF_DASH",t[t.FF_HASH=163]="FF_HASH",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.AT_SIGN=64]="AT_SIGN",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META=91]="META",t[t.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUM_ZERO=96]="NUM_ZERO",t[t.NUM_ONE=97]="NUM_ONE",t[t.NUM_TWO=98]="NUM_TWO",t[t.NUM_THREE=99]="NUM_THREE",t[t.NUM_FOUR=100]="NUM_FOUR",t[t.NUM_FIVE=101]="NUM_FIVE",t[t.NUM_SIX=102]="NUM_SIX",t[t.NUM_SEVEN=103]="NUM_SEVEN",t[t.NUM_EIGHT=104]="NUM_EIGHT",t[t.NUM_NINE=105]="NUM_NINE",t[t.NUM_MULTIPLY=106]="NUM_MULTIPLY",t[t.NUM_PLUS=107]="NUM_PLUS",t[t.NUM_MINUS=109]="NUM_MINUS",t[t.NUM_PERIOD=110]="NUM_PERIOD",t[t.NUM_DIVISION=111]="NUM_DIVISION",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",t[t.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",t[t.SEMICOLON=186]="SEMICOLON",t[t.DASH=189]="DASH",t[t.EQUALS=187]="EQUALS",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.APOSTROPHE=192]="APOSTROPHE",t[t.TILDE=192]="TILDE",t[t.SINGLE_QUOTE=222]="SINGLE_QUOTE",t[t.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",t[t.WIN_KEY=224]="WIN_KEY",t[t.MAC_FF_META=224]="MAC_FF_META",t[t.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",t[t.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",t[t.WIN_IME=229]="WIN_IME",t[t.VK_NONAME=252]="VK_NONAME",t[t.PHANTOM=255]="PHANTOM"}(Gu||(Gu={}));var zu={};zu.arc=es,zu.curve=Kn,zu.line=Qn,zu.lineOnAxis=ts,zu.lineTo=Zn,zu.moveBy=qn,zu.moveTo=Jn,zu.point=Yn;var ju={};ju.Coordinate=yl,ju.KeyCodes=Gu,ju.Rect=Ol,ju.Size=Rl,ju.Svg=Cl,ju.aria=zh,ju.array=pl,ju.browserEvents=dl,ju.colour=zc,ju.deprecation=Wu,ju.dom=Sl,ju.extensions=Uu,ju.idGenerator=$a,ju.math=sc,ju.object=Iu,ju.parsing=jc,ju.string=kc,ju.style=Ml,ju.svgMath=Dl,ju.svgPaths=zu,ju.toolbox=Zl,ju.userAgent=hl,ju.xml=Wl;var Xu={};Xu.register=is,Xu.unregister=os;var Yu=class extends Pu{constructor(t,e,i,o){super(e,i,o),this.text=t,this.workspace=e,this.anchor=i,this.ownerRect=o,this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(t){this.text=t,st(this.paragraph),this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}stringToSvg(t,e){return e=this.createParagraph(e),t=this.createSpans(e,t),this.workspace.RTL&&this.rightAlignSpans(e.getBBox().width,t),e}createParagraph(t){return tt(Cl.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:Pu.BORDER_WIDTH},t)}createSpans(t,e){return e.split("\n").map((e=>{const i=tt(Cl.TSPAN,{dy:"1em",x:Pu.BORDER_WIDTH},t);return e=document.createTextNode(e),i.appendChild(e),i}))}rightAlignSpans(t,e){for(const i of e)i.setAttribute("text-anchor","end"),i.setAttribute("x",`${t+Pu.BORDER_WIDTH}`)}updateBubbleSize(){const t=this.paragraph.getBBox();this.setSize(new Rl(t.width+2*Pu.BORDER_WIDTH,t.height+2*Pu.BORDER_WIDTH),!0)}},Ku=class extends Pu{constructor(t,e,i){super(t,e,i),this.workspace=t,this.anchor=e,this.ownerRect=i,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Rl(160+Pu.DOUBLE_BORDER,80+Pu.DOUBLE_BORDER),this.MIN_SIZE=new Rl(45+Pu.DOUBLE_BORDER,20+Pu.DOUBLE_BORDER),et(this.svgRoot,"blocklyTextInputBubble"),({inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer)),this.resizeGroup=this.createResizeHandle(this.svgRoot,t),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(t){this.text=t,this.textArea.value=t,this.onTextChange()}addTextChangeListener(t){this.textChangeListeners.push(t)}addSizeChangeListener(t){this.sizeChangeListeners.push(t)}createEditor(t){t=tt(Cl.FOREIGNOBJECT,{x:Pu.BORDER_WIDTH,y:Pu.BORDER_WIDTH},t);const e=document.createElementNS(El,"body");e.setAttribute("xmlns",El),e.className="blocklyMinimalBody";const i=document.createElementNS(El,"textarea");return i.className="blocklyTextarea blocklyText",i.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),e.appendChild(i),t.appendChild(e),this.bindTextAreaEvents(i),setTimeout((()=>{i.focus()}),0),{inputRoot:t,textArea:i}}bindTextAreaEvents(t){W(t,"wheel",this,(t=>{t.stopPropagation()})),W(t,"focus",this,this.onStartEdit,!0),W(t,"change",this,this.onTextChange)}createResizeHandle(t,e){return t=tt(Cl.IMAGE,{class:"blocklyResizeHandle",href:`${e.options.pathToMedia}resize-handle.svg`},t),W(t,"pointerdown",this,this.onResizePointerDown),t}setSize(t,e=!1){t.width=Math.max(t.width,this.MIN_SIZE.width),t.height=Math.max(t.height,this.MIN_SIZE.height);const i=t.width-Pu.DOUBLE_BORDER,o=t.height-Pu.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${i}`),this.inputRoot.setAttribute("height",`${o}`),this.resizeGroup.setAttribute("y",`${o}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",""+-Pu.DOUBLE_BORDER):this.resizeGroup.setAttribute("x",`${i}`),super.setSize(t,e),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(t){this.bringToFront(),Y(t)||(this.workspace.startDrag(t,new yl(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=W(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=W(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),t.stopPropagation()}onResizePointerUp(t){H(),this.resizePointerUpListener&&(j(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(j(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(t){t=this.workspace.moveDrag(t),this.setSize(new Rl(this.workspace.RTL?-t.x:t.x,t.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const t of this.textChangeListeners)t()}onSizeChange(){for(const t of this.sizeChangeListeners)t()}};Z("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n");var Ju=class extends Ru{constructor(t){super(t),this.sourceBlock=t,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new Rl(160,80),this.bubbleVisiblity=!1}getType(){return Ju.TYPE}initView(t){this.svgRoot||(super.initView(t),tt(Cl.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),tt(Cl.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),tt(Cl.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),et(this.svgRoot,"blockly-icon-comment"))}dispose(){let t,e;super.dispose(),null==(t=this.textInputBubble)||t.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return Ju.WEIGHT}getSize(){return new Rl(17,17)}applyColour(){super.applyColour();const t=this.sourceBlock.style.colourPrimary;let e,i;null==(e=this.textInputBubble)||e.setColour(t),null==(i=this.textBubble)||i.setColour(t)}updateEditable(){const t=this,e=()=>super.updateEditable;return Hr.asyncExecutePromiseGeneratorFunction((function*(){e().call(t),t.bubbleIsVisible()&&(yield t.setBubbleVisible(!1),yield t.setBubbleVisible(!0))}))}onLocationChange(t){let e,i;super.onLocationChange(t),t=this.getAnchorLocation(),null==(e=this.textInputBubble)||e.setAnchorLocation(t),null==(i=this.textBubble)||i.setAnchorLocation(t)}setText(t){const e=this.text;let i,o;p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,e,t)),this.text=t,null==(i=this.textInputBubble)||i.setText(this.text),null==(o=this.textBubble)||o.setText(this.text)}getText(){return this.text}setBubbleSize(t){let e;this.bubbleSize=t,null==(e=this.textInputBubble)||e.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(t){let e,i,o,n;this.text=null!=(e=t.text)?e:"",this.bubbleSize=new Rl(null!=(i=t.width)?i:160,null!=(o=t.height)?o:80),this.bubbleVisiblity=null!=(n=t.pinned)&&n,this.setBubbleVisible(this.bubbleVisiblity)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var t=this.textInputBubble.getText();this.text!==t&&(p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,this.text,t)),this.text=t)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(t){const e=this;return Hr.asyncExecutePromiseGeneratorFunction((function*(){e.bubbleVisiblity!==t&&(e.bubbleVisiblity=t,yield ve(),!e.sourceBlock.rendered||e.sourceBlock.isInFlyout||e.sourceBlock.isInsertionMarker()||(t?(e.sourceBlock.isEditable()?e.showEditableBubble():e.showNonEditableBubble(),e.applyColour()):e.hideBubble(),p(new(E(ra))(e.sourceBlock,t,"comment"))))}))}showEditableBubble(){this.textInputBubble=new Ku(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener((()=>this.onTextChange())),this.textInputBubble.addSizeChangeListener((()=>this.onSizeChange()))}showNonEditableBubble(){this.textBubble=new Yu(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let t,e;null==(t=this.textInputBubble)||t.dispose(),this.textInputBubble=null,null==(e=this.textBubble)||e.dispose(),this.textBubble=null}getAnchorLocation(){return yl.sum(this.workspaceLocation,new yl(8.5,8.5))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new Ol(t.y,t.y+t.height,t.x,t.x+t.width)}};Ju.TYPE=lh.COMMENT,Ju.WEIGHT=3,is(Ju.TYPE,Ju);var qu=class extends Ru{constructor(t){super(t),this.sourceBlock=t,this.textMap=new Map,this.textBubble=null}getType(){return qu.TYPE}initView(t){this.svgRoot||(super.initView(t),tt(Cl.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),tt(Cl.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),tt(Cl.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),et(this.svgRoot,"blockly-icon-warning"))}dispose(){let t;super.dispose(),null==(t=this.textBubble)||t.dispose()}getWeight(){return qu.WEIGHT}getSize(){return new Rl(17,17)}applyColour(){let t;super.applyColour(),null==(t=this.textBubble)||t.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(t){let e;super.onLocationChange(t),null==(e=this.textBubble)||e.setAnchorLocation(this.getAnchorLocation())}addMessage(t,e){if(this.textMap.get(e)===t)return this;let i;return t?this.textMap.set(e,t):this.textMap.delete(e),null==(i=this.textBubble)||i.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(t){const e=this;return Hr.asyncExecutePromiseGeneratorFunction((function*(){if(e.bubbleIsVisible()!==t){if(yield ve(),t)e.textBubble=new Yu(e.getText(),e.sourceBlock.workspace,e.getAnchorLocation(),e.getBubbleOwnerRect()),e.applyColour();else{let t;null==(t=e.textBubble)||t.dispose(),e.textBubble=null}p(new(E(ra))(e.sourceBlock,t,"warning"))}}))}getAnchorLocation(){return yl.sum(this.workspaceLocation,new yl(8.5,8.5))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new Ol(t.y,t.y+t.height,t.x,t.x+t.width)}};qu.TYPE=lh.WARNING,qu.WEIGHT=2;var Zu=class extends Error{constructor(t){super(`Tried to append an icon of type ${t.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=t}},Qu={};Qu.DuplicateIconType=Zu;var td,ed,id={};id.CommentIcon=Ju,id.Icon=Ru,id.IconType=lh,id.MutatorIcon=Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon,id.WarningIcon=qu,id.exceptions=Qu,id.registry=Xu,td="PROCEDURE",Ur.DEFAULT_ARG$$module$build$src$core$procedures="x",(ed={CATEGORY_NAME:td,DEFAULT_ARG:Ur.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Ou,ed.allProcedures=ns,ed.findLegalName=Ur.findLegalName$$module$build$src$core$procedures,ed.flyoutCategory=ls,ed.getCallers=ds,ed.getDefinition=Ur.getDefinition$$module$build$src$core$procedures,ed.isNameUsed=as,ed.isProcedureBlock=In,ed.mutateCallers=Ur.mutateCallers$$module$build$src$core$procedures,ed.mutatorOpenListener=cs,ed.rename=Ur.rename$$module$build$src$core$procedures;var od=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(t){return Object.prototype.hasOwnProperty.call(this,t)||(this[t]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[t]}isField(t){return t.type&this.FIELD}isHat(t){return t.type&this.HAT}isIcon(t){return t.type&this.ICON}isSpacer(t){return t.type&this.SPACER}isInRowSpacer(t){return t.type&this.IN_ROW_SPACER}isInput(t){return t.type&this.INPUT}isExternalInput(t){return t.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(t){return t.type&this.INLINE_INPUT}isStatementInput(t){return t.type&this.STATEMENT_INPUT}isPreviousConnection(t){return t.type&this.PREVIOUS_CONNECTION}isNextConnection(t){return t.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(t){return t.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(t){return t.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(t){return t.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(t){return t.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(t){return t.type&this.RIGHT_SQUARE_CORNER}isCorner(t){return t.type&this.CORNER}isJaggedEdge(t){return t.type&this.JAGGED_EDGE}isRow(t){return t.type&this.ROW}isBetweenRowSpacer(t){return t.type&this.BETWEEN_ROW_SPACER}isTopRow(t){return t.type&this.TOP_ROW}isBottomRow(t){return t.type&this.BOTTOM_ROW}isTopOrBottomRow(t){return t.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(t){return t.type&this.INPUT_ROW}},nd=class{constructor(t){this.centerline=this.xPos=this.height=this.width=0,this.constants_=t,this.type=od.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},sd=class{constructor(t){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=t,this.type=od.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let t=this.elements.length-1;0<=t;t--){const e=this.elements[t];if(od.isInput(e))return e}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let t=0;t<this.elements.length;t++){const e=this.elements[t];if(od.isSpacer(e))return e}return null}getLastSpacer(){for(let t=this.elements.length-1;0<=t;t--){const e=this.elements[t];if(od.isSpacer(e))return e}return null}},rd=class extends sd{constructor(t){super(t),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=od.BOTTOM_ROW}hasLeftSquareCorner(t){return!!t.outputConnection||!!t.getNextBlock()}hasRightSquareCorner(t){return!0}measure(){let t=0,e=0,i=0;for(let o=0;o<this.elements.length;o++){const n=this.elements[o];e+=n.width,od.isSpacer(n)||(od.isNextConnection(n)?i=Math.max(i,n.height):t=Math.max(t,n.height))}this.width=Math.max(this.minWidth,e),this.height=Math.max(this.minHeight,t)+i,this.descenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},ad=class extends nd{constructor(t,e){super(t),this.connectionModel=e,this.type|=od.CONNECTION,this.shape=this.constants_.shapeFor(e),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=e.isHighlighted()}},ld=class extends ad{constructor(t,e){super(t,e.connection),this.input=e,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=od.INPUT,this.align=e.align,(this.connectedBlock=e.connection&&e.connection.targetBlock()?e.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},hd=class extends ld{constructor(t,e){super(t,e),this.height=0,this.type|=od.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},cd=class extends nd{constructor(t,e,i){super(t),this.field=e,this.parentInput=i,this.isEditable=e.EDITABLE,this.flipRtl=e.getFlipRtl(),this.type|=od.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width}},ud=class extends nd{constructor(t){super(t),this.type|=od.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},dd=class extends nd{constructor(t,e){super(t),this.icon=e,this.flipRtl=!1,this.type|=od.ICON,t=e.getSize(),this.height=t.height,this.width=t.width}},pd=class extends nd{constructor(t,e){super(t),this.type=this.type|od.SPACER|od.IN_ROW_SPACER,this.width=e,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},gd=class extends ld{constructor(t,e){super(t,e),this.type|=od.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},fd=class extends ld{constructor(t,e){super(t,e),this.type|=od.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},md=class extends sd{constructor(t){super(t),this.connectedBlockWidths=0,this.type|=od.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let e=0;e<this.elements.length;e++){const i=this.elements[e];this.width+=i.width,od.isInput(i)&&i instanceof ld&&(od.isStatementInput(i)&&i instanceof fd?t+=i.connectedBlockWidth:od.isExternalInput(i)&&i instanceof hd&&0!==i.connectedBlockWidth&&(t+=i.connectedBlockWidth-i.connectionWidth)),od.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},vd=class extends nd{constructor(t){super(t),this.type|=od.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},bd=class extends ad{constructor(t,e){super(t,e),this.type|=od.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},_d=class extends ad{constructor(t,e){super(t,e),this.connectionOffsetX=0,this.type|=od.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},yd=class extends ad{constructor(t,e){super(t,e),this.type|=od.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Td=class extends nd{constructor(t,e){super(t),this.type=(e&&"left"!==e?od.RIGHT_ROUND_CORNER:od.LEFT_ROUND_CORNER)|od.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},Ed=class extends sd{constructor(t,e,i){super(t),this.height=e,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|od.SPACER|od.BETWEEN_ROW_SPACER,this.elements=[new pd(this.constants_,i)]}measure(){}},wd=class extends nd{constructor(t,e){super(t),this.type=(e&&"left"!==e?od.RIGHT_SQUARE_CORNER:od.LEFT_SQUARE_CORNER)|od.CORNER,this.width=this.height=this.constants_.NO_PADDING}},kd=class extends sd{constructor(t){super(t),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=od.TOP_ROW}hasLeftSquareCorner(t){const e=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,i=t.getPreviousBlock();return!!t.outputConnection||e||!!i&&i.getNextBlock()===t}hasRightSquareCorner(t){return!0}measure(){let t=0,e=0,i=0;for(let o=0;o<this.elements.length;o++){const n=this.elements[o];e+=n.width,od.isSpacer(n)||(od.isHat(n)&&n instanceof ud?i=Math.max(i,n.ascenderHeight):t=Math.max(t,n.height))}this.width=Math.max(this.minWidth,e),this.height=Math.max(this.minHeight,t)+i,this.capline=this.ascenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Id=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=qn(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(t){this.blockStyles=Object.create(null);const e=t.blockStyles;for(const t in e)this.blockStyles[t]=this.validatedBlockStyle_(e[t]);this.setDynamicProperties_(t)}setDynamicProperties_(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=void 0!==t.startHats?t.startHats:this.ADD_START_HATS}setFontConstants_(t){t.fontStyle&&t.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=t.fontStyle.family),t.fontStyle&&t.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=t.fontStyle.weight),t.fontStyle&&t.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=t.fontStyle.size),t=pt("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline}setComponentConstants_(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(t){const e="auto_"+t;return this.blockStyles[e]||(this.blockStyles[e]=this.createBlockStyle_(t)),{style:this.blockStyles[e],name:e}}getBlockStyle(t){return this.blockStyles[t||""]||(t&&t.startsWith("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(t){return this.validatedBlockStyle_({colourPrimary:t})}validatedBlockStyle_(t){const e={};return t&&Object.assign(e,t),t=_o(e.colourPrimary||"#000"),e.colourPrimary=t.hex,e.colourSecondary=e.colourSecondary?_o(e.colourSecondary).hex:this.generateSecondaryColour_(e.colourPrimary),e.colourTertiary=e.colourTertiary?_o(e.colourTertiary).hex:this.generateTertiaryColour_(e.colourPrimary),e.hat=e.hat||"",e}generateSecondaryColour_(t){return po("#fff",t,.6)||t}generateTertiaryColour_(t){return po("#fff",t,.3)||t}dispose(){this.embossFilter&&st(this.embossFilter),this.disabledPattern&&st(this.disabledPattern),this.debugFilter&&st(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const t=this.JAGGED_TEETH_HEIGHT,e=this.JAGGED_TEETH_WIDTH;return{height:t,width:e,path:Qn([Yn(e,t/4),Yn(2*-e,t/2),Yn(e,t/4)])}}makeStartHat(){const t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:Kn("c",[Yn(30,-t),Yn(70,-t),Yn(e,0)])}}makePuzzleTab(){function t(t){const o=-(t=t?-1:1);var n=i/2;const s=n+2.5,r=n+.5,a=Yn(-e,t*n);return n=Yn(e,t*n),Kn("c",[Yn(0,t*s),Yn(-e,o*r),a])+Kn("s",[Yn(e,2.5*o),n])}const e=this.TAB_WIDTH,i=this.TAB_HEIGHT,o=t(!0),n=t(!1);return{type:this.SHAPES.PUZZLE,width:e,height:i,pathDown:n,pathUp:o}}makeNotch(){function t(t){return Qn([Yn(t*o,i),Yn(3*t,0),Yn(t*o,-i)])}const e=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,o=(e-3)/2,n=t(1),s=t(-1);return{type:this.SHAPES.NOTCH,width:e,height:i,pathLeft:n,pathRight:s}}makeInsideCorners(){const t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:es("a","0 0,0",t,Yn(-t,t)),pathBottom:es("a","0 0,0",t,Yn(t,t))}}makeOutsideCorners(){const t=this.CORNER_RADIUS,e=qn(0,t)+es("a","0 0,1",t,Yn(t,-t)),i=es("a","0 0,1",t,Yn(t,t)),o=es("a","0 0,1",t,Yn(-t,-t));return{topLeft:e,topRight:i,bottomRight:es("a","0 0,1",t,Yn(-t,t)),bottomLeft:o,rightHeight:t}}shapeFor(t){switch(t.type){case mu.INPUT_VALUE:case mu.OUTPUT_VALUE:return this.PUZZLE_TAB;case mu.PREVIOUS_STATEMENT:case mu.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(t,e,i){this.injectCSS_(e,i),this.defs=tt(Cl.DEFS,{},t),t=tt(Cl.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),tt(Cl.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},t),e=tt(Cl.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},t),tt(Cl.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},e),tt(Cl.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},t),tt(Cl.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},t),this.embossFilterId=t.id,this.embossFilter=t,t=tt(Cl.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),tt(Cl.RECT,{width:10,height:10,fill:"#aaa"},t),tt(Cl.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},t),this.disabledPatternId=t.id,this.disabledPattern=t,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const t=tt(Cl.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),e=tt(Cl.FECOMPONENTTRANSFER,{result:"outBlur"},t);tt(Cl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),tt(Cl.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),tt(Cl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter=t}}injectCSS_(t,e){e=this.getCSS_(e),t="blockly-renderer-style-"+t,this.cssNode=document.getElementById(t);const i=e.join("\n");this.cssNode?this.cssNode.firstChild.textContent=i:((e=document.createElement("style")).id=t,t=document.createTextNode(i),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild),this.cssNode=e)}getCSS_(t){return[`${t} .blocklyText, `,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect,`,`${t} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text {`,"fill: #000;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${t} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${t} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${t} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${t} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${t} .blocklyReplaceable .blocklyPathLight,`,`${t} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},$d={};$d.ConstantProvider=Id,$d.isDynamicShape=gs,$d.isNotch=ms,$d.isPuzzleTab=fs;var Sd=class{constructor(t,e){this.inlinePath_=this.outlinePath_="",this.block_=t,this.info_=e,this.topLeft_=t.getRelativeToSurfaceXY(),this.constants_=e.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let t=1;t<this.info_.rows.length-1;t++){const e=this.info_.rows[t];e.hasJaggedEdge?this.drawJaggedEdge_(e):e.hasStatement?this.drawStatementInput_(e):e.hasExternalInput?this.drawValueInput_(e):this.drawRightSideRow_(e)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const t=this.info_.topRow,e=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=qn(t.xPos,this.info_.startY);for(let t,i=0;t=e[i];i++)od.isLeftRoundedCorner(t)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:od.isRightRoundedCorner(t)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:od.isPreviousConnection(t)&&t instanceof ad?this.outlinePath_+=t.shape.pathLeft:od.isHat(t)?this.outlinePath_+=this.constants_.START_HAT.path:od.isSpacer(t)&&(this.outlinePath_+=ts("h",t.width));this.outlinePath_+=ts("v",t.height)}drawJaggedEdge_(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+ts("v",t.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(t){const e=t.getLastInput();this.positionExternalValueConnection_(t);const i=gs(e.shape)?e.shape.pathDown(e.height):e.shape.pathDown;this.outlinePath_+=ts("H",e.xPos+e.width)+i+ts("v",t.height-e.connectionHeight)}drawStatementInput_(t){var e=t.getLastInput();if(e){var i=e.xPos+e.notchOffset+e.shape.width;e=e.shape.pathRight+ts("h",-(e.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var o=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=ts("H",i)+e+ts("v",o)+this.constants_.INSIDE_CORNERS.pathBottom+ts("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}}drawRightSideRow_(t){this.outlinePath_+=ts("V",t.yPos+t.height)}drawBottom_(){const t=this.info_.bottomRow,e=t.elements;this.positionNextConnection_();let i=0,o="";for(let n,s=e.length-1;n=e[s];s--)od.isNextConnection(n)&&n instanceof ad?o+=n.shape.pathRight:od.isLeftSquareCorner(n)?o+=ts("H",t.xPos):od.isLeftRoundedCorner(n)?o+=this.constants_.OUTSIDE_CORNERS.bottomLeft:od.isRightRoundedCorner(n)?(o+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):od.isSpacer(n)&&(o+=ts("h",-1*n.width));this.outlinePath_+=ts("V",t.baseline-i),this.outlinePath_+=o}drawLeft_(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){const e=t.connectionOffsetY+t.height;t=gs(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=ts("V",e)+t}this.outlinePath_+="z"}drawInternals_(){for(let t,e=0;t=this.info_.rows[e];e++)for(let e,i=0;e=t.elements[i];i++)od.isInlineInput(e)?this.drawInlineInput_(e):(od.isIcon(e)||od.isField(e))&&this.layoutField_(e)}layoutField_(t){const e=t.centerline-t.height/2;let i=t.xPos;var o="";this.info_.RTL&&(i=-(i+t.width),t.flipRtl&&(i+=t.width,o="scale(-1 1)")),od.isIcon(t)?((o=t.icon).setOffsetInBlock(new yl(i,e)),this.info_.isInsertionMarker&&o.hideForInsertionMarker()):((t=t.field.getSvgRoot()).setAttribute("transform","translate("+i+","+e+")"+o),this.info_.isInsertionMarker&&t.setAttribute("display","none"))}drawInlineInput_(t){const e=t.width,i=t.height,o=t.connectionOffsetY,n=t.connectionHeight+o;this.inlinePath_+=Jn(t.xPos+t.connectionWidth,t.centerline-i/2)+ts("v",o)+t.shape.pathDown+ts("v",i-n)+ts("h",e-t.connectionWidth)+ts("v",-i)+"z",this.positionInlineInputConnection_(t)}positionInlineInputConnection_(t){const e=t.centerline-t.height/2;if(t.connectionModel){let i=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e+t.connectionOffsetY)}}positionStatementInputConnection_(t){const e=t.getLastInput();if(null!=e&&e.connectionModel){let i=t.xPos+t.statementEdge+e.notchOffset;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t.yPos)}}positionExternalValueConnection_(t){const e=t.getLastInput();if(e&&e.connectionModel){let i=t.xPos+t.width;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t.yPos)}}positionPreviousConnection_(){const t=this.info_.topRow;if(t.connection){const e=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,0)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const e=t.connection,i=e.xPos;e.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,t.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const t of this.info_.rows)for(const e of t.elements)if(e instanceof ad)if(e.highlighted)this.drawConnectionHighlightPath(e);else{let t,i;null==(i=(t=this.block_.pathObject).removeConnectionHighlight)||i.call(t,e.connectionModel)}}drawConnectionHighlightPath(t){const e=t.connectionModel;t=e.type===mu.INPUT_VALUE||e.type===mu.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(t):this.getStatementConnectionHighlightPath(t);const i=e.getSourceBlock();let o,n;null==(n=(o=i.pathObject).addConnectionHighlight)||n.call(o,e,t,e.getOffsetInBlock(),i.RTL)}getExpressionConnectionHighlightPath(t){let e="";return gs(t.shape)?e=t.shape.pathDown(t.height):fs(t.shape)&&(e=t.shape.pathDown),t=this.constants_.TAB_OFFSET_FROM_TOP,qn(0,-t)+ts("v",t)+e+ts("v",t)}getStatementConnectionHighlightPath(t){if(!ms(t.shape))throw Error("Statement connections should have notch shapes");const e=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return qn(-e,0)+ts("h",e)+t.shape.pathLeft+ts("h",e)}};(function(t){t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(Ur.Align$$module$build$src$core$inputs$align||(Ur.Align$$module$build$src$core$inputs$align={})),Ur.Align$$module$build$src$core$inputs$align;var Cd=class extends Xc{constructor(t,e,i){super(Xc.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,t!==Xc.SKIP_SETUP&&(i?this.configure_(i):this.class=e||null,this.setValue(t))}configure_(t){super.configure_(t),t.class&&(this.class=t.class)}initView(){this.createTextElement_(),this.class&&et(this.getTextElement(),this.class)}doClassValidation_(t){return null==t?null:`${t}`}setClass(t){this.textElement_&&(this.class&&ot(this.textElement_,this.class),t&&et(this.textElement_,t)),this.class=t}static fromJson(t){return new this(vo(t.text),void 0,t)}};Sn("field_label",Cd),Cd.prototype.DEFAULT_VALUE="";var Od=class{constructor(t,e){this.name=t,this.sourceBlock=e,this.fieldRow=[],this.align=Ur.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=Ur.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(t,e){return this.insertFieldAt(this.fieldRow.length,t,e),this}insertFieldAt(t,e,i){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return e||""===e&&i?("string"==typeof e&&(e=Ur.fromJson$$module$build$src$core$field_registry({type:"field_label",text:e})),e.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(e),e.name=i,e.setVisible(this.isVisible()),e.prefixField&&(t=this.insertFieldAt(t,e.prefixField)),this.fieldRow.splice(t,0,e),t++,e.suffixField&&(t=this.insertFieldAt(t,e.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),t):t}removeField(t,e){for(let e,i=0;e=this.fieldRow[i];i++)if(e.name===t)return e.dispose(),this.fieldRow.splice(i,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(e)return!1;throw Error('Field "'+t+'" not found.')}isVisible(){return this.visible}setVisible(t){let e=[];if(this.visible===t)return e;this.visible=t;for(let e,i=0;e=this.fieldRow[i];i++)e.setVisible(t);if(this.connection){var i=this.connection;t?e=i.startTrackingAll():i.stopTrackingAll(),(i=i.targetBlock())&&(i.getSvgRoot().style.display=t?"block":"none")}return e}markDirty(){for(let t,e=0;t=this.fieldRow[e];e++)t.markDirty()}setCheck(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this}setAlign(t){return this.align=t,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const t of this.fieldRow)t.init()}initModel(){for(const t of this.fieldRow)t.initModel()}initField(t){this.sourceBlock.rendered?t.init():t.initModel()}dispose(){for(let t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(t){return this.sourceBlock.makeConnection_(t)}},Rd=class extends Od{constructor(t,e){super(t,e),this.name=t,this.type=Ur.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},Ad=class extends Od{constructor(t,e){super(t,e),this.name=t,this.type=Ur.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},Md=class extends Od{constructor(t,e){if(!t)throw Error("Statement inputs must have a non-empty name");super(t,e),this.name=t,this.type=Ur.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(mu.NEXT_STATEMENT)}};Ur.ValueInput$$module$build$src$core$inputs$value_input=class extends Od{constructor(t,e){if(!t)throw Error("Value inputs must have a non-empty name");super(t,e),this.name=t,this.type=Ur.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(mu.INPUT_VALUE)}},Ur.ValueInput$$module$build$src$core$inputs$value_input;var xd=class{constructor(t,e){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=t,this.block_=e,this.constants_=this.renderer_.getConstants(),this.outputConnection=e.outputConnection?new _d(this.constants_,e.outputConnection):null,this.isInline=e.getInputsInline()&&!e.isCollapsed(),this.isCollapsed=e.isCollapsed(),this.isInsertionMarker=e.isInsertionMarker(),this.RTL=e.RTL,this.topRow=new kd(this.constants_),this.bottomRow=new rd(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let t=new md(this.constants_);this.inputRows.push(t);var e=this.block_.getIcons();for(let i,o=0;i=e[o];o++){const e=new dd(this.constants_,i);this.isCollapsed&&!i.isShownWhenCollapsed()||t.elements.push(e)}e=void 0;for(let i,o=0;i=this.block_.inputList[o];o++)if(i.isVisible()){this.shouldStartNewRow_(i,e)&&(this.rows.push(t),t=new md(this.constants_),this.inputRows.push(t));for(let e,o=0;e=i.fieldRow[o];o++)t.elements.push(new cd(this.constants_,e,i));this.addInput_(i,t),e=i}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new vd(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var t=!!this.block_.previousConnection;const e=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;let i=this.topRow.hasLeftSquareCorner(this.block_)?wd:Td;this.topRow.elements.push(new i(this.constants_)),e?(t=new ud(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new yd(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof Md&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?wd:Td,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Md?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new wd(this.constants_)):this.bottomRow.elements.push(new Td(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new bd(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new wd(this.constants_,"right")):this.bottomRow.elements.push(new Td(this.constants_,"right"))}addInput_(t,e){this.isInline&&t instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input?(e.elements.push(new gd(this.constants_,t)),e.hasInlineInput=!0):t instanceof Md?(e.elements.push(new fd(this.constants_,t)),e.hasStatement=!0):t instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input?(e.elements.push(new hd(this.constants_,t)),e.hasExternalInput=!0):(t instanceof Rd||t instanceof Ad)&&(e.minHeight=Math.max(e.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),null===e.align&&(e.align=t.align)}shouldStartNewRow_(t,e){return!!e&&(e instanceof Ad||t instanceof Md||e instanceof Md||(t instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input||t instanceof Rd||e instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let t,e=0;t=this.rows[e];e++){const e=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new pd(this.constants_,this.getInRowSpacing_(null,e[0]))),e.length){for(let i=0;i<e.length-1;i++){t.elements.push(e[i]);const o=this.getInRowSpacing_(e[i],e[i+1]);t.elements.push(new pd(this.constants_,o))}t.elements.push(e[e.length-1]),t.endsWithElemSpacer()&&t.elements.push(new pd(this.constants_,this.getInRowSpacing_(e[e.length-1],null)))}}}getInRowSpacing_(t,e){if(!t&&e&&od.isStatementInput(e))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&od.isInput(t)&&!e){if(od.isExternalInput(t))return this.constants_.NO_PADDING;if(od.isInlineInput(t))return this.constants_.LARGE_PADDING;if(od.isStatementInput(t))return this.constants_.NO_PADDING}return t&&od.isLeftSquareCorner(t)&&e&&(od.isPreviousConnection(e)||od.isNextConnection(e))?e.notchOffset:t&&od.isLeftRoundedCorner(t)&&e&&(od.isPreviousConnection(e)||od.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let t=0,e=0,i=0;for(let n,s=0;n=this.rows[s];s++){if(n.measure(),e=Math.max(e,n.width),n.hasStatement){var o=n.getLastInput();let e,i;o=n.width-(null!=(i=null==(e=o)?void 0:e.width)?i:0),t=Math.max(t,o)}i=Math.max(i,n.widthWithConnectedBlocks)}this.statementEdge=t,this.width=e;for(let t,e=0;t=this.rows[e];e++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(e,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let e,i=0;e=this.rows[i];i++)if(e.hasStatement)this.alignStatementRow_(e);else{var t=e.width;0<(t=this.getDesiredRowWidth_(e)-t)&&this.addAlignmentPadding_(e,t),od.isTopOrBottomRow(e)&&(e.widthWithConnectedBlocks=e.width)}}getDesiredRowWidth_(t){return this.width-this.startX}addAlignmentPadding_(t,e){const i=t.getFirstSpacer(),o=t.getLastSpacer();if((t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=e),t.align===Ur.Align$$module$build$src$core$inputs$align.LEFT&&o)o.width+=e;else if(t.align===Ur.Align$$module$build$src$core$inputs$align.CENTRE&&i&&o)i.width+=e/2,o.width+=e/2;else if(t.align===Ur.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=e;else{if(!o)return;o.width+=e}t.width+=e}alignStatementRow_(t){const e=t.getLastInput();if(e){var i=t.width-e.width,o=this.statementEdge;0<(i=o-i)&&this.addAlignmentPadding_(t,i),i=t.width,o=this.getDesiredRowWidth_(t),e.width+=o-i,e.height=Math.max(e.height,t.height),t.width+=o-i,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)}}addRowSpacing_(){const t=this.rows;this.rows=[];for(let e=0;e<t.length;e++)this.rows.push(t[e]),e!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[e],t[e+1]))}makeSpacerRow_(t,e){var i=this.getSpacerRowHeight_(t,e);const o=this.getSpacerRowWidth_(t,e);return i=new Ed(this.constants_,i,o),t.hasStatement&&(i.followsStatement=!0),e.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(t,e){return this.width-this.startX}getSpacerRowHeight_(t,e){return this.constants_.MEDIUM_PADDING}getElemCenterline_(t,e){return od.isSpacer(e)?t.yPos+e.height/2:od.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,od.isNextConnection(e)?t+e.height/2:t-e.height/2):od.isTopRow(t)?od.isHat(e)?t.capline-e.height/2:t.capline+e.height/2:t.yPos+t.height/2}recordElemPositions_(t){let e=t.xPos;for(let i,o=0;i=t.elements[o];o++)od.isSpacer(i)&&(i.height=t.height),i.xPos=e,i.centerline=this.getElemCenterline_(t,i),e+=i.width}finalize_(){let t=0,e=0;for(let i,o=0;i=this.rows[o];o++)i.yPos=e,i.xPos=this.startX,e+=i.height,t=Math.max(t,i.widthWithConnectedBlocks),this.recordElemPositions_(i);if(this.outputConnection&&this.block_.nextConnection){const e=this.block_.nextConnection.targetBlock();e&&(t=Math.max(t,e.getHeightWidth().width))}this.widthWithChildren=t+this.startX,this.height=e,this.startY=this.topRow.capline,this.bottomRow.baseline=e-this.bottomRow.descenderHeight}getMeasureableForConnection(t){let e;if((null==(e=this.outputConnection)?void 0:e.connectionModel)===t)return this.outputConnection;for(const e of this.rows)for(const i of e.elements)if(i instanceof ad&&i.connectionModel===t)return i;return null}},Ld=class extends oc{constructor(t){if(super(t),this.type=Ur.DELETE$$module$build$src$core$events$utils,t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=jo(t),this.ids=y(t),this.wasShadow=t.isShadow(),this.oldJson=Ne(t,{addCoordinates:!0})}}toJson(){const t=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.oldXml=qo(this.oldXml),t.ids=this.ids,t.wasShadow=this.wasShadow,t.oldJson=this.oldJson,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Ld)).oldXml=Ur.textToDom$$module$build$src$core$utils$xml(t.oldXml),e.ids=t.ids,e.wasShadow=t.wasShadow||"shadow"===e.oldXml.tagName.toLowerCase(),e.oldJson=t.oldJson,void 0!==t.recordUndo&&(e.recordUndo=t.recordUndo),e}run(t){const e=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(t)for(t=0;t<this.ids.length;t++){const i=this.ids[t],o=e.getBlockById(i);o?o.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else ze(this.oldJson,e)}};t(jr.EVENT,Ur.DELETE$$module$build$src$core$events$utils,Ld);var Dd=class{constructor(t,e){this.type=e,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=t}connect_(t){const e=mu.INPUT_VALUE,i=this.getSourceBlock();var o=t.getSourceBlock();let n,s;if(t.isConnected()&&t.disconnectInternal(!1),this.isConnected()){const t=this.stashShadowState(),e=this.targetBlock();e.isShadow()?e.dispose(!1):(this.disconnectInternal(),n=e),this.applyShadowState(t)}b()&&(s=new(E(Ur.MOVE$$module$build$src$core$events$utils))(o),s.setReason(["connect"])),vs(this,t),o.setParent(i),s&&(s.recordNew(),p(s)),n&&(t=this.type===e?n.outputConnection:n.previousConnection)&&((o=Dd.getConnectionForOrphanedConnection(o,t))?t.connect(o):t.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const t=this.targetBlock();t&&!t.isDeadOrDying()&&t.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===mu.INPUT_VALUE||this.type===mu.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(t){}connect(t){if(this.targetConnection===t)return!0;if(this.getConnectionChecker().canConnect(this,t,!1)){const e=Ur.getGroup$$module$build$src$core$events$utils();e||Ur.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(t):t.connect_(this),Ur.setGroup$$module$build$src$core$events$utils(e)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(t=!0){const{parentConnection:e,childConnection:i}=this.getParentAndChildConnections();if(!e||!i)throw Error("Source connection not connected.");const o=Ur.getGroup$$module$build$src$core$events$utils();let n;o||Ur.setGroup$$module$build$src$core$events$utils(!0),b()&&(n=new(E(Ur.MOVE$$module$build$src$core$events$utils))(i.getSourceBlock()),n.setReason(["disconnect"]));const s=this.targetConnection;s&&(s.targetConnection=null),this.targetConnection=null,t&&i.getSourceBlock().setParent(null),n&&(n.recordNew(),p(n)),i.getSourceBlock().isShadow()||e.respawnShadow_(),Ur.setGroup$$module$build$src$core$events$utils(o)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(t,e){return!(this.getSourceBlock().isDeadOrDying()||(e=null==(i=t.getInput(e))?void 0:i.connection,(i=this.targetBlock())&&i!==t||!e||e.targetConnection===this||(e.isConnected()&&e.disconnect(),e.connect(this),0)));var i}targetBlock(){if(this.isConnected()){let t,e;return null!=(e=null==(t=this.targetConnection)?void 0:t.getSourceBlock())?e:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return t?(Array.isArray(t)||(t=[t]),this.check=t,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(t){this.setShadowStateInternal({shadowDom:t})}getShadowDom(t){return t&&this.targetBlock().isShadow()?Ko(this.targetBlock()):this.shadowDom}setShadowState(t){this.setShadowStateInternal({shadowState:t})}getShadowState(t){return t&&this.targetBlock()&&this.targetBlock().isShadow()?Ne(this.targetBlock()):this.shadowState}neighbours(t){return[]}getParentInput(){let t=null;const e=this.sourceBlock_.inputList;for(let i=0;i<e.length;i++)if(e[i].connection===this){t=e[i];break}return t}toString(){const t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection===this)var e="Output Connection of ";else if(t.previousConnection===this)e="Previous Connection of ";else if(t.nextConnection===this)e="Next Connection of ";else{e=null;for(let i,o=0;i=t.inputList[o];o++)if(i.connection===this){e=i;break}if(!e)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";e='Input "'+e.name+'" connection on '}return e+t.toDevString()}stashShadowState(){const t=this.getShadowDom(!0),e=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:t,shadowState:e}}applyShadowState({shadowDom:t,shadowState:e}){this.shadowDom=t,this.shadowState=e}setShadowStateInternal({shadowDom:t=null,shadowState:e=null}={}){this.shadowDom=t,this.shadowState=e,this.getSourceBlock().isDeadOrDying()||((t=this.targetBlock())?t.isShadow()?(t.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(t=this.createShadowBlock(!1),this.serializeShadow(t),t&&t.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(t){var e=this.getSourceBlock();const i=this.getShadowState(),o=this.getShadowDom();if(e.isDeadOrDying()||!i&&!o)return null;if(i)return je(i,e.workspace,{parentConnection:t?this:void 0,isShadow:!0,recordUndo:!1});if(o){if(e=on(o,e.workspace),t)if(this.type===mu.INPUT_VALUE){if(!e.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(e.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==mu.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!e.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(e.previousConnection))throw Error("Could not connect shadow block to connection")}return e}return null}serializeShadow(t){t&&(this.shadowDom=Ko(t),this.shadowState=Ne(t))}static getConnectionForOrphanedConnection(t,e){if(e.type===mu.OUTPUT_VALUE)return _s(t,e.getSourceBlock());t=t.lastConnectionInStack(!0);const i=e.getConnectionChecker();return t&&i.canConnect(e,t,!1)?t:null}};Dd.CAN_CONNECT=0,Dd.REASON_SELF_CONNECTION=1,Dd.REASON_WRONG_TYPE=2,Dd.REASON_TARGET_NULL=3,Dd.REASON_CHECKS_FAILED=4,Dd.REASON_DIFFERENT_WORKSPACES=5,Dd.REASON_SHADOW_PARENT=6,Dd.REASON_DRAG_CHECKS_FAILED=7,Dd.REASON_PREVIOUS_AND_OUTPUT=8;var Nd=class{constructor(t,e,i){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=null,this.statementInputCount=0,this.workspace=t,this.id=i&&!t.getBlockById(i)?i:u(),t.setBlockById(this.id,this),this.xy_=new yl(0,0),this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,e){if(this.type=e,!(i=Ea[e])||"object"!=typeof i)throw TypeError("Invalid block definition for type: "+e);Object.assign(this,i)}t.addTopBlock(this),t.addTypedBlock(this),new.target===Nd&&this.doInit_()}doInit_(){const t=Ur.getGroup$$module$build$src$core$events$utils();t||Ur.setGroup$$module$build$src$core$events$utils(!0);const e=d();try{"function"==typeof this.init&&(Ur.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),Ur.setRecordUndo$$module$build$src$core$events$utils(e)),b()&&p(new(E(Ur.CREATE$$module$build$src$core$events$utils))(this))}finally{Ur.setGroup$$module$build$src$core$events$utils(t),Ur.setRecordUndo$$module$build$src$core$events$utils(e)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(t=!1){this.disposing=!0,this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),b()&&p(new(E(Ur.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach((t=>t.disposeInternal())),this.inputList.forEach((t=>t.dispose())),this.inputList.length=0,this.getConnections_(!0).forEach((t=>t.dispose())),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const t of this.inputList)t.initModel();this.initialized=!0}}unplug(t){this.outputConnection&&this.unplugFromRow_(t),this.previousConnection&&this.unplugFromStack_(t)}unplugFromRow_(t){let e,i=null;null!=(e=this.outputConnection)&&e.isConnected()&&(i=this.outputConnection.targetConnection,this.outputConnection.disconnect()),i&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&(null==(t=t.targetConnection)||t.disconnect(),this.workspace.connectionChecker.canConnect(t,i,!1)?i.connect(t):null==t||t.onFailedConnect(i))}getOnlyValueConnection_(){let t=null;for(let e=0;e<this.inputList.length;e++){const i=this.inputList[e].connection;if(i&&i.type===mu.INPUT_VALUE&&i.targetConnection){if(t)return null;t=i}}return t}unplugFromStack_(t){let e=null;var i;if(null!=(i=this.previousConnection)&&i.isConnected()&&(e=this.previousConnection.targetConnection,this.previousConnection.disconnect()),i=this.getNextBlock(),t&&i&&!i.isShadow()){let i,o;null==(t=null!=(o=null==(i=this.nextConnection)?void 0:i.targetConnection)?o:null)||t.disconnect(),e&&this.workspace.connectionChecker.canConnect(e,t,!1)&&e.connect(t)}}getConnections_(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(let e,i=0;e=this.inputList[i];i++)e.connection&&t.push(e.connection);return t}lastConnectionInStack(t){let e=this.nextConnection;for(;e;){const i=e.targetBlock();if(!i||t&&i.isShadow())return e;e=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(t){for(let e,i=0;e=this.inputList[i];i++)if(e.connection&&e.connection.targetBlock()===t)return e;return null}getSurroundParent(){let t,e=this;do{if(t=e,e=e.getParent(),!e)return null}while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let t,e=this;do{t=e,e=t.parentBlock_}while(e);return t}getTopStackBlock(){let t,e=this;do{t=e.getPreviousBlock()}while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(t){if(!t)return this.childBlocks_;t=[];for(let i,o=0;i=this.inputList[o];o++)if(i.connection){var e=i.connection.targetBlock();e&&t.push(e)}return(e=this.getNextBlock())&&t.push(e),t}setParent(t){if(t!==this.parentBlock_){var e=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!e;if(i&&t&&e!==t)throw Error("Block connected to superior one that is not new parent.");if(!i&&t)throw Error("Block not connected to new parent.");if(i&&!t)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?q(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(t){const e=[this],i=this.getChildren(t);for(let o,n=0;o=i[n];n++)e.push(...o.getDescendants(t));return e}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(t){this.deletable_=t}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(t){this.movable_=t}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(L(this,!0))}isShadow(){return this.isShadow_}setShadow(t){this.isShadow_=t}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(t){this.isInsertionMarker_=t}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(t){this.editable_=t;for(let t,e=0;t=this.inputList[e];e++)for(let e,i=0;e=t.fieldRow[i];i++)e.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const t of this.inputList)if(t.connection||1<t.fieldRow.length)return!1;return!0}getMatchingConnection(t,e){const i=this.getConnections_(!0);if(t=t.getConnections_(!0),i.length!==t.length)throw Error("Connection lists did not match in length.");for(let o=0;o<t.length;o++)if(t[o]===e)return i[o];return null}setHelpUrl(t){this.helpUrl=t}setTooltip(t){this.tooltip=t}getTooltip(){return Gi(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(t){t=_o(t),this.hue_=t.hue,this.colour_=t.hex}setStyle(t){this.styleName_=t}setOnChange(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=t,this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(t){if("string"!=typeof t)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===t?"nothing":t+" of type "+typeof t)+" instead");for(let e,i=0;e=this.inputList[i];i++)for(let i,o=0;i=e.fieldRow[o];o++)if(i.name===t)return i;return null}getVars(){const t=[];for(let e,i=0;e=this.inputList[i];i++)for(let i,o=0;i=e.fieldRow[o];o++)i.referencesVariables()&&t.push(i.getValue());return t}getVarModels(){const t=[];for(let e,i=0;e=this.inputList[i];i++)for(let i,o=0;i=e.fieldRow[o];o++)if(i.referencesVariables()){const e=this.workspace.getVariableById(i.getValue());e&&t.push(e)}return t}updateVarName(t){for(let e,i=0;e=this.inputList[i];i++)for(let i,o=0;i=e.fieldRow[o];o++)i.referencesVariables()&&t.getId()===i.getValue()&&i.refreshVariableName()}renameVarById(t,e){for(let i,o=0;i=this.inputList[o];o++)for(let o,n=0;o=i.fieldRow[n];n++)o.referencesVariables()&&t===o.getValue()&&o.setValue(e)}getFieldValue(t){return(t=this.getField(t))?t.getValue():null}setFieldValue(t,e){const i=this.getField(e);if(!i)throw Error('Field "'+e+'" not found.');i.setValue(t)}setPreviousStatement(t,e){if(t)void 0===e&&(e=null),this.previousConnection||(this.previousConnection=this.makeConnection_(mu.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(e);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(t,e){if(t)void 0===e&&(e=null),this.nextConnection||(this.nextConnection=this.makeConnection_(mu.NEXT_STATEMENT)),this.nextConnection.setCheck(e);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(t,e){if(t)void 0===e&&(e=null),this.outputConnection||(this.outputConnection=this.makeConnection_(mu.OUTPUT_VALUE)),this.outputConnection.setCheck(e);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(t){this.inputsInline!==t&&(p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof Rd&&this.inputList[t]instanceof Rd)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[t]instanceof Rd)return!0;for(t=0;t<this.inputList.length;t++)if(this.inputList[t]instanceof Ad)return!0;return!1}setOutputShape(t){this.outputShape_=t}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}get disabled(){return Xn("disabled","v11","v12","the isEnabled or hasDisabledReason methods of Block"),this.hasDisabledReason(rh)}set disabled(t){Xn("disabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(t,rh)}setEnabled(t){Xn("setEnabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(!t,rh)}setDisabledReason(t,e){this.disabledReasons.has(e)!==t&&(t?this.disabledReasons.add(e):this.disabledReasons.delete(e),(t=new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,!t,t)).setDisabledReason(e),p(t))}getInheritedDisabled(){let t=this.getSurroundParent();for(;t;){if(!t.isEnabled())return!0;t=t.getSurroundParent()}return!1}hasDisabledReason(t){return this.disabledReasons.has(t)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(t){this.collapsed_!==t&&(p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)}toString(t,e){e=this.toTokens(e);for(let t=2;t<e.length;t++)"("===e[t-2]&&")"===e[t]&&(e[t-2]=e[t-1],e.splice(t-1,2));let i="";return e=(e=e.reduce(((t,e)=>(t=t+("("===i||")"===e?"":" ")+e,i=e[e.length-1],t)),"")).trim()||"???",t&&e.length>t&&(e=e.substring(0,t-3)+"..."),e}toTokens(t="?"){const e=[];for(const o of this.inputList)if(o.name!=nh){for(const t of o.fieldRow)e.push(t.getText());if(o.connection){const n=o.connection.targetBlock();if(n){var i=o.connection;let s=i.getCheck();!s&&i.targetConnection&&(s=i.targetConnection.getCheck()),(i=!!s&&(s.includes("Boolean")||s.includes("Number")))&&e.push("("),e.push(...n.toTokens(t)),i&&e.push(")")}else e.push(t)}}return e}appendValueInput(t){return this.appendInput(new Ur.ValueInput$$module$build$src$core$inputs$value_input(t,this))}appendStatementInput(t){return this.statementInputCount++,this.appendInput(new Md(t,this))}appendDummyInput(t=""){return this.appendInput(new Rd(t,this))}appendEndRowInput(t=""){return this.appendInput(new Ad(t,this))}appendInput(t){return this.inputList.push(t),t}appendInputFromRegistry(t,e){return(t=r(jr.INPUT,t,!1))?this.appendInput(new t(e,this)):null}jsonInit(t){var e=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(e+"Must not have both an output and a previousStatement.");for(var i=0;t["args"+i];){if(void 0===t["message"+i])throw Error(e+`args${i} must have a corresponding message (message${i}).`);i++}if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(e+"Must not have both a colour and a style.");for(t.style?this.jsonInitStyle_(t,e):this.jsonInitColour_(t,e),i=0;void 0!==t["message"+i];)this.interpolate_(t["message"+i],t["args"+i]||[],t["implicitAlign"+i]||t["lastDummyAlign"+i],e),i++;if(void 0!==t.inputsInline&&(Ur.disable$$module$build$src$core$events$utils(),this.setInputsInline(t.inputsInline),Ur.enable$$module$build$src$core$events$utils()),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(i=vo(t.tooltip),this.setTooltip(i)),void 0!==t.enableContextMenu&&(this.contextMenu=!!t.enableContextMenu),void 0!==t.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!t.suppressPrefixSuffix),void 0!==t.helpUrl&&(i=vo(t.helpUrl),this.setHelpUrl(i)),"string"==typeof t.extensions&&(console.warn(e+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&Dn(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(e=0;e<t.length;e++)Dn(t[e],this,!1)}jsonInitColour_(t,e){if("colour"in t)if(void 0===t.colour)console.warn(e+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(i){console.warn(e+"Illegal colour value: ",t)}}}jsonInitStyle_(t,e){t=t.style;try{this.setStyle(t)}catch(i){console.warn(e+"Style does not exist: ",t)}}mixin(t,e){if(void 0!==e&&"boolean"!=typeof e)throw Error("opt_disableCheck must be a boolean if provided");if(!e){e=[];for(const i in t)void 0!==this[i]&&e.push(i);if(e.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(e))}Object.assign(this,t)}interpolate_(t,e,i,o){t=mo(t),this.validateTokens_(t,e.length),e=this.interpolateArguments_(t,e,i),i=[];for(let n,s=0;n=e[s];s++)if(this.isInputKeyword_(n.type)){if(t=this.inputFromJson_(n,o)){for(let e,o=0;e=i[o];o++)t.appendField(e[0],e[1]);i.length=0}}else(t=this.fieldFromJson_(n))&&i.push([t,n.name])}validateTokens_(t,e){const i=[];let o=0;for(let n=0;n<t.length;n++){const s=t[n];if("number"==typeof s){if(1>s||s>e)throw Error('Block "'+this.type+'": Message index %'+s+" out of range.");if(i[s])throw Error('Block "'+this.type+'": Message index %'+s+" duplicated.");i[s]=!0,o++}}if(o!==e)throw Error('Block "'+this.type+'": Message does not reference all '+e+" arg(s).")}interpolateArguments_(t,e,i){const o=[];for(let s=0;s<t.length;s++){var n=t[s];if("number"==typeof n&&(n=e[n-1]),"string"==typeof n)if("\n"===n)n={type:"input_end_row"},i&&(n.align=i);else if(!(n=this.stringToFieldJson_(n)))continue;o.push(n)}return(t=o.length)&&!this.isInputKeyword_(o[t-1].type)&&(t={type:"input_dummy"},i&&(t.align=i),o.push(t)),o}fieldFromJson_(t){const e=Ur.fromJson$$module$build$src$core$field_registry(t);return!e&&t.alt?"string"==typeof t.alt?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):e}inputFromJson_(t,e){var i={LEFT:Ur.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:Ur.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:Ur.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:Ur.Align$$module$build$src$core$inputs$align.CENTRE};let o;switch(t.type){case"input_value":o=this.appendValueInput(t.name);break;case"input_statement":o=this.appendStatementInput(t.name);break;case"input_dummy":o=this.appendDummyInput(t.name);break;case"input_end_row":o=this.appendEndRowInput(t.name);break;default:o=this.appendInputFromRegistry(t.type,t.name)}return o?(t.check&&o.setCheck(t.check),t.align&&(void 0===(i=i[t.align.toUpperCase()])?console.warn(e+"Illegal align value: ",t.align):o.setAlign(i)),o):null}isInputKeyword_(t){return"input_value"===t||"input_statement"===t||"input_dummy"===t||"input_end_row"===t||s(jr.INPUT,t)}stringToFieldJson_(t){return(t=t.trim())?{type:"field_label",text:t}:null}moveInputBefore(t,e){if(t!==e){var i=-1,o=e?-1:this.inputList.length;for(let n,s=0;n=this.inputList[s];s++)if(n.name===t){if(i=s,-1!==o)break}else if(e&&n.name===e&&(o=s,-1!==i))break;if(-1===i)throw Error('Named input "'+t+'" not found.');if(-1===o)throw Error('Reference input "'+e+'" not found.');this.moveNumberedInputBefore(i,o)}}moveNumberedInputBefore(t,e){if(t===e)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(e>this.inputList.length)throw RangeError("Reference input "+e+" out of bounds.");const i=this.inputList[t];this.inputList.splice(t,1),t<e&&e--,this.inputList.splice(e,0,i)}removeInput(t,e){for(let e,i=0;e=this.inputList[i];i++)if(e.name===t)return e instanceof Md&&this.statementInputCount--,e.dispose(),this.inputList.splice(i,1),!0;if(e)return!1;throw Error("Input not found: "+t)}getInput(t){for(let e,i=0;e=this.inputList[i];i++)if(e.name===t)return e;return null}getInputTargetBlock(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()}getCommentText(){let t,e;return null!=(e=null==(t=this.getIcon(lh.COMMENT))?void 0:t.getText())?e:null}setCommentText(t){var e;let i;const o=null!=(i=null==(e=this.getIcon(lh.COMMENT))?void 0:e.getText())?i:null;if(o!==t){if(null!==t){if(!(e=this.getIcon(lh.COMMENT))){if(!(e=r(jr.ICON,lh.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(e=new e(this),!Ts(e))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");e=this.addIcon(e)}Ur.disable$$module$build$src$core$events$utils(),e.setText(t),Ur.enable$$module$build$src$core$events$utils()}else this.removeIcon(lh.COMMENT);p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,o,t))}}setWarningText(t,e){}setMutator(t){}addIcon(t){if(this.hasIcon(t.getType()))throw new Zu(t);return this.icons.push(t),this.icons.sort(((t,e)=>t.getWeight()-e.getWeight())),t}removeIcon(t){if(!this.hasIcon(t))return!1;let e;return null==(e=this.getIcon(t))||e.dispose(),this.icons=this.icons.filter((e=>!e.getType().equals(t))),!0}hasIcon(t){return this.icons.some((e=>e.getType().equals(t)))}getIcon(t){return t instanceof lh?this.icons.find((e=>e.getType().equals(t))):this.icons.find((e=>e.getType().toString()===t))}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(t,e,i){if(this.parentBlock_)throw Error("Block has parent");const o=new(E(Ur.MOVE$$module$build$src$core$events$utils))(this);i&&o.setReason(i),this.xy_.translate(t,e),o.recordNew(),p(o)}makeConnection_(t){return new Dd(this,t)}allInputsFilled(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(let i,o=0;i=this.inputList[o];o++)if(i.connection){var e=i.connection.targetBlock();if(!e||!e.allInputsFilled(t))return!1}return!(e=this.getNextBlock())||e.allInputsFilled(t)}toDevString(){let t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t}};Nd.COLLAPSED_INPUT_NAME=nh,Nd.COLLAPSED_FIELD_NAME=sh;var Pd=class{constructor(t,e,i,o){this.workspace=t,this.targetWorkspace=e,this.isFlyoutLabel=o,this.onMouseUpWrapper=null,this.height=this.width=0,this.cursorSvg=this.svgText=this.svgGroup=null,this.text=i.text,this.position=new yl(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i}createDom(){var t=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton";let e;this.cssClass&&(t+=" "+this.cssClass),this.svgGroup=tt(Cl.G,{class:t},this.workspace.getCanvas()),this.isFlyoutLabel||(e=tt(Cl.RECT,{class:"blocklyFlyoutButtonShadow",rx:Pd.BORDER_RADIUS,ry:Pd.BORDER_RADIUS,x:1,y:1},this.svgGroup)),t=tt(Cl.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:Pd.BORDER_RADIUS,ry:Pd.BORDER_RADIUS},this.svgGroup);const i=tt(Cl.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var o=vo(this.text);this.workspace.RTL&&(o+="â"),i.textContent=o,this.isFlyoutLabel&&(this.svgText=i,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const n=vt(i,"fontSize"),s=vt(i,"fontWeight"),r=vt(i,"fontFamily");if(this.width=dt(i,n,s,r),o=pt(o,n,s,r),this.height=o.height,!this.isFlyoutLabel){let t,i;this.width+=2*Pd.TEXT_MARGIN_X,this.height+=2*Pd.TEXT_MARGIN_Y,null==(t=e)||t.setAttribute("width",String(this.width)),null==(i=e)||i.setAttribute("height",String(this.height))}return t.setAttribute("width",String(this.width)),t.setAttribute("height",String(this.height)),i.setAttribute("x",String(this.width/2)),i.setAttribute("y",String(this.height/2-o.height/2+o.baseline)),this.updateTransform(),this.onMouseUpWrapper=W(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(t,e){this.position.x=t,this.position.y=e,this.updateTransform()}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){this.onMouseUpWrapper&&j(this.onMouseUpWrapper),this.svgGroup&&st(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(t){t?this.svgGroup&&(this.svgGroup.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(){throw Error("Attempted to set a marker on a button.")}onMouseUp(t){(t=this.targetWorkspace.getGesture(t))&&t.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(t=this.targetWorkspace.getButtonCallback(this.callbackKey))&&t(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};Pd.TEXT_MARGIN_X=5,Pd.TEXT_MARGIN_Y=2,Pd.BORDER_RADIUS=4,Z("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var Bd=class{constructor(t,e,i){if(this.wsCoordinate=null,!e)throw Error("Cannot create a node without a location.");this.type=t,this.isConnectionLocation=Bd.isConnectionType(t),this.location=e,this.processParams(i||null)}processParams(t){t&&t.wsCoordinate&&(this.wsCoordinate=t.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var t=this.location.getParentInput();const e=t.getSourceBlock();for(t=e.inputList.indexOf(t),t+=1;t<e.inputList.length;t++){const i=e.inputList[t],o=i.fieldRow;for(let t=0;t<o.length;t++){const e=o[t];if(e.isClickable()||Bd.NAVIGATE_ALL_FIELDS)return Bd.createFieldNode(e)}if(i.connection)return Bd.createInputNode(i)}return null}findNextForField(){var t=this.location,e=t.getParentInput();const i=t.getSourceBlock();if(!i)throw Error("The current AST location is not associated with a block");var o=i.inputList.indexOf(e);for(t=e.fieldRow.indexOf(t)+1;o<i.inputList.length;o++){const n=(e=i.inputList[o]).fieldRow;for(;t<n.length;){if(n[t].isClickable()||Bd.NAVIGATE_ALL_FIELDS)return Bd.createFieldNode(n[t]);t++}if(t=0,e.connection)return Bd.createInputNode(e)}return null}findPrevForInput(){const t=this.location.getParentInput(),e=t.getSourceBlock();for(var i=e.inputList.indexOf(t);0<=i;i--){var o=e.inputList[i];if(o.connection&&o!==t)return Bd.createInputNode(o);for(let t=(o=o.fieldRow).length-1;0<=t;t--){const e=o[t];if(e.isClickable()||Bd.NAVIGATE_ALL_FIELDS)return Bd.createFieldNode(e)}}return null}findPrevForField(){var t=this.location;const e=t.getParentInput(),i=t.getSourceBlock();if(!i)throw Error("The current AST location is not associated with a block");var o=i.inputList.indexOf(e);for(t=e.fieldRow.indexOf(t)-1;0<=o;o--){var n=i.inputList[o];if(n.connection&&n!==e)return Bd.createInputNode(n);for(n=n.fieldRow;-1<t;){if(n[t].isClickable()||Bd.NAVIGATE_ALL_FIELDS)return Bd.createFieldNode(n[t]);t--}0<=o-1&&(t=i.inputList[o-1].fieldRow.length-1)}return null}navigateBetweenStacks(t){var e=this.getLocation();if(e.getSourceBlock){var i=e.getSourceBlock();i&&(e=i)}if(!e||e.isDeadOrDying())return null;if(e.workspace.isFlyout)return this.navigateFlyoutContents(t);i=e.getRootBlock(),e=i.workspace.getTopBlocks(!0);for(let o=0;o<e.length;o++)if(i.id===e[o].id)return-1===(t=o+(t?1:-1))||t===e.length?null:Bd.createStackNode(e[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")}navigateFlyoutContents(t){let e;switch(this.getType()){case Bd.types.STACK:e=this.getLocation();var i=e.workspace.targetWorkspace;break;case Bd.types.BUTTON:e=this.getLocation(),i=e.getTargetWorkspace();break;default:return null}return(i=i.getFlyout())&&(t=this.findNextLocationInFlyout(i.getContents(),e,t))?"button"===t.type&&t.button?Bd.createButtonNode(t.button):"block"===t.type&&t.block?Bd.createStackNode(t.block):null:null}findNextLocationInFlyout(t,e,i){const o=t.findIndex((t=>e instanceof Nd&&t.block===e||e instanceof Pd&&t.button===e));return 0>o||-1===(i=i?o+1:o-1)||i===t.length?null:t[i]}findTopASTNodeForBlock(t){const e=Es(t);return e?Bd.createConnectionNode(e):Bd.createBlockNode(t)}getOutAstNodeForBlock(t){if(!t)return null;t=t.getTopStackBlock();const e=Es(t);return e&&e.targetConnection&&e.targetConnection.getParentInput()?Bd.createInputNode(e.targetConnection.getParentInput()):Bd.createStackNode(t)}findFirstFieldOrInput(t){t=t.inputList;for(let e=0;e<t.length;e++){const i=t[e],o=i.fieldRow;for(let t=0;t<o.length;t++){const e=o[t];if(e.isClickable()||Bd.NAVIGATE_ALL_FIELDS)return Bd.createFieldNode(e)}if(i.connection)return Bd.createInputNode(i)}return null}getSourceBlock(){return this.getType()===Bd.types.BLOCK||this.getType()===Bd.types.STACK?this.getLocation():this.getType()===Bd.types.WORKSPACE||this.getType()===Bd.types.BUTTON?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case Bd.types.STACK:return this.navigateBetweenStacks(!0);case Bd.types.OUTPUT:return Bd.createBlockNode(this.location.getSourceBlock());case Bd.types.FIELD:return this.findNextForField();case Bd.types.INPUT:return this.findNextForInput();case Bd.types.BLOCK:const t=this.location.nextConnection;if(!t)break;return Bd.createConnectionNode(t);case Bd.types.PREVIOUS:return Bd.createBlockNode(this.location.getSourceBlock());case Bd.types.NEXT:return Bd.createConnectionNode(this.location.targetConnection);case Bd.types.BUTTON:return this.navigateFlyoutContents(!0)}return null}in(){switch(this.type){case Bd.types.WORKSPACE:const t=this.location.getTopBlocks(!0);if(0<t.length)return Bd.createStackNode(t[0]);break;case Bd.types.STACK:return this.findTopASTNodeForBlock(this.location);case Bd.types.BLOCK:return this.findFirstFieldOrInput(this.location);case Bd.types.INPUT:return Bd.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case Bd.types.STACK:return this.navigateBetweenStacks(!1);case Bd.types.FIELD:return this.findPrevForField();case Bd.types.INPUT:return this.findPrevForInput();case Bd.types.BLOCK:var t=Es(this.location);if(!t)break;return Bd.createConnectionNode(t);case Bd.types.PREVIOUS:if((t=this.location.targetConnection)&&!t.getParentInput())return Bd.createConnectionNode(t);break;case Bd.types.NEXT:return Bd.createBlockNode(this.location.getSourceBlock());case Bd.types.BUTTON:return this.navigateFlyoutContents(!1)}return null}out(){switch(this.type){case Bd.types.STACK:var t=this.location,e=t.getRelativeToSurfaceXY();return e=new yl(e.x,e.y+Bd.DEFAULT_OFFSET_Y),Bd.createWorkspaceNode(t.workspace,e);case Bd.types.OUTPUT:return(e=(t=this.location).targetConnection)?Bd.createConnectionNode(e):Bd.createStackNode(t.getSourceBlock());case Bd.types.FIELD:if(!(t=this.location.getSourceBlock()))throw Error("The current AST location is not associated with a block");return Bd.createBlockNode(t);case Bd.types.INPUT:return Bd.createBlockNode(this.location.getSourceBlock());case Bd.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case Bd.types.PREVIOUS:case Bd.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(t){switch(t){case Bd.types.PREVIOUS:case Bd.types.NEXT:case Bd.types.INPUT:case Bd.types.OUTPUT:return!0}return!1}static createFieldNode(t){return t?new Bd(Bd.types.FIELD,t):null}static createConnectionNode(t){if(!t)return null;const e=t.type;return e===mu.INPUT_VALUE||e===mu.NEXT_STATEMENT&&t.getParentInput()?Bd.createInputNode(t.getParentInput()):e===mu.NEXT_STATEMENT?new Bd(Bd.types.NEXT,t):e===mu.OUTPUT_VALUE?new Bd(Bd.types.OUTPUT,t):e===mu.PREVIOUS_STATEMENT?new Bd(Bd.types.PREVIOUS,t):null}static createInputNode(t){return t&&t.connection?new Bd(Bd.types.INPUT,t.connection):null}static createBlockNode(t){return t?new Bd(Bd.types.BLOCK,t):null}static createStackNode(t){return t?new Bd(Bd.types.STACK,t):null}static createButtonNode(t){return t?new Bd(Bd.types.BUTTON,t):null}static createWorkspaceNode(t,e){return e&&t?new Bd(Bd.types.WORKSPACE,t,{wsCoordinate:e}):null}static createTopNode(t){const e=Es(t);return e?Bd.createConnectionNode(e):Bd.createBlockNode(t)}};Bd.NAVIGATE_ALL_FIELDS=!1,Bd.DEFAULT_OFFSET_Y=-20,function(t){(t=t.types||(t.types={})).FIELD="field",t.BLOCK="block",t.INPUT="input",t.OUTPUT="output",t.NEXT="next",t.PREVIOUS="previous",t.STACK="stack",t.WORKSPACE="workspace",t.BUTTON="button"}(Bd||(Bd={}));var Fd=class extends Pa{constructor(t,e,i,o){let n=t?t.workspace.id:void 0;o&&o.getType()===Bd.types.WORKSPACE&&(n=o.getLocation().id),super(n),this.type=sa,this.blockId=null==t?void 0:t.id,this.oldNode=i||void 0,this.newNode=o,this.isCursor=e}toJson(){const t=super.toJson();if(void 0===this.isCursor)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Fd)).isCursor=t.isCursor,e.blockId=t.blockId,e.oldNode=t.oldNode,e.newNode=t.newNode,e}};t(jr.EVENT,sa,Fd);var Hd=class{constructor(t,e,i){this.workspace=t,this.marker=i,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=e,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=i.colour||t}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return"cursor"===this.marker.type}createDom(){const t=this.isCursor()?"blocklyCursor":"blocklyMarker";return this.svgGroup_=tt(Cl.G,{class:t}),this.createDomInternal_(),this.svgGroup_}setParent_(t){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent=t}draw(t,e){if(e){this.constants_=this.workspace.getRenderer().getConstants();var i=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||i,this.applyColour_(e),this.showAtLocation_(e),this.fireMarkerEvent(t,e),void 0!==(t=this.currentMarkerSvg.childNodes[0])&&t.beginElement&&t.beginElement()}else this.hide()}showAtLocation_(t){const e=t.getLocation().type;t.getType()===Bd.types.BLOCK?this.showWithBlock_(t):t.getType()===Bd.types.OUTPUT?this.showWithOutput_(t):e===mu.INPUT_VALUE?this.showWithInput_(t):e===mu.NEXT_STATEMENT?this.showWithNext_(t):t.getType()===Bd.types.PREVIOUS?this.showWithPrevious_(t):t.getType()===Bd.types.FIELD?this.showWithField_(t):t.getType()===Bd.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()===Bd.types.STACK?this.showWithStack_(t):t.getType()===Bd.types.BUTTON&&this.showWithButton_(t)}showWithBlockPrevOutput(t){const e=(t=t.getSourceBlock()).width;var i=t.height,o=.75*i;const n=this.constants_.CURSOR_BLOCK_PADDING;t.previousConnection?(i=this.constants_.shapeFor(t.previousConnection),this.positionPrevious_(e,n,o,i)):t.outputConnection?(o=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(e,i,o)):this.positionBlock_(e,n,o),this.setParent_(t),this.showCurrent_()}showWithBlock_(t){this.showWithBlockPrevOutput(t)}showWithPrevious_(t){this.showWithBlockPrevOutput(t)}showWithOutput_(t){this.showWithBlockPrevOutput(t)}showWithCoordinates_(t){var e=t.getWsCoordinate();t=e.x,e=e.y,this.workspace.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,e,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(t){const e=(t=t.getLocation()).getSize().width,i=t.getSize().height;this.positionRect_(0,0,e,i),this.setParent_(t),this.showCurrent_()}showWithInput_(t){const e=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(e),this.showCurrent_()}showWithNext_(t){var e=t.getLocation();t=e.getSourceBlock();let i=0;e=e.getOffsetInBlock().y;const o=t.getHeightWidth().width;this.workspace.RTL&&(i=-o),this.positionLine_(i,e,o),this.setParent_(t),this.showCurrent_()}showWithStack_(t){var e=(t=t.getLocation()).getHeightWidth();const i=e.width+this.constants_.CURSOR_STACK_PADDING;e=e.height+this.constants_.CURSOR_STACK_PADDING;const o=-this.constants_.CURSOR_STACK_PADDING/2,n=-this.constants_.CURSOR_STACK_PADDING/2;let s=o;this.workspace.RTL&&(s=-(i+o)),this.positionRect_(s,n,i,e),this.setParent_(t),this.showCurrent_()}showWithButton_(t){const e=(t=t.getLocation()).width+this.constants_.CURSOR_STACK_PADDING,i=t.height+this.constants_.CURSOR_STACK_PADDING,o=-this.constants_.CURSOR_STACK_PADDING/2,n=-this.constants_.CURSOR_STACK_PADDING/2;let s=o;this.workspace.RTL&&(s=-(e+o)),this.positionRect_(s,n,e,i),this.setParent_(t),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(t,e,i){if(t=qn(-e,i)+ts("V",-e)+ts("H",t+2*e)+ts("V",i),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(t){const e=t.getOffsetInBlock().x,i=t.getOffsetInBlock().y;t=Jn(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+e+","+i+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(t,e,i){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${t}`),this.markerSvgLine_.setAttribute("y",`${e}`),this.markerSvgLine_.setAttribute("width",`${i}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(t,e,i){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");t=qn(t,0)+ts("h",-(t-i.width))+ts("v",this.constants_.TAB_OFFSET_FROM_TOP)+i.pathDown+ts("V",e)+ts("H",t),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(t,e,i,o){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");t=qn(-e,i)+ts("V",-e)+ts("H",this.constants_.NOTCH_OFFSET_LEFT)+o.pathLeft+ts("H",t+2*e)+ts("V",i),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(t,e,i,o){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${t}`),this.markerSvgRect_.setAttribute("y",`${e}`),this.markerSvgRect_.setAttribute("width",`${i}`),this.markerSvgRect_.setAttribute("height",`${o}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(t){t.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(t,e){const i=e.getSourceBlock();t=new(E(sa))(i,this.isCursor(),t,e),p(t)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=tt(Cl.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=tt(Cl.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=tt(Cl.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=tt(Cl.PATH,{transform:""},this.markerSvg_),this.markerBlock_=tt(Cl.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();tt(Cl.ANIMATE,t,this.markerSvgLine_),tt(Cl.ANIMATE,t,this.markerInput_),tt(Cl.ANIMATE,Object.assign({},t,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(t){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",t),this.markerInput_.firstElementChild.setAttribute("values",t),this.markerBlock_.firstElementChild.setAttribute("values",t))}dispose(){this.svgGroup_&&st(this.svgGroup_)}},Ud=class{constructor(t,e,i){this.markerSvg=this.cursorSvg=null,this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=e,this.svgRoot=t,this.svgPath=tt(Cl.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null}applyColour(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())}setStyle(t){this.style=t}setClass_(t,e){t&&(e?et(this.svgRoot,t):ot(this.svgRoot,t))}updateHighlighted(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(t){this.setClass_("blocklySelected",t)}updateDraggingDelete(t){this.setClass_("blocklyDraggingDelete",t)}updateInsertionMarker(t){this.setClass_("blocklyInsertionMarker",t)}updateMovable(t){this.setClass_("blocklyDraggable",t)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t)}updateShapeForInputHighlight(t,e){}addConnectionHighlight(t,e,i,o){if(this.connectionHighlights.has(t)){if(this.currentHighlightMatchesNew(t,e,i))return;this.removeConnectionHighlight(t)}e=tt(Cl.PATH,{class:"blocklyHighlightedConnectionPath",d:e,transform:`translate(${i.x}, ${i.y})`+(o?" scale(-1 1)":"")},this.svgRoot),this.connectionHighlights.set(t,e)}currentHighlightMatchesNew(t,e,i){let o;const n=null==(o=this.connectionHighlights.get(t))?void 0:o.getAttribute("d");return t=this.highlightOffsets.get(t),n===e&&yl.equals(t,i)}removeConnectionHighlight(t){const e=this.connectionHighlights.get(t);e&&(st(e),this.connectionHighlights.delete(t))}},Gd=class{constructor(t){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,Ur.setSelected$$module$build$src$core$common(t),this.topBlock=t,this.workspace=t.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Ur.disable$$module$build$src$core$events$utils(),this.hidePreview(),Ur.enable$$module$build$src$core$events$utils();var{local:t,closest:e}=this.activeCandidate;t.connect(e);var i=t.isSuperior()?e:t,o=this.topBlock.getRootBlock();ve().then((()=>{_n(i.getSourceBlock()),setTimeout((()=>{o.bringToFront()}),0)}))}}update(t,e){const i=this.getCandidate(t);((this.wouldDeleteBlock=this.shouldDelete(!!i,e))||this.shouldUpdatePreviews(i,t))&&(Ur.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(i),this.maybeShowPreview(i),Ur.enable$$module$build$src$core$events$utils())}createMarkerBlock(t){let e;Ur.disable$$module$build$src$core$events$utils();try{const i=Ne(t,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!i)throw Error(`Failed to serialize source block. ${t.toDevString()}`);e=ze(i,this.workspace);for(const t of e.getDescendants(!1))t.setInsertionMarker(!0);e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden")}finally{Ur.enable$$module$build$src$core$events$utils()}return e}initAvailableConnections(){const t=this.topBlock.getConnections_(!1),e=this.topBlock.lastConnectionInStack(!0);return e&&e!==this.topBlock.nextConnection&&(t.push(e),this.lastOnStack=e),t}shouldUpdatePreviews(t,e){if(!t)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:i,closest:o}=this.activeCandidate;if(o===t.closest&&i===t.local)return!1;const n=i.x+e.x-o.x;return e=i.y+e.y-o.y,t.radius<Math.sqrt(n*n+e*e)-Ur.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(t){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let e=this.getStartRadius(),i=null;for(let o=0;o<this.availableConnections.length;o++){const n=this.availableConnections[o],s=n.closest(e,t);s.connection&&(i={closest:s.connection,local:n,radius:s.radius},e=s.radius)}return i}getStartRadius(){return this.activeCandidate?Ur.config$$module$build$src$core$config.connectingSnapRadius:Ur.config$$module$build$src$core$config.snapRadius}shouldDelete(t,e){return!(!e||!this.workspace.getComponentManager().hasCapability(e.id,fl.Capability.DELETE_AREA))&&e.wouldDelete(this.topBlock)}maybeShowPreview(t){if(!this.wouldDeleteBlock&&t){var e,i=t.closest;i===(null==(e=this.activeCandidate)?void 0:e.closest)||i.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=t,this.showPreview(this.activeCandidate))}}showPreview(t){const e=this.workspace.getRenderer();switch(e.getConnectionPreviewMethod(t.closest,t.local,this.topBlock)){case Gd.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(t);break;case Gd.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(t);break;case Gd.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(t)}e.shouldHighlightConnection(t.closest)&&t.closest.highlight()}maybeHidePreview(t){if(t){if(this.activeCandidate){const e=this.activeCandidate.local!==t.local;(this.activeCandidate.closest!==t.closest||e||this.wouldDeleteBlock)&&this.hidePreview()}}else this.hidePreview();this.activeCandidate=this.markerConnection=null}hidePreview(){let t;const e=null==(t=this.activeCandidate)?void 0:t.closest;e&&e.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(e)&&e.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(t){const{local:e,closest:i}=t;let o,n=(t=this.lastOnStack&&e===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!n)throw Error("Cannot show the insertion marker because there is no insertion marker block");try{o=n.getMatchingConnection(e.getSourceBlock(),e)}catch(i){if(t&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),n=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),n=this.firstMarker=this.createMarkerBlock(this.topBlock)),!n)throw Error("Cannot show the insertion marker because there is no insertion marker block");o=n.getMatchingConnection(e.getSourceBlock(),e)}if(!o)throw Error("Cannot show the insertion marker because there is no associated connection");if(o===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");n.queueRender(),be(),o.connect(i);const s={x:i.x-o.x,y:i.y-o.y},r=o.getOffsetInBlock().clone(),a=o;ve().then((()=>{let t,e;null==(t=n)||t.positionNearConnection(a,s,r),null==(e=n)||e.getSvgRoot().setAttribute("visibility","visible")})),this.markerConnection=o}hideInsertionMarker(){if(this.markerConnection){var t,e=this.markerConnection,i=e.getSourceBlock(),o=i.outputConnection;if(null!=(t=i.previousConnection)&&t.targetConnection||null!=o&&o.targetConnection)i.unplug(!0);else{let t;null==(t=e.targetBlock())||t.unplug(!1)}if(e.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(e=i.getSvgRoot())&&e.setAttribute("visibility","hidden")}}showInsertionInputOutline(t){t=t.closest,this.highlightedBlock=t.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(t,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(t){if(this.fadedBlock=t.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const t=[];return this.firstMarker&&t.push(this.firstMarker),this.lastMarker&&t.push(this.lastMarker),t}disposeInsertionMarker(t){if(t){Ur.disable$$module$build$src$core$events$utils();try{t.dispose()}finally{Ur.enable$$module$build$src$core$events$utils()}}}};!function(t){(t=t.PREVIEW_TYPE||(t.PREVIEW_TYPE={}))[t.INSERTION_MARKER=0]="INSERTION_MARKER",t[t.INPUT_OUTLINE=1]="INPUT_OUTLINE",t[t.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"}(Gd||(Gd={}));var Vd=Gd.PREVIEW_TYPE,Wd={};Wd.InsertionMarkerManager=Gd,Wd.PreviewType=Vd;var zd=class{constructor(t){this.overrides=null,this.name=t}getClassName(){return this.name+"-renderer"}init(t,e){this.constants_=this.makeConstants_(),e&&(this.overrides=e,Object.assign(this.constants_,e)),this.constants_.setTheme(t),this.constants_.init()}createDom(t,e){this.constants_.createDom(t,this.name+"-"+e.name,"."+this.getClassName()+"."+e.getClassName())}refreshDom(t,e){const i=this.getConstants();i.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=i.randomIdentifier,this.constants_.setTheme(e),this.constants_.init(),this.createDom(t,e)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new Id}makeRenderInfo_(t){return new xd(this,t)}makeDrawer_(t,e){return new Sd(t,e)}makeMarkerDrawer(t,e){return new Hd(t,this.getConstants(),e)}makePathObject(t,e){return new Ud(t,e,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(t){return!0}orphanCanConnectAtEnd(t,e,i){return!!Dd.getConnectionForOrphanedConnection(t,i===mu.OUTPUT_VALUE?e.outputConnection:e.previousConnection)}getConnectionPreviewMethod(t,e,i){return Xn("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),e.type===mu.OUTPUT_VALUE||e.type===mu.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(i,t.targetBlock(),e.type)?Gd.PREVIEW_TYPE.INSERTION_MARKER:Gd.PREVIEW_TYPE.REPLACEMENT_FADE:Gd.PREVIEW_TYPE.INSERTION_MARKER}render(t){const e=this.makeRenderInfo_(t);e.measure(),this.makeDrawer_(t,e).draw()}},jd={};jd.BottomRow=rd,jd.Connection=ad,jd.ConstantProvider=Id,jd.Drawer=Sd,jd.ExternalValueInput=hd,jd.Field=cd,jd.Hat=ud,jd.Icon=dd,jd.InRowSpacer=pd,jd.InlineInput=gd,jd.InputConnection=ld,jd.InputRow=md,jd.JaggedEdge=vd,jd.MarkerSvg=Hd,jd.Measurable=nd,jd.NextConnection=bd,jd.OutputConnection=_d,jd.PathObject=Ud,jd.PreviousConnection=yd,jd.RenderInfo=xd,jd.Renderer=zd,jd.RoundCorner=Td,jd.Row=sd,jd.SpacerRow=Ed,jd.SquareCorner=wd,jd.StatementInput=fd,jd.TopRow=kd,jd.Types=od,jd.init=Is,jd.register=ws,jd.unregister=ks;var Xd=class{constructor(t,e){this.workspace=t,this.theme=e,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(t){var e=this.theme;this.theme=t,(t=this.workspace.getInjectionDiv())&&(e&&(e=e.getClassName())&&ot(t,e),(e=this.theme.getClassName())&&et(t,e));for(let t,e=0;t=this.subscribedWorkspaces_[e];e++)t.refreshTheme();for(const[i,o]of this.componentDB)for(const n of o){t=n.element,e=n.propertyName;const o=this.theme&&this.theme.getComponentStyle(i);t.style.setProperty(e,o||"")}for(const t of this.subscribedWorkspaces_)t.hideChaff()}subscribeWorkspace(t){this.subscribedWorkspaces_.push(t)}unsubscribeWorkspace(t){if(!q(this.subscribedWorkspaces_,t))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(t,e,i){this.componentDB.has(e)||this.componentDB.set(e,[]),this.componentDB.get(e).push({element:t,propertyName:i}),e=this.theme&&this.theme.getComponentStyle(e),t.style.setProperty(i,e||"")}unsubscribe(t){if(t)for(const[e,i]of this.componentDB){for(let e=i.length-1;0<=e;e--)i[e].element===t&&i.splice(e,1);i.length||this.componentDB.delete(e)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},Yd="VARIABLE_DYNAMIC",Kd={CATEGORY_NAME:Yd};Kd.flyoutCategory=Os,Kd.flyoutCategoryBlocks=Rs,Kd.onCreateVariableButtonClick_Colour=Cs,Kd.onCreateVariableButtonClick_Number=Ss,Kd.onCreateVariableButtonClick_String=$s;var Jd=[];Jd[mu.INPUT_VALUE]=mu.OUTPUT_VALUE,Jd[mu.OUTPUT_VALUE]=mu.INPUT_VALUE,Jd[mu.NEXT_STATEMENT]=mu.PREVIOUS_STATEMENT,Jd[mu.PREVIOUS_STATEMENT]=mu.NEXT_STATEMENT;var qd="RENAME_VARIABLE_ID",Zd="DELETE_VARIABLE_ID",Qd=class{canConnect(t,e,i,o){return this.canConnectWithReason(t,e,i,o)===Dd.CAN_CONNECT}canConnectWithReason(t,e,i,o){const n=this.doSafetyChecks(t,e);return n!==Dd.CAN_CONNECT?n:this.doTypeChecks(t,e)?i&&!this.doDragChecks(t,e,o||0)?Dd.REASON_DRAG_CHECKS_FAILED:Dd.CAN_CONNECT:Dd.REASON_CHECKS_FAILED}getErrorMessage(t,e,i){switch(t){case Dd.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Dd.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Dd.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Dd.REASON_TARGET_NULL:return"Target connection is null.";case Dd.REASON_CHECKS_FAILED:return"Connection checks failed. "+e+" expected "+e.getCheck()+", found "+i.getCheck();case Dd.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Dd.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Dd.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(t,e){if(!t||!e)return Dd.REASON_TARGET_NULL;let i,o,n;return t.isSuperior()?(i=t.getSourceBlock(),o=e.getSourceBlock(),n=e):(o=t.getSourceBlock(),i=e.getSourceBlock(),n=t,t=e),i===o?Dd.REASON_SELF_CONNECTION:n.type!==Jd[t.type]?Dd.REASON_WRONG_TYPE:i.workspace!==o.workspace?Dd.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!o.isShadow()?Dd.REASON_SHADOW_PARENT:n.type===mu.OUTPUT_VALUE&&o.previousConnection&&o.previousConnection.isConnected()||n.type===mu.PREVIOUS_STATEMENT&&o.outputConnection&&o.outputConnection.isConnected()?Dd.REASON_PREVIOUS_AND_OUTPUT:Dd.CAN_CONNECT}doTypeChecks(t,e){if(t=t.getCheck(),e=e.getCheck(),!t||!e)return!0;for(let i=0;i<t.length;i++)if(e.includes(t[i]))return!0;return!1}doDragChecks(t,e,i){if(t.distanceFrom(e)>i||e.getSourceBlock().isInsertionMarker())return!1;switch(e.type){case mu.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,e);case mu.OUTPUT_VALUE:if(e.isConnected()&&!e.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case mu.INPUT_VALUE:if(e.isConnected()&&!e.targetBlock().isMovable()&&!e.targetBlock().isShadow())return!1;break;case mu.NEXT_STATEMENT:if(e.isConnected()&&!t.getSourceBlock().nextConnection&&!e.targetBlock().isShadow()&&e.targetBlock().nextConnection||e.targetBlock()&&!e.targetBlock().isMovable()&&!e.targetBlock().isShadow())return!1;break;default:return!1}return!Aa.includes(e)}canConnectToPrevious_(t,e){return!(t.targetConnection||Aa.includes(e)||e.targetConnection&&(!(t=e.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))}};t(jr.CONNECTION_CHECKER,zr,Qd);var tp=class extends vh{constructor(t){super(t),this.type=Qr,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new tp)).varType=t.varType,e.varName=t.varName,e}run(t){const e=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?e.deleteVariableById(this.varId):e.createVariable(this.varName,this.varType,this.varId)}};t(jr.EVENT,Qr,tp);var ep=class extends vh{constructor(t,e){super(t),this.type=ta,t&&(this.oldName=t.name,this.newName=void 0===e?"":e)}toJson(){const t=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return t.oldName=this.oldName,t.newName=this.newName,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new ep)).oldName=t.oldName,e.newName=t.newName,e}run(t){const e=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");t?e.renameVariableById(this.varId,this.newName):e.renameVariableById(this.varId,this.oldName)}};t(jr.EVENT,ta,ep);var ip=class{constructor(t){this.workspace=t,this.variableMap=new Map}clear(){for(const t of this.variableMap.values())for(;0<t.length;)this.deleteVariable(t[0]);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(t,e){if(t.name!==e){var i=this.getVariable(e,t.type),o=this.workspace.getAllBlocks(!1),n=Ur.getGroup$$module$build$src$core$events$utils();n||Ur.setGroup$$module$build$src$core$events$utils(!0);try{i&&i.getId()!==t.getId()?this.renameVariableWithConflict_(t,e,i,o):this.renameVariableAndUses_(t,e,o)}finally{Ur.setGroup$$module$build$src$core$events$utils(n)}}}renameVariableById(t,e){const i=this.getVariableById(t);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(i,e)}renameVariableAndUses_(t,e,i){for(p(new(E(ta))(t,e)),t.name=e,e=0;e<i.length;e++)i[e].updateVarName(t)}renameVariableWithConflict_(t,e,i,o){const n=t.type;for(e!==i.name&&this.renameVariableAndUses_(i,e,o),e=0;e<o.length;e++)o[e].renameVarById(t.getId(),i.getId());p(new(E(Qr))(t)),q(this.variableMap.get(n),t)}createVariable(t,e,i){var o=this.getVariable(t,e);if(o){if(i&&o.getId()!==i)throw Error('Variable "'+t+'" is already in use and its id is "'+o.getId()+'" which conflicts with the passed in id, "'+i+'".');return o}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');return o=i||u(),e=e||"",o=new _h(this.workspace,t,e,o),(t=this.variableMap.get(e)||[]).push(o),this.variableMap.delete(e),this.variableMap.set(e,t),p(new(E(Zr))(o)),o}deleteVariable(t){const e=t.getId(),i=this.variableMap.get(t.type);if(i)for(let o=0;o<i.length;o++)if(i[o].getId()===e){i.splice(o,1),p(new(E(Qr))(t)),0===i.length&&this.variableMap.delete(t.type);break}}deleteVariableById(t){const e=this.getVariableById(t);if(e){var i=e.name;const o=this.getVariableUsesById(t);for(let e,n=0;e=o[n];n++)if("procedures_defnoreturn"===e.type||"procedures_defreturn"===e.type)return t=String(e.getFieldValue("NAME")),i=Ur.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",i).replace("%2",t),void zt(i);1<o.length?(i=Ur.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(o.length)).replace("%2",i),Xt(i,(t=>{t&&e&&this.deleteVariableInternal(e,o)}))):this.deleteVariableInternal(e,o)}else console.warn("Can't delete non-existent variable: "+t)}deleteVariableInternal(t,e){const i=Ur.getGroup$$module$build$src$core$events$utils();i||Ur.setGroup$$module$build$src$core$events$utils(!0);try{for(let t=0;t<e.length;t++)e[t].dispose(!0);this.deleteVariable(t)}finally{Ur.setGroup$$module$build$src$core$events$utils(i)}}getVariable(t,e){if(e=this.variableMap.get(e||""))for(let i,o=0;i=e[o];o++)if(Ur.Names$$module$build$src$core$names.equals(i.name,t))return i;return null}getVariableById(t){for(const e of this.variableMap.values())for(const i of e)if(i.getId()===t)return i;return null}getVariablesOfType(t){return(t=this.variableMap.get(t||""))?t.slice():[]}getVariableTypes(t){const e=new Set(this.variableMap.keys());if(t&&t.getPotentialVariableMap())for(const i of t.getPotentialVariableMap().variableMap.keys())e.add(i);return e.has("")||e.add(""),Array.from(e.values())}getAllVariables(){let t=[];for(const e of this.variableMap.values())t=t.concat(e);return t}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map((t=>t.name))}getVariableUsesById(t){const e=[],i=this.workspace.getAllBlocks(!1);for(let o=0;o<i.length;o++){const n=i[o].getVarModels();if(n)for(let s=0;s<n.length;s++)n[s].getId()===t&&e.push(i[o])}return e}},op=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(t){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Ou,this.potentialVariableMap=null,this.id=u(),$(this),this.options=t||new Cu({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(h(jr.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new ip(this)}dispose(){this.listeners.length=0,this.clear(),S(this)}sortObjects_(t,e){const i=Math.sin(ri(op.SCAN_ANGLE))*(this.RTL?-1:1);return t=t.getRelativeToSurfaceXY(),e=e.getRelativeToSurfaceXY(),t.y+i*t.x-(e.y+i*e.x)}addTopBlock(t){this.topBlocks.push(t)}removeTopBlock(t){if(!q(this.topBlocks,t))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(t=!1){const e=[].concat(this.topBlocks);return t&&1<e.length&&e.sort(this.sortObjects_.bind(this)),e}addTypedBlock(t){this.typedBlocksDB.has(t.type)||this.typedBlocksDB.set(t.type,[]),this.typedBlocksDB.get(t.type).push(t)}removeTypedBlock(t){q(this.typedBlocksDB.get(t.type),t),this.typedBlocksDB.get(t.type).length||this.typedBlocksDB.delete(t.type)}getBlocksByType(t,e=!1){return this.typedBlocksDB.has(t)?(t=this.typedBlocksDB.get(t).slice(0),e&&t&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t.filter((function(t){return!t.isInsertionMarker()}))):[]}addTopComment(t){this.topComments.push(t),this.commentDB.has(t.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB.set(t.id,t)}removeTopComment(t){if(!q(this.topComments,t))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(t.id)}getTopComments(t=!1){const e=[].concat(this.topComments);return t&&1<e.length&&e.sort(this.sortObjects_.bind(this)),e}getAllBlocks(t=!1){if(t){var e=this.getTopBlocks(!0);t=[];for(let i=0;i<e.length;i++)t.push(...e[i].getDescendants(!0))}else for(t=this.getTopBlocks(!1),e=0;e<t.length;e++)t.push(...t[e].getChildren(!1));return t.filter((function(t){return!t.isInsertionMarker()}))}clear(){this.isClearing=!0;try{const t=Ur.getGroup$$module$build$src$core$events$utils();for(t||Ur.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();Ur.setGroup$$module$build$src$core$events$utils(t),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(t,e){this.variableMap.renameVariableById(t,e)}createVariable(t,e,i){return this.variableMap.createVariable(t,e,i)}getVariableUsesById(t){return this.variableMap.getVariableUsesById(t)}deleteVariableById(t){this.variableMap.deleteVariableById(t)}getVariable(t,e){return this.variableMap.getVariable(t,e)}getVariableById(t){return this.variableMap.getVariableById(t)}getVariablesOfType(t){return this.variableMap.getVariablesOfType(t)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(t,e){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(t){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(t){return this.options.maxInstances?(void 0!==this.options.maxInstances[t]?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0}isCapacityAvailable(t){if(!this.hasBlockLimits())return!0;let e=0;for(const i in t){if(t[i]>this.remainingCapacityOfType(i))return!1;e+=t[i]}return!(e>this.remainingCapacity())}hasBlockLimits(){return 1/0!==this.options.maxBlocks||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(t){var e=t?this.redoStack_:this.undoStack_,i=t?this.undoStack_:this.redoStack_;const o=e.pop();if(o){for(var n=[o];e.length&&o.group&&o.group===e[e.length-1].group;){const t=e.pop();t&&n.push(t)}for(e=0;e<n.length;e++)i.push(n[e]);n=m(n,t),Ur.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<n.length;i++)n[i].run(t)}finally{Ur.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,v()}addChangeListener(t){return this.listeners.push(t),t}removeChangeListener(t){q(this.listeners,t)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let e=0;e<this.listeners.length;e++)(0,this.listeners[e])(t)}getBlockById(t){return this.blockDB.get(t)||null}setBlockById(t,e){this.blockDB.set(t,e)}removeBlockById(t){this.blockDB.delete(t)}getCommentById(t){let e;return null!=(e=this.commentDB.get(t))?e:null}allInputsFilled(t){const e=this.getTopBlocks(!1);for(let i=0;i<e.length;i++)if(!e[i].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new ip(this)}getVariableMap(){return this.variableMap}setVariableMap(t){this.variableMap=t}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let t=null;const e=this.options.parentWorkspace;return this.isFlyout?e&&e.options&&(t=e.options.parentWorkspace):e&&(t=e),t}static getById(t){return k(t)}static getAll(){return I()}};op.SCAN_ANGLE=3;var np=class{constructor(t){this.parentWorkspace=t,this.sounds=new Map,this.lastSound_=null,this.muted=!1}dispose(){this.sounds.clear()}load(t,e){if(t.length){try{var i=new globalThis.Audio}catch(t){return}for(let e=0;e<t.length;e++){const n=t[e],s=n.match(/\.(\w+)$/);if(s&&i.canPlayType("audio/"+s[1])){var o=new globalThis.Audio(n);break}}o&&this.sounds.set(e,o)}}preload(){for(const t of this.sounds.values()){t.volume=.01;const e=t.play();if(void 0!==e?e.then(t.pause).catch((function(){})):t.pause(),sl||rl)break}}play(t,e){if(!this.muted){var i=this.sounds.get(t);i?(t=new Date,null!==this.lastSound_&&t.getTime()-this.lastSound_.getTime()<100||(this.lastSound_=t,(i=sl||nl?i:i.cloneNode()).volume=void 0===e?1:e,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(t,e)}}setMuted(t){this.muted=t}getMuted(){return this.muted}},sp=class{constructor(t){this.workspace=t,this.layers=new Map,(t=t.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(t),this.animationLayer=this.createAnimationLayer(t)),t=this.createLayer(Mh),et(t,"blocklyBlockCanvas"),t=this.createLayer(100),et(t,"blocklyBubbleCanvas")}createDragLayer(t){const e=tt(Cl.SVG,{class:"blocklyBlockDragSurface",xmlns:Tl,"xmlns:html":El,"xmlns:xlink":wl,version:"1.1"});return t.append(e),tt(Cl.G,{},e)}createAnimationLayer(t){const e=tt(Cl.SVG,{class:"blocklyAnimationLayer",xmlns:Tl,"xmlns:html":El,"xmlns:xlink":wl,version:"1.1"});return t.append(e),tt(Cl.G,{},e)}appendToAnimationLayer(t){let e;const i=null==(e=this.dragLayer)?void 0:e.getAttribute("transform");if(i){let t;null==(t=this.animationLayer)||t.setAttribute("transform",i)}let o;null==(o=this.animationLayer)||o.appendChild(t.getSvgRoot())}translateLayers(t,e){let i;t=`translate(${t.x}, ${t.y}) scale(${e})`,null==(i=this.dragLayer)||i.setAttribute("transform",t);for(const[,e]of this.layers)e.setAttribute("transform",t)}moveToDragLayer(t){let e;null==(e=this.dragLayer)||e.appendChild(t.getSvgRoot())}moveOffDragLayer(t,e){this.append(t,e)}append(t,e){let i;this.layers.has(e)||this.createLayer(e),null==(i=this.layers.get(e))||i.appendChild(t.getSvgRoot())}createLayer(t){const e=this.workspace.getSvgGroup(),i=tt(Cl.G,{});let o=!1;const n=[...this.layers].sort(((t,e)=>t[0]-e[0]));for(const[s,r]of n)if(t<s){e.insertBefore(i,r),o=!0;break}return o||e.appendChild(i),this.layers.set(t,i),i}hasLayer(t){return t===this.dragLayer||new Set(this.layers.values()).has(t)}getBlockLayer(){return this.layers.get(Mh)}getBubbleLayer(){return this.layers.get(100)}},rp=class extends op{constructor(t){let e;super(t),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(h(jr.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=t.setMetrics||rp.setTopLevelWorkspaceMetrics_,this.componentManager=new fl,this.connectionDBList=bu.init(this.connectionChecker),this.audioManager=new np(t.parentWorkspace),this.grid=this.options.gridPattern?new ku(this.options.gridPattern,t.gridOptions):null,this.markerManager=new wc(this),wh&&ee&&this.registerToolboxCategoryCallback(yh,ee),Kd&&Os&&this.registerToolboxCategoryCallback(Yd,Os),ed&&ls&&(this.registerToolboxCategoryCallback(td,ls),this.addChangeListener(cs)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Xd(this,this.options.theme||Su),this.themeManager_.subscribeWorkspace(this),this.renderer=Is(this.options.renderer||"geras",this.getTheme(),null!=(e=this.options.rendererOverrides)?e:void 0),this.cachedParentSvgSize=new Rl(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(t){this.metricsManager=t,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(t){this.markerManager.setCursorSvg(t)}setMarkerSvg(t){this.markerManager.setMarkerSvg(t)}getMarker(t){return this.markerManager?this.markerManager.getMarker(t):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(t){t||(t=Su),this.themeManager_.setTheme(t)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter((function(t){return!!t.getStyleName()}))),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const t=new(E(ha))(this.getTheme().name,this.id);p(t)}updateBlockStyles_(t){for(let e,i=0;e=t[i];i++){const t=e.getStyleName();t&&e.setStyle(t)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM=t.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(t){let e=0,i=0,o=1;(this.getCanvas().contains(t)||this.getBubbleCanvas().contains(t))&&(o=this.scale);do{const n=wt(t);t!==this.getCanvas()&&t!==this.getBubbleCanvas()||(o=1),e+=n.x*o,i+=n.y*o,t=t.parentNode}while(t&&t!==this.getParentSvg()&&t!==this.getInjectionDiv());return new yl(e,i)}getCachedParentSvgSize(){const t=this.cachedParentSvgSize;return new Rl(t.width,t.height)}getOriginOffsetInPixels(){return kt(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let t=this.svgGroup_;for(;t;){if((" "+(t.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=t;break}t=t.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(t){this.resizeHandlerWrapper=t}createDom(t,e){return this.injectionDiv||(this.injectionDiv=null!=e?e:null),this.svgGroup_=tt(Cl.G,{class:"blocklyWorkspace"}),t&&(this.svgBackground_=tt(Cl.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"===t&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new sp(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(W(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),W(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(h(jr.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(t=h(jr.CURSOR,this.options))&&this.markerManager.setCursor(new t),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&st(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const t=this.getParentSvg();t&&t.parentNode&&st(t.parentNode)}this.resizeHandlerWrapper&&(j(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=rp.newTrashcan(this);const t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.getCanvas())}static newTrashcan(t){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new oh(this);const t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)}addFlyout(t){const e=new Cu({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return e.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(h(jr.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(e):new(h(jr.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(e),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(t)}getFlyout(t){return this.flyout||t?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const t=this.componentManager.getComponents(fl.Capability.POSITIONABLE,!0),e=this.getMetricsManager().getUiMetrics(),i=[];for(let o,n=0;o=t[n];n++){o.position(e,i);const t=o.getBoundingRectangle();t&&i.push(t)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const t=$t();yl.equals(this.lastRecordedPageScroll,t)||(this.lastRecordedPageScroll=t,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(t,e){const i=this.getParentSvg();null!=t&&(this.cachedParentSvgSize.width=t,i.setAttribute("data-cached-width",`${t}`)),null!=e&&(this.cachedParentSvgSize.height=e,i.setAttribute("data-cached-height",`${e}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let t=this.svgGroup_;for(;t;){if("svg"===t.tagName){this.cachedParentSvg=t;break}t=t.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(b()){var t=this.scale,e=-this.scrollY,i=-this.scrollX;if(!(t===this.oldScale&&1>Math.abs(e-this.oldTop)&&1>Math.abs(i-this.oldLeft))){var o=new(E(ca))(e,i,t,this.id,this.oldScale);this.oldScale=t,this.oldTop=e,this.oldLeft=i,p(o)}}}translate(t,e){let i,o;null==(i=this.layerManager)||i.translateLayers(new yl(t,e),this.scale),null==(o=this.grid)||o.moveTo(t,e),this.maybeFireViewportChangeEvent()}getWidth(){const t=this.getMetrics();return t?t.viewWidth/this.scale:0}setVisible(t){this.isVisible_=t,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t||this.hideChaff(!0))}render(){const t=this.getAllBlocks(!1);for(let e=t.length-1;0<=e;e--)t[e].queueRender();this.getTopBlocks().flatMap((t=>t.getDescendants(!1))).filter((t=>t.isInsertionMarker())).forEach((t=>t.queueRender())),ve().then((()=>{this.markerManager.updateMarkers()}))}highlightBlock(t,e){if(void 0===e){for(let t,e=0;t=this.highlightedBlocks[e];e++)t.setHighlighted(!1);this.highlightedBlocks.length=0}(t=t?this.getBlockById(t):null)&&((e=void 0===e||e)?this.highlightedBlocks.includes(t)||this.highlightedBlocks.push(t):q(this.highlightedBlocks,t),t.setHighlighted(e))}refreshToolboxSelection(){const t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()}renameVariableById(t,e){super.renameVariableById(t,e),this.refreshToolboxSelection()}deleteVariableById(t){super.deleteVariableById(t),this.refreshToolboxSelection()}createVariable(t,e,i){return t=super.createVariable(t,e,i),this.refreshToolboxSelection(),t}recordDragTargets(){const t=this.componentManager.getComponents(fl.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let e,i=0;e=t[i];i++){const t=e.getClientRect();t&&this.dragTargetAreas.push({component:e,clientRect:t})}}newBlock(t,e){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(t){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(t){for(let e,i=0;e=this.dragTargetAreas[i];i++)if(e.clientRect.contains(t.clientX,t.clientY))return e.component;return null}onMouseDown_(t){const e=this.getGesture(t);e&&e.handleWsStart(t,this)}startDrag(t,e){(t=K(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,this.dragDeltaXY=yl.difference(e,t)}moveDrag(t){return(t=K(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,yl.sum(this.dragDeltaXY,t)}isDragging(){return null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())}onMouseWheel_(t){if(wu.inProgress())t.preventDefault(),t.stopPropagation();else{var e=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(e||i){var o=J(t);if(al)var n=t.metaKey;e&&(t.ctrlKey||n||!i)?(o=-o.y/50,e=K(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(e.x,e.y,o)):(e=this.scrollX-o.x,i=this.scrollY-o.y,t.shiftKey&&!o.x&&(e=this.scrollX-o.y,i=this.scrollY),this.scroll(e,i)),t.preventDefault()}}}getBlocksBoundingBox(){const t=this.getTopBoundedElements();if(!t.length)return new Ol(0,0,0,0);const e=t[0].getBoundingRectangle();for(let o=1;o<t.length;o++){var i=t[o];i.isInsertionMarker&&i.isInsertionMarker()||((i=i.getBoundingRectangle()).top<e.top&&(e.top=i.top),i.bottom>e.bottom&&(e.bottom=i.bottom),i.left<e.left&&(e.left=i.left),i.right>e.right&&(e.right=i.right))}return e}cleanUp(){this.setResizesEnabled(!1),Ur.setGroup$$module$build$src$core$events$utils(!0);const t=this.getTopBlocks(!0);let e=0;for(let i,o=0;i=t[o];o++){if(!i.isMovable())continue;const t=i.getRelativeToSurfaceXY();i.moveBy(-t.x,e-t.y,["cleanup"]),i.snapToGrid(),e=i.getRelativeToSurfaceXY().y+i.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}Ur.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(t){if(!this.options.readOnly&&!this.isFlyout){var e=lu.registry.getContextMenuOptions(lu.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(e,t),No(t,e,this.RTL,this)}}updateToolbox(t){if(t=Mt(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Dt(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(O(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(t,e,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);const o=this.scale*i;if(this.scale!==o){o>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:o<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale);var n=this.getCanvas().getCTM(),s=this.getParentSvg().createSVGPoint();s.x=t,s.y=e,t=(s=s.matrixTransform(n.inverse())).x,e=s.y,n=n.translate(t*(1-i),e*(1-i)).scale(i),this.scrollX=n.e,this.scrollY=n.f,this.setScale(o)}}zoomCenter(t){var e=this.getMetrics();let i;this.flyout?(i=e.svgWidth?e.svgWidth/2:0,e=e.svgHeight?e.svgHeight/2:0):(i=e.viewWidth/2+e.absoluteLeft,e=e.viewHeight/2+e.absoluteTop),this.zoom(i,e,t)}zoomToFit(){if(this.isMovable()){var t=this.getMetrics(),e=t.viewWidth;t=t.viewHeight;var i=this.getBlocksBoundingBox(),o=i.right-i.left+40;if(i=i.bottom-i.top+40,o){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),i+=this.flyout.getHeight()/this.scale):(e+=this.flyout.getWidth(),o+=this.flyout.getWidth()/this.scale)),e/=o,t/=i,Ur.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(e,t)),this.scrollCenter()}finally{Ur.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){et(this.getCanvas(),"blocklyCanvasTransitioning"),et(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){ot(this.getCanvas(),"blocklyCanvasTransitioning"),ot(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var t=this.getMetrics(),e=(t.scrollWidth-t.viewWidth)/2,i=(t.scrollHeight-t.viewHeight)/2;e=-e-t.scrollLeft,i=-i-t.scrollTop,this.scroll(e,i)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(t,e){if(this.isMovable()){var i=t?this.getBlockById(t):null;if(i){t=i.getRelativeToSurfaceXY(),i=e?{height:i.height,width:i.width}:i.getHeightWidth();var o=this.scale;e=(t.x+(this.RTL?-1:1)*i.width/2)*o,t=(t.y+i.height/2)*o,i=this.getMetrics(),this.scroll(-(e-i.viewWidth/2),-(t-i.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,this.hideChaff(!1),(t=this.getFlyout(!1))&&t.isVisible()&&(t.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(t,e){this.hideChaff(!0);const i=this.getMetrics();t=Math.min(t,-i.scrollLeft),e=Math.min(e,-i.scrollTop);const o=i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight);t=Math.max(t,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),e=Math.max(e,-o),this.scrollX=t,this.scrollY=e,this.scrollbar&&this.scrollbar.set(-(t+i.scrollLeft),-(e+i.scrollTop),!1),t+=i.absoluteLeft,e+=i.absoluteTop,this.translate(t,e)}getBlockById(t){return super.getBlockById(t)}getAllBlocks(t=!1){return super.getAllBlocks(t)}getTopBlocks(t=!1){return super.getTopBlocks(t)}addTopBlock(t){this.addTopBoundedElement(t),super.addTopBlock(t)}removeTopBlock(t){this.removeTopBoundedElement(t),super.removeTopBlock(t)}addTopComment(t){this.addTopBoundedElement(t),super.addTopComment(t)}removeTopComment(t){this.removeTopBoundedElement(t),super.removeTopComment(t)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(t){this.topBoundedElements.push(t)}removeTopBoundedElement(t){q(this.topBoundedElements,t)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(t){const e=!this.resizesEnabled&&t;this.resizesEnabled=t,e&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(t,e){if("function"!=typeof e)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(t,e)}getButtonCallback(t){let e;return null!=(e=this.flyoutButtonCallbacks.get(t))?e:null}removeButtonCallback(t){this.flyoutButtonCallbacks.delete(t)}registerToolboxCategoryCallback(t,e){if("function"!=typeof e)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(t,e)}getToolboxCategoryCallback(t){return this.toolboxCategoryCallbacks.get(t)||null}removeToolboxCategoryCallback(t){this.toolboxCategoryCallbacks.delete(t)}getGesture(t){const e="pointerdown"===t.type,i=this.currentGesture_;return i?e&&i.hasStarted()?(console.warn("Tried to start the same gesture twice."),i.cancel(),null):i:e?this.currentGesture_=new wu(t,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(t=!1){qi(),So(this),Ci(),this.hideComponents(t)}hideComponents(t=!1){this.getComponentManager().getComponents(fl.Capability.AUTOHIDEABLE,!0).forEach((e=>e.autoHide(t)))}static setTopLevelWorkspaceMetrics_(t){const e=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-(e.scrollLeft+(e.scrollWidth-e.viewWidth)*t.x)),"number"==typeof t.y&&(this.scrollY=-(e.scrollTop+(e.scrollHeight-e.viewHeight)*t.y)),this.translate(this.scrollX+e.absoluteLeft,this.scrollY+e.absoluteTop)}},ap={};ap.WorkspaceSvg=rp,ap.resizeSvgContents=As;var lp=class extends Pa{constructor(t,e){super(e),this.type=aa,this.isOpen=t}toJson(){const t=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new lp)).isOpen=t.isOpen,e}};t(jr.EVENT,aa,lp);var hp=class extends Pa{constructor(t,e,i){super(i),this.type=oa,this.oldElementId=null!=t?t:void 0,this.newElementId=null!=e?e:void 0}toJson(){const t=super.toJson();return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new hp)).oldElementId=t.oldElementId,e.newElementId=t.newElementId,e}};t(jr.EVENT,oa,hp);var cp=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(t){this.drawer=t}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(t){const e=this.curNode;this.curNode=t,this.drawer&&this.drawer.draw(e,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},up=class extends cp{constructor(){super(),this.type="cursor"}next(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()===Bd.types.NEXT||t.getType()===Bd.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t}in(){var t=this.getCurNode();if(!t)return null;let e,i;return t.getType()!==Bd.types.PREVIOUS&&t.getType()!==Bd.types.OUTPUT||(t=t.next()),(t=null!=(i=null==(e=t)?void 0:e.in())?i:null)&&this.setCurNode(t),t}prev(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()===Bd.types.NEXT||t.getType()===Bd.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t}out(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()===Bd.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null}};t(jr.CURSOR,zr,up);var dp=class extends up{constructor(){super()}next(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null}in(){return this.next()}prev(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null}out(){return this.prev()}getNextNode_(t,e){if(!t)return null;const i=t.in()||t.next();return e(i)?i:i?this.getNextNode_(i,e):e(t=this.findSiblingOrParent(t.out()))?t:t?this.getNextNode_(t,e):null}getPreviousNode_(t,e){if(!t)return null;let i=t.prev();return i=i?this.getRightMostChild(i):t.out(),e(i)?i:i?this.getPreviousNode_(i,e):null}validNode_(t){let e=!1;return(t=t&&t.getType())!==Bd.types.OUTPUT&&t!==Bd.types.INPUT&&t!==Bd.types.FIELD&&t!==Bd.types.NEXT&&t!==Bd.types.PREVIOUS&&t!==Bd.types.WORKSPACE||(e=!0),e}findSiblingOrParent(t){if(!t)return null;return t.next()||this.findSiblingOrParent(t.out())}getRightMostChild(t){if(!t.in())return t;for(t=t.in();t&&t.next();)t=t.next();return this.getRightMostChild(t)}};dp.registrationName="basicCursor",t(jr.CURSOR,dp.registrationName,dp);var pp=class extends dp{validNode_(t){let e=!1;const i=t&&t.getType();return t&&(t=t.getLocation(),i===Bd.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(e=!0)),e}},gp=class extends Dd{constructor(t,e){super(t,e),this.highlighted=!1,this.targetConnection=null,this.db=t.workspace.connectionDBList[e],this.dbOpposite=t.workspace.connectionDBList[Jd[e]],this.offsetInBlock=new yl(0,0),this.trackedState=gp.TrackedState.WILL_TRACK}dispose(){let t,e;super.dispose(),this.trackedState===gp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(e=(t=this.sourceBlock_.pathObject).removeConnectionHighlight)||e.call(t,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(t){const e=this.x-t.x;return t=this.y-t.y,Math.sqrt(e*e+t*t)}bumpAwayFrom(t){if(!this.sourceBlock_.workspace.isDragging()){var e=this.sourceBlock_.getRootBlock();if(!e.isInFlyout){var i=!1;if(!e.isMovable()){if(!(e=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,i=!0}var o=R()==e;o||e.addSelect();var n=t.x+Ur.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random())-this.x,s=t.y+Ur.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random())-this.y;i&&(s=-s),e.RTL&&(n=t.x-Ur.config$$module$build$src$core$config.snapRadius-Math.floor(10*Math.random())-this.x),e.moveBy(n,s,["bump"]),o||e.removeSelect()}}}moveTo(t,e){let i=!1;return this.trackedState===gp.TrackedState.WILL_TRACK?(this.db.addConnection(this,e),this.trackedState=gp.TrackedState.TRACKED,i=!0):this.trackedState===gp.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,e),i=!0),this.x=t,this.y=e,i}moveBy(t,e){return this.moveTo(this.x+t,this.y+e)}moveToOffset(t){return this.moveTo(t.x+this.offsetInBlock.x,t.y+this.offsetInBlock.y)}setOffsetInBlock(t,e){this.offsetInBlock.x=t,this.offsetInBlock.y=e}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var t=this.targetConnection;const e=this.targetBlock();t&&e&&(t=yl.difference(this.offsetInBlock,t.offsetInBlock),e.translate(t.x,t.y))}closest(t,e){return this.dbOpposite.searchForClosest(this,t,e)}highlight(){this.highlighted=!0,this.getSourceBlock().queueRender()}unhighlight(){this.highlighted=!1,this.getSourceBlock().queueRender()}isHighlighted(){return this.highlighted}setTracking(t){t&&this.trackedState===gp.TrackedState.TRACKED||!t&&this.trackedState===gp.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db.addConnection(this,this.y),this.trackedState=gp.TrackedState.TRACKED):(this.trackedState===gp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=gp.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const t=this.targetBlock().getDescendants(!1);for(let e=0;e<t.length;e++){const i=t[e],o=i.getConnections_(!0);for(let t=0;t<o.length;t++)o[t].setTracking(!1);for(const t of i.getIcons())si(t)&&t.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let t=[];if(this.type!==mu.INPUT_VALUE&&this.type!==mu.NEXT_STATEMENT)return t;const e=this.targetBlock();if(e){let i;e.isCollapsed()?(i=[],e.outputConnection&&i.push(e.outputConnection),e.nextConnection&&i.push(e.nextConnection),e.previousConnection&&i.push(e.previousConnection)):i=e.getConnections_(!0);for(let e=0;e<i.length;e++)t.push(...i[e].startTrackingAll());t.length||(t=[e])}return t}onFailedConnect(t){const e=this.getSourceBlock();if(d()){const i=Ur.getGroup$$module$build$src$core$events$utils();setTimeout(function(){e.isDisposed()||e.getParent()||(Ur.setGroup$$module$build$src$core$events$utils(i),this.bumpAwayFrom(t),Ur.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),Ur.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(t=!0){const{parentConnection:e,childConnection:i}=this.getParentAndChildConnections();if(e&&i){var o=Ur.getGroup$$module$build$src$core$events$utils();o||Ur.setGroup$$module$build$src$core$events$utils(!0);var n=e.getSourceBlock(),s=i.getSourceBlock();super.disconnectInternal(t),n.queueRender(),s.updateDisabled(),s.queueRender(),s.getSvgRoot().style.display="block",Ur.setGroup$$module$build$src$core$events$utils(o)}}respawnShadow_(){super.respawnShadow_();const t=this.targetBlock();t&&(t.initSvg(),t.queueRender())}neighbours(t){return this.dbOpposite.getNeighbours(this,t)}connect_(t){super.connect_(t);var e=this.getSourceBlock();t=t.getSourceBlock(),e.updateDisabled(),t.updateDisabled(),t.queueRender(),(e=e.getInputWithBlock(t))&&(e=e.isVisible(),t.getSvgRoot().style.display=e?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return super.setCheck(t),this.sourceBlock_.queueRender(),this}};!function(t){(t=t.TrackedState||(t.TrackedState={}))[t.WILL_TRACK=-1]="WILL_TRACK",t[t.UNTRACKED=0]="UNTRACKED",t[t.TRACKED=1]="TRACKED"}(gp||(gp={}));var fp=gp.TrackedState,mp={};mp.RenderedConnection=gp,mp.TrackedState=fp;var vp=class{paste(t,e,i){if(!e.isCapacityAvailable(t.typeCounts))return null;let o;i&&(t.blockState.x=i.x,t.blockState.y=i.y),i=i||new yl(t.blockState.x||0,t.blockState.y||0),Ur.disable$$module$build$src$core$events$utils();try{o=ze(t.blockState,e),Ms(o,i)}finally{Ur.enable$$module$build$src$core$events$utils()}return o?(b()&&!o.isShadow()&&p(new(E(Ur.CREATE$$module$build$src$core$events$utils))(o)),Ur.setSelected$$module$build$src$core$common(o),o):o}};vp.TYPE="block",Oe(vp.TYPE,new vp);var bp={};bp.BlockPaster=vp,bp.moveBlockToNotConflict=Ms;var _p={};_p.bumpIntoBounds=Ds,_p.bumpIntoBoundsHandler=Ns,_p.bumpTopObjectsIntoBounds=Bs;var yp=class{constructor(t){this.block=t,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new yl(0,0),this.workspace=t.workspace}isMovable(){if(this.block.isShadow()){let t,e;return null!=(e=null==(t=this.block.getParent())?void 0:t.isMovable())&&e}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(t){var e;this.block.isShadow()?this.startDraggingShadow(t):(this.dragging=!0,Ur.getGroup$$module$build$src$core$events$utils()||Ur.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(h(jr.CONNECTION_PREVIEWER,this.workspace.options))(this.block),lt(),this.workspace.setResizesEnabled(!1),En(),t=!!t&&(t.altKey||t.ctrlKey||t.metaKey),this.shouldDisconnect(t)&&this.disconnectBlock(t),this.block.setDragging(!0),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.block))}startDraggingShadow(t){const e=this.block.getParent();if(!e)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=yl.difference(e.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),e.startDrag(t)}shouldDisconnect(t){return!!(this.block.getParent()||t&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(t){let e,i,o;if(this.startParentConn=null!=(o=null==(e=this.block.outputConnection)?void 0:e.targetConnection)?o:null==(i=this.block.previousConnection)?void 0:i.targetConnection,t){let t;this.startChildConn=null==(t=this.block.nextConnection)?void 0:t.targetConnection}this.block.unplug(t),yn(this.block)}fireDragStartEvent(){const t=new(E(ia))(this.block,!0,this.block.getDescendants(!1));p(t)}fireDragEndEvent(){const t=new(E(ia))(this.block,!1,this.block.getDescendants(!1));p(t)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var t=new(E(Ur.MOVE$$module$build$src$core$events$utils))(this.block);t.setReason(["drag"]),t.oldCoordinate=this.startLoc,t.recordNew(),p(t)}}drag(t){if(this.block.isShadow()){let e;null==(e=this.block.getParent())||e.drag(yl.sum(t,this.dragOffset))}else this.block.moveDuringDrag(t),this.updateConnectionPreview(this.block,yl.difference(t,this.startLoc))}updateConnectionPreview(t,e){var i=this.connectionCandidate;const o=this.getConnectionCandidate(t,e);if(o){this.connectionCandidate=e=i&&this.currCandidateIsBetter(i,e,o)?i:o;var{local:n,neighbour:s}=e;e=n.type===mu.OUTPUT_VALUE||n.type===mu.PREVIOUS_STATEMENT,i=s.isConnected()&&!s.targetBlock().isInsertionMarker(),e&&i&&!this.orphanCanConnectAtEnd(t,s.targetBlock(),n.type)?this.connectionPreviewer.previewReplacement(n,s,s.targetBlock()):this.connectionPreviewer.previewConnection(n,s)}else this.connectionPreviewer.hidePreview(),this.connectionCandidate=null}orphanCanConnectAtEnd(t,e,i){return!!Dd.getConnectionForOrphanedConnection(t,i===mu.OUTPUT_VALUE?e.outputConnection:e.previousConnection)}currCandidateIsBetter(t,e,i){const{local:o,neighbour:n}=t;t=new yl(o.x,o.y);const s=new yl(n.x,n.y);return e=yl.distance(yl.sum(t,e),s),i.distance>e-Ur.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(t,e){t=this.getLocalConnections(t);let i=this.connectionCandidate?Ur.config$$module$build$src$core$config.connectingSnapRadius:Ur.config$$module$build$src$core$config.snapRadius,o=null;for(const n of t){const{connection:t,radius:s}=n.closest(i,e);t&&(o={local:n,neighbour:t,distance:s},i=s)}return o}getLocalConnections(t){const e=t.getConnections_(!1),i=t.lastConnectionInStack(!0);return i&&i!==t.nextConnection&&e.push(i),e}endDrag(t){if(this.block.isShadow()){let e;null==(e=this.block.getParent())||e.endDrag(t)}else{if(this.fireDragEndEvent(),this.fireMoveEvent(),ht(),En(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let t;null==(t=this.workspace.getLayerManager())||t.moveOffDragLayer(this.block,Mh),this.block.setDragging(!1)}this.connectionCandidate?this.applyConnections(this.connectionCandidate):this.block.queueRender(),this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0),Ur.setGroup$$module$build$src$core$events$utils(!1)}}applyConnections(t){const{local:e,neighbour:i}=t;e.connect(i);const o=e.isSuperior()?i:e,n=this.block.getRootBlock();ve().then((()=>{_n(o.getSourceBlock()),setTimeout((()=>{n.bringToFront()}),0)}))}revertDrag(){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.revertDrag()}else{var t;if(null==(t=this.startChildConn)||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case mu.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case mu.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let t;this.block.moveTo(this.startLoc,["drag"]),null==(t=this.workspace.getLayerManager())||t.moveOffDragLayer(this.block,Mh),Ds(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}},Tp=class extends Nd{constructor(t,e,i){if(super(t,e,i),this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new yl(0,0),this.dragStrategy=new yp(this),!t.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=t,this.svgGroup_=tt(Cl.G,{}),this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),(t=this.pathObject.svgPath).tooltip=this,zi(t),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.initialized){for(var t of this.inputList)t.init();for(const t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),t=this.getSvgRoot(),!this.workspace.options.readOnly&&t&&W(t,"pointerdown",this,this.onMouseDown_),t.parentNode||this.workspace.getCanvas().appendChild(t),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()){let t;null==(t=this.getParent())||t.select()}else this.addSelect()}unselect(){if(this.isShadow()){let t;null==(t=this.getParent())||t.unselect()}else this.removeSelect()}setParent(t){const e=this.parentBlock_;if(t!==e){lt(),super.setParent(t),ht();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var o=this.getRelativeToSurfaceXY();t?t.getSvgRoot().appendChild(i):e&&((t=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(i,t):this.workspace.getCanvas().appendChild(i),this.translate(o.x,o.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const t=this.workspace.getLayerManager();if(!t)throw Error("Cannot calculate position because the workspace has not been appended");let e=0,i=0,o=this.getSvgRoot();if(o)do{const t=wt(o);e+=t.x,i+=t.y,o=o.parentNode}while(o&&!t.hasLayer(o));return new yl(e,i)}moveBy(t,e,i){if(this.parentBlock_)throw Error("Block has parent");const o=b();let n=null;o&&(n=new(E(Ur.MOVE$$module$build$src$core$events$utils))(this),i&&n.setReason(i)),t=new yl(t,e),e=this.getRelativeToSurfaceXY(),t=yl.sum(e,t),this.translate(t.x,t.y),this.updateComponentLocations(t),o&&n&&(n.recordNew(),p(n)),this.workspace.resizeContents()}translate(t,e){this.translation=`translate(${t}, ${e})`,this.relativeCoords=new yl(t,e),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(t,e){const i=this.getRelativeToSurfaceXY();this.moveBy(t.x-i.x,t.y-i.y,e)}moveDuringDrag(t){this.translate(t.x,t.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(t)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(null!=t&&t.shouldSnap()){var e=this.getRelativeToSurfaceXY();(t=t.alignXY(e))!==e&&this.moveTo(t,["snap"])}}}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY(),e=this.getHeightWidth();let i,o;return this.RTL?(i=t.x-e.width,o=t.x):(i=t.x,o=t.x+e.width),new Ol(t.y,t.y+e.height,i,o)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t,e=0;t=this.inputList[e];e++)t.markDirty()}setCollapsed(t){this.collapsed_!==t&&(super.setCollapsed(t),this.updateCollapsed_())}updateCollapsed_(){var t=this.isCollapsed();const e=nh,i=sh;for(let i,o=0;i=this.inputList[o];o++)i.name!==e&&i.setVisible(!t);for(var o of this.getIcons())o.updateCollapsed();t?(t=this.toString(30),(o=this.getField(i))?o.setValue(t):(this.getInput(e)||this.appendDummyInput(e)).appendField(new Cd(t),i)):(this.updateDisabled(),this.removeInput(e))}tab(t,e){const i=new pp;i.setCurNode(Bd.createFieldNode(t)),t=i.getCurNode(),e?i.next():i.prev(),(e=i.getCurNode())&&e!==t&&(e.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(e))}onMouseDown_(t){const e=this.workspace.getGesture(t);e&&e.handleBlockStart(t,this)}showHelp(){const t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const t=lu.registry.getContextMenuOptions(lu.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t}showContextMenu(t){const e=this.generateContextMenu();e&&e.length&&(No(t,e,this.RTL,this.workspace),Do(this))}updateComponentLocations(t){this.dragging||this.updateConnectionLocations(t),this.updateIconLocations(t),this.updateFieldLocations(t);for(const e of this.getChildren(!1))e.updateComponentLocations(yl.sum(t,e.relativeCoords))}updateConnectionLocations(t){for(const e of this.getConnections_(!1))e.moveToOffset(t)}updateIconLocations(t){for(const e of this.getIcons())e.onLocationChange(t)}updateFieldLocations(t){for(const e of this.inputList)for(const i of e.fieldRow)i.onLocationChange(t)}setDragging(t){(this.dragging=t)?(this.translation="",Aa.push(...this.getConnections_(!0)),et(this.svgGroup_,"blocklyDragging")):(Aa.length=0,ot(this.svgGroup_,"blocklyDragging"));for(let e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)}setMovable(t){super.setMovable(t),this.pathObject.updateMovable(t)}setEditable(t){super.setEditable(t),t=this.getIcons();for(let e=0;e<t.length;e++)t[e].updateEditable()}setShadow(t){super.setShadow(t),this.applyColour()}setInsertionMarker(t){this.isInsertionMarker_!==t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(t,e){this.disposing=!0,Ji(),Uo(),e&&(this.unplug(t),vn(this)),super.dispose(!!t),st(this.svgGroup_)}disposeInternal(){this.disposing=!0,super.disposeInternal(),R()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach((t=>clearTimeout(t))),this.warningTextDb.clear(),this.getIcons().forEach((t=>t.dispose()))}checkAndDelete(){this.workspace.isFlyout||(Ur.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),Ur.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:vp.TYPE,blockState:Ne(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:L(this,!0)}}applyColour(){this.pathObject.applyColour(this);const t=this.getIcons();for(let e=0;e<t.length;e++)t[e].applyColour();for(let t,e=0;t=this.inputList[e];e++)for(let e,i=0;e=t.fieldRow[i];i++)e.applyColour()}updateDisabled(){const t=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===t){let t;null==(t=this.getNextBlock())||t.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=t;for(const t of this.getChildren(!1))t.updateDisabled()}}setWarningText(t,e=""){if(e)this.warningTextDb.has(e)&&(clearTimeout(this.warningTextDb.get(e)),this.warningTextDb.delete(e));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(e,setTimeout((()=>{this.isDeadOrDying()||(this.warningTextDb.delete(e),this.setWarningText(t,e))}),100));else if(this.isInFlyout&&(t=null),i=this.getIcon(qu.TYPE),t){let o=this.getSurroundParent(),n=null;for(;o;)o.isCollapsed()&&(n=o),o=o.getSurroundParent();n&&n.setWarningText(Ur.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Tp.COLLAPSED_WARNING_ID),i?i.addMessage(t,e):this.addIcon(new qu(this).addMessage(t,e))}else i&&(e?(i.addMessage("",e),i.getText()||this.removeIcon(qu.TYPE)):this.removeIcon(qu.TYPE))}setMutator(t){this.removeIcon(Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),t&&this.addIcon(t)}addIcon(t){return super.addIcon(t),t instanceof Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=t),t.initView(this.createIconPointerDownListener(t)),t.applyColour(),t.updateEditable(),this.queueRender(),t}createIconPointerDownListener(t){return e=>{this.isDeadOrDying()||(e=this.workspace.getGesture(e))&&e.setStartIcon(t)}}removeIcon(t){const e=super.removeIcon(t);return t.equals(Ur.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),e}setEnabled(t){Xn("setEnabled","v11","v12","the setDisabledReason method of BlockSvg");const e=this.isEnabled();super.setEnabled(t),this.isEnabled()===e||this.getInheritedDisabled()||this.updateDisabled()}setDisabledReason(t,e){const i=this.isEnabled();super.setDisabledReason(t,e),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setHighlighted(t){this.pathObject.updateHighlighted(t)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(t){this.pathObject.updateDraggingDelete(t)}getColour(){return this.style.colourPrimary}setColour(t){super.setColour(t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()}setStyle(t){const e=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,!e)throw Error("Invalid style name: "+t);this.hat=e.hat,this.pathObject.setStyle(e),this.colour_=e.colourPrimary,this.style=e,this.applyColour()}bringToFront(t=!1){let e=this;if(!e.isDeadOrDying())do{const i=e.getSvgRoot(),o=i.parentNode,n=o.childNodes;if(n[n.length-1]!==i&&o.appendChild(i),t)break;e=e.getParent()}while(e)}setPreviousStatement(t,e){super.setPreviousStatement(t,e),this.queueRender()}setNextStatement(t,e){super.setNextStatement(t,e),this.queueRender()}setOutput(t,e){super.setOutput(t,e),this.queueRender()}setInputsInline(t){super.setInputsInline(t),this.queueRender()}removeInput(t,e){return t=super.removeInput(t,e),this.queueRender(),t}moveNumberedInputBefore(t,e){super.moveNumberedInputBefore(t,e),this.queueRender()}appendInput(t){return super.appendInput(t),this.queueRender(),t}setConnectionTracking(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var e=this.nextConnection.targetBlock();e&&e.setConnectionTracking(t)}if(!this.collapsed_)for(e=0;e<this.inputList.length;e++){var i=this.inputList[e].connection;i&&(i.setTracking(t),(i=i.targetBlock())&&i.setConnectionTracking(t))}}getConnections_(t){const e=[];if(this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection),t||!this.collapsed_)for(let t,i=0;t=this.inputList[i];i++)t.connection&&e.push(t.connection);return e}lastConnectionInStack(t){return super.lastConnectionInStack(t)}getMatchingConnection(t,e){return super.getMatchingConnection(t,e)}makeConnection_(t){return new gp(this,t)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const t=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||t.isInFlyout))for(const e of this.getConnections_(!1)){if(e.isSuperior()){let t;null==(t=e.targetBlock())||t.bumpNeighbours()}for(const i of e.neighbours(Ur.config$$module$build$src$core$config.snapRadius))i.getSourceBlock().getRootBlock()!==t&&(e.isConnected()&&i.isConnected()||(e.isSuperior()?i.bumpAwayFrom(e):e.bumpAwayFrom(i)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(t,e,i){if(t.type===mu.NEXT_STATEMENT||t.type===mu.INPUT_VALUE){let o=e.x;e=e.y,o+=i.x-t.getOffsetInBlock().x,e+=i.y-t.getOffsetInBlock().y,this.moveBy(o,e)}}getChildren(t){return super.getChildren(t)}queueRender(){return me(this)}render(){this.queueRender(),be()}renderEfficiently(){lt(),this.isCollapsed()&&this.updateCollapsed_(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),ht(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const t of this.inputList){const e=t.connection;e&&e.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(wc.LOCAL_MARKER).draw();for(const t of this.inputList)for(const e of t.fieldRow)e.updateMarkers_()}setCursorSvg(t){this.pathObject.setCursorSvg(t)}setMarkerSvg(t){this.pathObject.setMarkerSvg(t)}getHeightWidth(){let t=this.height,e=this.width;var i=this.getNextBlock();if(i){i=i.getHeightWidth();const o=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=i.height-o,e=Math.max(e,i.width)}return{height:t,width:e}}fadeForReplacement(t){this.pathObject.updateReplacementFade(t)}highlightShapeForInput(t,e){this.pathObject.updateShapeForInputHighlight(t,e)}setDragStrategy(t){this.dragStrategy=t}isMovable(){return this.dragStrategy.isMovable()}startDrag(t){this.dragStrategy.startDrag(t)}drag(t,e){this.dragStrategy.drag(t,e)}endDrag(t){this.dragStrategy.endDrag(t)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const t=Object.assign({},{kind:"BLOCK"},Ne(this)),e=new Set(["id","height","width","pinned","enabled"]),i=function(t){for(const o in t)e.has(o)?delete t[o]:"object"==typeof t[o]&&i(t[o])};return i(t),[t]}};Tp.INLINE=-1,Tp.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Ep=class{constructor(){}onDragEnter(t){}onDragOver(t){}onDragExit(t){}onDrop(t){}getClientRect(){return null}shouldPreventMove(t){return!1}},wp=class extends Ep{constructor(){super(),this.wouldDelete_=!1}wouldDelete(t){return t instanceof Tp?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t)):this.updateWouldDelete_(Fs(t)&&t.isDeletable()),this.wouldDelete_}updateWouldDelete_(t){this.wouldDelete_=t}},kp=class extends wp{constructor(t){super(),this.workspace=t,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(t=new Cu({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(t.toolboxPosition=this.workspace.toolboxPosition===zl.TOP?zl.BOTTOM:zl.TOP,this.flyout=new(h(jr.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(t)):(t.toolboxPosition=this.workspace.toolboxPosition===zl.RIGHT?zl.LEFT:zl.RIGHT,this.flyout=new(h(jr.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(t)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let t;this.svgGroup=tt(Cl.G,{class:"blocklyTrash"});const e=String(Math.random()).substring(2);t=tt(Cl.CLIPPATH,{id:"blocklyTrashBodyClipPath"+e},this.svgGroup),tt(Cl.RECT,{width:Ip,height:$p,y:Sp},t);const i=tt(Cl.IMAGE,{width:th,x:-Ap,height:eh,y:-Mp,"clip-path":"url(#blocklyTrashBodyClipPath"+e+")"},this.svgGroup);return i.setAttributeNS(wl,"xlink:href",this.workspace.options.pathToMedia+ih),t=tt(Cl.CLIPPATH,{id:"blocklyTrashLidClipPath"+e},this.svgGroup),tt(Cl.RECT,{width:Ip,height:Sp},t),this.svgLid=tt(Cl.IMAGE,{width:th,x:-Ap,height:eh,y:-Mp,"clip-path":"url(#blocklyTrashLidClipPath"+e+")"},this.svgGroup),this.svgLid.setAttributeNS(wl,"xlink:href",this.workspace.options.pathToMedia+ih),z(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),z(this.svgGroup,"pointerup",this,this.click),z(i,"pointerover",this,this.mouseOver),z(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(rt(this.flyout.createDom(Cl.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[fl.Capability.AUTOHIDEABLE,fl.Capability.DELETE_AREA,fl.Capability.DRAG_TARGET,fl.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&st(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var t=this.contents.map((function(t){return JSON.parse(t)})),e=this.workspace.getParentSvg().style;e.cursor="wait",setTimeout((()=>{let i,o;null==(i=this.flyout)||i.show(t),e.cursor="",null==(o=this.workspace.scrollbar)||o.setVisible(!1)}),10),this.fireUiEvent(!0)}}closeFlyout(){var t,e;this.contentsIsOpen()&&(null==(t=this.flyout)||t.hide(),null==(e=this.workspace.scrollbar)||e.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(t){!t&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(t,e){if(this.initialized){var i,o=Vt(this.workspace,t);t=Gt(o,new Rl(Ip,$p+Sp),Op,Cp,t,this.workspace),e=Wt(t,Cp,o.vertical===Yl.TOP?Jl.DOWN:Jl.UP,e),this.top=e.top,this.left=e.left,null==(i=this.svgGroup)||i.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new Ol(this.top,this.top+$p+Sp,this.left,this.left+Ip)}getClientRect(){if(!this.svgGroup)return null;var t=this.svgGroup.getBoundingClientRect();const e=t.top+Mp-Rp;return t=t.left+Ap-Rp,new Ol(e,e+Sp+$p+2*Rp,t,t+Ip+2*Rp)}onDragOver(t){this.setLidOpen(this.wouldDelete_)}onDragExit(t){this.setLidOpen(!1)}onDrop(t){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(t){this.isLidOpen!==t&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=t,this.animateLid())}animateLid(){const t=Dp;var e=1/(t+1);this.lidOpen+=this.isLidOpen?e:-e,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Bp),e=Np+this.lidOpen*(Pp-Np),this.svgGroup&&(this.svgGroup.style.opacity=`${e}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),Lp/t))}setLidAngle(t){const e=this.workspace.toolboxPosition===zl.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let i;null==(i=this.svgLid)||i.setAttribute("transform","rotate("+(e?-t:t)+","+(e?4:Ip-4)+","+(Sp-2)+")")}setMinOpenness(t){this.minOpenness=t,this.isLidOpen||this.setLidAngle(t*Bp)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(t){t=new(E(aa))(t,this.workspace.id),p(t)}blockMouseDownWhenOpenable(t){!this.contentsIsOpen()&&this.hasContents()&&t.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(t){if(!(0>=this.workspace.options.maxTrashcanContents||t.type!==Ur.DELETE$$module$build$src$core$events$utils||t.type!==Ur.DELETE$$module$build$src$core$events$utils||t.wasShadow)){if(!t.oldJson)throw Error("Encountered a delete event without proper oldJson");if(t=JSON.stringify(this.cleanBlockJson(t.oldJson)),!this.contents.includes(t)){for(this.contents.unshift(t);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(xp)}}}cleanBlockJson(t){return function t(e){if(e){if(delete e.id,delete e.x,delete e.y,delete e.enabled,delete e.disabledReasons,e.icons&&e.icons.comment){var i=e.icons.comment;delete i.height,delete i.width,delete i.pinned}for(var o in i=e.inputs){var n=i[o];const e=n.block;n=n.shadow,e&&t(e),n&&t(n)}e.next&&(e=(o=e.next).block,o=o.shadow,e&&t(e),o&&t(o))}}(t=JSON.parse(JSON.stringify(t))),Object.assign({},{kind:"BLOCK"},t)}},Ip=47,$p=44,Sp=16,Cp=20,Op=20,Rp=10,Ap=0,Mp=32,xp=.1,Lp=80,Dp=4,Np=.4,Pp=.8,Bp=45,Fp=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(t,e){if(this.shortcuts.get(t.name)&&!e)throw Error(`Shortcut named "${t.name}" already exists.`);if(this.shortcuts.set(t.name,t),(e=t.keyCodes)&&0<e.length)for(let i=0;i<e.length;i++)this.addKeyMapping(e[i],t.name,!!t.allowCollision)}unregister(t){return this.shortcuts.get(t)?(this.removeAllKeyMappings(t),this.shortcuts.delete(t),!0):(console.warn(`Keyboard shortcut named "${t}" not found.`),!1)}addKeyMapping(t,e,i){t=`${t}`;const o=this.keyMap.get(t);if(o&&!i)throw Error(`Shortcut named "${e}" collides with shortcuts "${o}"`);o&&i?o.unshift(e):this.keyMap.set(t,[e])}removeKeyMapping(t,e,i){const o=this.keyMap.get(t);if(!o)return i||console.warn(`No keyboard shortcut named "${e}" registered with key code "${t}"`),!1;const n=o.indexOf(e);return-1<n?(o.splice(n,1),0===o.length&&this.keyMap.delete(t),!0):(i||console.warn(`No keyboard shortcut named "${e}" registered with key code "${t}"`),!1)}removeAllKeyMappings(t){for(const e of this.keyMap.keys())this.removeKeyMapping(e,t,!0)}setKeyMap(t){this.keyMap.clear();for(const e in t)this.keyMap.set(e,t[e])}getKeyMap(){const t=Object.create(null);for(const[e,i]of this.keyMap)t[e]=i;return t}getRegistry(){const t=Object.create(null);for(const[e,i]of this.shortcuts)t[e]=i;return kn(Object.create(null),t)}onKeyDown(t,e){var i=this.serializeKeyEvent_(e);if(!(i=this.getShortcutNamesByKeyCode(i)))return!1;for(let o,n=0;o=i[n];n++){const i=this.shortcuts.get(o);let n,s;if(null==(n=i)||!n.preconditionFn||null!=(s=i)&&s.preconditionFn(t)){let o,n;if(null!=(o=i)&&o.callback&&null!=(n=i)&&n.callback(t,e,i))return!0}}return!1}getShortcutNamesByKeyCode(t){return this.keyMap.get(t)||[]}getKeyCodesByShortcutName(t){const e=[];for(const[i,o]of this.keyMap)-1<o.indexOf(t)&&e.push(i);return e}serializeKeyEvent_(t){let e="";for(const i in Fp.modifierKeys)t.getModifierState(i)&&(""!==e&&(e+="+"),e+=i);return""!==e&&t.keyCode?e+="+"+t.keyCode:t.keyCode&&(e=String(t.keyCode)),e}checkModifiers_(t){for(let e,i=0;e=t[i];i++)if(!(e in Fp.modifierKeys))throw Error(e+" is not a valid modifier key.")}createSerializedKey(t,e){let i="";if(e){this.checkModifiers_(e);for(const t in Fp.modifierKeys)e.includes(Fp.modifierKeys[t])&&(""!==i&&(i+="+"),i+=t)}return""!==i&&t?i+="+"+t:t&&(i=`${t}`),i}};Fp.registry=new Fp,function(t){(t=t.modifierKeys||(t.modifierKeys={}))[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta"}(Fp||(Fp={}));var Hp,Up=null,Gp=null,Vp={duplicateInternal:Vs,copyInternal:Hs},Wp={};Wp.BlockPaster=vp,Wp.TEST_ONLY=Vp,Wp.paste=Us,Wp.registry=Fh,function(t){t.ESCAPE="escape",t.DELETE="delete",t.COPY="copy",t.CUT="cut",t.PASTE="paste",t.UNDO="undo",t.REDO="redo"}(Hp||(Hp={}));var zp=null,jp=null,Xp=null;Zs();var Yp={};Yp.names=Hp,Yp.registerCopy=Xs,Yp.registerCut=Ys,Yp.registerDefaultShortcuts=Zs,Yp.registerDelete=js,Yp.registerEscape=zs,Yp.registerPaste=Ks,Yp.registerRedo=qs,Yp.registerUndo=Js;var Kp={ProcedureSerializer:class{constructor(t,e){this.procedureModelClass=t,this.parameterModelClass=e,this.priority=75}save(t){return(t=t.getProcedureMap().getProcedures().map((t=>Qs(t)))).length?t:null}load(t,e){const i=e.getProcedureMap();for(const o of t)i.add(tr(this.procedureModelClass,this.parameterModelClass,o,e))}clear(t){t.getProcedureMap().clear()}}};Kp.loadProcedure=tr,Kp.saveProcedure=Qs;var Jp=class{constructor(){this.priority=100}save(t){const e=[];for(const i of t.getAllVariables())t={name:i.name,id:i.getId()},i.type&&(t.type=i.type),e.push(t);return e.length?e:null}load(t,e){for(const i of t)e.createVariable(i.name,i.type,i.id)}clear(t){t.getVariableMap().clear()}};Ie("variables",new Jp);var qp={};qp.VariableSerializer=Jp;var Zp={};Zp.load=ir,Zp.save=er;var Qp={blocks:ic,exceptions:tc,priorities:Dh,procedures:Kp,registry:Nh,variables:qp,workspaceComments:Bh,workspaces:Zp},tg=class{constructor(t,e,i,o,n){this.workspace=t,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,i=void 0===i||i;const s=(e=void 0===e||e)&&i;e&&(this.hScroll=new Nl(t,!0,s,o,n)),i&&(this.vScroll=new Nl(t,!1,s,o,n)),s&&(this.corner_=tt(Cl.RECT,{height:Nl.scrollbarThickness,width:Nl.scrollbarThickness,class:"blocklyScrollbarBackground"}),rt(this.corner_,t.getBubbleCanvas()))}dispose(){st(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const t=this.workspace.getMetrics();if(t){var e=!1,i=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===t.viewWidth&&this.oldHostMetrics_.viewHeight===t.viewHeight&&this.oldHostMetrics_.absoluteTop===t.absoluteTop&&this.oldHostMetrics_.absoluteLeft===t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===t.scrollWidth&&this.oldHostMetrics_.viewLeft===t.viewLeft&&this.oldHostMetrics_.scrollLeft===t.scrollLeft||(e=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===t.scrollHeight&&this.oldHostMetrics_.viewTop===t.viewTop&&this.oldHostMetrics_.scrollTop===t.scrollTop||(i=!0)):i=e=!0,e||i){try{Ur.disable$$module$build$src$core$events$utils(),this.hScroll&&e&&this.hScroll.resize(t),this.vScroll&&i&&this.vScroll.resize(t)}finally{Ur.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft){let t;null==(t=this.corner_)||t.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteTop!==t.absoluteTop){let t;null==(t=this.corner_)||t.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=t}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(t,e){this.hScroll&&this.hScroll.setOrigin(t,e),this.vScroll&&this.vScroll.setOrigin(t,e)}set(t,e,i){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(e,!1),(i||void 0===i)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace.setMetrics(t))}setX(t){this.hScroll&&this.hScroll.set(t,!0)}setY(t){this.vScroll&&this.vScroll.set(t,!0)}setContainerVisible(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)}isVisible(){let t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t}setVisible(t){this.hScroll&&this.hScroll.setVisibleInternal(t),this.vScroll&&this.vScroll.setVisibleInternal(t)}resizeContent(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)}resizeView(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)}},eg=class{constructor(t){this.workspace_=t}getDimensionsPx_(t){let e=0,i=0;return t&&(e=t.getWidth(),i=t.getHeight()),new Rl(e,i)}getFlyoutMetrics(t){return{width:(t=this.getDimensionsPx_(this.workspace_.getFlyout(t))).width,height:t.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let t=0,e=0;const i=this.getToolboxMetrics(),o=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var s;const r=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=n?i.position:o.position)===zl.TOP;return s===zl.LEFT&&(n&&(t+=i.width),r&&(t+=o.width)),a&&(n&&(e+=i.height),r&&(e+=o.height)),{top:e,left:t}}getViewMetrics(t){t=t?this.workspace_.scale:1;const e=this.getSvgMetrics(),i=this.getToolboxMetrics(),o=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var s;const r=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=n?i.position:o.position)===zl.LEFT||s===zl.RIGHT;return s!==zl.TOP&&s!==zl.BOTTOM||(n&&(e.height-=i.height),r&&(e.height-=o.height)),a&&(n&&(e.width-=i.width),r&&(e.width-=o.width)),{height:e.height/t,width:e.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}}getContentMetrics(t){t=t?1:this.workspace_.scale;const e=this.workspace_.getBlocksBoundingBox();return{height:(e.bottom-e.top)*t,width:(e.right-e.left)*t,top:e.top*t,left:e.left*t}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(t){if(!this.hasFixedEdges())return{};const e=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);const o={};return i||(o.top=t.top,o.bottom=t.top+t.height),e||(o.left=t.left,o.right=t.left+t.width),o}getPaddedContent_(t,e){const i=e.top+e.height,o=e.left+e.width,n=t.width,s=n/2,r=(t=t.height)/2;return{top:Math.min(e.top-r,i-t),bottom:Math.max(i+r,e.top+t),left:Math.min(e.left-s,o-n),right:Math.max(o+s,e.left+n)}}getScrollMetrics(t,e,i){t=t?this.workspace_.scale:1,e=e||this.getViewMetrics(!1);var o=i||this.getContentMetrics();i=this.getComputedFixedEdges_(e),e=this.getPaddedContent_(e,o),o=void 0!==i.top?i.top:e.top;const n=void 0!==i.left?i.left:e.left;return{top:o/t,left:n/t,width:((void 0!==i.right?i.right:e.right)-n)/t,height:((void 0!==i.bottom?i.bottom:e.bottom)-o)/t}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const t=this.getToolboxMetrics(),e=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),o=this.getAbsoluteMetrics(),n=this.getViewMetrics(),s=this.getContentMetrics(),r=this.getScrollMetrics(!1,n,s);return{contentHeight:s.height,contentWidth:s.width,contentTop:s.top,contentLeft:s.left,scrollHeight:r.height,scrollWidth:r.width,scrollTop:r.top,scrollLeft:r.left,viewHeight:n.height,viewWidth:n.width,viewTop:n.top,viewLeft:n.left,absoluteTop:o.top,absoluteLeft:o.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:e.width,flyoutHeight:e.height}}};t(jr.METRICS_MANAGER,zr,eg),"Blockly"in globalThis||(globalThis.Blockly={Msg:ch});var ig=class extends Id{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(t){super.setFontConstants_(t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(t){super.setDynamicProperties_(t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const e=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=e&&!isNaN(e)?e:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&st(this.selectedGlowFilter),this.replacementGlowFilter&&st(this.replacementGlowFilter)}makeStartHat(){const t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:Kn("c",[Yn(25,-t),Yn(71,-t),Yn(e,0)])}}makeHexagonal(){function t(t,i,o){var n=t/2;return Zn(-(o=o?-1:1)*(n=n>e?e:n),t=(i?-1:1)*t/2)+Zn(o*n,t)}const e=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:t=>(t/=2)>e?e:t,height:t=>t,connectionOffsetY:t=>t/2,connectionOffsetX:t=>-t,pathDown:e=>t(e,!1,!1),pathUp:e=>t(e,!0,!1),pathRightDown:e=>t(e,!1,!0),pathRightUp:e=>t(e,!1,!0)}}makeRounded(){function t(t,e,o){const n=t>i?t-i:0,s=o===e?"0":"1";return es("a","0 0,"+s,t=(t>i?i:t)/2,Yn((o?1:-1)*t,(e?-1:1)*t))+ts("v",(e?-1:1)*n)+es("a","0 0,"+s,t,Yn((o?-1:1)*t,(e?-1:1)*t))}const e=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*e;return{type:this.SHAPES.ROUND,isDynamic:!0,width:t=>(t/=2)>e?e:t,height:t=>t,connectionOffsetY:t=>t/2,connectionOffsetX:t=>-t,pathDown:e=>t(e,!1,!1),pathUp:e=>t(e,!0,!1),pathRightDown:e=>t(e,!1,!0),pathRightUp:e=>t(e,!1,!0)}}makeSquared(){function t(t,i,o){t-=2*e;const n=o===i?"0":"1";return es("a","0 0,"+n,e,Yn((o?1:-1)*e,(i?-1:1)*e))+ts("v",(i?-1:1)*t)+es("a","0 0,"+n,e,Yn((o?-1:1)*e,(i?-1:1)*e))}const e=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:t=>e,height:t=>t,connectionOffsetY:t=>t/2,connectionOffsetX:t=>-t,pathDown:e=>t(e,!1,!1),pathUp:e=>t(e,!0,!1),pathRightDown:e=>t(e,!1,!0),pathRightUp:e=>t(e,!1,!0)}}shapeFor(t){let e=t.getCheck();switch(!e&&t.targetConnection&&(e=t.targetConnection.getCheck()),t.type){case mu.INPUT_VALUE:case mu.OUTPUT_VALUE:if(null!==(t=t.getSourceBlock().getOutputShape()))switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return e&&e.includes("Boolean")?this.HEXAGONAL:(e&&e.includes("Number")||e&&e.includes("String"),this.ROUNDED);case mu.PREVIOUS_STATEMENT:case mu.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function t(t){return Kn("c",[Yn(t*n/2,0),Yn(t*n*3/4,r/2),Yn(t*n,r)])+Qn([Yn(t*n,s)])+Kn("c",[Yn(t*n/4,r/2),Yn(t*n/2,r),Yn(t*n,r)])+ts("h",t*o)+Kn("c",[Yn(t*n/2,0),Yn(t*n*3/4,-r/2),Yn(t*n,-r)])+Qn([Yn(t*n,-s)])+Kn("c",[Yn(t*n/4,-r/2),Yn(t*n/2,-r),Yn(t*n,-r)])}const e=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,o=e/3,n=o/3,s=i/2,r=s/2,a=t(1),l=t(-1);return{type:this.SHAPES.NOTCH,width:e,height:i,pathLeft:a,pathRight:l}}makeInsideCorners(){const t=this.CORNER_RADIUS,e=es("a","0 0,0",t,Yn(-t,t)),i=es("a","0 0,1",t,Yn(-t,t));return{width:t,height:t,pathTop:e,pathBottom:es("a","0 0,0",t,Yn(t,t)),rightWidth:t,rightHeight:t,pathTopRight:i,pathBottomRight:es("a","0 0,1",t,Yn(t,t))}}generateSecondaryColour_(t){return po("#000",t,.15)||t}generateTertiaryColour_(t){return po("#000",t,.25)||t}createDom(t,e,i){super.createDom(t,e,i),t=tt(Cl.DEFS,{},t),e=tt(Cl.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),tt(Cl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},e),i=tt(Cl.FECOMPONENTTRANSFER,{result:"outBlur"},e),tt(Cl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),tt(Cl.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),tt(Cl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.selectedGlowFilterId=e.id,this.selectedGlowFilter=e,t=tt(Cl.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),tt(Cl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),e=tt(Cl.FECOMPONENTTRANSFER,{result:"outBlur"},t),tt(Cl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),tt(Cl.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),tt(Cl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),tt(Cl.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter=t}getCSS_(t){return[`${t} .blocklyText,`,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${t} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text,`,`${t} .blocklyNonEditableText>g>text,`,`${t} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${t} .blocklyDropdownText {`,"fill: #fff !important;","}",`${t}.blocklyWidgetDiv .goog-menuitem,`,`${t}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${t} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${t} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},og=class extends Sd{constructor(t,e){super(t,e)}draw(){const t=this.block_.pathObject;t.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),t.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(t){if(!(0>=t.height)){if(od.isSpacer(t)){const o=t.precedesStatement;var e=t.followsStatement;if(o||e){const n=this.constants_.INSIDE_CORNERS;var i=n.rightHeight;return i=t.height-(o?i:0),e=e?n.pathBottomRight:"",t=0<i?ts("V",t.yPos+i):"",void(this.outlinePath_+=e+t+(o?n.pathTopRight:""))}}this.outlinePath_+=ts("V",t.yPos+t.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=qn(t.xPos,this.info_.startY),this.outlinePath_+=ts("h",t.width)}drawFlatBottom_(){const t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=ts("V",t.baseline),this.outlinePath_+=ts("h",-t.width)}drawInlineInput_(t){this.positionInlineInputConnection_(t);const e=t.input.name;t.connectedBlock||this.info_.isInsertionMarker||(t=Jn(t.xPos+t.connectionWidth,t.centerline-t.height/2)+this.getInlineInputPath(t),this.block_.pathObject.setOutlinePath(e,t))}getInlineInputPath(t){const e=t.width-2*t.connectionWidth,i=t.height;return ts("h",e)+t.shape.pathRightDown(i)+ts("h",-e)+t.shape.pathUp(i)+"z"}drawStatementInput_(t){var e=t.getLastInput();const i=e.xPos+e.notchOffset+e.shape.width,o=this.constants_.INSIDE_CORNERS,n=e.shape.pathRight+ts("h",-(e.notchOffset-o.width))+o.pathTop,s=t.height-2*o.height;e=o.pathBottom+ts("h",e.notchOffset-o.width)+(e.connectedBottomNextConnection?"":e.shape.pathLeft),this.outlinePath_+=ts("H",i)+n+ts("v",s)+e+ts("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}drawConnectionHighlightPath(t){const e=t.connectionModel;if(e.type===mu.NEXT_STATEMENT||e.type===mu.PREVIOUS_STATEMENT||e.type===mu.OUTPUT_VALUE&&!t.isDynamicShape)super.drawConnectionHighlightPath(t);else{t=e.type===mu.INPUT_VALUE?Jn(t.connectionWidth,-t.height/2)+this.getInlineInputPath(t):Jn(t.width,-t.height/2)+t.shape.pathDown(t.height);var i,o,n=e.getSourceBlock();null==(o=(i=n.pathObject).addConnectionHighlight)||o.call(i,e,t,e.getOffsetInBlock(),n.RTL)}}},ng=class extends Xc{constructor(t,e,i,o,n,s,r){if(super(Xc.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(vo(i)),e=Number(vo(e)),isNaN(i)||isNaN(e))throw Error("Height and width values of an image field must cast to numbers.");if(0>=i||0>=e)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Rl(e,i+ng.Y_PADDING),this.imageHeight=i,"function"==typeof n&&(this.clickHandler=n),t!==Xc.SKIP_SETUP&&(r?this.configure_(r):(this.flipRtl=!!s,this.altText=vo(o)||""),this.setValue(vo(t)))}configure_(t){super.configure_(t),t.flipRtl&&(this.flipRtl=t.flipRtl),t.alt&&(this.altText=vo(t.alt))}initView(){this.imageElement=tt(Cl.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(wl,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(t){return"string"!=typeof t?null:t}doValueUpdate_(t){this.value_=t,this.imageElement&&this.imageElement.setAttributeNS(wl,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(t){t!==this.altText&&(this.altText=t||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(t){this.clickHandler=t}getText_(){return this.altText}static fromJson(t){if(!t.src||!t.width||!t.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(t.src,t.width,t.height,void 0,void 0,void 0,t)}};ng.Y_PADDING=1,Sn("field_image",ng),ng.prototype.DEFAULT_VALUE="";var sg=class extends Xc{constructor(t,e,i){super(Xc.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",t!==Xc.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(t),e&&this.setValidator(e))}configure_(t){super.configure_(t),void 0!==t.spellcheck&&(this.spellcheck_=t.spellcheck)}initView(){if(!this.getSourceBlock())throw new Yc;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const t=this.getSourceBlock();if(!t)throw new Yc;let e;return this.fullBlockClickTarget_=!(null==(e=this.getConstants())||!e.FULL_BLOCK_FIELDS)&&t.isSimpleReporter()}doValueInvalid_(t,e=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,t=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&b()&&this.value_!==t&&e&&p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,t,this.value_)))}doValueUpdate_(t){this.isTextValid_=this.isDirty_=!0,this.value_=t}applyColour(){const t=this.getSourceBlock();if(!t)throw new Yc;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",t.style.colourTertiary)):(this.borderRect_.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let t;return null!=(t=this.getConstants())&&t.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var t=this.htmlInput_;this.isTextValid_?(ot(t,"blocklyInvalidInput"),Le(t,Gh.INVALID,!1)):(et(t,"blocklyInvalidInput"),Le(t,Gh.INVALID,!0))}if(!(t=this.getSourceBlock()))throw new Yc;this.getConstants().FULL_BLOCK_FIELDS&&t.applyColour()}setSpellcheck(t){t!==this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(t,e=!1){this.workspace_=this.sourceBlock_.workspace,!e&&this.workspace_.options.modalInputs&&(ll||nl||sl)?this.showPromptEditor_():this.showInlineEditor_(e)}showPromptEditor_(){Jt(Ur.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),(t=>{null!==t&&this.setValue(this.getValueFromEditorText_(t)),this.onFinishEditing_(this.value_)}))}showInlineEditor_(t){const e=this.getSourceBlock();if(!e)throw new Yc;wo(this,e.RTL,this.widgetDispose_.bind(this),this.workspace_),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var t=this.getSourceBlock();if(!t)throw new Yc;Ur.setGroup$$module$build$src$core$events$utils(!0);const e=yo();var i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");et(i,"editing"),(i=document.createElement("input")).className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);const o=this.workspace_.getScale();var n=this.getConstants().FIELD_TEXT_FONTSIZE*o+"pt";return e.style.fontSize=n,i.style.fontSize=n,n=sg.BORDERRADIUS*o+"px",this.isFullBlockField()&&(n=((n=this.getScaledBBox()).bottom-n.top)/2+"px",t=t.getParent()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,i.style.border=1*o+"px solid "+t,e.style.borderRadius=n,e.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(e.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*o+"px")),i.style.borderRadius=n,e.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&b()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(p(new(E(Ur.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),Ur.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var t=yo().style;if(t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,!(t=this.getClickTarget_()))throw Error("A click target has not been set.");ot(t,"editing")}onFinishEditing_(t){}bindInputEvents_(t){this.onKeyDownWrapper_=W(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=W(t,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(j(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(j(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(t){"Enter"===t.key?($o(this),Ci()):"Escape"===t.key?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),$o(this),Ci()):"Tab"===t.key&&($o(this),Ci(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())}onHtmlInputChange_(t){t=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&b()&&this.value_!==t&&p(new(E(qr))(this.sourceBlock_,this.name||null,t,this.value_))}setEditorValue_(t,e=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t,e)}resizeEditor_(){var t=this.getSourceBlock();if(!t)throw new Yc;const e=yo(),i=this.getScaledBBox();e.style.width=i.right-i.left+"px",e.style.height=i.bottom-i.top+"px",t=new yl(t.RTL?i.right-e.offsetWidth:i.left,i.top),e.style.left=t.x+"px",e.style.top=t.y+"px"}repositionForWindowResize(){const t=this.getSourceBlock();return t instanceof Tp&&(Ds(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0)}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(t){return`${t}`}getValueFromEditorText_(t){return t}};sg.BORDERRADIUS=4;var rg=class extends sg{constructor(t,e,i){super(t,e,i)}doClassValidation_(t){return void 0===t?null:`${t}`}static fromJson(t){return new this(vo(t.text),void 0,t)}};Sn("field_input",rg),rg.prototype.DEFAULT_VALUE="";var ag=class extends rd{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){return!!t.outputConnection}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},lg=class extends fd{constructor(t,e){if(super(t,e),this.connectedBottomNextConnection=!1,this.connectedBlock){for(t=this.connectedBlock;e=t.getNextBlock();)t=e;t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},hg=class extends nd{constructor(t){super(t),this.width=this.height=0,this.type|=od.getType("RIGHT_CONNECTION")}},cg=class extends kd{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){const e=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||e}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},ug=class extends xd{constructor(t,e){super(t,e),this.isInline=!0,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.topRow=new cg(this.constants_),this.bottomRow=new ag(this.constants_),this.isMultiRow=!e.getInputsInline()||e.isCollapsed(),this.hasStatementInput=0<e.statementInputCount,this.rightSide=this.outputConnection?new hg(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(t,e){return!!e&&(e instanceof Ad||t instanceof Md||e instanceof Md||(t instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input||t instanceof Rd||t instanceof Ad)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(t)}getInRowSpacing_(t,e){return t&&e||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&e&&od.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&od.isLeftRoundedCorner(t)&&e&&(od.isPreviousConnection(e)||od.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:t&&od.isLeftSquareCorner(t)&&e&&od.isHat(e)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(t,e){if(od.isTopRow(t)&&od.isBottomRow(e))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const i=od.isInputRow(t)&&t.hasStatement,o=od.isInputRow(e)&&e.hasStatement;return o||i?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),o&&i?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):od.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):od.isBottomRow(e)?this.outputConnection?!e.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(t,e){const i=this.width-this.startX;return od.isInputRow(t)&&t.hasStatement||od.isInputRow(e)&&e.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(t,e){if(t.hasStatement&&!od.isSpacer(e)&&!od.isStatementInput(e))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(od.isInlineInput(e)&&e instanceof ld){const i=e.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return t.yPos+i.height/2}return super.getElemCenterline_(t,e)}addInput_(t,e){if((t instanceof Rd||t instanceof Ad)&&e.hasDummyInput&&e.align===Ur.Align$$module$build$src$core$inputs$align.LEFT&&t.align===Ur.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(e,t);else if(t instanceof Md)return e.elements.push(new lg(this.constants_,t)),e.hasStatement=!0,void(null===e.align&&(e.align=t.align));super.addInput_(t,e)}addAlignmentPadding_(t,e){if(this.rightAlignedDummyInputs.get(t)){let i;for(let e=0;e<t.elements.length;e++){const o=t.elements[e];if(od.isSpacer(o)&&(i=o),od.isField(o)&&o instanceof cd&&o.parentInput===this.rightAlignedDummyInputs.get(t))break}if(i)return i.width+=e,void(t.width+=e)}super.addAlignmentPadding_(t,e)}adjustXPosition_(){const t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let e=t;for(let n=2;n<this.rows.length-1;n+=2){var i=this.rows[n-1];const s=this.rows[n];var o=this.rows[n+1];if(i=2===n?!!this.topRow.hasPreviousConnection:!!i.followsStatement,o=n+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!o.precedesStatement,od.isInputRow(s)&&s.hasStatement){let i,o;s.measure(),e=s.width-(null!=(o=null==(i=s.getLastInput())?void 0:i.width)?o:0)+t}else if(i&&(2===n||o)&&od.isInputRow(s)&&!s.hasStatement){o=s.xPos,i=null;for(let t=0;t<s.elements.length;t++){const n=s.elements[t];od.isSpacer(n)&&(i=n),i&&(od.isField(n)||od.isInput(n))&&o<e&&!(od.isField(n)&&n instanceof cd&&(n.field instanceof Cd||n.field instanceof ng))&&(i.width+=e-o),o+=n.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var t=this.outputConnection.shape;if("isDynamic"in t&&t.isDynamic){for(var e=0,i=0;i<this.rows.length;i++){const t=this.rows[i];t.yPos=e,e+=t.height}this.height=e,i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,e=t.height(i),i=t.width(i),this.outputConnection.height=e,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=t.connectionOffsetY(e),this.outputConnection.connectionOffsetX=t.connectionOffsetX(i),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=i,this.rightSide.height=e,this.rightSide.width=t,this.rightSide.centerline=e/2,this.rightSide.xPos=this.width+t),this.startX=i,this.width+=i+t,this.widthWithChildren+=i+t}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t=0,e=0;e<this.rows.length;e++){var i=this.rows[e];if(!od.isInputRow(i))continue;t=i.elements[i.elements.length-2];let o=this.getNegativeSpacing_(i.elements[1]),n=this.getNegativeSpacing_(t);t=o+n;const s=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-t<s&&(o=(t=this.width-s)/2,n=t/2),i.elements.unshift(new pd(this.constants_,-o)),i.elements.push(new pd(this.constants_,-n))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,e=0;e<this.rows.length;e++)i=this.rows[e],od.isTopOrBottomRow(i)&&(i.elements[1].width-=t),i.width-=t,i.widthWithConnectedBlocks-=t}}getNegativeSpacing_(t){if(!t||!this.outputConnection)return 0;const e=this.outputConnection.width;var i=this.outputConnection.shape.type;const o=this.constants_;if(1<this.inputRows.length)return i===o.SHAPES.ROUND?(i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,e-(i=this.height/2>i?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i)))):0;if(od.isInlineInput(t)&&t instanceof ld){const n=t.connectedBlock;return null==(t=n?n.pathObject.outputShapeType:t.shape.type)||n&&n.outputConnection&&(n.statementInputCount||n.nextConnection)||i===o.SHAPES.HEXAGONAL&&i!==t?0:e-this.constants_.SHAPE_IN_SHAPE_PADDING[i][t]}return od.isField(t)&&t instanceof cd?i===o.SHAPES.ROUND&&t.field instanceof rg?e-2.75*o.GRID_UNIT:e-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:od.isIcon(t)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let o=2;o<this.rows.length-1;o+=2){const n=this.rows[o-1],s=this.rows[o],r=this.rows[o+1];var t=2===o,e=o+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement;if(t?this.topRow.hasPreviousConnection:n.followsStatement){var i=s.elements[1];if(i=3===s.elements.length&&i instanceof cd&&(i.field instanceof Cd||i.field instanceof ng),!t&&i)n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING,s.height-=this.constants_.MEDIUM_PADDING;else if(t||e){if(e){for(t=!1,e=0;e<s.elements.length;e++)if((i=s.elements[e])instanceof ld&&od.isInlineInput(i)&&i.connectedBlock&&!i.connectedBlock.isShadow()&&40<=i.connectedBlock.getHeightWidth().height){t=!0;break}t&&(n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},dg=class extends Hd{constructor(t,e,i){super(t,e,i),this.markerCircle=null}showWithInputOutput(t){const e=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle(t.x,t.y),this.setParent_(e),this.showCurrent_()}showWithOutput_(t){this.showWithInputOutput(t)}showWithInput_(t){this.showWithInputOutput(t)}showWithBlock_(t){const e=(t=t.getLocation()).getHeightWidth();this.positionRect_(0,0,e.width,e.height),this.setParent_(t),this.showCurrent_()}positionCircle(t,e){let i,o;null==(i=this.markerCircle)||i.setAttribute("cx",`${t}`),null==(o=this.markerCircle)||o.setAttribute("cy",`${e}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=tt(Cl.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();tt(Cl.ANIMATE,t,this.markerCircle)}return this.markerSvg_}applyColour_(t){let e,i;if(super.applyColour_(t),null==(e=this.markerCircle)||e.setAttribute("fill",this.colour_),null==(i=this.markerCircle)||i.setAttribute("stroke",this.colour_),this.isCursor()){let e;t=this.colour_+";transparent;transparent;",null==(e=this.markerCircle)||e.firstElementChild.setAttribute("values",t)}}},pg=class extends Ud{constructor(t,e,i){super(t,e,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(t){super.setPath(t),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",t)}applyColour(t){super.applyColour(t);const e=t.getParent();t.isShadow()&&e&&this.svgPath.setAttribute("stroke",e.style.colourTertiary);for(const t of this.outlines.values())t.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const t of this.outlines.values())t.setAttribute("transform","scale(-1 1)")}updateSelected(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(t,e){t=t.getParentInput().name,(t=this.getOutlinePath(t))&&(e?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const t of this.outlines.keys())this.remainingOutlines.add(t)}endDrawing(){if(this.remainingOutlines.size)for(const t of this.remainingOutlines)this.removeOutlinePath(t);this.remainingOutlines.clear()}setOutlinePath(t,e){(t=this.getOutlinePath(t)).setAttribute("d",e),t.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(t){return this.outlines.has(t)||this.outlines.set(t,tt(Cl.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(t),this.outlines.get(t)}removeOutlinePath(t){let e,i;null==(e=this.outlines.get(t))||null==(i=e.parentNode)||i.removeChild(this.outlines.get(t)),this.outlines.delete(t)}},gg=class extends zd{constructor(t){super(t)}makeConstants_(){return new ig}makeRenderInfo_(t){return new ug(this,t)}makeDrawer_(t,e){return new og(t,e)}makeMarkerDrawer(t,e){return new dg(t,this.getConstants(),e)}makePathObject(t,e){return new pg(t,e,this.getConstants())}getConstants(){return this.constants_}getConnectionPreviewMethod(t,e,i){return Xn("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),e.type===mu.OUTPUT_VALUE?t.isConnected()?Gd.PREVIEW_TYPE.REPLACEMENT_FADE:Gd.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(t,e,i)}};ws("zelos",gg);var fg=class{constructor(t){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=t.workspace}previewReplacement(t,e,i){Ur.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=i,i.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(e)&&(e.highlight(),this.staticConn=e)}finally{Ur.enable$$module$build$src$core$events$utils()}}previewConnection(t,e){if(t!==this.draggedConn||e!==this.staticConn){Ur.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(t,e)&&(this.markerConn=this.previewMarker(t,e)),this.workspace.getRenderer().shouldHighlightConnection(e)&&e.highlight(),this.draggedConn=t,this.staticConn=e}finally{Ur.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(t,e){return e.type===mu.PREVIOUS_STATEMENT||e.type===mu.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof gg)}previewMarker(t,e){const i=t.getSourceBlock(),o=this.createInsertionMarker(i),n=this.getMatchingConnection(i,o,t);if(!n)return null;o.queueRender(),be(),n.connect(e);const s={x:e.x-n.x,y:e.y-n.y},r=n.getOffsetInBlock().clone();return ve().then((()=>{if(!o.isDeadOrDying()){Ur.disable$$module$build$src$core$events$utils();try{null==o||o.positionNearConnection(n,s,r),null==o||o.getSvgRoot().setAttribute("visibility","visible")}finally{Ur.enable$$module$build$src$core$events$utils()}}})),n}createInsertionMarker(t){const e=Ne(t,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!e)throw Error(`Failed to serialize source block. ${t.toDevString()}`);t=ze(e,this.workspace);for(const e of t.getDescendants(!1))e.setInsertionMarker(!0);return t.initSvg(),t.getSvgRoot().setAttribute("visibility","hidden"),t}getMatchingConnection(t,e,i){if(t=t.getConnections_(!0),e=e.getConnections_(!0),t.length!==e.length)return null;for(let o=0;o<t.length;o++)if(t[o]===i)return e[o];return null}hidePreview(){Ur.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{Ur.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(t){const e=t.getSourceBlock(),i=e.outputConnection;let o;if(null!=(o=e.previousConnection)&&o.targetConnection||null!=i&&i.targetConnection)e.unplug(!0);else{let e;null==(e=t.targetBlock())||e.unplug(!1)}e.dispose()}dispose(){this.hidePreview()}};t(jr.CONNECTION_PREVIEWER,zr,fg);var mg={};mg.Align=Ur.Align$$module$build$src$core$inputs$align,mg.DummyInput=Rd,mg.EndRowInput=Ad,mg.Input=Od,mg.StatementInput=Md,mg.ValueInput=Ur.ValueInput$$module$build$src$core$inputs$value_input,mg.inputTypes=Ur.inputTypes$$module$build$src$core$inputs$input_types;var vg=!1;Ur.CodeGenerator$$module$build$src$core$generator=class{constructor(t){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=C());var e=[];this.init(t),t=t.getTopBlocks(!0);for(let i,o=0;i=t[o];o++){let t=this.blockToCode(i);Array.isArray(t)&&(t=t[0]),t&&(i.outputConnection&&(t=this.scrubNakedValue(t),this.STATEMENT_PREFIX&&!i.suppressPrefixSuffix&&(t=this.injectId(this.STATEMENT_PREFIX,i)+t),this.STATEMENT_SUFFIX&&!i.suppressPrefixSuffix&&(t+=this.injectId(this.STATEMENT_SUFFIX,i))),e.push(t))}return e=e.join("\n"),(e=(e=(e=this.finish(e)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(t,e){return e+t.replace(/(?!\n$)\n/g,"\n"+e)}allNestedComments(t){const e=[];t=t.getDescendants(!0);for(let i=0;i<t.length;i++){const o=t[i].getCommentText();o&&e.push(o)}return e.length&&e.push(""),e.join("\n")}blockToCode(t,e){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return e?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return e?"":this.blockToCode(t.getChildren(!1)[0]);var i=this.forBlock[t.type];if("function"!=typeof i)throw Error(`${this.name_} generator does not know how to generate code for block type "${t.type}".`);if(i=i.call(t,t,this),Array.isArray(i)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,i[0],e),i[1]]}if("string"==typeof i)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,t)+i),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,i,e);if(null===i)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(t,e,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+t.type);var o=t.getInputTargetBlock(e);if(!o&&!t.getInput(e))throw ReferenceError(`Input "${e}" doesn't exist on "${t.type}"`);if(!o)return"";if(""===(e=this.blockToCode(o)))return"";if(!Array.isArray(e))throw TypeError(`Expecting tuple from value block: ${o.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(t=e[0],e=e[1],isNaN(e))throw TypeError("Expecting valid order from value block: "+o.type);if(!t)return"";o=!1;var n=Math.floor(i);const s=Math.floor(e);if(n<=s&&(n!==s||0!==n&&99!==n))for(o=!0,n=0;n<this.ORDER_OVERRIDES.length;n++)if(this.ORDER_OVERRIDES[n][0]===i&&this.ORDER_OVERRIDES[n][1]===e){o=!1;break}return o&&(t="("+t+")"),t}statementToCode(t,e){const i=t.getInputTargetBlock(e);if(!i&&!t.getInput(e))throw ReferenceError(`Input "${e}" doesn't exist on "${t.type}"`);if("string"!=typeof(t=this.blockToCode(i)))throw TypeError("Expecting code from statement block: "+(i&&i.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(t,e){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,e),this.INDENT)+t),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,e),this.INDENT)+t),this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,e),this.INDENT)),t}injectId(t,e){return e=e.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+e+"'")}addReservedWords(t){this.RESERVED_WORDS_+=t+","}provideFunction_(t,e){if(!this.definitions_[t]){const i=this.nameDB_.getDistinctName(t,Ur.NameType$$module$build$src$core$names.PROCEDURE);let o;for(this.functionNames_[t]=i,Array.isArray(e)&&(e=e.join("\n")),e=e.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,i);o!==e;)o=e,e=e.replace(/^(( {2})*) {2}/gm,"$1\0");e=e.replace(/\0/g,this.INDENT),this.definitions_[t]=e}return this.functionNames_[t]}getVariableName(t){return this.getName(t,Ur.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(t){return this.getName(t,Ur.NameType$$module$build$src$core$names.PROCEDURE)}getName(t,e){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(t,e)}init(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(t,e,i){return e}finish(t){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),t}scrubNakedValue(t){return t}},Ur.CodeGenerator$$module$build$src$core$generator;var bg,_g=class extends eg{constructor(t,e){super(t),this.flyout_=e}getBoundingBox_(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(t){const e=this.getBoundingBox_();return t=t?1:this.workspace_.scale,{height:e.height*t,width:e.width*t,top:e.y*t,left:e.x*t}}getScrollMetrics(t,e,i){return e=i||this.getContentMetrics(),i=this.flyout_.MARGIN*this.workspace_.scale,t=t?this.workspace_.scale:1,{height:(e.height+2*i)/t,width:(e.width+e.left+i)/t,top:0,left:0}}};!function(t){t.BLOCK="block",t.BUTTON="button"}(bg||(bg={}));var yg=class extends wp{constructor(t){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.contents=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new rp(t),this.workspace_.setMetricsManager(new _g(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=u(),this.RTL=!!t.RTL,this.toolboxPosition_=t.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(t){return this.svgGroup_=tt(t,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=tt(Cl.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new tg(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(W(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(W(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[fl.Capability.AUTOHIDEABLE,fl.Capability.DELETE_AREA,fl.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const t of this.boundEvents)j(t);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&st(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(t){this.autoClose=t,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(t){!t&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.isVisible_}setVisible(t){const e=t!==this.isVisible();this.isVisible_=t,e&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(t){const e=t!==this.containerVisible;this.containerVisible=t,e&&this.updateDisplay()}getContents(){return this.contents}setContents(t){this.contents=t}updateDisplay(){let t,e;t=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none"),null==(e=this.workspace_.scrollbar)||e.setContainerVisible(t)}positionAt_(t,e,i,o){let n,s;null==(n=this.svgGroup_)||n.setAttribute("width",`${t}`),null==(s=this.svgGroup_)||s.setAttribute("height",`${e}`),this.workspace_.setCachedParentSvgSize(t,e),this.svgGroup_&&at(this.svgGroup_,"translate("+i+"px,"+o+"px)"),(t=this.workspace_.scrollbar)&&(t.setOrigin(i,o),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const t of this.listeners)j(t);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof t&&(t=this.getDynamicCategoryContents(t)),this.setVisible(!0),t=Lt(t),t=this.createFlyoutInfo(t),be(this.workspace_),this.setContents(t.contents),this.layout_(t.contents,t.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(t){const e=[],i=[];this.permanentlyDisabled.length=0;const o=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const n of t){if("custom"in n){t=this.getDynamicCategoryContents(n.custom),t=Lt(t);const{contents:o,gaps:s}=this.createFlyoutInfo(t);e.push(...o),i.push(...s)}switch(n.kind.toUpperCase()){case"BLOCK":t=n;const s=this.createFlyoutBlock(t);e.push({type:bg.BLOCK,block:s}),this.addBlockGap(t,i,o);break;case"SEP":this.addSeparatorGap(n,i,o);break;case"LABEL":t=this.createButton(n,!0),e.push({type:bg.BUTTON,button:t}),i.push(o);break;case"BUTTON":t=this.createButton(n,!1),e.push({type:bg.BUTTON,button:t}),i.push(o)}}return{contents:e,gaps:i}}getDynamicCategoryContents(t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return t(this.workspace_.targetWorkspace)}createButton(t,e){return new Pd(this.workspace_,this.targetWorkspace,t,e)}createFlyoutBlock(t){let e;return t.blockxml?(t="string"==typeof t.blockxml?Ur.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,(e=this.getRecycledBlock(t.getAttribute("type")))||(e=on(t,this.workspace_))):(e=this.getRecycledBlock(t.type),e||(void 0===t.enabled&&(t.enabled="true"!==t.disabled&&!0!==t.disabled),void 0===t.disabledReasons&&!1===t.enabled&&(t.disabledReasons=[rh]),e=je(t,this.workspace_))),e.isEnabled()||this.permanentlyDisabled.push(e),e}getRecycledBlock(t){let e=-1;for(let i=0;i<this.recycledBlocks.length;i++)if(this.recycledBlocks[i].type===t){e=i;break}return-1===e?void 0:this.recycledBlocks.splice(e,1)[0]}addBlockGap(t,e,i){let o;t.gap?o=parseInt(String(t.gap)):t.blockxml&&(t="string"==typeof t.blockxml?Ur.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,o=parseInt(t.getAttribute("gap"))),e.push(!o||isNaN(o)?i:o)}addSeparatorGap(t,e,i){t=parseInt(String(t.gap)),!isNaN(t)&&0<e.length?e[e.length-1]=t:e.push(i)}clearOldBlocks(){var t=this.workspace_.getTopBlocks(!1);for(let e,i=0;e=t[i];i++)this.blockIsRecyclable_(e)?this.recycleBlock(e):e.dispose(!1,!1);for(t=0;t<this.mats.length;t++){const e=this.mats[t];e&&(ji(e),st(e))}this.mats.length=0;for(let t,e=0;t=this.buttons_[e];e++)t.dispose();let e;this.buttons_.length=0,null==(e=this.workspace_.getPotentialVariableMap())||e.clear()}emptyRecycledBlocks(){for(let t=0;t<this.recycledBlocks.length;t++)this.recycledBlocks[t].dispose();this.recycledBlocks=[]}blockIsRecyclable_(t){return!1}recycleBlock(t){const e=t.getRelativeToSurfaceXY();t.moveBy(-e.x,-e.y),this.recycledBlocks.push(t)}addBlockListeners_(t,e,i){this.listeners.push(W(t,"pointerdown",null,this.blockMouseDown(e))),this.listeners.push(W(i,"pointerdown",null,this.blockMouseDown(e))),this.listeners.push(z(t,"pointerenter",e,(()=>{this.targetWorkspace.isDragging()||e.addSelect()}))),this.listeners.push(z(t,"pointerleave",e,(()=>{this.targetWorkspace.isDragging()||e.removeSelect()}))),this.listeners.push(z(i,"pointerenter",e,(()=>{this.targetWorkspace.isDragging()||e.addSelect()}))),this.listeners.push(z(i,"pointerleave",e,(()=>{this.targetWorkspace.isDragging()||e.removeSelect()})))}blockMouseDown(t){return e=>{const i=this.targetWorkspace.getGesture(e);i&&(i.setStartBlock(t),i.handleFlyoutStart(e,this))}}onMouseDown(t){const e=this.targetWorkspace.getGesture(t);e&&e.handleFlyoutStart(t,this)}isBlockCreatable(t){return t.isEnabled()}createBlock(t){let e=null;Ur.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{e=this.placeNewBlock(t)}finally{Ur.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),t=fe(this.targetWorkspace,i),b()){for(Ur.setGroup$$module$build$src$core$events$utils(!0),i=0;i<t.length;i++){const e=t[i];p(new(E(Zr))(e))}p(new(E(Ur.CREATE$$module$build$src$core$events$utils))(e))}return this.autoClose?this.hide():this.filterForCapacity(),e}initFlyoutButton_(t,e,i){const o=t.createDom();t.moveTo(e,i),t.show(),this.listeners.push(W(o,"pointerdown",this,this.onMouseDown)),this.buttons_.push(t)}createRect_(t,e,i,o,n){return(e=tt(Cl.RECT,{"fill-opacity":0,x:e,y:i,height:o.height,width:o.width})).tooltip=t,zi(e),this.workspace_.getCanvas().insertBefore(e,t.getSvgRoot()),this.rectMap_.set(t,e),this.mats[n]=e}moveRectToBlock_(t,e){const i=e.getHeightWidth();t.setAttribute("width",String(i.width)),t.setAttribute("height",String(i.height)),e=e.getRelativeToSurfaceXY(),t.setAttribute("y",String(e.y)),t.setAttribute("x",String(this.RTL?e.x-i.width:e.x))}filterForCapacity(){const t=this.workspace_.getTopBlocks(!1);for(let e,i=0;e=t[i];i++)if(!this.permanentlyDisabled.includes(e)){const t=this.targetWorkspace.isCapacityAvailable(L(e));for(;e;)e.setDisabledReason(!t,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(t){var e=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered");const i=this.serializeBlock(t);return e.setResizesEnabled(!1),e=ze(i,e),this.positionNewBlock(t,e),e}serializeBlock(t){return Ne(t)}positionNewBlock(t,e){const i=this.targetWorkspace;var o=i.getOriginOffsetInPixels(),n=this.workspace_.getOriginOffsetInPixels();(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),n=yl.sum(n,t),(o=yl.difference(n,o)).scale(1/i.scale),e.moveTo(new yl(o.x,o.y))}};yg.FlyoutItemType=bg;var Tg=class extends yg{constructor(t){super(t)}setMetrics_(t){if(this.isVisible()){var e=this.workspace_.getMetricsManager(),i=e.getScrollMetrics(),o=e.getViewMetrics();e=e.getAbsoluteMetrics(),"number"==typeof t.y&&(this.workspace_.scrollY=-(i.top+(i.height-o.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+e.left,this.workspace_.scrollY+e.top)}}getX(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const e=t.getAbsoluteMetrics(),i=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===zl.LEFT?t.width:i.width-this.width_:this.toolboxPosition_===zl.LEFT?0:i.width:this.toolboxPosition_===zl.LEFT?0:i.width+e.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var e=this.getY();this.positionAt_(this.width_,this.height_,t,e)}}setBackgroundPath(t,e){const i=this.toolboxPosition_===zl.RIGHT;var o=t+this.CORNER_RADIUS;(o=["M "+(i?o:0)+",0"]).push("h",i?-t:t),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("v",Math.max(0,e)),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("h",i?t:-t),o.push("z"),this.svgBackground_.setAttribute("d",o.join(" "))}scrollToStart(){let t;null==(t=this.workspace_.scrollbar)||t.setY(0)}wheel_(t){var e=J(t);if(e.y){const t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics();let o;e=t.getViewMetrics().top-i.top+e.y,null==(o=this.workspace_.scrollbar)||o.setY(e),So(this.workspace_),Ci()}t.preventDefault(),t.stopPropagation()}layout_(t,e){this.workspace_.scale=this.targetWorkspace.scale;var i=this.MARGIN;const o=this.RTL?i:i+this.tabWidth_;for(let a,l=0;a=t[l];l++)if("block"===a.type){var n=a.block;if(!n)continue;var s=n.getDescendants(!1);for(let t,e=0;t=s[e];e++)t.isInFlyout=!0;s=n.getSvgRoot();const t=n.getHeightWidth();var r=n.outputConnection?o-this.tabWidth_:o;n.moveBy(r,i),r=this.createRect_(n,this.RTL?r-t.width:r,i,t,l),this.addBlockListeners_(s,n,r),i+=t.height+e[l]}else"button"===a.type&&(n=a.button,this.initFlyoutButton_(n,o,i),i+=n.height+e[l])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const e=this.dragAngleRange_;return t<e&&t>-e||t<-180+e||t>180-e}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),e=t.left;return this.toolboxPosition_===zl.LEFT?new Ol(-1e9,1e9,-1e9,e+t.width):new Ol(-1e9,1e9,e,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;var e=this.workspace_.getTopBlocks(!1);for(let o,n=0;o=e[n];n++){var i=o.getHeightWidth().width;o.outputConnection&&(i-=this.tabWidth_),t=Math.max(t,i)}for(let e,i=0;e=this.buttons_[i];i++)t=Math.max(t,e.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,t+=Nl.scrollbarThickness,this.width_!==t){for(let o,n=0;o=e[n];n++){if(this.RTL){i=o.getRelativeToSurfaceXY().x;let e=t/this.workspace_.scale-this.MARGIN;o.outputConnection||(e-=this.tabWidth_),o.moveBy(e-i,0)}this.rectMap_.has(o)&&this.moveRectToBlock_(this.rectMap_.get(o),o)}if(this.RTL)for(let i,o=0;i=this.buttons_[o];o++)e=i.getPosition().y,i.moveTo(t/this.workspace_.scale-i.width-this.MARGIN-this.tabWidth_,e);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==zl.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Tg.registryName="verticalFlyout",t(jr.FLYOUTS_VERTICAL_TOOLBOX,zr,Tg);var Eg=class extends yg{constructor(t){super(t),this.horizontalLayout=!0}setMetrics_(t){if(this.isVisible()){var e=this.workspace_.getMetricsManager(),i=e.getScrollMetrics(),o=e.getViewMetrics();e=e.getAbsoluteMetrics(),"number"==typeof t.x&&(this.workspace_.scrollX=-(i.left+(i.width-o.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+e.left,this.workspace_.scrollY+e.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const e=t.getAbsoluteMetrics(),i=t.getViewMetrics();t=t.getToolboxMetrics();const o=this.toolboxPosition_===zl.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?o?t.height:i.height-this.height_:o?0:i.height:o?0:i.height+e.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var e=this.getY();this.positionAt_(this.width_,this.height_,t,e)}}setBackgroundPath(t,e){const i=this.toolboxPosition_===zl.TOP,o=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(o.push("h",t+2*this.CORNER_RADIUS),o.push("v",e),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("h",-t),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),o.push("h",t),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("v",e),o.push("h",-t-2*this.CORNER_RADIUS)),o.push("z"),this.svgBackground_.setAttribute("d",o.join(" "))}scrollToStart(){let t;null==(t=this.workspace_.scrollbar)||t.setX(this.RTL?1/0:0)}wheel_(t){var e=J(t);if(e=e.x||e.y){const t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics();let o;e=t.getViewMetrics().left-i.left+e,null==(o=this.workspace_.scrollbar)||o.setX(e),So(this.workspace_),Ci()}t.preventDefault(),t.stopPropagation()}layout_(t,e){this.workspace_.scale=this.targetWorkspace.scale;const i=this.MARGIN;let o=i+this.tabWidth_;this.RTL&&(t=t.reverse());for(let a,l=0;a=t[l];l++)if("block"===a.type){var n=a.block;if(null==n)continue;var s=n.getDescendants(!1);for(let t,e=0;t=s[e];e++)t.isInFlyout=!0;s=n.getSvgRoot();const t=n.getHeightWidth();var r=n.outputConnection?this.tabWidth_:0;r=this.RTL?o+t.width:o-r,n.moveBy(r,i),r=this.createRect_(n,r,i,t,l),o+=t.width+e[l],this.addBlockListeners_(s,n,r)}else"button"===a.type&&(n=a.button,this.initFlyoutButton_(n,o,i),o+=n.width+e[l])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const e=this.dragAngleRange_;return t<90+e&&t>90-e||t>-90-e&&t<-90+e}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),e=t.top;return this.toolboxPosition_===zl.TOP?new Ol(-1e9,e+t.height,-1e9,1e9):new Ol(e,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;const e=this.workspace_.getTopBlocks(!1);for(let i,o=0;i=e[o];o++)t=Math.max(t,i.getHeightWidth().height);const i=this.buttons_;for(let e,o=0;e=i[o];o++)t=Math.max(t,e.height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,t+=Nl.scrollbarThickness,this.height_!==t){for(let t,i=0;t=e[i];i++)this.rectMap_.has(t)&&this.moveRectToBlock_(this.rectMap_.get(t),t);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==zl.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};t(jr.FLYOUTS_HORIZONTAL_TOOLBOX,zr,Eg);var wg=class extends xu{constructor(t,e,i,o,n){super(Xc.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=wg.dropdownCreate,this.defaultVariableName="string"==typeof t?t:"",this.size_=new Rl(0,0),t!==Xc.SKIP_SETUP&&(n?this.configure_(n):this.setTypes(i,o),e&&this.setValidator(e))}configure_(t){super.configure_(t),this.setTypes(t.variableTypes,t.defaultType)}initModel(){var t=this.getSourceBlock();if(!t)throw new Yc;this.variable||(t=Ur.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(t.getId()))}shouldAddBorderRect_(){const t=this.getSourceBlock();if(!t)throw new Yc;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==t.type)}fromXml(t){var e=this.getSourceBlock();if(!e)throw new Yc;const i=t.getAttribute("id"),o=t.textContent,n=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(e=Ur.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,i,o,n),null!==n&&n!==e.type)throw Error("Serialized variable type with id '"+e.getId()+"' had type "+e.type+", and does not match variable field that references it: "+qo(t)+".");this.setValue(e.getId())}toXml(t){return this.initModel(),t.id=this.variable.getId(),t.textContent=this.variable.name,this.variable.type&&t.setAttribute("variabletype",this.variable.type),t}saveState(t){var e=this.saveLegacyState(wg);return null!==e||(this.initModel(),e={id:this.variable.getId()},t&&(e.name=this.variable.name,e.type=this.variable.type)),e}loadState(t){const e=this.getSourceBlock();if(!e)throw new Yc;this.loadLegacyState(wg,t)||(t=Ur.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,t.id||null,t.name,t.type||""),this.setValue(t.getId()))}setSourceBlock(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(t)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(t){if(null===t)return null;var e=this.getSourceBlock();if(!e)throw new Yc;return(e=Ur.getVariable$$module$build$src$core$variables(e.workspace,t))?(e=e.type,this.typeIsAllowed(e)?t:(console.warn("Variable type doesn't match this field!  Type was "+e),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)}doValueUpdate_(t){const e=this.getSourceBlock();if(!e)throw new Yc;this.variable=Ur.getVariable$$module$build$src$core$variables(e.workspace,t),super.doValueUpdate_(t)}typeIsAllowed(t){const e=this.getVariableTypes();if(!e)return!0;for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}getVariableTypes(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(0===(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t}setTypes(t=null,e=""){if(Array.isArray(t)){let i=!1;for(let o=0;o<t.length;o++)t[o]===e&&(i=!0);if(!i)throw Error("Invalid default type '"+e+"' in the definition of a FieldVariable")}else if(null!==t)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=e,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(t,e){if(t=e.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(t===qd)return void Ur.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(t===Zd)return void this.sourceBlock_.workspace.deleteVariableById(this.variable.getId())}this.setValue(t)}referencesVariables(){return!0}static fromJson(t){return new this(vo(t.variable),void 0,void 0,void 0,t)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const t=this.getText();let e=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var i=this.getVariableTypes(),o=0;o<i.length;o++){const t=this.sourceBlock_.workspace.getVariablesOfType(i[o]);e=e.concat(t)}for(e.sort(_h.compareByName),i=[],o=0;o<e.length;o++)i[o]=[e[o].name,e[o].getId()];return i.push([Ur.Msg$$module$build$src$core$msg.RENAME_VARIABLE,qd]),Ur.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&i.push([Ur.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",t),Zd]),i}};Sn("field_variable",wg);var kg=class extends sg{constructor(t,e,i,o,n,s){super(Xc.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,t!==Xc.SKIP_SETUP&&(s?this.configure_(s):this.setConstraints(e,i,o),this.setValue(t),n&&this.setValidator(n))}configure_(t){super.configure_(t),this.setMinInternal(t.min),this.setMaxInternal(t.max),this.setPrecisionInternal(t.precision)}setConstraints(t,e,i){this.setMinInternal(t),this.setMaxInternal(e),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(t){this.setMinInternal(t),this.setValue(this.getValue())}setMinInternal(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))}getMin(){return this.min_}setMax(t){this.setMaxInternal(t),this.setValue(this.getValue())}setMaxInternal(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))}getMax(){return this.max_}setPrecision(t){this.setPrecisionInternal(t),this.setValue(this.getValue())}setPrecisionInternal(t){this.precision_=Number(t)||0;let e=String(this.precision_);e.includes("e")&&(e=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const i=e.indexOf(".");this.decimalPlaces=-1===i?t?0:null:e.length-i-1}getPrecision(){return this.precision_}doClassValidation_(t){return null===t?null:(t=(t=(t=`${t}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t)?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!==this.decimalPlaces&&(t=Number(t.toFixed(this.decimalPlaces))),t))}widgetCreate_(){const t=super.widgetCreate_();return-1/0<this.min_&&(t.min=`${this.min_}`,Le(t,Gh.VALUEMIN,this.min_)),1/0>this.max_&&(t.max=`${this.max_}`,Le(t,Gh.VALUEMAX,this.max_)),t}static fromJson(t){return new this(t.value,void 0,void 0,void 0,void 0,t)}};Sn("field_number",kg),kg.prototype.DEFAULT_VALUE=0;var Ig=class extends Cd{constructor(t,e,i){super(String(null!=t?t:""),e,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(t){return new this(vo(t.text),void 0,t)}};Sn("field_label_serializable",Ig);var $g=class extends Xc{constructor(t,e,i){super(Xc.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=$g.CHECK_CHAR,t!==Xc.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(t),e&&this.setValidator(e))}configure_(t){super.configure_(t),t.checkCharacter&&(this.checkChar=t.checkCharacter)}saveState(){const t=this.saveLegacyState($g);return null!==t?t:this.getValueBoolean()}initView(){super.initView();const t=this.getTextElement();et(t,"blocklyCheckbox"),t.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(t){this.checkChar=t||$g.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null}doValueUpdate_(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(t){return"string"==typeof t?"TRUE"===t:!!t}static fromJson(t){return new this(t.checked,void 0,t)}};$g.CHECK_CHAR="â",Sn("field_checkbox",$g),$g.prototype.DEFAULT_VALUE=!1;var Sg=class{constructor(t,e){this.draggable=t,this.workspace=e,this.dragTarget=null,this.startLoc=t.getRelativeToSurfaceXY()}onDragStart(t){this.draggable.startDrag(t)}onDrag(t,e){this.moveDraggable(t,e),e=this.getRoot(this.draggable),Fs(e)&&e.setDeleteStyle(this.wouldDeleteDraggable(t,e)),this.updateDragTarget(t)}updateDragTarget(t){t=this.workspace.getDragTarget(t);const e=this.getRoot(this.draggable);if(this.dragTarget!==t){let i;null==(i=this.dragTarget)||i.onDragExit(e),null==t||t.onDragEnter(e)}null==t||t.onDragOver(e),this.dragTarget=t}moveDraggable(t,e){e=this.pixelsToWorkspaceUnits(e),e=yl.sum(this.startLoc,e),this.draggable.drag(e,t)}wouldDeleteDraggable(t,e){return!(!(t=this.workspace.getDragTarget(t))||!this.workspace.getComponentManager().hasCapability(t.id,fl.Capability.DELETE_AREA))&&t.wouldDelete(e)}onDragEnd(t){const e=Ur.getGroup$$module$build$src$core$events$utils();var i=this.workspace.getDragTarget(t);const o=this.getRoot(this.draggable);if(i){let t;null==(t=this.dragTarget)||t.onDrop(o)}this.shouldReturnToStart(t,o)&&this.draggable.revertDrag(),(i=Fs(o)&&this.wouldDeleteDraggable(t,o))&&this.draggable instanceof Tp&&vn(this.draggable.getRootBlock()),this.draggable.endDrag(t),i&&Fs(o)&&(t=Ur.getGroup$$module$build$src$core$events$utils(),Ur.setGroup$$module$build$src$core$events$utils(e),o.dispose(),Ur.setGroup$$module$build$src$core$events$utils(t))}getRoot(t){return t instanceof Tp?t.getRootBlock():t}shouldReturnToStart(t,e){return!!(t=this.workspace.getDragTarget(t))&&t.shouldPreventMove(e)}pixelsToWorkspaceUnits(t){return t=new yl(t.x/this.workspace.scale,t.y/this.workspace.scale),this.workspace.isMutator&&t.scale(1/this.workspace.options.parentWorkspace.scale),t}};t(jr.BLOCK_DRAGGER,zr,Sg);var Cg={};Cg.BlockDragStrategy=yp,Cg.BubbleDragStrategy=Nu,Cg.CommentDragStrategy=Lh,Cg.Dragger=Sg;var Og=class extends Pa{constructor(t,e,i){super(t?t.workspace.id:void 0),this.type=ia,t&&(this.blockId=t.id,this.isStart=e,this.blocks=i)}toJson(){const t=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Og)).isStart=t.isStart,e.blockId=t.blockId,e.blocks=t.blocks,e}};t(jr.EVENT,ia,Og);var Rg=class extends oc{constructor(t,e,i,o){super(t),this.type=qr,this.recordUndo=!1,t&&(this.name=e,this.oldValue=i,this.newValue=o)}toJson(){const t=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Rg)).name=t.name,e.oldValue=t.oldValue,e.newValue=t.newValue,e}isNull(){return this.oldValue===this.newValue}run(t){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(e=e.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");t=t?this.newValue:this.oldValue,(e=e.getField(this.name))?e.setValue(t):console.warn("Can't set non-existent field: "+this.name)}};t(jr.EVENT,qr,Rg);var Ag=class extends oc{constructor(t){super(t),this.type=Ur.MOVE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)}toJson(){const t=super.toJson();return t.oldParentId=this.oldParentId,t.oldInputName=this.oldInputName,this.oldCoordinate&&(t.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),t.newParentId=this.newParentId,t.newInputName=this.newInputName,this.newCoordinate&&(t.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(t.reason=this.reason),this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Ag)).oldParentId=t.oldParentId,e.oldInputName=t.oldInputName,t.oldCoordinate&&(i=t.oldCoordinate.split(","),e.oldCoordinate=new yl(Number(i[0]),Number(i[1]))),e.newParentId=t.newParentId,e.newInputName=t.newInputName,t.newCoordinate&&(i=t.newCoordinate.split(","),e.newCoordinate=new yl(Number(i[0]),Number(i[1]))),void 0!==t.reason&&(e.reason=t.reason),void 0!==t.recordUndo&&(e.recordUndo=t.recordUndo),e}recordNew(){const t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate}setReason(t){this.reason=t}currentLocation_(){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var e=t.getBlockById(this.blockId);if(!e)throw Error("The block associated with the block move event could not be found");t={};const i=e.getParent();return i?(t.parentId=i.id,(e=i.getInputWithBlock(e))&&(t.inputName=e.name)):t.coordinate=e.getRelativeToSurfaceXY(),t}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&yl.equals(this.oldCoordinate,this.newCoordinate)}run(t){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=e.getBlockById(this.blockId);if(i){var o=t?this.newParentId:this.oldParentId,n=t?this.newInputName:this.oldInputName;if(t=t?this.newCoordinate:this.oldCoordinate,o){var s=e.getBlockById(o);if(!s)return void console.warn("Can't connect to non-existent block: "+o)}if(i.getParent()&&i.unplug(),t)n=i.getRelativeToSurfaceXY(),i.moveBy(t.x-n.x,t.y-n.y,this.reason);else{let t,o;(!(e=i.outputConnection)||i.previousConnection&&i.previousConnection.isConnected())&&(e=i.previousConnection),i=null==(o=e)?void 0:o.type,n?(i=s.getInput(n))&&(t=i.connection):i===mu.PREVIOUS_STATEMENT&&(t=s.nextConnection),t&&e?e.connect(t):console.warn("Can't connect to non-existent input: "+n)}}else console.warn("Can't move non-existent block: "+this.blockId)}};t(jr.EVENT,Ur.MOVE$$module$build$src$core$events$utils,Ag);var Mg,xg=class extends Pa{constructor(t,e,i){super(t?t.workspace.id:void 0),this.type=ra,t&&(this.blockId=t.id,this.isOpen=e,this.bubbleType=i)}toJson(){const t=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId||"",t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new xg)).isOpen=t.isOpen,e.bubbleType=t.bubbleType,e.blockId=t.blockId,e}};(function(t){t.MUTATOR="mutator",t.COMMENT="comment",t.WARNING="warning"})(Mg||(Mg={})),t(jr.EVENT,ra,xg);var Lg={};Lg.BubbleOpen=xg,Lg.BubbleType=Mg;var Dg=class extends Na{constructor(t){super(),this.isBlank=!t,t&&(this.commentId=t.id,this.workspaceId=t.workspace.id,this.group=Ur.getGroup$$module$build$src$core$events$utils(),this.recordUndo=d())}toJson(){const t=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return t.commentId=this.commentId,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Dg)).commentId=t.commentId,e}static CommentCreateDeleteHelper(t,e){const i=t.getEventWorkspace_();if(e){if(!t.json)throw Error("Encountered a comment event without proper json");Ce(t.json,i)}else{if(!t.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(e=i.getCommentById(t.commentId))?e.dispose():console.warn("Can't delete non-existent comment: "+t.commentId)}}},Ng=class extends Dg{constructor(t,e,i){super(t),this.type=pa,t&&(this.oldContents_=void 0===e?"":e,this.newContents_=void 0===i?"":i)}toJson(){const t=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Ng)).oldContents_=t.oldContents,e.newContents_=t.newContents,e}isNull(){return this.oldContents_===this.newContents_}run(t){var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(e=e.getCommentById(this.commentId)){var i=t?this.newContents_:this.oldContents_;if(void 0===i){if(t)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}e.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}};t(jr.EVENT,pa,Ng);var Pg=class extends Dg{constructor(t){super(t),this.type=ua,t&&(this.xml=Wo(t),this.json=Se(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=qo(this.xml),t.json=this.json,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Pg)).xml=Ur.textToDom$$module$build$src$core$utils$xml(t.xml),e.json=t.json,e}run(t){Dg.CommentCreateDeleteHelper(this,t)}};t(jr.EVENT,ua,Pg);var Bg=class extends Dg{constructor(t){super(t),this.type=da,t&&(this.xml=Wo(t),this.json=Se(t,{addCoordinates:!0}))}run(t){Dg.CommentCreateDeleteHelper(this,!t)}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=qo(this.xml),t.json=this.json,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Bg)).xml=Ur.textToDom$$module$build$src$core$utils$xml(t.xml),e.json=t.json,e}};t(jr.EVENT,da,Bg);var Fg=class extends Dg{constructor(t){super(t),this.type=ga,t&&(this.comment_=t,this.oldCoordinate_=t.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(t){this.reason=t}setOldCoordinate(t){this.oldCoordinate_=t}toJson(){const t=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return t.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),t}static fromJson(t,e,i){return e=super.fromJson(t,e,null!=i?i:new Fg),i=t.oldCoordinate.split(","),e.oldCoordinate_=new yl(Number(i[0]),Number(i[1])),i=t.newCoordinate.split(","),e.newCoordinate_=new yl(Number(i[0]),Number(i[1])),e}isNull(){return yl.equals(this.oldCoordinate_,this.newCoordinate_)}run(t){var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(e=e.getCommentById(this.commentId)){if(!(t=t?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");e.moveTo(t)}else console.warn("Can't move non-existent comment: "+this.commentId)}};t(jr.EVENT,ga,Fg);var Hg=class extends Dg{constructor(t,e){super(t),this.newCollapsed=e,this.type=fa}toJson(){const t=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return t.newCollapsed=this.newCollapsed,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Hg)).newCollapsed=t.newCollapsed,e}run(t){var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(e=e.getCommentById(this.commentId))?e.setCollapsed(t?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};t(jr.EVENT,fa,Hg);var Ug=class extends Pa{constructor(t,e,i){super(i),this.type=la,this.oldItem=null!=t?t:void 0,this.newItem=null!=e?e:void 0}toJson(){const t=super.toJson();return t.oldItem=this.oldItem,t.newItem=this.newItem,t}static fromJson(t,e,i){return(e=super.fromJson(t,e,null!=i?i:new Ug)).oldItem=t.oldItem,e.newItem=t.newItem,e}};t(jr.EVENT,la,Ug);var Gg=class extends Na{constructor(t){super(),this.isBlank=!0,this.recordUndo=!1,this.type=ma,this.isBlank=!!t,t&&(this.workspaceId=t.id)}};t(jr.EVENT,ma,Gg),Ur.CHANGE$$module$build$src$core$events$utils,Ur.CREATE$$module$build$src$core$events$utils,Ur.DELETE$$module$build$src$core$events$utils,Ur.MOVE$$module$build$src$core$events$utils,Ur.CHANGE$$module$build$src$core$events$utils,Ur.CREATE$$module$build$src$core$events$utils,Ur.DELETE$$module$build$src$core$events$utils,Ur.MOVE$$module$build$src$core$events$utils,Ur.disable$$module$build$src$core$events$utils,Ur.enable$$module$build$src$core$events$utils,Ur.getGroup$$module$build$src$core$events$utils,Ur.setGroup$$module$build$src$core$events$utils,Ur.setRecordUndo$$module$build$src$core$events$utils;var Vg={};Vg.Abstract=Na,Vg.BLOCK_CHANGE=Ur.CHANGE$$module$build$src$core$events$utils,Vg.BLOCK_CREATE=Ur.CREATE$$module$build$src$core$events$utils,Vg.BLOCK_DELETE=Ur.DELETE$$module$build$src$core$events$utils,Vg.BLOCK_DRAG=ia,Vg.BLOCK_FIELD_INTERMEDIATE_CHANGE=qr,Vg.BLOCK_MOVE=Ur.MOVE$$module$build$src$core$events$utils,Vg.BUBBLE_OPEN=ra,Vg.BUMP_EVENTS=ba,Vg.BlockBase=oc,Vg.BlockChange=nc,Vg.BlockCreate=pu,Vg.BlockDelete=Ld,Vg.BlockDrag=Og,Vg.BlockFieldIntermediateChange=Rg,Vg.BlockMove=Ag,Vg.BubbleOpen=xg,Vg.BubbleType=Mg,Vg.CHANGE=Ur.CHANGE$$module$build$src$core$events$utils,Vg.CLICK=na,Vg.COMMENT_CHANGE=pa,Vg.COMMENT_CREATE=ua,Vg.COMMENT_DELETE=da,Vg.COMMENT_MOVE=ga,Vg.CREATE=Ur.CREATE$$module$build$src$core$events$utils,Vg.Click=Ba,Vg.ClickTarget=La,Vg.CommentBase=Dg,Vg.CommentChange=Ng,Vg.CommentCollapse=Hg,Vg.CommentCreate=Pg,Vg.CommentDelete=Bg,Vg.CommentMove=Fg,Vg.DELETE=Ur.DELETE$$module$build$src$core$events$utils,Vg.FINISHED_LOADING=ma,Vg.FinishedLoading=Gg,Vg.MARKER_MOVE=sa,Vg.MOVE=Ur.MOVE$$module$build$src$core$events$utils,Vg.MarkerMove=Fd,Vg.SELECTED=oa,Vg.Selected=hp,Vg.THEME_CHANGE=ha,Vg.TOOLBOX_ITEM_SELECT=la,Vg.TRASHCAN_OPEN=aa,Vg.ThemeChange=fu,Vg.ToolboxItemSelect=Ug,Vg.TrashcanOpen=lp,Vg.UI=ea,Vg.UiBase=Pa,Vg.VAR_CREATE=Zr,Vg.VAR_DELETE=Qr,Vg.VAR_RENAME=ta,Vg.VIEWPORT_CHANGE=ca,Vg.VarBase=vh,Vg.VarCreate=bh,Vg.VarDelete=tp,Vg.VarRename=ep,Vg.ViewportChange=vu,Vg.clearPendingUndo=v,Vg.disable=Ur.disable$$module$build$src$core$events$utils,Vg.disableOrphans=w,Vg.enable=Ur.enable$$module$build$src$core$events$utils,Vg.filter=m,Vg.fire=p,Vg.fromJson=T,Vg.get=E,Vg.getDescendantIds=y,Vg.getGroup=Ur.getGroup$$module$build$src$core$events$utils,Vg.getRecordUndo=d,Vg.isEnabled=b,Vg.setGroup=Ur.setGroup$$module$build$src$core$events$utils,Vg.setRecordUndo=Ur.setRecordUndo$$module$build$src$core$events$utils;var Wg={};Wg.BottomRow=ag,Wg.ConstantProvider=ig,Wg.Drawer=og,Wg.MarkerSvg=dg,Wg.PathObject=pg,Wg.RenderInfo=ug,Wg.Renderer=gg,Wg.RightConnectionShape=hg,Wg.StatementInput=lg,Wg.TopRow=cg,Lr();var zg={};zg.registerCleanup=dr,zg.registerCollapse=gr,zg.registerCollapseExpandBlock=kr,zg.registerComment=Er,zg.registerCommentCreate=Rr,zg.registerCommentDelete=Cr,zg.registerCommentDuplicate=Or,zg.registerCommentOptions=xr,zg.registerDefaultOptions=Lr,zg.registerDelete=$r,zg.registerDeleteAll=_r,zg.registerDisable=Ir,zg.registerDuplicate=Tr,zg.registerExpand=fr,zg.registerHelp=Sr,zg.registerInline=wr,zg.registerRedo=ur,zg.registerUndo=cr;var jg={};jg.CommentView=xh,jg.RenderedWorkspaceComment=uu,jg.WorkspaceComment=Ah;var Xg={};Xg.Bubble=Pu,Xg.MiniWorkspaceBubble=Bu,Xg.TextBubble=Yu,Xg.TextInputBubble=Ku;var Yg=class extends Id{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(t){return super.getCSS_(t).concat([`${t} .blocklyInsertionMarker>.blocklyPathLight,`,`${t} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Kg=class{constructor(t){this.inlineSteps_=this.steps_="",this.info_=t,this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(t){this.steps_+=qn(t.xPos,this.info_.startY);for(let e,i=0;e=t.elements[i];i++)od.isLeftSquareCorner(e)?this.steps_+=this.highlightConstants_.START_POINT:od.isLeftRoundedCorner(e)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):od.isPreviousConnection(e)?this.steps_+=this.notchPaths_.pathLeft:od.isHat(e)?this.steps_+=this.startPaths_.path(this.RTL_):od.isSpacer(e)&&0!==e.width&&(this.steps_+=ts("H",e.xPos+e.width-this.highlightOffset));this.steps_+=ts("H",t.xPos+t.width-this.highlightOffset)}drawJaggedEdge_(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+ts("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(t){const e=t.getLastInput();if(this.RTL_){const i=t.height-e.connectionHeight;this.steps_+=Jn(e.xPos+e.width-this.highlightOffset,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+ts("v",i)}else this.steps_+=Jn(e.xPos+e.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(t){const e=t.getLastInput();if(e)if(this.RTL_){const i=t.height-2*this.insideCornerPaths_.height;this.steps_+=Jn(e.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+ts("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+Zn(t.width-e.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Jn(e.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Zn(t.width-e.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(t){const e=t.xPos+t.width-this.highlightOffset;t instanceof Ed&&t.followsStatement&&(this.steps_+=ts("H",e)),this.RTL_&&(this.steps_+=ts("H",e),t.height>this.highlightOffset&&(this.steps_+=ts("V",t.yPos+t.height-this.highlightOffset)))}drawBottomRow(t){if(this.RTL_)this.steps_+=ts("V",t.baseline-this.highlightOffset);else{const e=this.info_.bottomRow.elements[0];od.isLeftSquareCorner(e)?this.steps_+=Jn(t.xPos+this.highlightOffset,t.baseline-this.highlightOffset):od.isLeftRoundedCorner(e)&&(this.steps_+=Jn(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=Jn(this.info_.startX,t):(this.steps_+=Jn(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=ts("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,od.isLeftRoundedCorner(t.elements[0])?this.steps_+=ts("V",this.outsideCornerPaths_.height):this.steps_+=ts("V",t.capline+this.highlightOffset))}drawInlineInput(t){const e=this.highlightOffset,i=t.xPos+t.connectionWidth;var o=t.centerline-t.height/2;const n=t.width-t.connectionWidth,s=o+e;this.RTL_?(o=t.connectionOffsetY-e,t=t.height-(t.connectionOffsetY+t.connectionHeight)+e,this.inlineSteps_+=Jn(i-e,s)+ts("v",o)+this.puzzleTabPaths_.pathDown(this.RTL_)+ts("v",t)+ts("h",n)):this.inlineSteps_+=Jn(t.xPos+t.width+e,s)+ts("v",t.height)+ts("h",-n)+Jn(i,o+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Jg=class extends Sd{constructor(t,e){super(t,e),this.highlighter_=new Kg(e)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const t=this.block_.pathObject;t.setPath(this.outlinePath_+"\n"+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(t){this.highlighter_.drawJaggedEdge_(t),super.drawJaggedEdge_(t)}drawValueInput_(t){this.highlighter_.drawValueInput(t),super.drawValueInput_(t)}drawStatementInput_(t){this.highlighter_.drawStatementInput(t),super.drawStatementInput_(t)}drawRightSideRow_(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=ts("H",t.xPos+t.width)+ts("V",t.yPos+t.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(t){this.highlighter_.drawInlineInput(t),super.drawInlineInput_(t)}positionInlineInputConnection_(t){const e=t.centerline-t.height/2;if(t.connectionModel){let i=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(t){const e=t.getLastInput();if(null!=e&&e.connectionModel){let i=t.xPos+t.statementEdge+e.notchOffset;i=this.info_.RTL?-1*i:i+this.constants_.DARK_PATH_OFFSET,e.connectionModel.setOffsetInBlock(i,t.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(t){const e=t.getLastInput();if(e&&e.connectionModel){let i=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t.yPos)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const e=t.connection,i=e.xPos;e.connectionModel.setOffsetInBlock((this.info_.RTL?-i:i)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}}},qg=class{constructor(t){this.OFFSET=.5,this.constantProvider=t,this.START_POINT=qn(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,i=(1-Math.SQRT1_2)*(t+e)-e,o=qn(i,i)+es("a","0 0,0",t,Yn(-i-e,t-i)),n=es("a","0 0,0",t+e,Yn(t+e,t+e)),s=qn(i,-i)+es("a","0 0,0",t+e,Yn(t-i,i+e));return{width:t+e,height:t,pathTop:t=>t?o:"",pathBottom:t=>t?n:s}}makeOutsideCorner(){const t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,i=(1-Math.SQRT1_2)*(t-e)+e,o=qn(i,i)+es("a","0 0,1",t-e,Yn(t-i,-i+e)),n=qn(e,t)+es("a","0 0,1",t-e,Yn(t,-t+e)),s=-i,r=qn(i,s)+es("a","0 0,1",t-e,Yn(-i+e,-s-t));return{height:t,topLeft:t=>t?o:n,bottomLeft:()=>r}}makePuzzleTab(){const t=this.constantProvider.TAB_WIDTH,e=this.constantProvider.TAB_HEIGHT,i=qn(-2,3.4-e)+Zn(-.45*t,-2.1),o=ts("v",2.5)+qn(.97*-t,2.5)+Kn("q",[Yn(.05*-t,10),Yn(.3*t,9.5)])+qn(.67*t,-1.9)+ts("v",2.5),n=ts("v",-1.5)+qn(-.92*t,-.5)+Kn("q",[Yn(-.19*t,-5.5),Yn(0,-11)])+qn(.92*t,1),s=qn(-5,e-.7)+Zn(.46*t,-2.1);return{width:t,height:e,pathUp:t=>t?i:n,pathDown:t=>t?o:s}}makeNotch(){return{pathLeft:ts("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Zn(5.1,2.6)+qn(-10.2,6.8)+Zn(5.1,2.6),height:12,width:10.2}}makeStartHat(){const t=this.constantProvider.START_HAT.height,e=qn(25,-8.7)+Kn("c",[Yn(29.7,-6.2),Yn(57.2,-.5),Yn(75,8.7)]),i=Kn("c",[Yn(17.8,-9.2),Yn(45.3,-14.9),Yn(75,-8.7)])+Jn(100.5,t+.5);return{path:t=>t?e:i}}},Zg=class extends gd{constructor(t,e){super(t,e),this.constants_=t,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Qg=class extends fd{constructor(t,e){super(t,e),this.constants_=t,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},tf=class extends xd{constructor(t,e){super(t,e),this.renderer_=t}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Md||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(t,e){this.isInline&&t instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input?(e.elements.push(new Zg(this.constants_,t)),e.hasInlineInput=!0):t instanceof Md?(e.elements.push(new Qg(this.constants_,t)),e.hasStatement=!0):t instanceof Ur.ValueInput$$module$build$src$core$inputs$value_input?(e.elements.push(new hd(this.constants_,t)),e.hasExternalInput=!0):(t instanceof Rd||t instanceof Ad)&&(e.minHeight=Math.max(e.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),this.isInline||null!==e.align||(e.align=t.align)}addElemSpacing_(){let t=!1;for(let e,i=0;e=this.rows[i];i++)e.hasExternalInput&&(t=!0);for(let i,o=0;i=this.rows[o];o++){var e=i.elements;if(i.elements=[],i.startsWithElemSpacer()&&i.elements.push(new pd(this.constants_,this.getInRowSpacing_(null,e[0]))),e.length){for(let t=0;t<e.length-1;t++){i.elements.push(e[t]);const o=this.getInRowSpacing_(e[t],e[t+1]);i.elements.push(new pd(this.constants_,o))}i.elements.push(e[e.length-1]),i.endsWithElemSpacer()&&(e=this.getInRowSpacing_(e[e.length-1],null),t&&i.hasDummyInput&&(e+=this.constants_.TAB_WIDTH),i.elements.push(new pd(this.constants_,e)))}}}getInRowSpacing_(t,e){if(!t)return e&&od.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&od.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&od.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!od.isInput(t)&&(!e||od.isStatementInput(e)))return od.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:od.isIcon(t)?2*this.constants_.LARGE_PADDING+1:od.isHat(t)?this.constants_.NO_PADDING:od.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:od.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:od.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(od.isInput(t)&&!e){if(od.isExternalInput(t))return this.constants_.NO_PADDING;if(od.isInlineInput(t))return this.constants_.LARGE_PADDING;if(od.isStatementInput(t))return this.constants_.NO_PADDING}if(!od.isInput(t)&&e&&od.isInput(e)){if(od.isField(t)&&t.isEditable){if(od.isInlineInput(e)||od.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(od.isInlineInput(e)||od.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(od.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(od.isIcon(t)&&e&&!od.isInput(e))return this.constants_.LARGE_PADDING;if(od.isInlineInput(t)&&e&&od.isField(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(od.isLeftSquareCorner(t)&&e){if(od.isHat(e))return this.constants_.NO_PADDING;if(od.isPreviousConnection(e))return e.notchOffset;if(od.isNextConnection(e))return e.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(od.isLeftRoundedCorner(t)&&e){if(od.isPreviousConnection(e))return e.notchOffset-this.constants_.CORNER_RADIUS;if(od.isNextConnection(e))return e.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return od.isField(t)&&e&&od.isField(e)&&t.isEditable===e.isEditable||e&&od.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,e){return od.isTopRow(t)&&od.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:od.isTopRow(t)||od.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||!t.hasStatement&&e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,e){if(od.isSpacer(e))return t.yPos+e.height/2;if(od.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,od.isNextConnection(e)?t+e.height/2:t-e.height/2;if(od.isTopRow(t))return od.isHat(e)?t.capline-e.height/2:t.capline+e.height/2;let i=t.yPos;return od.isField(e)||od.isIcon(e)?(i+=e.height/2,(t.hasInlineInput||t.hasStatement)&&e.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=od.isInlineInput(e)?i+e.height/2:i+t.height/2,i}alignRowElements_(){if(this.isInline){var t=0,e=new WeakMap,i=null;for(let o,n=this.rows.length-1;o=this.rows[n];n--)e.set(o,t),od.isInputRow(o)&&(o.hasStatement&&this.alignStatementRow_(o),i&&i.hasStatement&&o.width<i.width?e.set(o,i.width):t=o.hasStatement?o.width:Math.max(t,o.width),i=o);t=0;for(let o,n=0;o=this.rows[n];n++)o.hasStatement?t=this.getDesiredRowWidth_(o):od.isSpacer(o)?o.width=Math.max(t,e.get(o)):(i=o.width,0<(t=Math.max(t,e.get(o))-i)&&this.addAlignmentPadding_(o,t),t=o.width)}else super.alignRowElements_()}getDesiredRowWidth_(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(t)}finalize_(){let t=0,e=0;for(let o,n=0;o=this.rows[n];n++){o.yPos=e,o.xPos=this.startX,e+=o.height,t=Math.max(t,o.widthWithConnectedBlocks);var i=e-this.topRow.ascenderHeight;o===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,e+=i),this.recordElemPositions_(o)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=e-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=e+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},ef=class extends Ud{constructor(t,e,i){super(t,e,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=tt(Cl.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=tt(Cl.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)}setHighlightPath(t){this.svgPathLight.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(t){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(t),this.svgPath.setAttribute("stroke","none")}setStyle(t){this.style=t,this.colourDark=po("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(t){if(t){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(t){super.updateDisabled_(t),t&&this.svgPath.setAttribute("stroke","none")}},of=class extends zd{constructor(t){super(t),this.highlightConstants=null}init(t,e){super.init(t,e),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(t,e){super.refreshDom(t,e),this.getHighlightConstants().init()}makeConstants_(){return new Yg}makeRenderInfo_(t){return new tf(this,t)}makeDrawer_(t,e){return new Jg(t,e)}makePathObject(t,e){return new ef(t,e,this.getConstants())}makeHighlightConstants_(){return new qg(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};ws("geras",of);var nf={};nf.ConstantProvider=Yg,nf.Drawer=Jg,nf.HighlightConstantProvider=qg,nf.Highlighter=Kg,nf.InlineInput=Zg,nf.PathObject=ef,nf.RenderInfo=tf,nf.Renderer=of,nf.StatementInput=Qg;var sf=class extends xd{constructor(t,e){super(t,e)}getRenderer(){return this.renderer_}addElemSpacing_(){let t=!1;for(var e=0;e<this.rows.length;e++)if(this.rows[e].hasExternalInput){t=!0;break}for(e=0;e<this.rows.length;e++){const o=this.rows[e];var i=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new pd(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let t=0;t<i.length-1;t++){o.elements.push(i[t]);const e=this.getInRowSpacing_(i[t],i[t+1]);o.elements.push(new pd(this.constants_,e))}o.elements.push(i[i.length-1]),o.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),t&&o.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),o.elements.push(new pd(this.constants_,i)))}}}getInRowSpacing_(t,e){if(!t)return e&&od.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&od.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&od.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!od.isInput(t)&&!e)return od.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:od.isIcon(t)?2*this.constants_.LARGE_PADDING+1:od.isHat(t)?this.constants_.NO_PADDING:od.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:od.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:od.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(od.isInput(t)&&!e){if(od.isExternalInput(t))return this.constants_.NO_PADDING;if(od.isInlineInput(t))return this.constants_.LARGE_PADDING;if(od.isStatementInput(t))return this.constants_.NO_PADDING}if(!od.isInput(t)&&e&&od.isInput(e)){if(od.isField(t)&&t.isEditable){if(od.isInlineInput(e)||od.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(od.isInlineInput(e)||od.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(od.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(od.isIcon(t)&&e&&!od.isInput(e))return this.constants_.LARGE_PADDING;if(od.isInlineInput(t)&&e&&od.isField(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(od.isLeftSquareCorner(t)&&e){if(od.isHat(e))return this.constants_.NO_PADDING;if(od.isPreviousConnection(e)||od.isNextConnection(e))return e.notchOffset}return od.isLeftRoundedCorner(t)&&e?e.notchOffset-this.constants_.CORNER_RADIUS:od.isField(t)&&e&&od.isField(e)&&t.isEditable===e.isEditable||e&&od.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,e){return od.isTopRow(t)&&od.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:od.isTopRow(t)||od.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,e){if(od.isSpacer(e))return t.yPos+e.height/2;if(od.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,od.isNextConnection(e)?t+e.height/2:t-e.height/2;if(od.isTopRow(t))return od.isHat(e)?t.capline-e.height/2:t.capline+e.height/2;let i=t.yPos;return od.isField(e)&&t.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+e.height/2):i+t.height/2}finalize_(){let t=0,e=0;for(var i=0;i<this.rows.length;i++){const n=this.rows[i];n.yPos=e,n.xPos=this.startX,e+=n.height,t=Math.max(t,n.widthWithConnectedBlocks);var o=e-this.topRow.ascenderHeight;n===this.bottomRow&&o<this.constants_.MIN_BLOCK_HEIGHT&&(o=this.constants_.MIN_BLOCK_HEIGHT-o,this.bottomRow.height+=o,e+=o),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,i.getHeightWidth().width)),this.bottomRow.baseline=e-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=e,this.startY=this.topRow.capline}},rf=class extends zd{constructor(t){super(t)}makeRenderInfo_(t){return new sf(this,t)}};ws("thrasos",rf);var af={};af.RenderInfo=sf,af.Renderer=rf;var lf=new $u("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),hf={Classic:Su,Zelos:lf},cf=class{constructor(t,e,i){this.id_=t.toolboxitemid||c(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=e,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(t){}},uf=class extends cf{constructor(t,e,i){super(t,e,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let e=0;e<t.length;e++){const i=t[e];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(t){this.name_="name"in t?vo(t.name):"",this.colour_=this.getColour_(t),Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),xe(this.htmlDiv_,Uh.TREEITEM),Le(this.htmlDiv_,Gh.SELECTED,!1),Le(this.htmlDiv_,Gh.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),xe(this.iconDom_,Uh.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const t=this.labelDom_.getAttribute("id");return t&&Le(this.htmlDiv_,Gh.LABELLEDBY,t),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const t=document.createElement("div"),e=this.cssConfig_.container;return e&&et(t,e),t}createRowContainer_(){const t=document.createElement("div");var e=this.cssConfig_.row;return e&&et(t,e),e=uf.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?t.style.paddingRight=e:t.style.paddingLeft=e,t}createRowContentsContainer_(){const t=document.createElement("div"),e=this.cssConfig_.rowcontentcontainer;return e&&et(t,e),t}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const e=this.cssConfig_.icon;e&&et(t,e)}return t.style.display="inline-block",t}createLabelDom_(t){const e=document.createElement("span");return e.setAttribute("id",this.getId()+".label"),e.textContent=t,(t=this.cssConfig_.label)&&et(e,t),e}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(t){t&&(t=uf.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)}getColour_(t){const e=t.categorystyle||t.categoryStyle;if((t=t.colour)&&e)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(e)return this.getColourfromStyle_(e);if(t)return this.parseColour_(t)}return""}getColourfromStyle_(t){var e=this.workspace_.getTheme();if(t&&e){if((e=e.categoryStyles[t])&&e.colour)return this.parseColour_(e.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(t){if(null==(t=vo(t))||""===t)return"";var e=Number(t);return isNaN(e)?(e=lo(t))?e:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):go(e)}openIcon_(t){if(t){var e=this.cssConfig_.closedicon;e&&it(t,e),(e=this.cssConfig_.openicon)&&et(t,e)}}closeIcon_(t){if(t){var e=this.cssConfig_.openicon;e&&it(t,e),(e=this.cssConfig_.closedicon)&&et(t,e)}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let t=this;for(;t.getParent();)if(t=t.getParent(),!t.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(t){}setSelected(t){if(this.rowDiv_){var e=this.cssConfig_.selected;if(t){const t=this.parseColour_(uf.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||t,e&&et(this.rowDiv_,e)}else this.rowDiv_.style.backgroundColor="",e&&ot(this.rowDiv_,e);Le(this.htmlDiv_,Gh.SELECTED,t)}}setDisabled(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",`${t}`),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(t){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof t?{kind:this.toolboxItemDef_.kind,custom:t,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Lt(t),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){st(this.htmlDiv_)}};uf.registrationName="category",uf.nestedPadding=19,uf.borderWidth=8,uf.defaultBackgroundColour="#57e",Z('\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n'),t(jr.TOOLBOX_ITEM,uf.registrationName,uf);var df=class extends cf{constructor(t,e){super(t,e),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}init(){this.createDom_()}createDom_(){const t=document.createElement("div"),e=this.cssConfig_.container;return e&&et(t,e),this.htmlDiv_=t}getDiv(){return this.htmlDiv_}dispose(){st(this.htmlDiv_)}};df.registrationName="sep",Z('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),t(jr.TOOLBOX_ITEM,df.registrationName,df);var pf=class extends uf{constructor(t,e,i){super(t,e,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const t=super.makeDefaultCssConfig_();return t.contents="blocklyToolboxContents",t}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else{const e=t.contents;if(e){this.flyoutItems_=[],t=!0;for(let i=0;i<e.length;i++){const o=e[i];!s(jr.TOOLBOX_ITEM,o.kind)||o.kind.toLowerCase()===df.registrationName&&t?(this.flyoutItems_.push(o),t=!0):(this.createToolboxItem_(o),t=!1)}}}}createToolboxItem_(t){let e=t.kind;"CATEGORY"===e.toUpperCase()&&Pt(t)&&(e=pf.registrationName),t=new(r(jr.TOOLBOX_ITEM,e))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),xe(this.subcategoriesDiv_,Uh.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Le(this.htmlDiv_,Gh.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const e=this.cssConfig_.icon;e&&et(t,e),t.style.visibility="visible"}return t.style.display="inline-block",t}createSubCategoriesDom_(t){const e=document.createElement("div");e.style.display="none";var i=this.cssConfig_.contents;for(i&&et(e,i),i=0;i<t.length;i++){const o=t[i];o.init();const n=o.getDiv();if(e.appendChild(n),o.getClickTarget){let t;null==(t=o.getClickTarget())||t.setAttribute("id",o.getId())}}return e}setExpanded(t){if(this.expanded_!==t){if(this.expanded_=t)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let t;null==(t=this.parentToolbox_.getFlyout())||t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}Le(this.htmlDiv_,Gh.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";const e=this.getChildToolboxItems();for(let i=0;i<e.length;i++)e[i].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(t){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};pf.registrationName="collapsibleCategory",t(jr.TOOLBOX_ITEM,pf.registrationName,pf);var gf=class extends wp{constructor(t){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.RTL=t.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition}onShortcut(t){return!1}init(){var t=this.workspace_;const e=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),rt(this.flyout_.createDom("svg"),e),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),(t=t.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[fl.Capability.AUTOHIDEABLE,fl.Capability.DELETE_AREA,fl.Capability.DRAG_TARGET]})}createDom_(t){t=t.getParentSvg();const e=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,xe(this.contentsDiv_,Uh.TREE),e.appendChild(this.contentsDiv_),t.parentNode.insertBefore(e,t),this.attachEvents_(e,this.contentsDiv_),e}createContainer_(){const t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),et(t,"blocklyToolboxDiv"),et(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t}createContentsContainer_(){const t=document.createElement("div");return et(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t}attachEvents_(t,e){t=W(t,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(t),e=W(e,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(e)}onClick_(t){if(Y(t)||t.target===this.HtmlDiv)C().hideChaff(!1);else{var e=t.target.getAttribute("id");e&&(e=this.getToolboxItemById(e)).isSelectable()&&(this.setSelectedItem(e),e.onClick(t)),C().hideChaff(!0)}H()}onKeyDown_(t){let e=!1;switch(t.key){case"ArrowDown":e=this.selectNext_();break;case"ArrowUp":e=this.selectPrevious_();break;case"ArrowLeft":e=this.selectParent_();break;case"ArrowRight":e=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),e=!0);break;default:e=!1}!e&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(e=this.selectedItem_.onKeyDown(t)),e&&t.preventDefault()}createFlyout_(){const t=this.workspace_,e=new Cu({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return e.toolboxPosition=t.options.toolboxPosition,new(t.horizontalLayout?h(jr.FLYOUTS_HORIZONTAL_TOOLBOX,t.options,!0):h(jr.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(e)}render(t){this.toolboxDef_=t;for(let t=0;t<this.contents_.length;t++){const e=this.contents_[t];e&&e.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){const e=document.createDocumentFragment();for(let i=0;i<t.length;i++)this.createToolboxItem_(t[i],e);this.contentsDiv_.appendChild(e)}createToolboxItem_(t,e){var i=t.kind;"CATEGORY"===i.toUpperCase()&&Pt(t)&&(i=pf.registrationName),(i=r(jr.TOOLBOX_ITEM,i.toLowerCase()))&&((t=new i(t,this)).init(),this.addToolboxItem_(t),(i=t.getDiv())&&e.appendChild(i),t.getClickTarget()&&t.getClickTarget().setAttribute("id",t.getId()))}addToolboxItem_(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible()){t=t.getChildToolboxItems();for(let e=0;e<t.length;e++)this.addToolboxItem_(t[e])}}getToolboxItems(){return this.contents_}addStyle(t){t&&this.HtmlDiv&&et(this.HtmlDiv,t)}removeStyle(t){t&&this.HtmlDiv&&ot(this.HtmlDiv,t)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect();const e=t.top,i=e+t.height,o=t.left;return t=o+t.width,this.toolboxPosition===zl.TOP?new Ol(-1e7,i,-1e7,1e7):this.toolboxPosition===zl.BOTTOM?new Ol(e,1e7,-1e7,1e7):this.toolboxPosition===zl.LEFT?new Ol(-1e7,1e7,-1e7,t):new Ol(-1e7,1e7,o,1e7)}wouldDelete(t){return t instanceof Tp?this.updateWouldDelete_(!t.getParent()&&t.isDeletable()):this.updateWouldDelete_(Fs(t)&&t.isDeletable()),this.wouldDelete_}onDragEnter(t){this.updateCursorDeleteStyle_(!0)}onDragExit(t){this.updateCursorDeleteStyle_(!1)}onDrop(t){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(t){const e=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(e):this.removeStyle(e)}getToolboxItemById(t){return this.contentMap_[t]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const t=this.workspace_.getMetrics(),e=this.HtmlDiv;e&&(this.horizontalLayout_?(e.style.left="0",e.style.height="auto",e.style.width="100%",this.height_=e.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition===zl.TOP?e.style.top="0":e.style.bottom="0"):(this.toolboxPosition===zl.RIGHT?e.style.right="0":e.style.left="0",e.style.height="100%",this.width_=e.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const t=this.workspace_,e=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition===zl.LEFT?t.scrollX+e.width:t.scrollX,this.toolboxPosition===zl.TOP?t.scrollY+e.height:t.scrollY),x(t)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let t=0;t<this.contents_.length;t++){const e=this.contents_[t];e.refreshTheme&&e.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())}autoHide(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(t){const e=this.selectedItem_;!t&&!e||t&&!Br(t)||(this.shouldDeselectItem_(e,t)&&null!==e&&this.deselectItem_(e),this.shouldSelectItem_(e,t)&&null!==t&&this.selectItem_(e,t),this.updateFlyout_(e,t),this.fireSelectEvent_(e,t))}shouldDeselectItem_(t,e){return null!==t&&(!t.isCollapsible()||t!==e)}shouldSelectItem_(t,e){return null!==e&&e!==t}deselectItem_(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),Le(this.contentsDiv_,Gh.ACTIVEDESCENDANT,"")}selectItem_(t,e){this.selectedItem_=e,this.previouslySelectedItem_=t,e.setSelected(!0),Le(this.contentsDiv_,Gh.ACTIVEDESCENDANT,e.getId())}selectItemByPosition(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t]).isSelectable()&&this.setSelectedItem(t)}updateFlyout_(t,e){e&&(t!==e||e.isCollapsible())&&e.getContents().length?(this.flyout_.show(e.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(t,e){const i=t&&t.getName();let o=e&&e.getName();t===e&&(o=null),t=new(E(la))(i,o,this.workspace_.id),p(t)}selectParent_(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){let e=this.contents_[t];for(;e&&!e.isSelectable();)e=this.contents_[++t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){let e=this.contents_[t];for(;e&&!e.isSelectable();)e=this.contents_[--t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)j(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),st(this.HtmlDiv))}};Z('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n'),t(jr.TOOLBOX,zr,gf);var ff=mu.INPUT_VALUE,mf=mu.OUTPUT_VALUE,vf=mu.NEXT_STATEMENT,bf=mu.PREVIOUS_STATEMENT,_f=zl.TOP,yf=zl.BOTTOM,Tf=zl.LEFT,Ef=zl.RIGHT;op.prototype.newBlock=function(t,e){return new Nd(this,t,e)},rp.prototype.newBlock=function(t,e){return new Tp(this,t,e)},op.prototype.newComment=function(t){return new Ah(this,t)},rp.prototype.newComment=function(t){return new uu(this,t)},rp.newTrashcan=function(t){return new kp(t)},Bu.prototype.newWorkspaceSvg=function(t){return new rp(t)},Ur.Names$$module$build$src$core$names.prototype.populateProcedures=function(t){t=(t=ns(t))[0].concat(t[1]);for(let e=0;e<t.length;e++)this.getName(t[e][0],Ur.Names$$module$build$src$core$names.NameType.PROCEDURE)};var wf={};return wf.ASTNode=Bd,wf.BasicCursor=dp,wf.Block=Nd,wf.BlockSvg=Tp,wf.Blocks=Ea,wf.COLLAPSED_FIELD_NAME=sh,wf.COLLAPSED_INPUT_NAME=nh,wf.COLLAPSE_CHARS=30,wf.CodeGenerator=Ur.CodeGenerator$$module$build$src$core$generator,wf.CollapsibleToolboxCategory=pf,wf.ComponentManager=fl,wf.Connection=Dd,wf.ConnectionChecker=Qd,wf.ConnectionDB=bu,wf.ConnectionType=mu,wf.ContextMenu=au,wf.ContextMenuItems=zg,wf.ContextMenuRegistry=lu,wf.Css=bl,wf.Cursor=up,wf.DELETE_VARIABLE_ID=Zd,wf.DeleteArea=wp,wf.DragTarget=Ep,wf.DropDownDiv=Ec,wf.Events=Vg,wf.Extensions=Uu,wf.Field=Xc,wf.FieldCheckbox=$g,wf.FieldDropdown=xu,wf.FieldImage=ng,wf.FieldLabel=Cd,wf.FieldLabelSerializable=Ig,wf.FieldNumber=kg,wf.FieldTextInput=rg,wf.FieldVariable=wg,wf.Flyout=yg,wf.FlyoutButton=Pd,wf.FlyoutMetricsManager=_g,wf.Generator=Ur.CodeGenerator$$module$build$src$core$generator,wf.Gesture=wu,wf.Grid=ku,wf.HorizontalFlyout=Eg,wf.INPUT_VALUE=ff,wf.Input=Od,wf.InsertionMarkerManager=Gd,wf.InsertionMarkerPreviewer=fg,wf.Marker=cp,wf.MarkerManager=wc,wf.Menu=jh,wf.MenuItem=Xh,wf.MetricsManager=eg,wf.Msg=Ur.Msg$$module$build$src$core$msg,wf.NEXT_STATEMENT=vf,wf.Names=Ur.Names$$module$build$src$core$names,wf.OPPOSITE_TYPE=Jd,wf.OUTPUT_VALUE=mf,wf.Options=Cu,wf.PREVIOUS_STATEMENT=bf,wf.PROCEDURE_CATEGORY_NAME=td,wf.Procedures=ed,wf.RENAME_VARIABLE_ID=qd,wf.RenderedConnection=gp,wf.Scrollbar=Nl,wf.ScrollbarPair=tg,wf.ShortcutItems=Yp,wf.ShortcutRegistry=Fp,wf.TOOLBOX_AT_BOTTOM=yf,wf.TOOLBOX_AT_LEFT=Tf,wf.TOOLBOX_AT_RIGHT=Ef,wf.TOOLBOX_AT_TOP=_f,wf.TabNavigateCursor=pp,wf.Theme=$u,wf.ThemeManager=Xd,wf.Themes=hf,wf.Toolbox=gf,wf.ToolboxCategory=uf,wf.ToolboxItem=cf,wf.ToolboxSeparator=df,wf.Tooltip=Uc,wf.Touch=el,wf.Trashcan=kp,wf.UnattachedFieldError=Yc,wf.VARIABLE_CATEGORY_NAME=yh,wf.VARIABLE_DYNAMIC_CATEGORY_NAME=Yd,wf.VERSION="11.1.1",wf.VariableMap=ip,wf.VariableModel=_h,wf.Variables=wh,wf.VariablesDynamic=Kd,wf.VerticalFlyout=Tg,wf.WidgetDiv=ou,wf.Workspace=op,wf.WorkspaceAudio=np,wf.WorkspaceDragger=Eu,wf.WorkspaceSvg=rp,wf.Xml=du,wf.ZoomControls=oh,wf.blockAnimations=Tu,wf.blockRendering=jd,wf.browserEvents=dl,wf.bubbles=Xg,wf.bumpObjects=_p,wf.clipboard=Wp,wf.comments=jg,wf.common=xa,wf.config=Ur.config$$module$build$src$core$config,wf.constants=ah,wf.defineBlocksWithJsonArray=N,wf.dialog=fh,wf.dragging=Cg,wf.fieldRegistry=Mu,wf.geras=nf,wf.getMainWorkspace=C,wf.getSelected=R,wf.hasBubble=si,wf.hideChaff=Fr,wf.icons=id,wf.inject=or,wf.inputs=mg,wf.isCopyable=Ws,wf.isDeletable=Fs,wf.isDraggable=wn,wf.isIcon=ys,wf.isObservable=$n,wf.isPaster=Dr,wf.isRenderedElement=Nr,wf.isSelectable=Pr,wf.isSerializable=De,wf.isVariableBackedParameterModel=Zt,wf.procedures=ed,wf.registry=Xr,wf.renderManagement=Rh,wf.serialization=Qp,wf.setLocale=hh,wf.setParentContainer=M,wf.svgResize=x,wf.thrasos=af,wf.uiPosition=Ql,wf.utils=ju,wf.zelos=Wg,wf.__namespace__=Ur,wf})?o.apply(e,[]):o)||(t.exports=n)},822:function(t,e,i){var o,n,s;n=[i(500)],void 0===(s="function"==typeof(o=function(t){var e=t.__namespace__,i=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),o={customContextMenu:function(t){if(this.isInFlyout)"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(o={text:e.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:n(this)},r=this.getField("VAR").getText(),r={text:e.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:s(this)},t.unshift(o),t.unshift(r));else{if("variables_get_dynamic"===this.type)var i="variables_set_dynamic",o=e.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else i="variables_get_dynamic",o=e.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var r=this.getField("VAR");i={type:i,fields:{VAR:r.saveState(!0)}},t.push({enabled:0<this.workspace.remainingCapacity(),text:o.replace("%1",r.getText()),callback:e.callbackFactory$$module$build$src$core$contextmenu(this,i)})}},onchange:function(t){t=this.getFieldValue("VAR"),t=e.getVariable$$module$build$src$core$variables(this.workspace,t),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(t.type):this.getInput("VALUE").connection.setCheck(t.type)}},n=function(t){return function(){const i=t.workspace,o=t.getField("VAR").getVariable();e.renameVariable$$module$build$src$core$variables(i,o)}},s=function(t){return function(){const e=t.workspace,i=t.getField("VAR").getVariable();e.deleteVariableById(i.getId()),e.refreshToolboxSelection()}};e.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",o),e.defineBlocks$$module$build$src$core$common(i);var r={blocks:i},a=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),l={customContextMenu:function(t){if(this.isInFlyout)"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(o={text:e.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:h(this)},n=this.getField("VAR").getText(),n={text:e.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",n),enabled:!0,callback:c(this)},t.unshift(o),t.unshift(n));else{if("variables_get"===this.type)var i="variables_set",o=e.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else i="variables_get",o=e.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var n=this.getField("VAR");i={type:i,fields:{VAR:n.saveState(!0)}},t.push({enabled:0<this.workspace.remainingCapacity(),text:o.replace("%1",n.getText()),callback:e.callbackFactory$$module$build$src$core$contextmenu(this,i)})}}},h=function(t){return function(){const i=t.workspace,o=t.getField("VAR").getVariable();e.renameVariable$$module$build$src$core$variables(i,o)}},c=function(t){return function(){const e=t.workspace,i=t.getField("VAR").getVariable();e.deleteVariableById(i.getId()),e.refreshToolboxSelection()}};e.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",l),e.defineBlocks$$module$build$src$core$common(a);var u={blocks:a},d=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),p={init:function(){this.WHERE_OPTIONS_1=[[e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");var i=this.getInput("AT1")instanceof e.ValueInput$$module$build$src$core$inputs$value_input;return t.setAttribute("at1",`${i}`),i=this.getInput("AT2")instanceof e.ValueInput$$module$build$src$core$inputs$value_input,t.setAttribute("at2",`${i}`),t},domToMutation:function(t){const e="true"===t.getAttribute("at1");t="true"===t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(t,i){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),i?(this.appendValueInput("AT"+t).setCheck("Number"),e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t),2===t&&e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const o=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+t]});o.setValidator((function(e){const o="FROM_START"===e||"FROM_END"===e;if(o!==i){const i=this.getSourceBlock();return i.updateAt_(t,o),i.setFieldValue(e,"WHERE"+t),null}})),this.getInput("AT"+t).appendField(o,"WHERE"+t),1===t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};d.text_getSubstring=p,d.text_changeCase={init:function(){const t=[[e.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[e.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[e.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(e.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},d.text_trim={init:function(){const t=[[e.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[e.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[e.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(e.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},d.text_print={init:function(){this.jsonInit({message0:e.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:e.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:e.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var g={updateType_:function(t){this.outputConnection.setCheck("NUMBER"===t?"Number":"String")},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("type",this.getFieldValue("TYPE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("type"))}};d.text_prompt_ext=Object.assign({},g,{init:function(){var t=[[e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(e.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(t=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t})).setValidator((t=>{this.updateType_(t)})),this.appendValueInput("TEXT").appendField(t,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});var f=Object.assign({},g,{init:function(){this.mixin(m);var t=[[e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(e.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(t=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t})).setValidator((t=>{this.updateType_(t)})),this.appendDummyInput().appendField(t,"TYPE").appendField(this.newQuote_(!0)).appendField(e.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});d.text_prompt=f,d.text_count={init:function(){this.jsonInit({message0:e.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:e.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:e.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},d.text_replace={init:function(){this.jsonInit({message0:e.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:e.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:e.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},d.text_reverse={init:function(){this.jsonInit({message0:e.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:e.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:e.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var m={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(t){for(let e,i=0;e=this.inputList[i];i++)for(let i,o=0;i=e.fieldRow[o];o++)if(t===i.name)return e.insertFieldAt(o,this.newQuote_(!0)),void e.insertFieldAt(o+2,this.newQuote_(!1));console.warn('field named "'+t+'" not found in '+this.toDevString())},newQuote_:function(t){return t=this.RTL?!t:t,e.fromJson$$module$build$src$core$field_registry({type:"field_image",src:t?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:t?"â":"â"})}},v={itemCount_:0,mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("items",`${this.itemCount_}`),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(t){this.itemCount_=t.itemCount,this.updateShape_()},decompose:function(t){const e=t.newBlock("text_create_join_container");e.initSvg();let i=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){const e=t.newBlock("text_create_join_item");e.initSvg(),i.connect(e.previousConnection),i=e.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e;)e.isInsertionMarker()||t.push(e.valueConnection_),e=e.getNextBlock();for(e=0;e<this.itemCount_;e++){const i=this.getInput("ADD"+e).connection.targetConnection;i&&!t.includes(i)&&i.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++){let i;null==(i=t[e])||i.reconnect(this,"ADD"+e)}},saveConnections:function(t){t=t.getInputTargetBlock("STACK");let e=0;for(;t;){if(t.isInsertionMarker()){t=t.getNextBlock();continue}const i=this.getInput("ADD"+e);t.valueConnection_=i&&i.connection.targetConnection,t=t.getNextBlock(),e++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){const i=this.appendValueInput("ADD"+t).setAlign(e.Align$$module$build$src$core$inputs$align.RIGHT);0===t&&i.appendField(e.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(t=this.itemCount_;this.getInput("ADD"+t);t++)this.removeInput("ADD"+t)}};e.register$$module$build$src$core$extensions("text_append_tooltip",e.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var b={isAt_:!1,mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("at",`${this.isAt_}`),t},domToMutation:function(t){t="false"!==t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(t){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),t&&(this.appendValueInput("AT").setCheck("Number"),e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),e.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=t}};e.register$$module$build$src$core$extensions("text_indexOf_tooltip",(function(){this.setTooltip((()=>e.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))})),e.register$$module$build$src$core$extensions("text_quotes",(function(){this.mixin(m),this.quoteField_("TEXT")})),e.registerMixin$$module$build$src$core$extensions("quote_image_mixin",m),e.registerMutator$$module$build$src$core$extensions("text_join_mutator",v,(function(){this.mixin(m),this.itemCount_=2,this.updateShape_(),this.setMutator(new e.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))})),e.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",b,(function(){this.getField("WHERE").setValidator((function(t){t="FROM_START"===t||"FROM_END"===t;const e=this.getSourceBlock();t!==e.isAt_&&e.updateAt_(t)})),this.updateAt_(!0),this.setTooltip((()=>{var t=this.getFieldValue("WHERE");let i=e.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===t||"FROM_END"===t)&&(t="FROM_START"===t?e.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(i+="  "+t.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i}))})),e.defineBlocks$$module$build$src$core$common(d);var _={blocks:d},y={},T={setStatements_:function(t){this.hasStatements_!==t&&(t?(this.appendStatementInput("STACK").appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=t)},updateParams_:function(){let t="";this.arguments_.length&&(t=e.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),e.disable$$module$build$src$core$events$utils();try{this.setFieldValue(t,"PARAMS")}finally{e.enable$$module$build$src$core$events$utils()}},mutationToDom:function(t){const i=e.createElement$$module$build$src$core$utils$xml("mutation");t&&i.setAttribute("name",this.getFieldValue("NAME"));for(let o=0;o<this.argumentVarModels_.length;o++){const n=e.createElement$$module$build$src$core$utils$xml("arg"),s=this.argumentVarModels_[o];n.setAttribute("name",s.name),n.setAttribute("varid",s.getId()),t&&this.paramIds_&&n.setAttribute("paramId",this.paramIds_[o]),i.appendChild(n)}return this.hasStatements_||i.setAttribute("statements","false"),i},domToMutation:function(t){this.arguments_=[],this.argumentVarModels_=[];for(let o,n=0;o=t.childNodes[n];n++)if("arg"===o.nodeName.toLowerCase()){var i=o;const t=i.getAttribute("name");i=i.getAttribute("varid")||i.getAttribute("varId"),this.arguments_.push(t),null!==(i=e.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,i,t,""))?this.argumentVarModels_.push(i):console.log(`Failed to create a variable named "${t}", ignoring.`)}this.updateParams_(),e.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==t.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const t=Object.create(null);if(this.argumentVarModels_.length){t.params=[];for(let e=0;e<this.argumentVarModels_.length;e++)t.params.push({name:this.argumentVarModels_[e].name,id:this.argumentVarModels_[e].getId()})}return this.hasStatements_||(t.hasStatements=!1),t},loadExtraState:function(t){if(this.arguments_=[],this.argumentVarModels_=[],t.params)for(let o=0;o<t.params.length;o++){var i=t.params[o];i=e.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,i.id,i.name,""),this.arguments_.push(i.name),this.argumentVarModels_.push(i)}this.updateParams_(),e.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==t.hasStatements)},decompose:function(t){const i=e.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_mutatorcontainer");var o=e.createElement$$module$build$src$core$utils$xml("statement");o.setAttribute("name","STACK"),i.appendChild(o);for(let t=0;t<this.arguments_.length;t++){const i=e.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_mutatorarg");var n=e.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME");const s=e.createTextNode$$module$build$src$core$utils$xml(this.arguments_[t]);n.appendChild(s),i.appendChild(n),n=e.createElement$$module$build$src$core$utils$xml("next"),i.appendChild(n),o.appendChild(i),o=n}return t=e.domToBlock$$module$build$src$core$xml(i,t),"procedures_defreturn"===this.type?t.setFieldValue(this.hasStatements_,"STATEMENTS"):t.removeInput("STATEMENT_INPUT"),e.mutateCallers$$module$build$src$core$procedures(this),t},compose:function(t){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let i=t.getInputTargetBlock("STACK");for(;i&&!i.isInsertionMarker();){var o=i.getFieldValue("NAME");this.arguments_.push(o),o=this.workspace.getVariable(o,""),this.argumentVarModels_.push(o),this.paramIds_.push(i.id),i=i.nextConnection&&i.nextConnection.targetBlock()}if(this.updateParams_(),e.mutateCallers$$module$build$src$core$procedures(this),null!==(t=t.getFieldValue("STATEMENTS"))&&(t="TRUE"===t,this.hasStatements_!==t))if(t){var n;this.setStatements_(!0),null==(n=this.statementConnection_)||n.reconnect(this,"STACK"),this.statementConnection_=null}else n=this.getInput("STACK").connection,(this.statementConnection_=n.targetConnection)&&((n=n.targetBlock()).unplug(),n.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(t,i){var o=this.workspace.getVariableById(t);if(""===o.type){o=o.name,i=this.workspace.getVariableById(i);var n=!1;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===t&&(this.arguments_[e]=i.name,this.argumentVarModels_[e]=i,n=!0);n&&(this.displayRenamedVar_(o,i.name),e.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(t){const i=t.name;let o,n=!1;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===t.getId()&&(o=this.arguments_[e],this.arguments_[e]=i,n=!0);n&&(this.displayRenamedVar_(o,i),e.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(t,i){this.updateParams_();var o=this.getIcon(e.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(o&&o.bubbleIsVisible()){o=o.getWorkspace().getAllBlocks(!1);for(let n,s=0;n=o[s];s++)"procedures_mutatorarg"===n.type&&e.Names$$module$build$src$core$names.equals(t,n.getFieldValue("NAME"))&&n.setFieldValue(i,"NAME")}},customContextMenu:function(t){if(!this.isInFlyout){var i=this.getFieldValue("NAME"),o={type:this.callType_,extraState:{name:i,params:this.arguments_}};if(t.push({enabled:!0,text:e.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",i),callback:e.callbackFactory$$module$build$src$core$contextmenu(this,o)}),!this.isCollapsed())for(i=0;i<this.argumentVarModels_.length;i++){const n={type:"variables_get",fields:{VAR:{name:(o=this.argumentVarModels_[i]).name,id:o.getId(),type:o.type}}};t.push({enabled:!0,text:e.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",o.name),callback:e.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}}};y.procedures_defnoreturn=Object.assign({},T,{init:function(){var t=e.findLegalName$$module$build$src$core$procedures("",this);(t=e.fromJson$$module$build$src$core$field_registry({type:"field_input",text:t})).setValidator(e.rename$$module$build$src$core$procedures),t.setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.setMutator(new e.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),y.procedures_defreturn=Object.assign({},T,{init:function(){var t=e.findLegalName$$module$build$src$core$procedures("",this);(t=e.fromJson$$module$build$src$core$field_registry({type:"field_input",text:t})).setValidator(e.rename$$module$build$src$core$procedures),t.setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(e.Align$$module$build$src$core$inputs$align.RIGHT).appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new e.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var E={init:function(){this.appendDummyInput().appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(e.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};y.procedures_mutatorcontainer=E;var w={init:function(){const t=e.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e.DEFAULT_ARG$$module$build$src$core$procedures});t.setValidator(this.validator_),t.oldShowEditorFn_=t.showEditor_,t.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(t,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,t.onFinishEditing_=this.deleteIntermediateVars_,t.createdVariables_=[],t.onFinishEditing_("x")},validator_:function(t){var e=this.getSourceBlock();const i=e.workspace.getRootWorkspace();if(!(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const o=(e.workspace.targetWorkspace||e.workspace).getAllBlocks(!1),n=t.toLowerCase();for(let t=0;t<o.length;t++){if(o[t].id===this.getSourceBlock().id)continue;const e=o[t].getFieldValue("NAME");if(e&&e.toLowerCase()===n)return null}return e.isInFlyout||((e=i.getVariable(t,""))&&e.name!==t&&i.renameVariableById(e.getId(),t),e||(e=i.createVariable(t,""))&&this.createdVariables_&&this.createdVariables_.push(e)),t},deleteIntermediateVars_:function(t){const e=this.getSourceBlock().workspace.getRootWorkspace();if(e)for(let i=0;i<this.createdVariables_.length;i++){const o=this.createdVariables_[i];o.name!==t&&e.deleteVariableById(o.getId())}}};y.procedures_mutatorarg=w;var k={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(t,i){e.Names$$module$build$src$core$names.equals(t,this.getProcedureCall())&&(this.setFieldValue(i,"NAME"),this.setTooltip((this.outputConnection?e.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:e.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",i)))},setProcedureParameters_:function(t,i){var o=e.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((o=(o=o&&o.getIcon(e.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&o.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),t.join("\n")===this.arguments_.join("\n"))this.quarkIds_=i;else{if(i.length!==t.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let t=0;t<this.arguments_.length;t++){var n=this.getInput("ARG"+t);n&&(n=n.connection.targetConnection,this.quarkConnections_[this.quarkIds_[t]]=n,o&&n&&!i.includes(this.quarkIds_[t])&&(n.disconnect(),n.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(t),this.argumentVarModels_=[],t=0;t<this.arguments_.length;t++)o=e.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[t],""),this.argumentVarModels_.push(o);if(this.updateShape_(),this.quarkIds_=i)for(i=0;i<this.arguments_.length;i++)if((t=this.quarkIds_[i])in this.quarkConnections_){let e;null!=(e=this.quarkConnections_[t])&&e.reconnect(this,"ARG"+i)||delete this.quarkConnections_[t]}}},updateShape_:function(){for(var t=0;t<this.arguments_.length;t++){var i=this.getField("ARGNAME"+t);if(i){e.disable$$module$build$src$core$events$utils();try{i.setValue(this.arguments_[t])}finally{e.enable$$module$build$src$core$events$utils()}}else i=e.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[t]}),this.appendValueInput("ARG"+t).setAlign(e.Align$$module$build$src$core$inputs$align.RIGHT).appendField(i,"ARGNAME"+t)}for(t=this.arguments_.length;this.getInput("ARG"+t);t++)this.removeInput("ARG"+t);(t=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||t.appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&t.removeField("WITH"))},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");t.setAttribute("name",this.getProcedureCall());for(let i=0;i<this.arguments_.length;i++){const o=e.createElement$$module$build$src$core$utils$xml("arg");o.setAttribute("name",this.arguments_[i]),t.appendChild(o)}return t},domToMutation:function(t){var e=t.getAttribute("name");this.renameProcedure(this.getProcedureCall(),e),e=[];const i=[];for(let o,n=0;o=t.childNodes[n];n++)"arg"===o.nodeName.toLowerCase()&&(e.push(o.getAttribute("name")),i.push(o.getAttribute("paramId")));this.setProcedureParameters_(e,i)},saveExtraState:function(){const t=Object.create(null);return t.name=this.getProcedureCall(),this.arguments_.length&&(t.params=this.arguments_),t},loadExtraState:function(t){if(this.renameProcedure(this.getProcedureCall(),t.name),t=t.params){const e=[];e.length=t.length,e.fill(null),this.setProcedureParameters_(t,e)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&t.recordUndo)if(t.type===e.CREATE$$module$build$src$core$events$utils&&t.ids.includes(this.id)){var i=this.getProcedureCall();if(!(i=e.getDefinition$$module$build$src$core$procedures(i,this.workspace))||i.type===this.defType_&&JSON.stringify(i.getVars())===JSON.stringify(this.arguments_)||(i=null),!i){e.setGroup$$module$build$src$core$events$utils(t.group),t=e.createElement$$module$build$src$core$utils$xml("xml"),(i=e.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var o=this.getRelativeToSurfaceXY(),n=o.y+2*e.config$$module$build$src$core$config.snapRadius;i.setAttribute("x",`${o.x+e.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),i.setAttribute("y",`${n}`),o=this.mutationToDom(),i.appendChild(o),(o=e.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n=this.getProcedureCall();const s=e.findLegalName$$module$build$src$core$procedures(n,this);n!==s&&this.renameProcedure(n,s),o.appendChild(e.createTextNode$$module$build$src$core$utils$xml(n)),i.appendChild(o),t.appendChild(i),e.domToWorkspace$$module$build$src$core$xml(t,this.workspace),e.setGroup$$module$build$src$core$events$utils(!1)}}else t.type===e.DELETE$$module$build$src$core$events$utils?(i=this.getProcedureCall(),e.getDefinition$$module$build$src$core$procedures(i,this.workspace)||(e.setGroup$$module$build$src$core$events$utils(t.group),this.dispose(!0),e.setGroup$$module$build$src$core$events$utils(!1))):t.type===e.CHANGE$$module$build$src$core$events$utils&&"disabled"===t.element&&(i=this.getProcedureCall(),(n=e.getDefinition$$module$build$src$core$procedures(i,this.workspace))&&n.id===t.blockId&&((o=e.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),e.setGroup$$module$build$src$core$events$utils(t.group),t=n.isEnabled(),this.setDisabledReason(!t,"DISABLED_PROCEDURE_DEFINITION"),this.setWarningText(t?null:e.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",i)),e.setGroup$$module$build$src$core$events$utils(o)))},customContextMenu:function(t){if(this.workspace.isMovable()){var i=this.getProcedureCall(),o=this.workspace;t.push({enabled:!0,text:e.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const t=e.getDefinition$$module$build$src$core$procedures(i,o);t&&(o.centerOnBlock(t.id),e.setSelected$$module$build$src$core$common(t))}})}}};y.procedures_callnoreturn=Object.assign({},k,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(e.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),y.procedures_callreturn=Object.assign({},k,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(e.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});var I={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(e.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(e.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("value",String(Number(this.hasReturnValue_))),t},domToMutation:function(t){this.hasReturnValue_="1"===t.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(t){if(!(this.workspace.isDragging&&this.workspace.isDragging()||t.type!==e.MOVE$$module$build$src$core$events$utils&&t.type!==e.CREATE$$module$build$src$core$events$utils)){t=!1;var i=this;do{if(this.FUNCTION_TYPES.includes(i.type)){t=!0;break}i=i.getSurroundParent()}while(i);if(t?("procedures_defnoreturn"===i.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==i.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(e.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(e.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{e.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!t,"UNPARENTED_IFRETURN")}finally{e.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};y.procedures_ifreturn=I,e.defineBlocks$$module$build$src$core$common(y);var $={blocks:y},S=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["Ï","PI"],["e","E"],["Ï","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(Â½)","SQRT1_2"],["â","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);e.register$$module$build$src$core$extensions("math_op_tooltip",e.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"}));var C={mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation"),i="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return t.setAttribute("divisor_input",String(i)),t},domToMutation:function(t){t="true"===t.getAttribute("divisor_input"),this.updateShape_(t)},updateShape_:function(t){const e=this.getInput("DIVISOR");t?e||this.appendValueInput("DIVISOR").setCheck("Number"):e&&this.removeInput("DIVISOR")}};e.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",C,(function(){this.getField("PROPERTY").setValidator((function(t){t="DIVISIBLE_BY"===t,this.getSourceBlock().updateShape_(t)}))})),e.register$$module$build$src$core$extensions("math_change_tooltip",e.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var O={updateType_:function(t){"MODE"===t?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("op",this.getFieldValue("OP")),t},domToMutation:function(t){if(null===(t=t.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(t)}};e.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",O,(function(){this.getField("OP").setValidator(function(t){this.updateType_(t)}.bind(this))})),e.defineBlocks$$module$build$src$core$common(S);var R={blocks:S},A=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);e.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",e.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"}));e.register$$module$build$src$core$extensions("controls_flow_tooltip",e.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"}));var M={customContextMenu:function(t){if(!this.isInFlyout){var i=this.getField("VAR"),o=i.getVariable().name;this.isCollapsed()||null===o||(i={type:"variables_get",fields:{VAR:i.saveState(!0)}},t.push({enabled:!0,text:e.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",o),callback:e.callbackFactory$$module$build$src$core$contextmenu(this,i)}))}}};e.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",M),e.register$$module$build$src$core$extensions("controls_for_tooltip",e.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),e.register$$module$build$src$core$extensions("controls_forEach_tooltip",e.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var x=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),L={getSurroundLoop:function(){let t=this;do{if(x.has(t.type))return t;t=t.getSurroundParent()}while(t);return null},onchange:function(t){const i=this.workspace;if(i.isDragging&&!i.isDragging()&&(t.type===e.MOVE$$module$build$src$core$events$utils||t.type===e.CREATE$$module$build$src$core$events$utils)&&(t=!!this.getSurroundLoop(),this.setWarningText(t?null:e.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{e.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!t,"CONTROL_FLOW_NOT_IN_LOOP")}finally{e.setRecordUndo$$module$build$src$core$events$utils(!0)}}};e.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",L),e.defineBlocks$$module$build$src$core$common(A);var D={blocks:A,loopTypes:x},N=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["â ","NEQ"],["â<","LT"],["ââ¤","LTE"],["â>","GT"],["ââ¥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);e.register$$module$build$src$core$extensions("logic_op_tooltip",e.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"}));var P={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const t=e.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&t.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&t.setAttribute("else","1"),t},domToMutation:function(t){this.elseifCount_=parseInt(t.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(t.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const t=Object.create(null);return this.elseifCount_&&(t.elseIfCount=this.elseifCount_),this.elseCount_&&(t.hasElse=!0),t},loadExtraState:function(t){this.elseifCount_=t.elseIfCount||0,this.elseCount_=t.hasElse?1:0,this.updateShape_()},decompose:function(t){const e=t.newBlock("controls_if_if");e.initSvg();let i=e.nextConnection;for(let e=1;e<=this.elseifCount_;e++){const e=t.newBlock("controls_if_elseif");e.initSvg(),i.connect(e.previousConnection),i=e.nextConnection}return this.elseCount_&&((t=t.newBlock("controls_if_else")).initSvg(),i.connect(t.previousConnection)),e},compose:function(t){t=t.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const e=[null],i=[null];let o=null;for(;t;){if(!t.isInsertionMarker())switch(t.type){case"controls_if_elseif":this.elseifCount_++,e.push(t.valueConnection_),i.push(t.statementConnection_);break;case"controls_if_else":this.elseCount_++,o=t.statementConnection_;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(e,i,o)},saveConnections:function(t){t=t.nextConnection.targetBlock();let e=1;for(;t;){if(!t.isInsertionMarker())switch(t.type){case"controls_if_elseif":var i=this.getInput("IF"+e);const o=this.getInput("DO"+e);t.valueConnection_=i&&i.connection.targetConnection,t.statementConnection_=o&&o.connection.targetConnection,e++;break;case"controls_if_else":i=this.getInput("ELSE"),t.statementConnection_=i&&i.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.getNextBlock()}},rebuildShape_:function(){const t=[null],e=[null];let i=null;this.getInput("ELSE")&&(i=this.getInput("ELSE").connection.targetConnection);for(let i=1;this.getInput("IF"+i);i++){const o=this.getInput("IF"+i),n=this.getInput("DO"+i);t.push(o.connection.targetConnection),e.push(n.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(t,e,i)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var t=1;this.getInput("IF"+t);t++)this.removeInput("IF"+t),this.removeInput("DO"+t);for(t=1;t<=this.elseifCount_;t++)this.appendValueInput("IF"+t).setCheck("Boolean").appendField(e.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+t).appendField(e.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(e.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(t,e,i){for(let i=1;i<=this.elseifCount_;i++){let o,n;null==(o=t[i])||o.reconnect(this,"IF"+i),null==(n=e[i])||n.reconnect(this,"DO"+i)}null==i||i.reconnect(this,"ELSE")}};e.registerMutator$$module$build$src$core$extensions("controls_if_mutator",P,null,["controls_if_elseif","controls_if_else"]);e.register$$module$build$src$core$extensions("controls_if_tooltip",(function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?e.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?e.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?e.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":e.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))}));var B={onchange:function(t){this.prevBlocks_||(this.prevBlocks_=[null,null]);var i=this.getInputTargetBlock("A");const o=this.getInputTargetBlock("B");i&&o&&!this.workspace.connectionChecker.doTypeChecks(i.outputConnection,o.outputConnection)&&(e.setGroup$$module$build$src$core$events$utils(t.group),(t=this.prevBlocks_[0])!==i&&(i.unplug(),!t||t.isDisposed()||t.isShadow()||this.getInput("A").connection.connect(t.outputConnection)),(i=this.prevBlocks_[1])!==o&&(o.unplug(),!i||i.isDisposed()||i.isShadow()||this.getInput("B").connection.connect(i.outputConnection)),this.bumpNeighbours(),e.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};e.register$$module$build$src$core$extensions("logic_compare",(function(){this.mixin(B)}));var F={prevParentConnection_:null,onchange:function(t){const i=this.getInputTargetBlock("THEN"),o=this.getInputTargetBlock("ELSE"),n=this.outputConnection.targetConnection;if((i||o)&&n)for(let s=0;2>s;s++){const r=1===s?i:o;r&&!r.workspace.connectionChecker.doTypeChecks(r.outputConnection,n)&&(e.setGroup$$module$build$src$core$events$utils(t.group),n===this.prevParentConnection_?(this.unplug(),n.getSourceBlock().bumpNeighbours()):(r.unplug(),r.bumpNeighbours()),e.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=n}};e.registerMixin$$module$build$src$core$extensions("logic_ternary",F),e.defineBlocks$$module$build$src$core$common(N);var H={blocks:N},U=e.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),G={init:function(){this.setHelpUrl(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new e.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("items",String(this.itemCount_)),t},domToMutation:function(t){if(!(t=t.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(t,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(t){this.itemCount_=t.itemCount,this.updateShape_()},decompose:function(t){const e=t.newBlock("lists_create_with_container");e.initSvg();let i=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){const e=t.newBlock("lists_create_with_item");if(e.initSvg(),!e.previousConnection)throw Error("itemBlock has no previousConnection");i.connect(e.previousConnection),i=e.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e;)e.isInsertionMarker()||t.push(e.valueConnection_),e=e.getNextBlock();for(e=0;e<this.itemCount_;e++){const i=this.getInput("ADD"+e).connection.targetConnection;i&&!t.includes(i)&&i.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++){let i;null==(i=t[e])||i.reconnect(this,"ADD"+e)}},saveConnections:function(t){t=t.getInputTargetBlock("STACK");let e=0;for(;t;){if(t.isInsertionMarker()){t=t.getNextBlock();continue}const i=this.getInput("ADD"+e);let o;t.valueConnection_=null==(o=i)?void 0:o.connection.targetConnection,t=t.getNextBlock(),e++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(e.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){const i=this.appendValueInput("ADD"+t).setAlign(e.Align$$module$build$src$core$inputs$align.RIGHT);0===t&&i.appendField(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(t=this.itemCount_;this.getInput("ADD"+t);t++)this.removeInput("ADD"+t)}};U.lists_create_with=G;var V={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};U.lists_create_with_container=V;var W={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};U.lists_create_with_item=W;var z={init:function(){var t=[[e.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[e.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(e.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(t=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(t,"END"),this.setInputsInline(!0),this.setTooltip((()=>e.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))}};U.lists_indexOf=z;var j={init:function(){var t=[[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(t=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t})).setValidator((function(t){t="REMOVE"===t,this.getSourceBlock().updateStatement_(t)})),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(t,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip((()=>{const t=this.getFieldValue("MODE"),i=this.getFieldValue("WHERE");let o="";switch(t+" "+i){case"GET FROM_START":case"GET FROM_END":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":o=e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==i&&"FROM_END"!==i||(o+="  "+("FROM_START"===i?e.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),o}))},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");t.setAttribute("statement",String(!this.outputConnection));const i=this.getInput("AT")instanceof e.ValueInput$$module$build$src$core$inputs$value_input;return t.setAttribute("at",String(i)),t},domToMutation:function(t){const e="true"===t.getAttribute("statement");this.updateStatement_(e),t="false"!==t.getAttribute("at"),this.updateAt_(t)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(t){t.isStatement?this.updateStatement_(!0):"string"==typeof t&&this.domToMutation(e.textToDom$$module$build$src$core$utils$xml(t))},updateStatement_:function(t){t!==!this.outputConnection&&(this.unplug(!0,!0),t?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const i=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});i.setValidator((function(e){const i="FROM_START"===e||"FROM_END"===e;if(i!==t){const t=this.getSourceBlock();return t.updateAt_(i),t.setFieldValue(e,"WHERE"),null}})),this.getInput("AT").appendField(i,"WHERE"),e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};U.lists_getIndex=j;var X={init:function(){var t=[[e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),t=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:t}),this.appendDummyInput().appendField(t,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip((()=>{const t=this.getFieldValue("MODE"),i=this.getFieldValue("WHERE");let o="";switch(t+" "+i){case"SET FROM_START":case"SET FROM_END":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":o=e.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==i&&"FROM_END"!==i||(o+="  "+e.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),o}))},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation"),i=this.getInput("AT")instanceof e.ValueInput$$module$build$src$core$inputs$value_input;return t.setAttribute("at",String(i)),t},domToMutation:function(t){t="false"!==t.getAttribute("at"),this.updateAt_(t)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const i=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});i.setValidator((function(e){const i="FROM_START"===e||"FROM_END"===e;if(i!==t){const t=this.getSourceBlock();return t.updateAt_(i),t.setFieldValue(e,"WHERE"),null}})),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(i,"WHERE")}};U.lists_setIndex=X;var Y={init:function(){this.WHERE_OPTIONS_1=[[e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");var i=this.getInput("AT1")instanceof e.ValueInput$$module$build$src$core$inputs$value_input;return t.setAttribute("at1",String(i)),i=this.getInput("AT2")instanceof e.ValueInput$$module$build$src$core$inputs$value_input,t.setAttribute("at2",String(i)),t},domToMutation:function(t){const e="true"===t.getAttribute("at1");t="true"===t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(t,i){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),i?(this.appendValueInput("AT"+t).setCheck("Number"),e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(e.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t);const o=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+t]});o.setValidator((function(e){const o="FROM_START"===e||"FROM_END"===e;if(o!==i){const i=this.getSourceBlock();return i.updateAt_(t,o),i.setFieldValue(e,"WHERE"+t),null}})),this.getInput("AT"+t).appendField(o,"WHERE"+t),1===t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),e.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};U.lists_getSublist=Y,U.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},U.lists_split={init:function(){const t=e.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[e.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[e.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!t)throw Error("field_dropdown not found");t.setValidator((t=>{this.updateType_(t)})),this.setHelpUrl(e.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(t,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(e.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((()=>{const t=this.getFieldValue("MODE");if("SPLIT"===t)return e.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===t)return e.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+t)}))},updateType_:function(t){if(this.getFieldValue("MODE")!==t){const t=this.getInput("INPUT").connection;t.setShadowDom(null);const e=t.targetBlock();e&&(t.disconnect(),e.isShadow()?e.dispose(!1):this.bumpNeighbours())}"SPLIT"===t?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const t=e.createElement$$module$build$src$core$utils$xml("mutation");return t.setAttribute("mode",this.getFieldValue("MODE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},e.defineBlocks$$module$build$src$core$common(U);var K={blocks:U},J={blocks:Object.assign({},U,N,A,S,y,d,a,i),lists:K,logic:H,loops:D,math:R,procedures:$,texts:_,variables:u,variablesDynamic:r};return J.__namespace__=e,J})?o.apply(e,n):o)||(t.exports=s)},548:function(t,e,i){var o,n,s;n=[i(500),i(955),i(822)],void 0===(s="function"==typeof(o=function(t,e,i){"use strict";return t.setLocale(e),t})?o.apply(e,n):o)||(t.exports=s)},955:function(t,e){var i,o;void 0===(o="function"==typeof(i=function(){"use strict";var t=t||{Msg:Object.create(null)};return t.Msg.ADD_COMMENT="Add Comment",t.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",t.Msg.CHANGE_VALUE_TITLE="Change value:",t.Msg.CLEAN_UP="Clean up Blocks",t.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",t.Msg.COLLAPSE_ALL="Collapse Blocks",t.Msg.COLLAPSE_BLOCK="Collapse Block",t.Msg.COLOUR_BLEND_COLOUR1="colour 1",t.Msg.COLOUR_BLEND_COLOUR2="colour 2",t.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",t.Msg.COLOUR_BLEND_RATIO="ratio",t.Msg.COLOUR_BLEND_TITLE="blend",t.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",t.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",t.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",t.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",t.Msg.COLOUR_RANDOM_TITLE="random colour",t.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",t.Msg.COLOUR_RGB_BLUE="blue",t.Msg.COLOUR_RGB_GREEN="green",t.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",t.Msg.COLOUR_RGB_RED="red",t.Msg.COLOUR_RGB_TITLE="colour with",t.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",t.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",t.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",t.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",t.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",t.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",t.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",t.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",t.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",t.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",t.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",t.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",t.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",t.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",t.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",t.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",t.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",t.Msg.CONTROLS_IF_MSG_ELSE="else",t.Msg.CONTROLS_IF_MSG_ELSEIF="else if",t.Msg.CONTROLS_IF_MSG_IF="if",t.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",t.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",t.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",t.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",t.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",t.Msg.CONTROLS_REPEAT_INPUT_DO="do",t.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",t.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",t.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",t.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",t.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",t.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",t.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",t.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",t.Msg.DELETE_BLOCK="Delete Block",t.Msg.DELETE_VARIABLE="Delete the '%1' variable",t.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",t.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",t.Msg.DIALOG_CANCEL="Cancel",t.Msg.DIALOG_OK="OK",t.Msg.DISABLE_BLOCK="Disable Block",t.Msg.DUPLICATE_BLOCK="Duplicate",t.Msg.DUPLICATE_COMMENT="Duplicate Comment",t.Msg.ENABLE_BLOCK="Enable Block",t.Msg.EXPAND_ALL="Expand Blocks",t.Msg.EXPAND_BLOCK="Expand Block",t.Msg.EXTERNAL_INPUTS="External Inputs",t.Msg.HELP="Help",t.Msg.INLINE_INPUTS="Inline Inputs",t.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",t.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",t.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",t.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",t.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",t.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",t.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",t.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",t.Msg.LISTS_GET_INDEX_FIRST="first",t.Msg.LISTS_GET_INDEX_FROM_END="# from end",t.Msg.LISTS_GET_INDEX_FROM_START="#",t.Msg.LISTS_GET_INDEX_GET="get",t.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",t.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",t.Msg.LISTS_GET_INDEX_LAST="last",t.Msg.LISTS_GET_INDEX_RANDOM="random",t.Msg.LISTS_GET_INDEX_REMOVE="remove",t.Msg.LISTS_GET_INDEX_TAIL="",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",t.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",t.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",t.Msg.LISTS_GET_SUBLIST_END_LAST="to last",t.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",t.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",t.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",t.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",t.Msg.LISTS_GET_SUBLIST_TAIL="",t.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",t.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",t.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",t.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",t.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",t.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",t.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",t.Msg.LISTS_INLIST="in list",t.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",t.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",t.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",t.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",t.Msg.LISTS_LENGTH_TITLE="length of %1",t.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",t.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",t.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",t.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",t.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",t.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",t.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",t.Msg.LISTS_SET_INDEX_INPUT_TO="as",t.Msg.LISTS_SET_INDEX_INSERT="insert at",t.Msg.LISTS_SET_INDEX_SET="set",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",t.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",t.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",t.Msg.LISTS_SORT_ORDER_DESCENDING="descending",t.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",t.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",t.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",t.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",t.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",t.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",t.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",t.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",t.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",t.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",t.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",t.Msg.LOGIC_BOOLEAN_FALSE="false",t.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",t.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",t.Msg.LOGIC_BOOLEAN_TRUE="true",t.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",t.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",t.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",t.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",t.Msg.LOGIC_NEGATE_TITLE="not %1",t.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",t.Msg.LOGIC_NULL="null",t.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",t.Msg.LOGIC_NULL_TOOLTIP="Returns null.",t.Msg.LOGIC_OPERATION_AND="and",t.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",t.Msg.LOGIC_OPERATION_OR="or",t.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",t.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",t.Msg.LOGIC_TERNARY_CONDITION="test",t.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",t.Msg.LOGIC_TERNARY_IF_FALSE="if false",t.Msg.LOGIC_TERNARY_IF_TRUE="if true",t.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",t.Msg.MATH_ADDITION_SYMBOL="+",t.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",t.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",t.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",t.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",t.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",t.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",t.Msg.MATH_CHANGE_TITLE="change %1 by %2",t.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",t.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",t.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: Ï (3.141â¦), e (2.718â¦), Ï (1.618â¦), sqrt(2) (1.414â¦), sqrt(Â½) (0.707â¦), or â (infinity).",t.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",t.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",t.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",t.Msg.MATH_DIVISION_SYMBOL="Ã·",t.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",t.Msg.MATH_IS_EVEN="is even",t.Msg.MATH_IS_NEGATIVE="is negative",t.Msg.MATH_IS_ODD="is odd",t.Msg.MATH_IS_POSITIVE="is positive",t.Msg.MATH_IS_PRIME="is prime",t.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",t.Msg.MATH_IS_WHOLE="is whole",t.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",t.Msg.MATH_MODULO_TITLE="remainder of %1 Ã· %2",t.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",t.Msg.MATH_MULTIPLICATION_SYMBOL="Ã",t.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",t.Msg.MATH_NUMBER_TOOLTIP="A number.",t.Msg.MATH_ONLIST_HELPURL="",t.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",t.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",t.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",t.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",t.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",t.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",t.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",t.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",t.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",t.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",t.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",t.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",t.Msg.MATH_POWER_SYMBOL="^",t.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",t.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",t.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",t.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",t.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",t.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",t.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",t.Msg.MATH_ROUND_OPERATOR_ROUND="round",t.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",t.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",t.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",t.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",t.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",t.Msg.MATH_SINGLE_OP_ROOT="square root",t.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",t.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",t.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",t.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",t.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",t.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",t.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",t.Msg.MATH_SUBTRACTION_SYMBOL="-",t.Msg.MATH_TRIG_ACOS="acos",t.Msg.MATH_TRIG_ASIN="asin",t.Msg.MATH_TRIG_ATAN="atan",t.Msg.MATH_TRIG_COS="cos",t.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",t.Msg.MATH_TRIG_SIN="sin",t.Msg.MATH_TRIG_TAN="tan",t.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",t.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",t.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",t.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",t.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",t.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",t.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",t.Msg.NEW_NUMBER_VARIABLE="Create number variable...",t.Msg.NEW_STRING_VARIABLE="Create string variable...",t.Msg.NEW_VARIABLE="Create variable...",t.Msg.NEW_VARIABLE_TITLE="New variable name:",t.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",t.Msg.ORDINAL_NUMBER_SUFFIX="",t.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",t.Msg.PROCEDURES_BEFORE_PARAMS="with:",t.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",t.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",t.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",t.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",t.Msg.PROCEDURES_CREATE_DO="Create '%1'",t.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",t.Msg.PROCEDURES_DEFNORETURN_DO="",t.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",t.Msg.PROCEDURES_DEFNORETURN_TITLE="to",t.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",t.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_DEFRETURN_RETURN="return",t.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",t.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",t.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",t.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",t.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",t.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",t.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",t.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",t.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",t.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",t.Msg.REDO="Redo",t.Msg.REMOVE_COMMENT="Remove Comment",t.Msg.RENAME_VARIABLE="Rename variable...",t.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",t.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg.TEXT_APPEND_TITLE="to %1 append text %2",t.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",t.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",t.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",t.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",t.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",t.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",t.Msg.TEXT_CHARAT_FIRST="get first letter",t.Msg.TEXT_CHARAT_FROM_END="get letter # from end",t.Msg.TEXT_CHARAT_FROM_START="get letter #",t.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",t.Msg.TEXT_CHARAT_LAST="get last letter",t.Msg.TEXT_CHARAT_RANDOM="get random letter",t.Msg.TEXT_CHARAT_TAIL="",t.Msg.TEXT_CHARAT_TITLE="in text %1 %2",t.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",t.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",t.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",t.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",t.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",t.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",t.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",t.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",t.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",t.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",t.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",t.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",t.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",t.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",t.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",t.Msg.TEXT_GET_SUBSTRING_TAIL="",t.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",t.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",t.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",t.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",t.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",t.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",t.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",t.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",t.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",t.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",t.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",t.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",t.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg.TEXT_LENGTH_TITLE="length of %1",t.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",t.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",t.Msg.TEXT_PRINT_TITLE="print %1",t.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",t.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",t.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",t.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",t.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",t.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",t.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",t.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",t.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",t.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",t.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",t.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",t.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",t.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",t.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",t.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",t.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",t.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",t.Msg.TODAY="Today",t.Msg.UNDO="Undo",t.Msg.UNNAMED_KEY="unnamed",t.Msg.VARIABLES_DEFAULT_NAME="item",t.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",t.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",t.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",t.Msg.VARIABLES_SET="set %1 to %2",t.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",t.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",t.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",t.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",t.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",t.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",t.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",t.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",t.Msg.CONTROLS_FOREACH_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_FOR_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=t.Msg.CONTROLS_IF_MSG_ELSEIF,t.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=t.Msg.CONTROLS_IF_MSG_ELSE,t.Msg.CONTROLS_IF_IF_TITLE_IF=t.Msg.CONTROLS_IF_MSG_IF,t.Msg.CONTROLS_IF_MSG_THEN=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.LISTS_CREATE_WITH_ITEM_TITLE=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.MATH_CHANGE_TITLE_ITEM=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.PROCEDURES_DEFRETURN_COMMENT=t.Msg.PROCEDURES_DEFNORETURN_COMMENT,t.Msg.PROCEDURES_DEFRETURN_DO=t.Msg.PROCEDURES_DEFNORETURN_DO,t.Msg.PROCEDURES_DEFRETURN_PROCEDURE=t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,t.Msg.PROCEDURES_DEFRETURN_TITLE=t.Msg.PROCEDURES_DEFNORETURN_TITLE,t.Msg.TEXT_APPEND_VARIABLE=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.COLOUR_HUE="20",t.Msg.LISTS_HUE="260",t.Msg.LOGIC_HUE="210",t.Msg.LOOPS_HUE="120",t.Msg.MATH_HUE="230",t.Msg.PROCEDURES_HUE="290",t.Msg.TEXTS_HUE="160",t.Msg.VARIABLES_DYNAMIC_HUE="310",t.Msg.VARIABLES_HUE="330",t.Msg})?i.apply(e,[]):i)||(t.exports=o)}},e={};function i(o){var n=e[o];if(void 0!==n)return n.exports;var s=e[o]={id:o,exports:{}};return t[o].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nc=void 0,(()=>{"use strict";var t=i(548);const{ASTNode:e,BasicCursor:o,Block:n,BlockSvg:s,Blocks:r,COLLAPSED_FIELD_NAME:a,COLLAPSED_INPUT_NAME:l,COLLAPSE_CHARS:h,CodeGenerator:c,CollapsibleToolboxCategory:u,ComponentManager:d,Connection:p,ConnectionChecker:g,ConnectionDB:f,ConnectionType:m,ContextMenu:v,ContextMenuItems:b,ContextMenuRegistry:_,Css:y,Cursor:T,DELETE_VARIABLE_ID:E,DeleteArea:w,DragTarget:k,DropDownDiv:I,Events:$,Extensions:S,Field:C,FieldCheckbox:O,FieldDropdown:R,FieldImage:A,FieldLabel:M,FieldLabelSerializable:x,FieldNumber:L,FieldTextInput:D,FieldVariable:N,Flyout:P,FlyoutButton:B,FlyoutMetricsManager:F,Generator:H,Gesture:U,Grid:G,HorizontalFlyout:V,INPUT_VALUE:W,Input:z,InsertionMarkerManager:j,InsertionMarkerPreviewer:X,Marker:Y,MarkerManager:K,Menu:J,MenuItem:q,MetricsManager:Z,Msg:Q,NEXT_STATEMENT:tt,Names:et,OPPOSITE_TYPE:it,OUTPUT_VALUE:ot,Options:nt,PREVIOUS_STATEMENT:st,PROCEDURE_CATEGORY_NAME:rt,Procedures:at,RENAME_VARIABLE_ID:lt,RenderedConnection:ht,Scrollbar:ct,ScrollbarPair:ut,ShortcutItems:dt,ShortcutRegistry:pt,TOOLBOX_AT_BOTTOM:gt,TOOLBOX_AT_LEFT:ft,TOOLBOX_AT_RIGHT:mt,TOOLBOX_AT_TOP:vt,TabNavigateCursor:bt,Theme:_t,ThemeManager:yt,Themes:Tt,Toolbox:Et,ToolboxCategory:wt,ToolboxItem:kt,ToolboxSeparator:It,Tooltip:$t,Touch:St,Trashcan:Ct,UnattachedFieldError:Ot,VARIABLE_CATEGORY_NAME:Rt,VARIABLE_DYNAMIC_CATEGORY_NAME:At,VERSION:Mt,VariableMap:xt,VariableModel:Lt,Variables:Dt,VariablesDynamic:Nt,VerticalFlyout:Pt,WidgetDiv:Bt,Workspace:Ft,WorkspaceAudio:Ht,WorkspaceDragger:Ut,WorkspaceSvg:Gt,Xml:Vt,ZoomControls:Wt,blockAnimations:zt,blockRendering:jt,browserEvents:Xt,bubbles:Yt,bumpObjects:Kt,clipboard:Jt,comments:qt,common:Zt,config:Qt,constants:te,defineBlocksWithJsonArray:ee,dialog:ie,dragging:oe,fieldRegistry:ne,geras:se,getMainWorkspace:re,getSelected:ae,hasBubble:le,hideChaff:he,icons:ce,inject:ue,inputs:de,isCopyable:pe,isDeletable:ge,isDraggable:fe,isIcon:me,isObservable:ve,isPaster:be,isRenderedElement:_e,isSelectable:ye,isSerializable:Te,isVariableBackedParameterModel:Ee,procedures:we,registry:ke,renderManagement:Ie,serialization:$e,setLocale:Se,setParentContainer:Ce,svgResize:Oe,thrasos:Re,uiPosition:Ae,utils:Me,zelos:xe}=t;var Le=i(993);const De=Zt.createBlockDefinitionsFromJsonArray([{type:"binary_op",message0:"%1 %2 %3",args0:[{type:"field_dropdown",name:"OPERATION",options:[["and","AND"],["or","OR"]]},{type:"input_value",name:"OPERAND1",check:"bool"},{type:"input_value",name:"OPERAND2",check:"bool"}],output:"bool",colour:230},{type:"not",message0:"not %1",args0:[{type:"input_value",name:"OPERAND",check:"bool"}],output:"bool",colour:230},{type:"node",message0:"âªï¸ %1",args0:[{type:"field_dropdown",name:"VARNAME",options:[["a","a"],["b","b"],["c","c"],["d","d"],["e","e"],["f","f"],["g","g"]]}],output:["expr","variable"],colour:230},{type:"target_node",message0:"ð¢",args0:[],output:"expr",colour:230},{type:"points_to",message0:"%1 -> %2",args0:[{type:"input_value",name:"SOURCE",check:"expr"},{type:"input_value",name:"TARGET",check:"expr"}],output:"bool",colour:230,inputsInline:!0},{type:"quantifier",message0:"%1 node named %2\n%3",args0:[{type:"field_dropdown",name:"QUANTIFIER",options:[["for any","FORALL"],["exists a","EXISTS"]]},{type:"input_value",name:"FREEVAR",check:"variable"},{type:"input_value",name:"PREDICATE",check:"bool"}],output:"bool",colour:230,inputsInline:!1}]),Ne=new H("fol");Ne.forBlock.target_node=function(t,e){return["y",0]},Ne.forBlock.node=function(t,e){return["x"+(t.getFieldValue("VARNAME").charCodeAt(0)-97),0]},Ne.forBlock.points_to=function(t,e){return[`R(${e.valueToCode(t,"SOURCE",0)},${e.valueToCode(t,"TARGET",0)})`,0]},Ne.forBlock.binary_op=function(t,e){return[`${"AND"===t.getFieldValue("OPERATION")?"&":"|"}(${e.valueToCode(t,"OPERAND1",0)},${e.valueToCode(t,"OPERAND2",0)})`,0]},Ne.forBlock.not=function(t,e){return[`~(${e.valueToCode(t,"OPERAND",0)})`,0]},Ne.forBlock.quantifier=function(t,e){return[`${"FORALL"===t.getFieldValue("QUANTIFIER")?"A":"E"}${e.valueToCode(t,"FREEVAR",0)}(${e.valueToCode(t,"PREDICATE",0)})`,0]};var Pe=i(500);const{ASTNode:Be,BasicCursor:Fe,Block:He,BlockSvg:Ue,Blocks:Ge,COLLAPSED_FIELD_NAME:Ve,COLLAPSED_INPUT_NAME:We,COLLAPSE_CHARS:ze,CodeGenerator:je,CollapsibleToolboxCategory:Xe,ComponentManager:Ye,Connection:Ke,ConnectionChecker:Je,ConnectionDB:qe,ConnectionType:Ze,ContextMenu:Qe,ContextMenuItems:ti,ContextMenuRegistry:ei,Css:ii,Cursor:oi,DELETE_VARIABLE_ID:ni,DeleteArea:si,DragTarget:ri,DropDownDiv:ai,Events:li,Extensions:hi,Field:ci,FieldCheckbox:ui,FieldDropdown:di,FieldImage:pi,FieldLabel:gi,FieldLabelSerializable:fi,FieldNumber:mi,FieldTextInput:vi,FieldVariable:bi,Flyout:_i,FlyoutButton:yi,FlyoutMetricsManager:Ti,Generator:Ei,Gesture:wi,Grid:ki,HorizontalFlyout:Ii,INPUT_VALUE:$i,Input:Si,InsertionMarkerManager:Ci,InsertionMarkerPreviewer:Oi,Marker:Ri,MarkerManager:Ai,Menu:Mi,MenuItem:xi,MetricsManager:Li,Msg:Di,NEXT_STATEMENT:Ni,Names:Pi,OPPOSITE_TYPE:Bi,OUTPUT_VALUE:Fi,Options:Hi,PREVIOUS_STATEMENT:Ui,PROCEDURE_CATEGORY_NAME:Gi,Procedures:Vi,RENAME_VARIABLE_ID:Wi,RenderedConnection:zi,Scrollbar:ji,ScrollbarPair:Xi,ShortcutItems:Yi,ShortcutRegistry:Ki,TOOLBOX_AT_BOTTOM:Ji,TOOLBOX_AT_LEFT:qi,TOOLBOX_AT_RIGHT:Zi,TOOLBOX_AT_TOP:Qi,TabNavigateCursor:to,Theme:eo,ThemeManager:io,Themes:oo,Toolbox:no,ToolboxCategory:so,ToolboxItem:ro,ToolboxSeparator:ao,Tooltip:lo,Touch:ho,Trashcan:co,UnattachedFieldError:uo,VARIABLE_CATEGORY_NAME:po,VARIABLE_DYNAMIC_CATEGORY_NAME:go,VERSION:fo,VariableMap:mo,VariableModel:vo,Variables:bo,VariablesDynamic:_o,VerticalFlyout:yo,WidgetDiv:To,Workspace:Eo,WorkspaceAudio:wo,WorkspaceDragger:ko,WorkspaceSvg:Io,Xml:$o,ZoomControls:So,blockAnimations:Co,blockRendering:Oo,browserEvents:Ro,bubbles:Ao,bumpObjects:Mo,clipboard:xo,comments:Lo,common:Do,config:No,constants:Po,defineBlocksWithJsonArray:Bo,dialog:Fo,dragging:Ho,fieldRegistry:Uo,geras:Go,getMainWorkspace:Vo,getSelected:Wo,hasBubble:zo,hideChaff:jo,icons:Xo,inject:Yo,inputs:Ko,isCopyable:Jo,isDeletable:qo,isDraggable:Zo,isIcon:Qo,isObservable:tn,isPaster:en,isRenderedElement:on,isSelectable:nn,isSerializable:sn,isVariableBackedParameterModel:rn,procedures:an,registry:ln,renderManagement:hn,serialization:cn,setLocale:un,setParentContainer:dn,svgResize:pn,thrasos:gn,uiPosition:fn,utils:mn,zelos:vn}=Pe,bn="folGeneratorWorkspace";class _n{constructor(t,e){this.token=t,this.children=e}}class yn{constructor(t,e,i,o){this.varTokens=t,this.fxnTokens=e,this.relTokens=i,this.cstTokens=o,this.qfrTokens=["A","E"],this.binConTokens=["&","|"],this.unConTokens=["~"],this.unconsumed=""}tryParseToken(t){for(;this.unconsumed.startsWith(" ");)this.unconsumed=this.unconsumed.slice(1);if(this.unconsumed.startsWith(t))return this.unconsumed=this.unconsumed.slice(t.length),new _n(t,[])}tryParseAnyToken(t){for(let e=0;e<t.length;e++){let i=this.tryParseToken(t.at(e));if(null!=i)return i}}tryParseVar(){return this.tryParseAnyToken(this.varTokens)}tryParseCst(){return this.tryParseAnyToken(this.cstTokens)}mustParseFxn(){let t=this.tryParseAnyToken(this.fxnTokens);if(null==t)return;if(null==this.tryParseToken("("))throw new SyntaxError("Expected open paren following function name "+t.token);let e=[];for(e.push(this.mustParseExpr());null!=this.tryParseToken(",");)e.push(this.mustParseExpr());if(null==this.tryParseToken(")"))throw new SyntaxError("Expected close paren following args of function "+t.token);return t.children=e,t}mustParseExpr(){let t=this.tryParseCst();if(null!=t)return t;if(t=this.tryParseVar(),null!=t)return t;if(t=this.mustParseFxn(),null!=t)return t;throw new SyntaxError("Expected expression, but instead found "+this.unconsumed)}mustParseFormula(t=!0){let e,i=this.tryParseToken("(");if(null!=i&&(e=this.mustParseFormula(),null==this.tryParseToken(")")))throw new SyntaxError("Expected close paren closing parenthesized formula");if(null==e&&(i=this.tryParseAnyToken(this.unConTokens),null!=i&&(e=i,e.children.push(this.mustParseFormula(!1)),t&&(i=this.tryParseAnyToken(this.binConTokens),null!=i)))){let t=i;t.children=[e,this.mustParseFormula()],e=t}if(null==e&&(i=this.tryParseAnyToken(this.qfrTokens),null!=i)){if(e=i,i=this.tryParseAnyToken(this.varTokens),null==i)throw new SyntaxError("Expected variable name after quantifier "+e.token);e.children=[i,this.mustParseFormula(!1)]}if(null==e&&(i=this.tryParseAnyToken(this.relTokens),null!=i)){if(e=i,null==this.tryParseToken("("))throw new SyntaxError("Expected open paren for call to relation "+e.token);for(e.children.push(this.mustParseExpr());null!=this.tryParseToken(",");)e.children.push(this.mustParseExpr());if(null==this.tryParseToken(")"))throw new SyntaxError("Expected close paren for call to relation "+e.token)}if(null==e)throw new SyntaxError("Expected string starting with formula, but found "+this.unconsumed);if(t&&(i=this.tryParseAnyToken(this.binConTokens),null!=i)){let t=i;t.children=[e,this.mustParseFormula()],e=t}return e}mustParseEntireFormula(){let t=this.mustParseFormula();if(this.unconsumed.replace(/\s/g,"").length>0)throw new SyntaxError("Unexpected tokens at end of string: "+this.unconsumed);return t}}class Tn{constructor(t,e,i,o){this.universe=t,this.cmap=e,this.fmap=i,this.rmap=o;let n=[...Array(99).keys()].map((t=>"x"+t));this.parser=new yn(n,Object.keys(i),Object.keys(o),Object.keys(e))}evaluateExprNodeInContext(t,e){if(Object.keys(this.fmap).indexOf(t.token)>-1){let i=this.fmap[t.token];if(t.children.length!=i.length)throw new Error("Function "+t.token+" expected "+i.length+" arguments, got "+t.children.length);return i(...t.children.map((t=>this.evaluateExprNodeInContext(t,e))))}if(Object.keys(this.cmap).indexOf(t.token)>-1)return this.cmap[t.token];if(Object.keys(e).indexOf(t.token)>-1)return e[t.token];throw new Error("Literal '"+t.token+"' unrecognized")}evaluateExpr(t){this.parser.unconsumed=t;let e=this.parser.mustParseExpr();return this.evaluateNodeInContext(e,{})}evaluateFormulaNodeInContext(t,e){if(this.parser.unConTokens.indexOf(t.token)>-1&&"~"==t.token)return!this.evaluateFormulaNodeInContext(t.children[0],e);if(this.parser.binConTokens.indexOf(t.token)>-1){if("&"===t.token)return this.evaluateFormulaNodeInContext(t.children[0],e)&&this.evaluateFormulaNodeInContext(t.children[1],e);if("|"===t.token)return this.evaluateFormulaNodeInContext(t.children[0],e)||this.evaluateFormulaNodeInContext(t.children[1],e)}if(this.parser.relTokens.indexOf(t.token)>-1)return(0,this.rmap[t.token])(...t.children.map((t=>this.evaluateExprNodeInContext(t,e))));if(this.parser.qfrTokens.indexOf(t.token)>-1){if("A"===t.token){for(let i=0;i<this.universe.length;i++){let o={...e};if(o[t.children[0].token]=this.universe[i],!this.evaluateFormulaNodeInContext(t.children[1],o))return!1}return!0}if("E"===t.token){for(let i=0;i<this.universe.length;i++){let o={...e};if(o[t.children[0].token]=this.universe[i],this.evaluateFormulaNodeInContext(t.children[1],o))return!0}return!1}}throw new SyntaxError("Unrecognized token "+t.token)}evaluateFormulaInContext(t,e){this.parser.unconsumed=t;let i=this.parser.mustParseEntireFormula();return this.evaluateFormulaNodeInContext(i,e)}}var En=["y"].concat(Array.from(Array(99).keys()).map((t=>`x${t}`)));new yn(En,[],["eq","R"],[]);var wn=i(72),kn=i.n(wn),In=i(825),$n=i.n(In),Sn=i(659),Cn=i.n(Sn),On=i(56),Rn=i.n(On),An=i(540),Mn=i.n(An),xn=i(113),Ln=i.n(xn),Dn=i(523),Nn={};Nn.styleTagTransform=Ln(),Nn.setAttributes=Rn(),Nn.insert=Cn().bind(null,"head"),Nn.domAPI=$n(),Nn.insertStyleElement=Mn(),kn()(Dn.A,Nn),Dn.A&&Dn.A.locals&&Dn.A.locals,Zt.defineBlocks(De),document.getElementById("networkbox");const Pn=document.getElementById("blocklyDiv");var Bn=document.getElementById("levels-list");const Fn=ue(Pn,{toolbox:{kind:"flyoutToolbox",contents:[{kind:"block",type:"binary_op"},{kind:"block",type:"not"},{kind:"block",type:"node"},{kind:"block",type:"target_node"},{kind:"block",type:"points_to"},{kind:"block",type:"quantifier"}]}});var Hn=new class{constructor(){this.level=-1,this.size=0,this.edglist=[],this.targets=[],this.selected=[];var t=["y"].concat(Array.from(Array(99).keys()).map((t=>`x${t}`)));this.fop=new yn(t,[],["eq","R"],[]),this.fom=void 0}erdosRenyi(t,e){this.size=t;let i=Array.from(Array(t).keys()),o=[].concat(...i.map((t=>i.map((e=>[t,e])))));return Array.from(o.filter((t=>Math.random()<e)))}fromEdgeList(t,e){this.size=t;let i=Array.from(Array(t).keys());this.fom=new Tn(i,{},{},{eq:(t,e)=>t==e,R:(t,i)=>e.some((e=>e[0]===t&&e[1]===i))})}getSat(t){let e=Array.from(Array(this.fom.universe.length).keys()),i=Array.from(e.map((e=>this.fom.evaluateFormulaInContext(t,{y:e}))));return e.filter((t=>i[t]))}runRandomGraph(t,e){var i=this.erdosRenyi(t,e);this.edglist=i,this.fromEdgeList(t,i),this.fom.parser=this.fop,this.level=-1,this.target=[]}runLevelGraph(t){var e=t.nodes,i=t.edges;this.edglist=i,this.fromEdgeList(e,i),this.fom.parser=this.fop,this.target=t.target}};Hn.runRandomGraph(20,.1);var Un=new class{constructor(){this.visNodes=void 0,this.visEdges=void 0,this.network=void 0}visNodesList(t){let e=Array.from(Array(t).keys()).map((t=>({id:t,label:"",color:{background:"black",border:"orange",highlight:{background:"black",border:"orange"}},borderWidth:0})));this.visNodes=new Le.vis.DataSet(e)}visEdgesList(t){var e=[];for(let o=0;o<t.length;o++){var i=t[o];e.some((t=>t.from===i[1]&&t.to===i[0]))||(t.slice(o).some((t=>t[0]===i[1]&&t[1]===i[0]))?e.push({from:i[0],to:i[1],width:1}):e.push({from:i[0],to:i[1],width:1,arrows:"to"}))}this.visEdges=new Le.vis.DataSet(e)}setNodeColor(t,e,i){this.visNodes.update({id:t,color:{background:e,border:i,highlight:{background:e,border:i}}})}setNodeBorder(t,e){this.visNodes.update({id:t,borderWidth:e,borderWidthSelected:e})}highlightSelected(t){Array.from(Array(this.visNodes.length).keys());for(let e=0;e<this.visNodes.length;e++)t.includes(e)?this.setNodeBorder(e,3):this.setNodeBorder(e,0)}render(){scroll(0,0);var t={nodes:this.visNodes,edges:this.visEdges};this.network=new Le.vis.Network(document.getElementById("networkbox"),t,{edges:{color:{inherit:!1}}})}styleNodes(t){for(let e=0;e<this.visNodes.length;e++)t.includes(e)?this.setNodeColor(e,"#22A7F0","orange"):this.setNodeColor(e,"black","orange")}markLevelCompleted(t){document.getElementById(`level-marker-${t}`).innerHTML=" â"}};Un.visNodesList(20),Un.visEdgesList(Hn.edglist);var Gn=new class{constructor(t,e){this.model=t,this.view=e}randomize(){this.model.runRandomGraph(20,.1),this.view.visNodesList(this.model.size),this.view.visEdgesList(this.model.edglist),this.view.render()}runLevel(t){this.model.runLevelGraph(t),this.model.level=t.num,this.view.visNodesList(this.model.size),this.view.visEdgesList(this.model.edglist),this.view.render(),this.view.styleNodes(this.model.target)}tryPredicate(t){var e=this.model.getSat(t);this.view.highlightSelected(e);var i=-1!=this.model.level&&e.toString()===this.model.target.toString();return i&&this.view.markLevelCompleted(this.model.level),i}}(Hn,Un);Gn.randomize();for(let t in levels){var Vn=levels[t],Wn=document.createElement("li"),zn=document.createElement("a"),jn=document.createElement("a");jn.textContent=" â",jn.id=`level-marker-${t}`,zn.textContent=Vn.name,zn.href=`javascript:c.runLevel(levels[${t}])`,Wn.appendChild(zn),Wn.appendChild(jn),Bn.appendChild(Wn)}const Xn=()=>{const t=Ne.workspaceToCode(Fn);console.log(t),Gn.tryPredicate(t)};!function(t){const e=window.localStorage?.getItem(bn);e&&(li.disable(),cn.workspaces.load(JSON.parse(e),t,!1),li.enable())}(Fn),Xn(),Fn.addChangeListener((t=>{t.isUiEvent||function(t){const e=cn.workspaces.save(t);window.localStorage?.setItem(bn,JSON.stringify(e))}(Fn)})),Fn.addChangeListener((t=>{t.isUiEvent||t.type==$.FINISHED_LOADING||Fn.isDragging()||Xn()}))})()})();